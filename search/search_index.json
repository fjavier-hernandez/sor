{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Sistemas Operativos en Red","text":"<p>Estos apuntes desarrollan los materiales did\u00e1cticos del m\u00f3dulo de Sistemas Operativos en Red (SOR), el cual se imparte en el IES Severo Ochoa. Dicho m\u00f3dulo se realiza durante el segundo curso del ciclo formativo de grado medio de Sistemas Microinform\u00e1ticos en Red (SMR), cuyas ense\u00f1anzas m\u00ednimas se definen en el RD 1691/2007 y se concretan en el curr\u00edculo de la ORDEN de 29 de julio de 2009.</p> <p>Cabe destacar las siguientes caracter\u00edsticas del m\u00f3dulo SOR:</p> <ul> <li>En la modalidad presencial La duraci\u00f3n del m\u00f3dulo es de 176 horas lectivas, a raz\u00f3n de 8 horas semanales. </li> <li>En el caso de semipresencial se realizaran 4 horas tutor\u00edas colectivas y 4 horas de tutor\u00edas telem\u00e1ticas semanalmente, de las cuales las tutor\u00edas colectivas se imparten 2 horas por la ma\u00f1ana y 2 horas por la tarde.</li> </ul>"},{"location":"index.html#que-voy-a-aprender","title":"\u00bfQu\u00e9 voy a aprender?","text":"<p>El aprendizaje en Formaci\u00f3n Profesional (FP) se basa en las competencias profesionales, personales y sociales (CPPS), las cuales se definen en el art\u00edculo 5 del citado Real Decreto (RD 1691/2007). Estas competencias se traducen en el conjunto de conocimientos y destrezas que permiten dar respuesta a los requerimientos del sector productivo en el que se trabaja.</p> <p>El m\u00f3dulo de SOR contribuyen a las siguientes Competencias Profesionales:</p> <ul> <li>Instalar, configurar y mantener servicios multiusuario, aplicaciones y dispositivos compartidos en un entorno de red local, atendiendo a las necesidades y requerimientos especificados.</li> <li>Instalar y configurar recursos compartidos (acceso a directorios, impresi\u00f3n, accesos remotos, entre otros) en condiciones de calidad.</li> <li>Administrar usuarios de acuerdo a las especificaciones de explotaci\u00f3n para garantizar los accesos y la disponibilidad de los recursos del sistema.</li> <li>Gestionar los recursos de diferentes sistemas operativos (programando y verificando su cumplimiento).</li> <li>Aplicar los protocolos y normas de seguridad, calidad de los servicios instalados.</li> <li>Mantener un esp\u00edritu constante de innovaci\u00f3n y actualizaci\u00f3n en el \u00e1mbito del sector inform\u00e1tico.</li> </ul>"},{"location":"index.html#resultados-de-aprendizaje","title":"Resultados de aprendizaje","text":"<p>Un Resultado de Aprendizaje (RA): \"es una declaraci\u00f3n de lo que el estudiante se espera que conozca, comprenda y sea capaz de hacer al finalizar un periodo de aprendizaje\".</p> <p>Es importante conocer los RAs ya que la evaluaci\u00f3n de la formaci\u00f3n profesional se basa en la valoraci\u00f3n dichos resultados de aprendizaje. Los Resultados de Aprendizaje de SOR son:</p> <ol> <li>Instala sistemas operativos en red describiendo sus caracter\u00edsticas e interpretando la documentaci\u00f3n t\u00e9cnica.</li> <li>Gestiona usuarios y grupos de sistemas operativos en red, interpretando especificaciones y aplicando herramientas del sistema.</li> <li>Realiza tareas de gesti\u00f3n sobre dominios identificando necesidades y aplicando herramientas de administraci\u00f3n de dominios.</li> <li>Gestiona los recursos compartidos del sistema, interpretando especificaciones y determinando niveles de seguridad.</li> <li>Realiza tareas de monitorizaci\u00f3n y uso del sistema operativo en red, describiendo las herramientas utilizadas e identificando las principales incidencias.</li> <li>Realiza tareas de integraci\u00f3n de sistemas operativos libres y propietarios, describiendo las ventajas de compartir recursos e instalando software espec\u00edfico.</li> </ol>"},{"location":"index.html#mapa-general-de-la-programacion-didactica","title":"Mapa General de la Programaci\u00f3n Did\u00e1ctica","text":"<p>A modo de resumen de la Programaci\u00f3n did\u00e1ctica (PD) de SOR, se muestra la secuenciaci\u00f3n de las Unidades de trabajo planificadas y los Resultados de aprendizaje (RAs) tratados en cada una de dichas unidades.</p> Nombre del m\u00f3dulo profesional Curso Sistemas Operativos en Red (SOR) 2\u00ba UUTT RA01 RA02 RA03 RA04 RA05 RA06 Duraci\u00f3n 1. Instalaci\u00f3n de Sistemas Operativos en red. Linux y Windows.  X 16h 2. Servicio de directorio en Linux. X 16h 3. Administraci\u00f3n de usuarios y grupos Linux. X 16h 4. Administraci\u00f3n y monitorizaci\u00f3n de recursos compartidos en Linux. X X 16h 5. Servicio de directorio en Windows Server (WS). X 16h 6. Administraci\u00f3n de usuarios y grupos WS. X 7. Administraci\u00f3n y monitorizaci\u00f3n de recursos compartidos en WS. X X 16h 8. Integraci\u00f3n de los Sistemas Operativos en red. X 16h"},{"location":"Evaluacion.html","title":"Evaluaci\u00f3n","text":"<p>La evaluaci\u00f3n es un proceso continuo y formativo basado en la calificaci\u00f3n de competencias a trav\u00e9s de los resultados de aprendizaje (RAs). </p> <p>En el caso de SOR se obtiene a trav\u00e9s la media ponderada de las calificaciones de las actividades realizadas en cada RA, una vez obtenidas las calificaciones de todos los RAs, se realiza de nuevo la media ponderada simple de las calificaciones de los RAs para la obtenci\u00f3n de la nota del m\u00f3dulo profesional.</p> <p>IMPORTANTE</p> <ul> <li>Por lo tanto LA CALIFICACI\u00d3N FINAL DEL M\u00d3DULO se obtendr\u00e1 de la media ponderada de las calificaciones de los RAs.</li> </ul>"},{"location":"Evaluacion.html#procedimientos-de-evaluacion","title":"Procedimientos de Evaluaci\u00f3n","text":"<ul> <li>La calificaci\u00f3n de cada RA se obtendr\u00e1 de la media ponderada de las actividades formativas trabajadas. Para ello se utilizan los siguientes procedimientos de evaluaci\u00f3n:</li> </ul> INSTRUMENTO DE EVALUACI\u00d3N INSTRUMENTO DE CALIFICACI\u00d3N IE1. (10 puntos) Pr\u00e1cticas/Trabajos (PT):Pr\u00e1cticas de investigaci\u00f3n o guiadas, evaluables con IC1 o IC2. IC1: r\u00fabrica practica individual. IC2: r\u00fabrica pr\u00e1ctica colaborativa. IE2 (60 puntos): Defensa de proyectos (DP): Mediante sesiones de evaluaci\u00f3n orales, se presentan el proyecto. IC3. IC3: r\u00fabrica exposici\u00f3n."},{"location":"Evaluacion.html#evaluaciones-trimestrales","title":"Evaluaciones Trimestrales","text":"<ul> <li> <p>Primer trimestre: la calificaci\u00f3n se obtiene de la media ponderada simple de las actividades formativas evaluables trabajadas durante el primer trimestre, por lo tanto NO HABR\u00c1 EXAMEN.</p> </li> <li> <p>Segundo trimestre: media ponderada simple de todas las actividades formativas, incluyendo la presentaci\u00f3n individual del \"Proyecto de M\u00f3dulo\" que se realizar\u00e1 en lugar del examen de la 2\u00aa evaluaci\u00f3n.</p> </li> </ul>"},{"location":"Evaluacion.html#evaluaciones-extraordinaria","title":"Evaluaciones Extraordinaria","text":"<p>En el caso de no superar alg\u00fan resultado de aprendizaje durante la evaluaci\u00f3n continua se deber\u00e1 presentarse a la extraordinaria:</p> <p>IMPORTANTE</p> <ul> <li>se debe aprobar las pr\u00e1cticas pendientes y el proyecto final de m\u00f3dulo en la convocatoria Extraordinaria.</li> </ul>"},{"location":"ProgramacionAula.html","title":"Programaci\u00f3n de Aula","text":"<p>Las unidades de trabajo (UT) se han temporalizado siguiendo la distribuci\u00f3n en quincenas para las UTs indicada en la ORDEN 30/2002, de 12 de mayo, con el resultado a nivel de centro publicado en el calendario escolar 2023/2024.</p> <p>Teniendo en cuenta esta temporalizaci\u00f3n inicial se han planificado las siguientes sesiones para el m\u00f3dulo de SOR:</p>"},{"location":"ProgramacionAula.html#planificacion-de-sesiones","title":"Planificaci\u00f3n de Sesiones","text":"Sesi\u00f3n Tipo Fechas Descripci\u00f3n Actividades/Recursos PRIMERA EVALUACI\u00d3N 1 Te\u00f3rica: Explicativa. 25/09/23(Ma\u00f1ana) 28/09/23(Tarde) Presentaci\u00f3n del m\u00f3dulo e introducci\u00f3n a los sistemas operativos en red destacando herramientas de virtualizaci\u00f3n innovadoras como Docker. 1.1.Introducci\u00f3n SOR.1.2.Virtualizaci\u00f3n.1.3.Docker.1.4.NextCloud.- V\u00eddeo: explicaci\u00f3n m\u00f3dulo. 2 Pr\u00e1ctica:Resoluci\u00f3n actividades y dudas. 02/10/23(Ma\u00f1ana) 05/10/23(Tarde) Realizaci\u00f3n guiada de la pr\u00e1ctica de NextCloud. Se comenta el v\u00eddeo-gu\u00eda de la pr\u00e1ctica para dar la facilidad al alumnado  PT11. NextCloud mediante DockerPT12. (Refuerzo) OwnCloud mediante Docker.PT13. (Ampliaci\u00f3n) Instalaci\u00f3n aplicaciones Cloud.Test/cuestionario Docker en Aules. 3 Te\u00f3rica: Explicativa. 16/10/23(Ma\u00f1ana) 19/10/23(Tarde) Introducci\u00f3n al servicio Samba para compartir carpetas y explicaci\u00f3n de Docker Compose. 2.1.Introducci\u00f3n Samba.2.2.Instalaci\u00f3n y configuraci\u00f3n inicial.2.3.Docker Compose Samba. 4 Pr\u00e1ctica:Resoluci\u00f3n actividades y dudas. 23/10/23(Ma\u00f1ana) 26/10/23(Tarde) Revisi\u00f3n del v\u00eddeo-gu\u00eda de la pr\u00e1ctica de instalaci\u00f3n de Samba. Realizaci\u00f3n de muestras de accesos permitidos y denegados a las carpetas seg\u00fan se indica en la pr\u00e1ctica.Realizaci\u00f3n y revisi\u00f3n del v\u00eddeo de Docker compose Samba. PT21. Pr\u00e1ctica Instalaci\u00f3n y configuraci\u00f3n inicial de SambaPT22. Samba mediante Docker compose.PT23. (Refuerzo) Generar carpeta compartida con acceso total.PT24. (Ampliaci\u00f3n) Generar carpeta con permisos desde Docker Compose Samba.- V\u00eddeo: Instalaci\u00f3n Samba y permisos.- V\u00eddeo: Docker Compose Samba 5 Te\u00f3rica y Pr\u00e1ctica 31/10/23(Ma\u00f1ana) Explicaci\u00f3n de la creaci\u00f3n de usuarios, grupos y secciones en Samba.Realizaci\u00f3n guiada de la pr\u00e1ctica de NextCloud. Se comenta el v\u00eddeo-gu\u00eda de la pr\u00e1ctica para dar la facilidad al alumnado 3.1.Introducci\u00f3n Secciones y usuarios Samba.- V\u00eddeo: usuarios y grupos.PT31.Creaci\u00f3n de usuarios y grupos en Samba.PT32.Gesti\u00f3n usuarios y secciones Samba.PT33.(Refuerzo) Configuraci\u00f3n Usuarios y grupos.PT34. (Ampliaci\u00f3n) Creaci\u00f3n usuarios Shellscripting.- V\u00eddeo: secciones. Permiso Paternidad del 02/11/23 hasta 04/12/23 6 Te\u00f3rica: Explicativa. 11/12/23(Ma\u00f1ana) 14/12/23(Tarde) Presentaci\u00f3n de Servicios de directorio y de sus elementos principales.Explicaci\u00f3n de Samba Domain Controller y Pr\u00e1ctica Guiada. 4.1.Introducci\u00f3n Samba DC.4.2.Instalaci\u00f3n y configuraci\u00f3n de Samba DC. 7 Pr\u00e1ctica:Resoluci\u00f3n actividades y dudas. 18/12/23(Ma\u00f1ana) 21/10/23(Tarde) Realizaci\u00f3n guiada de la pr\u00e1ctica de Samba Domain Controller.  PT41. Gesti\u00f3n de recursos compartidos en Samba DCPT42. (Refuerzo) Samba DC directoriosPT43. (Ampliaci\u00f3n) Samba DC con Docker Compose SEGUNDA EVALUACI\u00d3N 8 Te\u00f3rica: Explicativa. 08/01/24(Ma\u00f1ana) 11/01/24(Tarde) Introducci\u00f3n a Windows server y su configuraci\u00f3n b\u00e1sica.Introducci\u00f3n e instalaci\u00f3n de Active Directory 6.1.Introducci\u00f3n Active Directory.6.2.Configuraci\u00f3n Windows Server.6.3.Instalaci\u00f3n de Active Directory.V\u00eddeo: explicaci\u00f3n configuraci\u00f3n WS. 9 Pr\u00e1ctica:Resoluci\u00f3n actividades y dudas. 15/01/24(Ma\u00f1ana) 18/01/24(Tarde) Realizaci\u00f3n guiada de la Instalaci\u00f3n de Active Directory. PT61. Configuraci\u00f3n Windows ServerPT62. Instalaci\u00f3n programada de Active Directory.- V\u00eddeo: Realizaci\u00f3n guiada de PT62 10 Te\u00f3rica: Explicativa. 22/01/24(Ma\u00f1ana) 25/01/24(Tarde) Administracio\u0301n de dominios en Active Directory.creaci\u00f3n de usuarios y grupos, la degradaci\u00f3n de un dominio, y eliminaci\u00f3n de usuarios. 7.1.Administracio\u0301n de dominios en Active Directory.7.2.Administraci\u00f3n de Usuarios y Grupos.7.3.Gesti\u00f3n de dominio en Active Directory. 11 Pr\u00e1ctica:Resoluci\u00f3n actividades y dudas. 29/01/24(Ma\u00f1ana) 01/02/24(Tarde) Realizaci\u00f3n guiada de la gesti\u00f3n de dominios en Active Directory. PT71.Administraci\u00f3n de usuarios y gruposPT72. Gesti\u00f3n de Dominios en Active Directory.- V\u00eddeos: de creaci\u00f3n y gesti\u00f3n de usuarios, grupos y Unidades organizativas."},{"location":"ResumenUD.html","title":"Resumen UD","text":"<p>A continuaci\u00f3n se muestra un resumen de la Unidad Did\u00e1ctica:</p>  RESUMEN UNIDAD DID\u00c1CTICA <p>Unidad Did\u00e1ctica</p> <p>UD1.- ShellScripting. Realizaci\u00f3n de Guiones en Sistemas Operativos Libres.</p> <p>Horas</p> <p>6 Sesiones - 12 Horas</p> <p>Resultados de Aprendizaje</p> <p>RA7. Utiliza lenguajes de guiones en sistemas operativos, describiendo su aplicaci\u00f3n y administrando servicios del sistema operativo.</p> <p>Preconocimiento</p> <p>Funcionamiento del terminal de Linux/GNU. Aplicaci\u00f3n de comandos. Utilizaci\u00f3n de editores. Conocimiento de permisos de archivos.</p> <p>Objetivos Operativos</p> <p>Competencias Personales y Sociales. Transversales</p> <p> <ul> <li>Administraci\u00f3n de terminal de Linux/GNU.</li> <li>Conocer comandos b\u00e1sicos y avanzados en Shell.</li> <li>Optimizar el c\u00f3digo de los scripts mediante tuber\u00edas y redirecciones.</li> </ul> </p> <p>14. Gestionar y/o realizar el mantenimiento de los recursos de su \u00e1rea (programando y verificando su cumplimiento), en funci\u00f3n de las cargas de trabajo y el plan de mantenimiento.</p> <p>16. Mantener el esp\u00edritu de innovaci\u00f3n y actualizaci\u00f3n en el \u00e1mbito de su trabajo para adaptarse a los cambios tecnol\u00f3gicos y organizativos de su entorno profesional.</p> <p>Contenidos conceptuales</p> <p> <ul> <li>Introducci\u00f3n Linux. Creaci\u00f3n ShellScripts. Depuraci\u00f3n.</li> <li>Argumentos, variables, operadores; Entrada y Salida.</li> </ul> </p> <p> <ul> <li>Control de Flujo. Estructuras condicionales e iterativas.</li> <li>Funciones y vectores.</li> </ul> </p> <p>Instrumentos Evaluaci\u00f3n</p> <p>Actividades INICIALES (IE1).</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <p>Actividades desde la 101 a la 104. Basadas en Scripts de nivel bajo, en concreto, sobre el desarrollo de:</p> <p> <ul> <li>Creaci\u00f3n primeros scripts de nivel bajo</li> <li>Depuraci\u00f3n de scripts.</li> </ul> </p> <p> <ul> <li>CE7b. Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietarios.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <p> <ul> <li>IC1.</li> </ul> </p> <p>Actividades DESARROLLO (IE1).</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 105 a la 108. Interacci\u00f3n con usuario, utilizaci\u00f3n de variables, par\u00e1metros y operadores.</li> <li>Actividades desde la 109 a la 111. Control de Flujo. Estructuras condicionales e iterativas.</li> <li>Actividades desde la 112 a la 115. Vectores y funciones.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>IC1.</li> </ul> <p>Actividades Refuerzo.</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 116 a la 119. Variables, par\u00e1metros, comprobaciones, estructuras condicionales e iterativas.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>IC1.</li> </ul> <p>Actividades Ampliaci\u00f3n.</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 120 a la 122. Vectores, funciones, estructuras condicionales e iterativas.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>IC1.</li> </ul> <p>Prueba de Auditor\u00eda.</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Cuestionario multi-opci\u00f3n (test) de 20 preguntas sobre la teor\u00eda de la unidad.</li> <li>Ejercicios pr\u00e1cticos sobre las actividades realizadas de la unidad.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>CE7b. Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>IC1 e IC2.</li> </ul>"},{"location":"SituacionAprendizaje.html","title":"Situaci\u00f3n de aprendizaje","text":"<p>Las situaciones de aprendizaje representan una herramienta eficaz para integrar los resultados de aprendizaje de las distintas \u00e1reas mediante tareas y actividades significativas y relevantes para resolver problemas de manera creativa y cooperativa, reforzando la autoestima, la autonom\u00eda, la reflexi\u00f3n y la responsabilidad.</p>"},{"location":"SituacionAprendizaje.html#tabla-resumen","title":"Tabla resumen","text":"<p>En la siguiente tabla se muestran los datos identificativos de la situaci\u00f3n de aprendizaje de SOR.</p> DATOS IDENTIFICATIVOS T\u00edtulo ORGANIZAMOS DIRECTORIOS DE TRABAJO EMPRESARIAL Ciclo Sistemas Microinform\u00e1ticos en Red M\u00f3dulo Sistemas Operativos en Red Vinculaci\u00f3n Servicios en red y Seguridad Inform\u00e1tica Descripci\u00f3n En esta Situaci\u00f3n de Aprendizaje de SOR debes situarte como empleada o empleado del departamento de TIC de NetOS S.L., la cual se dedica a la implementaci\u00f3n de sistemas operativos en red, para garantizar la instalaci\u00f3n, administraci\u00f3n, y soporte de Servicios de Directorio a terceros, atendiendo a las necesidades empresariales de sus usuarios tanto internos como externos Metodolog\u00eda Aprendizaje basado en retos"},{"location":"SituacionAprendizaje.html#detalle","title":"Detalle","text":"<p>A modo de concretar la situaci\u00f3n de aprendizaje (SA), cabe destacar que la SA contextualiza al alumnado en una empresa ficticia que se dedica a la instalaci\u00f3n, puesta en marcha y gesti\u00f3n de los los archivos y carpetas compartidos en red de cualquier cliente (empresa imaginar\u00eda) que solicite dichos servicios, dicha solicitud supone un reto organizativo que el t\u00e9cnico de sistemas operativos en red debe afrontar con garant\u00edas de \u00e9xito.</p> <ul> <li>Para ello se dispone de herramientas organizativas como los Servicios de Directorio, los cuales son un conjunto de aplicaciones que guardan y administran toda la informaci\u00f3n sobre los recursos de una red. El m\u00f3dulo se basa en la instalaci\u00f3n y configuraci\u00f3n de estos servicios de directorios en las empresas \"cliente\" ficticias que solicitan la gesti\u00f3n de sus archivos.</li> </ul> <p>Nota</p> <p>Los recursos pueden ser: vol\u00famenes de disco duro, carpetas, archivos, impresoras, usuarios, grupos, dispositivos, n\u00fameros de tel\u00e9fono y un largo etc\u00e9tera.</p>"},{"location":"SituacionAprendizaje.html#diseno-de-retos","title":"Dise\u00f1o de retos","text":"<p>A partir de la situaci\u00f3n de aprendizaje se generan los diferentes retos en forma de pr\u00e1cticas divididas en actividades que tienen como objetivo la gesti\u00f3n de archivos y recursos compartidos en de una empresa.</p> <p>En cada Unidad de Trabajo (UT) se definen los retos contextualizados hacia experiencias reales y adaptados a los RAs que contribuye la UT, los cuales se especifican y se destacan al inicio del enunciado de cada reto. </p>"},{"location":"Unidades.html","title":"Unidades","text":""},{"location":"Unidades.html#primera-evaluacion","title":"Primera evaluaci\u00f3n","text":"<ol> <li>Introducci\u00f3n SOR. Docker. NextCloud. (8 sesiones, 16 horas)<ul> <li>Introducci\u00f3n a los sistemas operativos en red.</li> <li>Contenedores. Docker</li> <li>NextCloud.</li> </ul> </li> <li>Introducci\u00f3n Samba. (8 sesiones, 16 horas)<ul> <li>Instalaci\u00f3n Samba.</li> <li>fichero configuraci\u00f3n, Creaci\u00f3n directorio compartido.</li> </ul> </li> <li>Gesti\u00f3n Usuarios y grupos Samba. (8 sesiones, 16 horas)<ul> <li>Perfiles de usuario y grupos.</li> <li>Integraci\u00f3n de permisos.</li> </ul> </li> <li>Gestio\u0301n de recursos compartidos en Samba. (8 sesiones, 16 horas)<ul> <li>Creaci\u00f3n de de recursos compartidos.</li> <li>Monitorizaci\u00f3n de incidencias. </li> </ul> </li> </ol>"},{"location":"Unidades.html#segunda-evaluacion","title":"Segunda evaluaci\u00f3n","text":"<ol> <li>Entornos de desarrollo virtualizados. Vagrant. (8 sesiones, 16 horas).<ul> <li>Escenarios heterog\u00e9neos, Protocolos para redes heterog\u00e9neas, servicios de recursos compartidos.</li> <li>creaci\u00f3n de entronos de desarrollo virtualizados mediante Vagrant.</li> </ul> </li> <li>Directorio Activo en Windows Server (8 sesiones, 16 horas).<ul> <li>Active Directory, configuraci\u00f3n b\u00e1sica Windows Server. *Active Directory, Instalaci\u00f3n AD, Creaci\u00f3n estructura empresa.</li> <li>Servicio Monitorizaci\u00f3n en Windows Server.</li> </ul> </li> <li>Administracio\u0301n de dominios en Windows Server (8 sesiones, 16 horas). <ul> <li>Creaci\u00f3n de dominios.</li> <li>Administraci\u00f3n de dominios.</li> </ul> </li> <li>Gestio\u0301n de recursos compartidos en Windows Server (8 sesiones, 16 horas).<ul> <li>Permisos, directivas de grupo, perfiles y relaciones de confianza.</li> </ul> </li> </ol>"},{"location":"01_INTRO_SOR/001_IntroSOR.html","title":"Introducci\u00f3n SOR","text":"<p>Un sistema operativo en red posibilita la conexi\u00f3n y comunicaci\u00f3n de varios ordenadores aut\u00f3nomos dentro de una red. Sus principales funciones son:</p> <ul> <li>Proporcionar servicios a los clientes como DHCP, DNS, correo (estos servicios son competencias del m\u00f3dulo de SER)</li> <li>Compartir y gestionar los dispositivos, archivos y recursos de forma centralizada.</li> <li>Permitir el acceso remoto al sistema, a otro ordenador o a dispositivos perif\u00e9ricos.</li> <li>Planificar tareas y funciones entre varios ordenadores para que se finalicen antes.</li> <li>Creaci\u00f3n diferentes tipos de usuarios y grupos.</li> <li>Crear reglas de seguridad de acceso a los recursos compartidos  a los usuarios creados.</li> <li>Monitorizaci\u00f3n de los dispositivos de la red.</li> </ul>"},{"location":"01_INTRO_SOR/001_IntroSOR.html#arquitectura-de-los-sistemas-operativos-en-red","title":"Arquitectura de los Sistemas Operativos en Red","text":"<p>Los sistemas operativos en red pueden catalogarse seg\u00fan su arquitectura de red en distribuidos y centralizados. </p> <ul> <li>Los primeros se componen de un software que controla todos los equipos inform\u00e1ticos de forma distribuida en modo \"cluster\". Un ejemplo es el SO llamado Amoeba de A.S.Tanenbaum. Se utilizan en despliegues espec\u00edficos que no competen en este m\u00f3dulo.</li> <li>Los centralizados se realizan mediante la estructura de \"Cliente/Servidor\", la cual es la m\u00e1s utilizada a nivel empresarial y sirve de base para la creaci\u00f3n de los escenarios de red en este m\u00f3dulo.</li> </ul> <p>Consejo</p> <p>Es importante conocer la evoluci\u00f3n desarrollada en las redes empresariales anteriormente a la utilizaci\u00f3n de la arquitectura cliente/servidor. En el siguiente apartado se desarrolla en detalle.</p>"},{"location":"01_INTRO_SOR/001_IntroSOR.html#estructura-red-plana","title":"Estructura Red plana","text":"<p>Antes del desarrollo de las herramientas de los servicios de red en las empresas, se comenz\u00f3 a desarrollar la Estructura de trabajo en grupo, la cual trataba la red en modo plano.</p> <ul> <li>Una red plana entre iguales o punto a punto, es aquella en la ninguno de los equipos realiza tareas de administraci\u00f3n de la red, sino tan s\u00f3lo de s\u00ed mismo. No existe un equipo que haga las veces de administrador, por lo que en realidad, todos los clientes se convierten en administradores de los recursos que ofrecen a la red.</li> </ul> <p>Ejemplo</p> <p>Si un cliente decide compartir un recuso, \u00e9ste estar\u00e1 disponible para todos los miembros de la red sin distinci\u00f3n. Si es necesario limitar el acceso a un subconjunto de usuarios, habr\u00e1 que establecer una contrase\u00f1a y hac\u00e9rsela llegar a trav\u00e9s de un medio seguro.</p> <p>Advertencia</p> <p>Si cada uno de los usuarios empieza a compartir recursos sin control, su localizaci\u00f3n puede ser una tarea complicada, ya que los usuarios de la red deben conocer en todo momento su distribuci\u00f3n y configuraci\u00f3n. La localizaci\u00f3n puede suponer un grave problema.</p> <ul> <li>Microsoft introdujo en sus sistemas operativos la posibilidad de crear grupos de trabajo que divid\u00edan la red en subconjuntos. De este modo, si se sabe a qu\u00e9 grupo pertenece el equipo que comparte un recurso ser\u00e1 m\u00e1s sencillo su localizaci\u00f3n. Estas divisiones se realizaban por funciones, por ubicaci\u00f3n f\u00edsica o por cualquier otro criterio de la empresa.</li> </ul> Introducci\u00f3n de un equipo a un grupo de trabajo <p>Advertencia</p> <p>Resultaba m\u00e1s sencillo localizar recursos, pero no solucionaban el problema de acceso. Este sistema de organizaci\u00f3n de red presenta numerosos problemas de seguridad.</p> <p>Para controlar los accesos de los diferentes usuarios de las empresas y de este modo solucionar dicho problema se desarrollo la estructura cliente/servidor.</p>"},{"location":"01_INTRO_SOR/001_IntroSOR.html#estructura-cliente-servidor","title":"Estructura cliente-servidor","text":"<p>Se trata de un modelo de aplicaci\u00f3n centralizada en el que las tareas se dividen entre los proveedores de recursos o servicios. A estas m\u00e1quinas se las conoce como servidores y a los equipos que demandan estos servicios se les conoce como clientes.</p> Esquema de red cliente servidor <p>En este tipo de redes:</p> <ul> <li>Los clientes est\u00e1n conectados a un servidor en el que se centralizan los recursos y servicios.</li> <li>El servidor es el encargado de ponerlos a disposici\u00f3n de los clientes cada vez que estos son solicitados.</li> <li>Por lo tanto, todas las gestiones que se realizan se concentran en el servidor, lo que facilita la localizaci\u00f3n de los recursos de una forma sencilla.</li> </ul> <p>A tener en cuenta</p> <ul> <li>Sin embargo, agregar un segundo servidor puede complicar las cosas de manera significativa. El problema surge porque cada servidor individual mantiene su propia lista de usuarios y recursos. El servidor A ofrece alojamiento a aplicaciones, el servidor B al correo electr\u00f3nico y las aplicaciones de contabilidad y la base de datos se encuentran en el servidor C.</li> </ul> Red cliente-servidor con varios servidores. <ul> <li>Los usuarios que requieren acceso a la base de datos y utilizar las aplicaciones, necesitan una cuenta en dos de los tres servidores. </li> </ul> <p>Advertencia</p> <p>Cada una de esas cuentas de usuarios debe ser creada y mantenida de manera separada. Es f\u00e1cil para los servidores perder sincron\u00eda cuando deben ser actualizados manualmente.</p> <p>Note</p> <p>Estas y otras cuestiones ser\u00e1n resueltas con el siguiente modo de organizaci\u00f3n de red.</p>"},{"location":"01_INTRO_SOR/001_IntroSOR.html#servicios-de-directorio","title":"Servicios de directorio","text":"<p>los servicios de directorios, son un conjunto de aplicaciones que guardan y administran toda la informaci\u00f3n sobre los elementos de una red.</p> <ul> <li>Cada recurso de la red se considera como un objeto, donde su informaci\u00f3n se almacena como atributos.</li> <li>Para la gesti\u00f3n de esta informaci\u00f3n, el servicio de directorio establece una serie de permisos de acceso y condiciones de seguridad que la salvaguardan esta informaci\u00f3n.</li> <li>Ofrecen una infraestructura para localizar, manejar, administrar, y organizar los componentes y recursos comunes de una red.</li> </ul> <p>Nota</p> <p>Los recursos pueden ser: vol\u00famenes, carpetas, archivos, impresoras, usuarios, grupos, dispositivos, n\u00fameros de tel\u00e9fono y un largo etc\u00e9tera.</p> <p>Los servicios de directorios contienen diferentes objetos relacionados entre s\u00ed, que se desarrollar\u00e1n en detalle a lo largo del curso, de momento es suficiente con esta breve introducci\u00f3n.</p>"},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html","title":"Virtualizaci\u00f3n","text":"<p>En general, el objetivo de la virtualizaci\u00f3n es poder utilizar simult\u00e1neamente en un mismo ordenador dos o m\u00e1s sistemas operativos. Por lo tanto, para poder hablar de virtualizaci\u00f3n tienen que estar funcionando a la vez varios sistemas operativos.</p> <p>Nota</p> <ul> <li>De acuerdo con esta definici\u00f3n, instalar dos sistemas operativos en un ordenador (Windows y Linux, por ejemplo) y poder elegir uno u otro mediante un arranque dual no se considera virtualizaci\u00f3n, puesto que mediante un arranque dual no podemos ejecutar a la vez ambos sistemas.</li> <li>Y tampoco ser\u00eda virtualizaci\u00f3n la simulaci\u00f3n, que consiste en simular el aspecto visual del sistema imitado. Por ejemplo, podr\u00edamos instalar un tema de escritorio en GNOME o KDE que imitara el escritorio de Windows. El problema de esta simulaci\u00f3n ser\u00eda que realmente no estar\u00edamos utilizando Windows sino simplemente algo que parece Windows. As\u00ed que, por ejemplo, no podr\u00edamos instalar una aplicaci\u00f3n de Windows puesto que el sistema operativo ser\u00eda Linux, que no acepta instaladores de Windows.</li> </ul> <p>A tener en cuenta</p> <ul> <li>Los sistemas operativos son los encargados de la gesti\u00f3n del hardware y requieren un control completo del mismo, por lo que dos sistemas operativos no pueden en principio estar funcionando a la vez sobre el mismo hardware.</li> <li>La soluci\u00f3n para la virtualizaci\u00f3n es la existencia de un hipervisor (en ingl\u00e9s, hypervisor).</li> </ul> <p>Antes de definir que es el hipervisor, es importante conocer las ventajas que aporta la virtualizaci\u00f3n.</p>"},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#ventajas-virtualizacion","title":"Ventajas Virtualizaci\u00f3n","text":"<p>La virtualizaci\u00f3n tiene muchas aplicaciones interesantes:</p> <ul> <li>La m\u00e1s habitual es poder ejecutar aplicaciones que no est\u00e1n disponibles para el sistema operativo host (anfitri\u00f3n), pero s\u00ed para otro sistema operativo que se instalar\u00eda como guest (hu\u00e9sped).</li> <li>La virtualizaci\u00f3n permite la conservaci\u00f3n del software. Debido al progreso del hardware, los procesadores antiguos dejan de fabricarse y los sistemas operativos y aplicaciones antiguos dejan de desarrollarse y dejan de funcionar en el hardware moderno. Pero si el sistema operativo puede instalarse como guest, puede seguir utiliz\u00e1ndose para siempre.</li> <li>La virtualizaci\u00f3n permite depurar y comprobar el funcionamiento de los programas y los sistemas operativos. Si un programa provoca un fallo de funcionamiento total, si se est\u00e1 ejecutando como guest, el sistema host puede recoger informaci\u00f3n sobre el motivo del fallo.</li> <li>La virtualizaci\u00f3n permite un mejor aprovechamiento del hardware, ya que un mismo ordenador puede contener muchos sistemas guests utilizados por usuarios diferentes, aislados unos de otros.</li> </ul>"},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#hipervisor","title":"Hipervisor","text":"<p>Definici\u00f3n</p> <p>Un hipervisor, conocido tambi\u00e9n como monitor de m\u00e1quinas virtuales, es un proceso que crea y ejecuta m\u00e1quinas virtuales. Un hipervisor permite que un ordenador host preste soporte a varias m\u00e1quinas virtuales invitadas mediante el uso compartido virtual de sus recursos, como la memoria y el procesamiento.</p> <p>Por lo tanto el hipervisor es la pieza fundamental de la virtualizaci\u00f3n. Tradicionalmente, se distinguen dos tipos de hipervisores:</p> <ul> <li>Los hipervisores de tipo 1, denominados \u00abhipervisores bare metal\u00bb, dichos hipervisores est\u00e1n en contacto directo con el hardware de la m\u00e1quina, sin necesidad de ning\u00fan sistema operativo previo.</li> <li>Los hipervisores de tipo 2, denominados \u00abalojados\u00bb, y son una aplicaci\u00f3n m\u00e1s del sistema operativo instalado en la m\u00e1quina y el hipervisor accede al hardware de la m\u00e1quina a trav\u00e9s de ese sistema operativo.</li> </ul> Tipos de Hipervisor. <p>Nota</p> <ul> <li>En el caso de los hipervisores de tipo 2, el sistema operativo que tiene el control del hardware recibe el nombre de host (anfitri\u00f3n). Es el sistema operativo que se instal\u00f3 primero en el ordenador y el que se pone en marcha al arrancar el ordenador. Los dem\u00e1s sistemas operativos reciben el nombre de guests (hu\u00e9spedes) y pueden ejecutarse o no a voluntad del usuario.</li> <li>En el caso de los hipervisores de tipo 1 no hay un sistema operativo host, todos los sistemas operativos son guests del hipervisor.</li> </ul> <p>Ejemplo</p> <ul> <li>Tipo 1: ejemplos de este tipo de hipervisores son VMware ESXi o Xen, los cuales son utilizados a nivel de centro de datos. Hyper-V de Microsoft se puede considerar un hipervisor de tipo 1, porque aunque necesita que est\u00e9 instalado primero Windows para poder instalar Hyper-V, una vez instalado convierte a Windows en un guest m\u00e1s de Hyper-V (aunque con acceso prioritario con respecto al resto de guests). </li> <li>Tipo 1/Tipo 2: KVM, al estar integrado en el kernel de Linux, se puede considerar tanto de tipo 1 como de tipo 2. </li> <li>Tipo 2: VirtualBox es un hipervisor de tipo 2.</li> </ul>"},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#contenedores","title":"Contenedores","text":"<p>El problema de los hipervisores y las m\u00e1quinas virtuales es que cada m\u00e1quina virtual es independiente de las dem\u00e1s. Al no reutilizarse ning\u00fan componente, se ocupa mucho espacio tanto en disco como en memoria y el tiempo de ejecuci\u00f3n siempre ser\u00e1 mayor que si s\u00f3lo hubiera un sistema operativo (sobre todo en el caso de hipervisores de tipo 2).</p> <p>Para resolver este problema se crearon los contenedores en los que se utilizan mecanismos existentes en el sistema operativo para aislar las aplicaciones, pero compartiendo el mayor n\u00famero posible de componentes del sistema operativo o incluso de las aplicaciones.</p> <ul> <li>Como definici\u00f3n, Un contenedor es el equivalente a una m\u00e1quina virtual de la virtualizaci\u00f3n cl\u00e1sica, pero mucho m\u00e1s ligera porque utiliza recursos del sistema operativo del host. </li> <li>Las aplicaciones de cada contenedor \"ven\" un sistema operativo, que puede ser diferente en cada contenedor, pero quien realiza el trabajo es el sistema operativo com\u00fan que hay por debajo.</li> </ul> <p>Nota</p> <ul> <li>Los contenedores suelen ser elementos ef\u00edmeros. La facilidad con la que pueden crearse y ponerse en marcha hace m\u00e1s f\u00e1cil crear un nuevo contenedor que modificar uno ya existente. Por ello, los datos generados por las aplicaciones no se suelen guardar en los contenedores, sino fuera de ellos. </li> <li>Su ligereza hace m\u00e1s f\u00e1cil tener varios contenedores con una aplicaci\u00f3n en cada uno de ellos que tener un \u00fanico contenedor con varias aplicaciones en \u00e9l. Por ello, un aspecto importante de los contenedores es su orquestaci\u00f3n, es decir, la administraci\u00f3n simult\u00e1nea de muchos contenedores, una de las herramientas m\u00e1s utilizadas es Kubernetes.</li> </ul>"},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#maquinas-virtuales-vs-contenedores","title":"M\u00e1quinas Virtuales VS Contenedores","text":"Contenedores Vs M\u00e1quinas Virtuales."},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#microservicios","title":"Microservicios","text":"<p>Uno de los objetivos principales de la configuraci\u00f3n e implantaci\u00f3n de contenedores es solucionar los problemas de:</p> <ul> <li>Errores de dependencias entre diferentes Sistemas Operativos de los trabajadores y m\u00e1quinas de puesta en marcha.</li> <li>Evitar la Elevada carga y capacidad de las M\u00e1quinas Virtuales.</li> <li>Ca\u00edda de todos los servicios instalados de forma monol\u00edtica en los servidores.</li> </ul> <p>En este \u00faltimo punto cabe destacar la evoluci\u00f3n de implantaci\u00f3n de sistemas operativos en los Centros de Procesado de Datos:</p> <ul> <li>SOA (Service Oriented Architecture) \u2192 Diferentes M\u00e1quinas una con cada Servicio conectadas.</li> <li>Monol\u00edtico \u2192 Todos los servicios en la misma m\u00e1quina.</li> <li>MicroServicios \u2192 Divisi\u00f3n m\u00e1s peque\u00f1a de los servicios.</li> </ul> Monol\u00edtico Vs Microservicios."},{"location":"01_INTRO_SOR/002_Virtualizaci%C3%B3n.html#caracteristicas-principales-de-los-contenedores","title":"Caracter\u00edsticas principales de los Contenedores","text":"<p>En resumen los contenedores:</p> <ul> <li>Consisten en Agrupar y Aislar Aplicaciones o grupos de aplicaciones que se ejecutan sobre un mismo n\u00facleo de sistema operativo.</li> <li>Su caracter\u00edstica principal se basa en su propio sistema de archivos ejecutable en cualquier Sistema Operativo.</li> <li>No es necesario emular el HW y SW completo como en las m\u00e1quinas virtuales, por lo tanto son mucho m\u00e1s ligeros, comparten el m\u00e1ximo de componentes con el sistema operativo host, y su rapidez, ya que gracias a que apenas a\u00f1aden capas adicionales consiguen casi velocidades nativas.</li> <li>Soluciona problemas de espacio y compatibilidades a la hora de puesta en marcha en servidores de producci\u00f3n.</li> <li>Los contenedores suelen ser elementos ef\u00edmeros.</li> </ul>"},{"location":"01_INTRO_SOR/003_Docker.html","title":"DOCKER","text":"Figura 1: Logo Docker. <p>Docker (estibador en ingl\u00e9s) es un Sistema de Virtualizaci\u00f3n de Aplicaciones mediante contenedores, creado por Solomon Hykes y su equipo de ingenieros.</p> <ul> <li>En 2013 se convirti\u00f3 en un proyecto de software libre (licencia Apache) en el que participan cada vez m\u00e1s empresas. </li> <li>La versi\u00f3n 1.0 se public\u00f3 en junio de 2014 y ha tenido un desarrollo muy r\u00e1pido.</li> <li>En marzo de 2017, Docker anunci\u00f3 un desarrollo todav\u00eda m\u00e1s r\u00e1pido, pasando a publicar una nueva versi\u00f3n cada mes. La numeraci\u00f3n de las versiones adopt\u00f3 al formato AA.MM (la primera fue Docker 17.03).</li> <li>En julio de 2018, Docker anunci\u00f3 que volv\u00edan a un desarrollo m\u00e1s pausado. A partir de Docker 18.09 habr\u00eda una versi\u00f3n \"estable\" cada seis meses.</li> </ul>"},{"location":"01_INTRO_SOR/003_Docker.html#caracteristicas-principales-de-docker","title":"Caracter\u00edsticas principales de Docker","text":"<p>Por lo tanto se define Docker como...</p> <p>Un proyecto de c\u00f3digo abierto que automatiza el despliegue de aplicaciones dentro de contenedores de software, proporcionando una capa adicional de abstracci\u00f3n y automatizaci\u00f3n de virtualizaci\u00f3n de aplicaciones en m\u00faltiples sistemas operativos.\u200b</p> <p>Sus principales caracter\u00edsticas son:</p> <ul> <li>Docker es una API amigable del tipo Open Source.</li> <li>Genera un proceso aislado del resto de los procesos de la m\u00e1quina gracias a: Ejecutar sobre su propio sistema de ficheros, con su propio espacio de usuarios y procesos, y sus propias interfaces de red... </li> <li>Es Modular ya que esta dividido en varios componentes.</li> <li>Es portable e inmutable utilizando la plataforma DockerHub.</li> <li>Su es lema \u201cBuild, Ship and Run, any app,\u201d.</li> </ul> Lema Docker. <p>Nota</p> <p>Aunque un contenedor puede incluir cualquier n\u00famero de aplicaciones, lo habitual es que un contenedor contenga una sola aplicaci\u00f3n (y los programas necesarios para ponerse en marcha). </p>"},{"location":"01_INTRO_SOR/003_Docker.html#arquitectura-docker","title":"Arquitectura Docker","text":"<ol> <li>Docker Engine (\"Motor\" del Gestor Docker): el cual basado en la arquitectura de Cliente-Servidor (que pueden estar en la misma m\u00e1quina, o en distintas), y realizada por mediante una API de REST que utiliza HTTP.<ul> <li>API REST: interfaz de programaci\u00f3n con un estilo de arquitectura software para sistemas hipermedia distribuidos como la World Wide Web.</li> </ul> </li> <li>\"Daemon Docker\" (Servicio): lleva a cabo Gesti\u00f3n y enlace de los componentes del gestor.</li> <li>Im\u00e1genes: Las im\u00e1genes son una especie de plantillas que contienen como m\u00ednimo todo el software que necesita la aplicaci\u00f3n para ponerse en marcha. est\u00e1n formadas por una colecci\u00f3n ordenada de: Sistemas Archivos, Repositorios, Comandos, Par\u00e1metros, Aplicaciones.</li> <li>Contenedores: son el conjunto de procesos que encapsulan e identifican a una Imagen. Pueden ser:<ul> <li>Creado, inicializado, parado, vuelto a ejecutar y destruido.</li> </ul> </li> <li>Registros son im\u00e1genes guardadas en repositorios para: Almacenar o Distribuir.<ul> <li>Se almacenan en Docker Hub y pueden ser  P\u00fablicos o Privados.</li> </ul> </li> </ol> Componentes de Docker. <p>Nota</p> <ul> <li>El componente b\u00e1sico de Docker es el Docker Engine, pero Docker ofrece tambi\u00e9n una serie de herramientas para administrar, distribuir e instalar contenedores: Docker Compose, Docker Swarm.</li> <li>Las im\u00e1genes se pueden crear a partir de otras im\u00e1genes m\u00e1s b\u00e1sicas incluyendo software adicional en forma de capas. Todos los contenedores creados a partir de una imagen contienen el mismo software, aunque en el momento de su creaci\u00f3n se pueden personalizar algunos detalles</li> </ul>"},{"location":"01_INTRO_SOR/003_Docker.html#instalacion","title":"Instalaci\u00f3n","text":"<p>Para la Instalaci\u00f3n de Docker es recomendable seguir la documentaci\u00f3n oficial. Adem\u00e1s se recomienda Instalar m\u00e1quina Ubuntu Server \u00faltima versi\u00f3n e instalar Docker en ella.</p> <ul> <li>Docker for Mac:<ul> <li>Instalaci\u00f3n Mac</li> </ul> </li> <li>Docker for Windows:<ul> <li>Instalaci\u00f3n Windows</li> </ul> </li> <li>Docker for ubuntu:<ul> <li>Instalaci\u00f3n Ubuntu</li> </ul> </li> </ul> <p>Advertencia</p> <ul> <li>Docker empez\u00f3 estando disponible solamente para distribuciones GNU/Linux, pero desde junio de 2016 tambi\u00e9n est\u00e1 disponible como aplicaci\u00f3n nativa en Windows Server 2016 y Windows 10.</li> <li>Docker utiliza la virtualizaci\u00f3n ofrecida por el sistema operativo. En el caso de Windows 10, eso significa que para usar Docker de forma nativa hay que activar Hyper-V que, por desgracia, es incompatible con VirtualBox. Para poder utilizar Docker en Windows 7 o en Windows 10 sin Hyper-V, Docker ofrece desde agosto de 2015 Docker Toolbox, que realmente es una m\u00e1quina virtual (que se ejecuta en VirtualBox) que contiene Docker.</li> <li>Otra opci\u00f3n ser\u00eda utilizar Podman</li> </ul>"},{"location":"01_INTRO_SOR/003_Docker.html#ejemplo-instalacion-en-ubuntu-server","title":"Ejemplo Instalaci\u00f3n en Ubuntu server","text":"<ul> <li>A continuaci\u00f3n se muestra la instalaci\u00f3n aconsejada para Ubuntu Server utilizando el m\u00e9todo de repositorios:</li> </ul> <ol> <li>En primer lugar se actualizan los paquetes y se instalan los paquetes para utilizar el repositorio sobre HTTPS:</li> </ol> <pre><code>sudo apt-get update\napt-get install ca-certificates curl gnupg lsb-release\n</code></pre> <ol> <li>Se a\u00f1ade la clave GPG oficial de Docker:</li> </ol> <pre><code>mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n</code></pre> <ol> <li>Se configura el repositorio:</li> </ol> <pre><code>echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n</code></pre> <ul> <li>Se realiza de nuevo una actualizaci\u00f3n.</li> </ul> <pre><code>sudo apt-get update\n</code></pre> <ol> <li>Instalaci\u00f3n propia del Engine de Docker y Docker Compose:</li> </ol> <pre><code>apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n</code></pre> <ol> <li>Comprobamos que est\u00e1 correctamente bien instalado ejecutando el contenedor \"Hello World\"</li> </ol> <pre><code>docker run hello-world\n</code></pre>"},{"location":"01_INTRO_SOR/003_Docker.html#principales-comandos","title":"Principales Comandos","text":"<p>A continuaci\u00f3n se muestran los comandos m\u00e1s utilizados:</p> Comando Acci\u00f3n Comando Acci\u00f3n <code>docker info</code> obtener informaci\u00f3n relativa a docker <code>docker start</code> (docker container start) inicia la ejecuci\u00f3n <code>docker run</code> (docker container run) crea y ejecuta el contenedor <code>docker rm</code> (docker container eliminar) elimina el contenedor <code>docker build</code> crea una imagen <code>docker cp</code> (docker container copiar) <code>docker ps</code> muestra la lista de contenedores creados <code>docker logs</code> (docker container logs) muestra los errores <code>docker inspect</code> (docker container inspect) informaci\u00f3n detallada de los contenedores <code>docker stats</code> (docker container stats) muestra el estado <code>docker stop</code> (docker container stop) detiene la ejecuci\u00f3n del contenedor <code>docker system prune</code> limpiar todo el sistena de contenedores im\u00e1genes y volumenes <ul> <li>Chuleta de Comandos</li> </ul> Chuleta Docker."},{"location":"01_INTRO_SOR/003_Docker.html#primer-contenedor","title":"Primer Contenedor","text":"<p>A continuaci\u00f3n se muestra un ejemplo guiado de la creaci\u00f3n del contenedor \"Hello World\"</p> <ol> <li>Comprobaci\u00f3n que inicialmente no hay ning\u00fan contenedor creado (la opci\u00f3n <code>-a</code> hace que se muestren tambi\u00e9n los contenedores detenidos, sin ella se muestran s\u00f3lo los contenedor que est\u00e9n en marcha):</li> </ol> <p><pre><code>sudo docker ps -a\n</code></pre> o tambi\u00e9n</p> <pre><code>sudo docker container ls -a\n</code></pre> <ol> <li>Compruebe que inicialmente tampoco disponemos de ninguna imagen:</li> </ol> <pre><code>sudo docker image ls\n</code></pre> <p>Nota</p> <p>Docker crea los contenedores a partir de im\u00e1genes locales (ya descargadas), pero si al crear el contenedor no se dispone de la imagen local, Docker descarga la imagen de su repositorio.</p> <ol> <li>La orden m\u00e1s simple para crear un contenedor sigue esta estructura:</li> </ol> <pre><code>sudo docker run IMAGEN\n</code></pre> <p>Ejemplo</p> <pre><code>sudo docker run hello-world\n</code></pre> <p>Nota</p> <p>Como no tenemos todav\u00eda la imagen en nuestro ordenador, Docker descarga la imagen, crea el contenedor y lo pone en marcha. En este caso, la aplicaci\u00f3n que contiene el contenedor hello-world simplemente escribe un mensaje de salida al arrancar e inmediatamente se detiene el contenedor.</p> <p>Si listamos de nuevo imagenes y contenedores, las veremos creadas.</p> <ul> <li>Cada contenedor tiene un identificador (ID) y un nombre distinto. Docker \"bautiza\" los contenedores con un \"nombre peculiar\", compuesto de un adjetivo y un apellido.</li> <li>Podemos crear tantos contenedores como queramos a partir de una imagen. Una vez la imagen est\u00e1 disponible localmente, Docker no necesita descargarla y el proceso de creaci\u00f3n del contenedor es inmediato (aunque en el caso de hello-world la descarga es r\u00e1pida, con im\u00e1genes m\u00e1s grandes la descarga inicial puede tardar un rato).</li> </ul> <p>Tip</p> <ul> <li>Normalmente se aconseja usar siempre la opci\u00f3n <code>-d</code>, que arranca el contenedor en segundo plano (detached) y permite seguir teniendo acceso a la shell (aunque con hello-world no es estrictamente necesario porque el contenedor hello-world se detiene autom\u00e1ticamente tras mostrar el mensaje).</li> <li>Al crear el contenedor hello-world con la opci\u00f3n <code>-d</code> no se muestra el mensaje, simplemente muestra el identificador completo del contenedor.</li> </ul> <ul> <li> <p>Los contenedores se pueden destruir mediante el comando rm, haciendo referencia a ellos mediante su nombre o su id. No es necesario indicar el id completo, basta con escribir los primeros caracteres (de manera que no haya ambig\u00fcedades).</p> </li> <li> <p>Adem\u00e1s podemos dar nombre a los contenedores al crearlos:</p> </li> </ul> <pre><code>sudo docker run -d --name=hola-1 hello-world\n</code></pre>"},{"location":"01_INTRO_SOR/003_Docker.html#volumenes","title":"Vol\u00famenes","text":"<p>Docker simplifica enormemente la creaci\u00f3n de contenedores, y eso lleva a tratar los contenedores como un elemento ef\u00edmero, que se crea cuando se necesita y que no importa que se destruya puesto que puede ser reconstruido una y otra vez a partir de su imagen.</p> <p>Advertencia</p> <p>Pero si la aplicaci\u00f3n o aplicaciones incluidas en el contenedor generan datos y esos datos se guardan en el propio contenedor, en el momento en que se destruyera el contenedor perder\u00edamos esos datos.</p> <ul> <li> <p>El objetivo principal de los volumenes es no perder datos si borro el contenedor y mejorar rendimiento del Docker.  Para conseguir la persistencia de los datos, se pueden emplear dos t\u00e9cnicas:</p> <ol> <li> <p>Los directorios enlazados (bind), en la que la informaci\u00f3n se guarda fuera de Docker, en la m\u00e1quina host (por ejemplo si lo ejecutamos en la m\u00e1quina virtual de Ubuntu o la m\u00e1quina f\u00edsica de Lliurex en clase).</p> </li> <li> <p>Los vol\u00famenes, en la que la informaci\u00f3n se guarda mediante Docker, pero en unos elementos llamados vol\u00famenes, independientes de las im\u00e1genes y los contenedores. Adem\u00e1s los vol\u00famenes se pueden catalogar en dos tipos.</p> <ol> <li>Volu\u0301menes de Datos: es como si montar\u00e1 un disco en el contenedor y por defecto se realizan en un path temporal.</li> <li>Volu\u0301menes de Host: Mismo concepto pero indic\u00e1ndole el path.</li> </ol> </li> </ol> </li> </ul> <p>Tip</p> <p>Aconsejable utilizar la t\u00e9cnica de volumenes, ya que, La ventaja frente a los directorios enlazados es que pueden ser gestionados por Docker. Otro detalle importante es que el acceso al contenido de los vol\u00famenes s\u00f3lo se puede hacer a trav\u00e9s de alg\u00fan contenedor que utilice el volumen.</p>"},{"location":"01_INTRO_SOR/003_Docker.html#ventajas-volumenes","title":"Ventajas Vol\u00famenes","text":"<p>Los vol\u00famenes tienen varias ventajas sobre los directorios enlazados:</p> <ul> <li>Los vol\u00famenes son m\u00e1s f\u00e1ciles de respaldar o migrar que enlazar montajes.</li> <li>Puede administrar vol\u00famenes mediante los comandos de la CLI de Docker o la API de Docker.</li> <li>Los vol\u00famenes funcionan tanto en contenedores de Linux como de Windows.</li> <li>Los vol\u00famenes se pueden compartir de forma m\u00e1s segura entre varios contenedores.</li> <li>Los controladores de volumen le permiten almacenar vol\u00famenes en hosts remotos o proveedores en la nube, para cifrar el contenido de los vol\u00famenes o para agregar otras funciones.</li> <li>Los nuevos vol\u00famenes pueden tener su contenido precargado por un contenedor.</li> <li>Los vol\u00famenes en Docker Desktop tienen un rendimiento mucho mayor que los directorios enlazados de hosts de Mac y Windows.</li> </ul> <p>Nota</p> <p>Adem\u00e1s, los vol\u00famenes suelen ser una mejor opci\u00f3n que los datos persistentes en la capa de escritura de un contenedor, porque un volumen no aumenta el tama\u00f1o de los contenedores que lo usan y el contenido del volumen existe fuera del ciclo de vida de un contenedor determinado.</p> Gr\u00e1fico t\u00e9cnicas de persistencia de datos. <p>Nota</p> <p>Los vol\u00famenes son independientes de los contenedores, por lo que tambi\u00e9n podemos conservar los datos aunque se destruya el contenedor, reutilizarlos con otro contenedor, etc.</p>"},{"location":"01_INTRO_SOR/003_Docker.html#opciones","title":"Opciones","text":"<ul> <li>Opciones:</li> </ul> <pre><code>`Docker volume (create|Is|inspect|rm)`\n</code></pre> <ul> <li>para crear el volumen a la vez que creamos y ejecutamos un contenedor se utilzan las opciones <code>v</code> o <code>--mount</code></li> </ul> <p>En general, <code>--mount</code> m\u00e1s expl\u00edcito y detallado. La mayor diferencia es que la sintaxis de <code>-v</code> combina todas las opciones juntas en un campo, mientras que la sintaxis <code>--mount</code>  las separa. A continuaci\u00f3n se muestra una comparaci\u00f3n de la sintaxis de cada \"flag\".</p> <ul> <li> <p><code>-v</code> o <code>--volume</code> : consta de tres campos, separados por dos puntos ( :). Los campos deben estar en el orden correcto y el significado de cada campo no es inmediatamente obvio.</p> <ul> <li>En el caso de vol\u00famenes con nombre, el primer campo es el nombre del volumen y es \u00fanico en una m\u00e1quina host determinada. Para vol\u00famenes an\u00f3nimos, se omite el primer campo.</li> <li>El segundo campo es la ruta donde se monta el archivo o directorio en el contenedor.</li> <li>El tercer campo es opcional y es una lista de opciones separadas por comas, como <code>ro</code> (readonly). </li> </ul> </li> <li> <p><code>--mount</code>: Consta de varios pares clave-valor, separados por comas (cada uno formado por una = dupla). La sintaxis de <code>--mount</code> es m\u00e1s detallada que <code>-v</code> o <code>--volume</code>; adem\u00e1s el orden de las claves no es significativo, por lo tanto el valor de las \"flags\" son m\u00e1s f\u00e1ciles de entender.  <li>Valores de las duplas:<ul> <li>type: puede ser <code>bind</code>, <code>volume</code> o <code>tmpfs</code>.</li> <li>source: Para vol\u00famenes con nombre, este es el nombre del volumen. Para vol\u00famenes an\u00f3nimos, este campo se omite. Puede especificarse como source o src.</li> <li>destination: toma como valor de la ruta en el archivo o directorio est\u00e1 montado en el contenedor. Puede ser especificado como destination, <code>dst</code> o <code>target</code>.</li> <li>readonly: si est\u00e1 presente, hace que el montaje de enlace se monte en el contenedor como de solo lectura. Puede especificarse como <code>readonly</code> o <code>ro</code>.</li> <li>volume-opt se puede especificar m\u00e1s de una vez, toma un par clave-valor que consta del nombre de la opci\u00f3n y su valor. Ejemplo: <code>volume-opt=type=nfs</code></li> </ul> </li> <p>Nota</p> <p>Todas las opciones de vol\u00famenes est\u00e1n disponibles para los indicadores <code>--mount</code> y <code>-v</code>, por que a la hora de elegir uno u otro depende del t\u00e9cnico para su facilidad de configuraci\u00f3n donde por su sintaxis a priori ser\u00eda mejor <code>--mount</code>.</p>"},{"location":"01_INTRO_SOR/003_Docker.html#ejemplo","title":"Ejemplo","text":"<p>A continuaci\u00f3n se muestra un ejemplo de creaci\u00f3n del servidor web NGINX.</p> <p>Ejemplo</p> <pre><code>docker run -d \\\n--name nginx1 -p 8080:80 \\\n--mount type=volume,source=myvol1,target=/usr/share/nginx/html \\\nnginx:latest\n</code></pre> <p>Nota</p> <ul> <li>Si en lugar de la opci\u00f3n <code>-p 8080:80</code> se utiliza la opci\u00f3n <code>-P</code> hace que Docker asigne de forma aleatoria un puerto de la m\u00e1quina virtual al puerto asignado a Nginx en el contenedor.</li> </ul> <ul> <li>Si se creara una p\u00e1gina de incio del apache diferente a la de defecto podr\u00edamos copiarla en el volumen y esta cambiar\u00eda:</li> </ul> <pre><code>nano index.html\n</code></pre> <ul> <li>Nueva p\u00e1gina de inicio:</li> </ul> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"es\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\"&gt;\n  &lt;title&gt;Apache en Docker&lt;/title&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;h1&gt;\u00a1Hola Mundo!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <ul> <li> <p>Para cambiar la p\u00e1gina de inicio del apache se debe copiar dentro del volumen creado. <pre><code>docker cp index.html nginx1:/usr/share/nginx/html\n</code></pre></p> </li> <li> <p>Si accedemos al servidor apache aparecer\u00e1 la nueva p\u00e1gina. </p> </li> </ul> <p>Advertencia</p> <p>Si aparece el error forbiden 403, es debido a permisos del index.html, debemos entrar en container y cambiar los permisos.</p> <pre><code>docker exec -it nginx1 /bin/bash\n</code></pre> <pre><code>cd /usr/share/nginx/html\nchown -R root:root index.html\n</code></pre> <ul> <li> <p>Adem\u00e1s podemos crear un nuevo contenedor con este volumen: <pre><code>docker run -d \\\n    --name nginx2 -p 8080:80 \\\n    --mount type=volume,source=myvol1,target=/usr/share/nginx/html \\\n    nginx:latest\n</code></pre></p> </li> <li> <p>Se comprueba que el nuevo contenedor muestra la nueva p\u00e1gina index.html</p> </li> </ul> <p>Advertencia</p> <p>Si se intenta borrar el volumen del ejemplo anterior mientras los contenedores est\u00e1n en marcha, Docker muestra un mensaje de error que indica los contenedores afectados.</p>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html","title":"Definici\u00f3n Pr\u00e1ctica NextCloud","text":""},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#nextcloud","title":"NextCloud","text":"<p>Nextcloud hace referencia al conjunto de herramientas software de c\u00f3digo abierto con arquitectura cliente-servidor, que permiten la creaci\u00f3n de servicios de alojamiento de archivos en servidores privados.</p>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Los archivos Nextcloud son almacenados en estructuras de directorio convencionales y se pueden acceder a trav\u00e9s del protocolo WebDAV si es necesario.</li> <li>Los archivos son encriptados en la transmisi\u00f3n y opcionalmente durante el almacenamiento.</li> <li>Los usuarios pueden manejar calendarios (CalDAV), contactos (CardDAV), tareas programadas y reproducir contenido multimedia (Ampache).</li> <li>Permite la administraci\u00f3n de usuarios y grupos de usuarios (v\u00eda OpenID o LDAP) y definir permisos de acceso.</li> <li>Posibilidad de a\u00f1adir aplicaciones (de un solo clic) y conexiones con Dropbox, Google Drive y Amazon S3.</li> <li>Disponibilidad de acceso a diferentes bases de datos mediante SQLite, MariaDB, MySQL, Oracle Database, y PostgreSQL.</li> </ul> <p>Nota</p> <p>WebDAV es un grupo de trabajo del Internet Engineering Task Force (IETF). El t\u00e9rmino significa \"Autor\u00eda y versionado distribuidos por Web\" (Web Distributed Authoring and Versioning), y se refiere al protocolo (m\u00e1s precisamente, a la extensi\u00f3n del protocolo) que el grupo defini\u00f3. Este protocolo proporciona funcionalidades para crear, cambiar y mover documentos en un servidor remoto (t\u00edpicamente un servidor web).</p>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#pt11-instalacion-y-configuracion-de-nextcloud-mediante-docker","title":"PT11. Instalaci\u00f3n y configuraci\u00f3n de NextCloud mediante Docker","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Las actividades de esta pr\u00e1ctica contribuyen a los criterios de evaluaci\u00f3n del RA1: CE1, CE2, CE6, CE8 y CE9, del RA4: CE2 y CE5, y del RA6: CE1, CE2, CE3, CE4, CE5, CE6 y CE9 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>Siguiendo la situaci\u00f3n de aprendizaje, estamos trabajando en el departamento TIC de NetOS y nos encargan un proyecto para instalar de una empresa l\u00edder en el sector hotelero un servicio que cubra la necesidad de compartir recursos (carpetas documentos, im\u00e1genes...), tanto entre las personas dentro de la empresa como con clientes fuera de \u00e9sta.</li> <li>Para hacernos valer dentro de la empresa indicamos que podemos instalar un servidor NextCloud en unos pocos minutos para solventar dicho problema.</li> <li>La empresa cuenta con un servidor con Ubuntu 22.04 para instalar el servicio, por lo tanto decidimos hacer uso de docker para levantar el servicio NextCloud de una forma muy r\u00e1pida y sencilla.</li> </ul> <p>Premisas</p> <ul> <li>El servicio docker se debe levantar en la red 192.168.20.0/24.</li> <li>Debe tener la traducci\u00f3n est\u00e1tica del puerto 80 de la m\u00e1quina anfitriona al puerto 80 del contenedor.</li> <li>Debe tener un volumen asociado llamado \"volNextCloud\".</li> </ul> <p>Tareas</p> <ul> <li>Actividad P11_1: enlace al video de la instalaci\u00f3n de Docker (3 puntos al RA1).</li> <li>Actividad P11_2: enlace al video de la instalaci\u00f3n de NextCloud (3 puntos al RA6).</li> <li>Actividad P11_3: enlace al video de la gesti\u00f3n de recursos compartidos mediante vol\u00famenes de Docker (3 puntos al RA4).</li> <li>Actividad P11_4: entrega de pdf con la resoluci\u00f3n de las preguntas de Comprensi\u00f3n descritas en el siguiente subapartado. (3 puntos al RA4).</li> </ul> <p>Nota</p> <p>Excepci\u00f3n de instrumento de calificaci\u00f3n, al dividir la pr\u00e1ctica en apartados se calificar\u00e1 cada uno de ellos con IC1.</p>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#comprension","title":"Comprensi\u00f3n","text":"<p>advertencia</p> <p>Preguntas a responder en la actividad PT11_4:</p> <ul> <li>Crea el contenedor Nextcloud \u00bfAl crear el contenedor se ha generado autom\u00e1ticamente alg\u00fan volumen? \u00bfCu\u00e1l?</li> <li>Dentro del sistema anfitri\u00f3n (lliurex/Windows) \u00bfD\u00f3nde est\u00e1 guardado el fichero subido previamente?</li> <li>\u00bfEste contenedor es persistente? \u00bfQu\u00e9 significa que el contenedor es persistente? \u00bfC\u00f3mo lo has comprobado?</li> </ul>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#ayuda","title":"Ayuda","text":"<ul> <li>P\u00e1gina oficial para la Instalaci\u00f3n en ubuntu en el siguiente enlace Instalaci\u00f3n en Ubuntu Documentaci\u00f3n</li> <li>Lee la documentaci\u00f3n sobre la imagen NextCloud que hay en Dockerhub Nextcloud_Docker.</li> </ul>"},{"location":"01_INTRO_SOR/004_PracticaNextCloud.html#guia","title":"Gu\u00eda","text":"<p>En este enlace puedes acceder a una gu\u00eda para realizar la pr\u00e1ctica: GU\u00cdA INSTALACI\u00d3N NEXTCLOUD CON DOCKER</p>"},{"location":"01_INTRO_SOR/005_RefuerzoAmpliacion.html","title":"Refuerzo y Ampliaci\u00f3n","text":"<p>A continuaci\u00f3n se definen las actividades de refuerzo y ampliaci\u00f3n de la UT1</p>"},{"location":"01_INTRO_SOR/005_RefuerzoAmpliacion.html#refuerzo","title":"Refuerzo","text":""},{"location":"01_INTRO_SOR/005_RefuerzoAmpliacion.html#pt12-instalacion-y-configuracion-de-owncloud-mediante-docker","title":"PT12. Instalaci\u00f3n y configuraci\u00f3n de OwnCloud mediante Docker","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Las actividades de esta pr\u00e1ctica contribuyen a los criterios de evaluaci\u00f3n del RA1: CE1, CE2, CE6, CE8 y CE9, del RA4: CE2 y CE5, y del RA6: CE1, CE2, CE3, CE4, CE5, CE6 y CE9 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>Siguiendo la situaci\u00f3n de aprendizaje, estamos trabajando en el departamento TIC de NetOS y nos encargan un proyecto para instalar de una empresa l\u00edder en el sector del turismo un servicio que cubra la necesidad de compartir recursos (carpetas documentos, im\u00e1genes...), tanto entre las personas dentro de la empresa como con clientes fuera de \u00e9sta.</li> <li>Para hacernos valer dentro de la empresa indicamos que podemos instalar un servidor OwnCloud en unos pocos minutos para solventar dicho problema.</li> <li>La empresa cuenta con un servidor con Ubuntu 22.04 para instalar el servicio, por lo tanto decidimos hacer uso de docker para levantar el servicio OwnCloud de una forma muy r\u00e1pida y sencilla.</li> </ul> <p>Enunciado</p> <ul> <li>Realiza la instalaci\u00f3n de Docker en un Ubuntu 22.04, posteriormente realiza la instalaci\u00f3n de OwnCloud mediante su imagen de Docker oficial.</li> <li>Genera un volumen persistente.</li> <li>Genera un archivo de prueba en el servidor.</li> <li>Comprueba que al realizar la eliminaci\u00f3n del contenedor y vuelta a generar la informaci\u00f3n no se ha perdido.</li> </ul> <p>Tareas</p> <ul> <li>Actividad PT12_1: enlace al video de la instalaci\u00f3n de Docker (3 puntos al RA1).</li> <li>Actividad PT12_2: enlace al video de la instalaci\u00f3n de OwnCloud (3 puntos al RA6).</li> <li>Actividad PT12_3: enlace al video de la gesti\u00f3n de recursos compartidos mediante vol\u00famenes de Docker (3 puntos al RA4).</li> </ul> <p>ayuda</p> <p>Para la instalaci\u00f3n de OwnCloud puedes guiarte en su p\u00e1gina oficial: Docker OwnCloud</p>"},{"location":"01_INTRO_SOR/005_RefuerzoAmpliacion.html#ampliacion","title":"Ampliaci\u00f3n","text":""},{"location":"01_INTRO_SOR/005_RefuerzoAmpliacion.html#pt13-instalacion-aplicaciones-cloud","title":"PT13. Instalaci\u00f3n aplicaciones Cloud.","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Las actividades de esta pr\u00e1ctica contribuyen a los criterios de evaluaci\u00f3n del RA1: CE1, CE2, CE6, CE8 y CE9, del RA4: CE2 y CE5, y del RA6: CE1, CE2, CE3, CE4, CE5, CE6 y CE9 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>Despu\u00e9s del \u00e9xito de la instalaci\u00f3n de servicios \"Cloud\" para la compartici\u00f3n de recursos, tu superior o superiora solicita que hagas un estudio de las diferentes aplicaciones Cloud m\u00e1s utilizadas actualmente.</li> </ul> <p>Enunciado</p> <ul> <li>Realiza un estudio de comparaci\u00f3n de las mejora Aplicaciones Cloud para la compartici\u00f3n de recursos actuales.</li> <li>Elije una APP para instalar con Docker.</li> <li>Haz una prueba de instalaci\u00f3n con volumen persistente.</li> </ul> <p>Tareas</p> <ul> <li>Realiza un informe de la comparativa de las APP de Cloud y un v\u00eddeo de la instalaci\u00f3n y pruebas de los recursos compartidos con el volumen persistente en Docker. (3 puntos IE1)</li> </ul>"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html","title":"GU\u00cdA INSTALACI\u00d3N NEXTCLOUD-DOCKER","text":""},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#pt11_1-instalacion-docker","title":"PT11_1 Instalaci\u00f3n Docker","text":"<p>Se realiza la instalaci\u00f3n de Docker en una m\u00e1quina virtual de Ubuntu 22.04 siguiendo el m\u00e9todo Install using the repository</p> <ol> <li>Se realiza un actualizaci\u00f3n y se instalan los paquetes necesarios para usar el repositorio sobre HTTPS:</li> </ol> <ul> <li>C\u00f3digo para la actualizaci\u00f3n de paquetes:</li> </ul> <p><pre><code>sudo apt-get update\n</code></pre> - Resultado:</p> Actualizaci\u00f3n repositorios <ul> <li>C\u00f3digo para instalar los paquetes necesarios para usar el repositorio sobre HTTPS:</li> </ul> <p><pre><code>sudo apt-get install ca-certificates curl gnupg lsb-release\n</code></pre> - Resultado:</p> Instalaci\u00f3n repositorios necesarios <ol> <li>Se a\u00f1ade la clave GPG oficial de Docker y el comando para configurar el repositorio:</li> </ol> <ul> <li>C\u00f3digo para los objetivos comentados en este punto:</li> </ul> <p><pre><code>sudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n</code></pre> - Resultado:</p> Clave GPG y configuraci\u00f3n repositorio <ol> <li>se realiza otra actualizaci\u00f3n:</li> </ol> <ul> <li>C\u00f3digo para la nueva actualizaci\u00f3n de paquetes, debido a la configuraci\u00f3n realizada:</li> </ul> <pre><code>sudo apt-get update\n</code></pre> <ul> <li>Resultado:</li> </ul> Nueva actualizaci\u00f3n <ol> <li>Se Instala Docker Engine, containerd y Docker Compose:</li> </ol> <ul> <li>C\u00f3digo para la instalaci\u00f3n de paquetes Docker:</li> </ul> <pre><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n</code></pre> <ul> <li>Resultado:</li> </ul> Instalaci\u00f3n Docker <ol> <li>Comprobaci\u00f3n que la instalaci\u00f3n del motor Docker sea correcta ejecutando la imagen hello-world:</li> </ol> <ul> <li>C\u00f3digo para la comprobaci\u00f3n de Docker, mediante la ejecuci\u00f3n de un contenedor:</li> </ul> <p><pre><code>sudo docker run hello-world\n</code></pre> - Resultado:</p> Comprobaci\u00f3n"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#pt11_2-instalacion-contenedor-nextcloud-sin-volumen-persistente","title":"PT11_2 Instalaci\u00f3n contenedor NextCloud sin volumen persistente.","text":"<p>La instalaci\u00f3n del contenedor se puede consultar en Imagen oficial NextCloud Docker Hub</p> <ol> <li>Se instala y ejecuta el contenedor:</li> </ol> <ul> <li>C\u00f3digo para la instalaci\u00f3n NextCloud:</li> </ul> <pre><code>docker run -d -p 8080:80 nextcloud\n</code></pre> <ul> <li>Resultado:</li> </ul> Instalaci\u00f3n y ejecuci\u00f3n del contenedor de NextCloud <ol> <li>Comprobaci\u00f3n de instalaci\u00f3n correcta del contenedor NextCloud:</li> </ol> <ul> <li>Se introduce en un navegador http://\"IPm\u00e1quinaVirtual\":8080 debe aparecer el inicio de NextCloud para crear una cuenta de administrador, como se muestra en la siguiente figura:</li> </ul> Instalaci\u00f3n de NextCloud <ul> <li>Probamos a subir un archivo para ver donde se guardan:</li> </ul> Subir archivo NextCloud <ul> <li>Se comprueba en el GUI de NextCloud que esta subido:</li> </ul> Comprobaci\u00f3n subido el archivo en el GUI de NextCloud <ul> <li>Se comprueba en el bash del contenedor de NextCloud que esta subido:</li> </ul> Comprobaci\u00f3n subido el archivo en el contenedor de NextCloud <ul> <li>Si borramos el contenedor y lo volvemos a crear se comprueba que se ha perdido el fichero:</li> </ul> Borrado del contenedor Comprobaci\u00f3n del fichero borrado"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#pt11_3-instalacion-contenedor-nextcloud-con-volumen-persistente-y-red-interna","title":"PT11_3 Instalaci\u00f3n contenedor NextCloud con volumen persistente y red interna","text":"<ul> <li> <p>Siguiendo los apuntes en el punto 3 se describen los vol\u00famenes y la importancia de los mismos para salvaguardar los datos si el contenedor se corrompe, o incluso utilizarlo para un segundo contenedor de docker. El ejemplo 3.3 es una buena gu\u00eda para realizar este punto.</p> </li> <li> <p>Por lo tanto el c\u00f3digo a ejecutar para que el volumen se llame \"volNextCloud\" podr\u00eda ser:</p> </li> </ul> <pre><code>sudo docker run -d --name nextcloud --ip 192.168.20.2 --mount type=volume,source=volNextCloud,target=/var/www/html/data -p 80:80 nextcloud\n</code></pre> Creaci\u00f3n NextCloud con Persistent Data y red interna"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#comprobacion-nextcloud-con-volumen-persistente","title":"Comprobaci\u00f3n NextCloud con volumen persistente","text":"<ol> <li>Se sube un fichero como el caso anterior.</li> </ol> Subimos fichero <ol> <li>Se comprueba que esta en el contenedor.</li> </ol> El archivo existe en el path del volumen <ol> <li>Se borra el contenedor, se crea uno nuevo apuntando al volumen y se comprueba que el fichero perdura.</li> </ol> Comprobaci\u00f3n fichero existe, despu\u00e9s de borrar contenedor y volver a crear uno nuevo"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#network","title":"Network","text":"<ul> <li>Se observa en el c\u00f3digo del apartado anterior en el mismo comando se ha estado introduciendo la IP del enunciado. Para que dicha IP se refleje en el contenedor adem\u00e1s debe existir una red creada previamente y apuntar a ella. en los siguientes pasos se muestra.</li> </ul> <ol> <li>Crear red:</li> </ol> <pre><code>sudo docker network create --driver=bridge --subnet=192.168.20.0/24 nextCloudNet\n</code></pre> <ol> <li>Referenciamos contenedor a la red creada.</li> </ol> <pre><code>sudo docker run -d --name nextcloud --network nextCloudNet --ip 192.168.20.2 --mount type=volume,source=volNextCloud,target=/var/www/html/data -p 80:80 nextcloud\n</code></pre> <ol> <li>Confirmamos la IP.</li> </ol> <pre><code>docker inspect -f '{{range.NetworkSettings.Networks}} {{.IPAddress}}{{end}}' CONTAINER_ID\n</code></pre>"},{"location":"01_INTRO_SOR/NextCloudDockerSolucion.html#comprobacion-ip","title":"Comprobaci\u00f3n IP","text":"<ul> <li>En la siguiente figura se muestra la comprobaci\u00f3n de la red y la IP del contenedor:</li> </ul> Contenedor en la IP del enunciado"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html","title":"Introducci\u00f3n de Servicios de directorio y LDAP","text":"<p>La organizaci\u00f3n de una red de trabajo empresarial supone un reto organizativo que el administrador del sistema debe afrontar con garant\u00edas de \u00e9xito. </p> <ul> <li>Para ello dispone de herramientas organizativas como los servicios de directorio, tanto SAMBA como Active Directory, ambas basadas en el protocolo LDAP, las cuales ofrecen una amplia gama de herramientas que facilitan la organizaci\u00f3n de recursos de una red.</li> </ul> <p>Note</p> <p>Si no se concibe un ordenador sin sistema operativo que lo administre, tampoco debe existir una red de cierta entidad sin sistema operativo de red que la gestione.</p> <ul> <li>En definitiva, un sistema operativo de red (SOR en lo sucesivo), est\u00e1 dise\u00f1ado para administrar redes y todos los elementos que la componen. Sus tareas m\u00e1s importantes son:<ol> <li>La gesti\u00f3n centralizada de los recursos.</li> <li>Ofrecer servicios a los clientes.</li> <li>Proporcionar acceso seguro a esos recursos y monitorizar todo lo que pasa en la red.</li> </ol> </li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#arquitectura-de-redes","title":"Arquitectura de Redes","text":"<p>Los sistemas operativos en red pueden catalogarse en distribuidos y centralizados. Los primeros se componen de un software que controla todos los equipos inform\u00e1ticos de forma distribuido en modo \"cluster\".</p> <p>Un ejemplo es el SO llamado Amoeba de A.S.Tanenbaum. Se utilizan en despliegues espec\u00edficos que no competen en este m\u00f3dulo. por lo tanto a continuaci\u00f3n se desarrollaran los centralizados.</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#estructura-red-plana","title":"Estructura Red plana","text":"<p>Antes del desarrollo de las herramientas de los servicios de red, se comenz\u00f3 a desarrollar la Estructura trabajo en grupo, la cual trataba la red en modo plano.</p> <ul> <li>Una red plana, entre iguales o punto a punto, es aquella en la ninguno de los equipos realiza tareas de administraci\u00f3n de la red, sino tan s\u00f3lo de s\u00ed mismo. No existe un equipo que haga las veces de administrador, por lo que en realidad, todos los clientes se convierten en administradores de los recursos que ofrecen a la red.</li> </ul> <p>Example</p> <p>Si un cliente decide compartir un recuso, \u00e9ste estar\u00e1 disponible para todos los miembros de la red sin distinci\u00f3n. Si es necesario limitar el acceso a un subconjunto de usuarios, habr\u00e1 que establecer una contrase\u00f1a y hac\u00e9rsela llegar a trav\u00e9s de un medio seguro.</p> <p>Advertencia</p> <p>Si cada uno de los usuarios empieza a compartir recursos sin control, su localizaci\u00f3n puede ser una tarea complicada, ya que los usuarios de la red deben conocer en todo momento su distribuci\u00f3n y configuraci\u00f3n. La localizaci\u00f3n puede suponer un grave problema.</p> <ul> <li>Microsoft introdujo en sus sistemas operativos la posibilidad de crear grupos de trabajo que divid\u00edan la red en subconjuntos. De este modo, si se sabe a qu\u00e9 grupo pertenece el equipo que comparte un recurso ser\u00e1 m\u00e1s sencillo su localizaci\u00f3n. Estas divisiones se realizaban por funciones, por ubicaci\u00f3n f\u00edsica o por cualquier otro criterio de la empresa.</li> </ul> Introducci\u00f3n de un equipo a un grupo de trabajo <p>Advertencia</p> <p>Resultaba m\u00e1s sencillo localizar recursos, pero no solucionaban el problema de acceso. Este sistema de organizaci\u00f3n de red presenta numerosos problemas de seguridad.</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#estructura-cliente-servidor","title":"Estructura cliente-servidor","text":"<p>Se trata de un modelo de aplicaci\u00f3n centralizada en el que las tareas se dividen entre los proveedores de recursos o servicios. A estas m\u00e1quinas se las conoce como servidores y a los equipos que demandan estos servicios se les conoce como clientes.</p> Esquema de red cliente servidor <p>En este tipo de redes:</p> <ul> <li>Los clientes est\u00e1n conectados a un servidor en el que se centralizan los recursos y servicios con que se cuenta la red.</li> <li>El servidor es el encargado de ponerlos a disposici\u00f3n de los clientes cada vez que estos son solicitados.</li> <li>Por lo tanto, todas las gestiones que se realizan se concentran en el servidor, lo que facilita la localizaci\u00f3n de los recurso de una forma sencilla.</li> </ul> <p>Warning</p> <ul> <li>Sin embargo, agregar un segundo servidor puede complicar las cosas de manera significativa. El problema surge porque cada servidor individual mantiene su propia lista de usuarios y recursos. El servidor A ofrece alojamiento a aplicaciones, el servidor B al correo electr\u00f3nico y las aplicaciones de contabilidad y la base de datos se encuentran en el servidor C.</li> </ul> Red cliente-servidor con varios servidores. <ul> <li>Los usuarios que requieren acceso a la base de datos y utilizar las aplicaciones, necesitan una cuenta en dos de los tres servidores. Cada una de esas cuentas de usuarios debe ser creada y mantenida de manera separada. Es f\u00e1cil para los servidores perder sincron\u00eda cuando deben ser actualizados manualmente.</li> </ul> <p>Note</p> <p>Estas y otras cuestiones ser\u00e1n resueltas con el siguiente modo de organizaci\u00f3n de red.</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#servicios-de-directorio","title":"Servicios de directorio","text":"<p>los servicios de directorios, son un conjunto de aplicaciones que guardan y administran toda la informaci\u00f3n sobre los elementos de una red.</p> <ul> <li>Cada recurso de la red se considera como un objeto, donde su informaci\u00f3n se almacena como atributos.</li> <li>Para la gesti\u00f3n de esta informaci\u00f3n, el servicio de directorio establece una serie de permisos de acceso y condiciones de seguridad que la salvaguardan esta informaci\u00f3n.</li> <li>Ofrecen una infraestructura para localizar, manejar, administrar, y organizar los componentes y recursos comunes de una red.</li> </ul> <p>Note</p> <p>Los recursos pueden ser: vol\u00famenes, carpetas, archivos, impresoras, usuarios, grupos, dispositivos, n\u00fameros de tel\u00e9fono y un largo etc\u00e9tera.</p> <p>Los servicios de directorios contienen diferentes objetos relacionados entre s\u00ed, y que ser\u00e1 conveniente familiarizarse con ellos:</p> <ol> <li>Directorio, es un repositorio \u00fanico para la informaci\u00f3n relativa a los objetos de una organizaci\u00f3n.</li> <li>Dominio, es una colecci\u00f3n de objetos dentro de un directorio.</li> <li>Objeto, cualquiera de los elementos que forman parte del directorio. Pueden ser recursos, usuarios, equipos, relaciones de confianza, servidores, unidades organizativas entre otros. En general todos estos objetos se clasifican en tres categor\u00edas:<ol> <li>usuarios, identificados a trav\u00e9s del binomio nombre/contrase\u00f1a y que pueden organizarse en grupos.</li> <li>recursos, elementos que los usuarios pueden usar para el correcto desarrollo de su actividad.</li> <li>servicios, que son funciones a los que el usuario tienen acceso como el correo electr\u00f3nico, copias de seguridad en la nube, conexi\u00f3n Internet entre otros.</li> </ol> </li> <li>Unidad organizativa, es un contendedor de objetos que permite organizarlos en subconjuntos de forma jer\u00e1rquica. Facilita la organizaci\u00f3n de los dominios.</li> </ol> Unidades Organizativas en Active Directory <ol> <li>Grupo, conjunto de objetos usuario. Al igual que las unidades organizativas, facilitan la organizaci\u00f3n y administraci\u00f3n de los objetos, los grupos lo hacen con objetos tipo usuario.</li> <li>Controlador de dominio, equipo que contiene la base de datos de objetos para un determinado dominio, incluida la informaci\u00f3n de seguridad y la responsabilidad de la autenticaci\u00f3n de objetos de su \u00e1mbito de gobierno.</li> <li>Cat\u00e1logo global, base de datos con la informaci\u00f3n de todos los objetos que contiene el directorio. Esta informaci\u00f3n habitualmente se divide entre los controladores de dominio siendo \u00e9stos responsables del mantenimiento de su parte de esta informaci\u00f3n.</li> <li>Maestro de operaciones, existen un conjunto de operaciones que deben estar centralizadas para mantener la consistencia del sistema. El equipo encargado de esas operaciones obtiene este rol espec\u00edfico. Seg\u00fan el caso puede ser un equipo independiente que controle estas operaciones o asignar estas tareas a un equipo existente.</li> <li>\u00c1rbol, un conjunto de dominios dependientes de una ra\u00edz com\u00fan y que tienen una estructura jer\u00e1rquica. Se caracterizan por tener un espacio de nombres com\u00fan (un servidor DNS propio). El objetivo de esta fragmentaci\u00f3n de la estructura es replicar s\u00f3lo la informaci\u00f3n necesaria y disminuir el tr\u00e1fico de red.</li> </ol> Objetos en Active Directory. <ol> <li>Bosque, se trata del mayor contenedor l\u00f3gico dentro del directorio, conteniendo a todos los \u00e1rboles dentro de su \u00e1mbito. Cada uno de estos contenedores posee su propio espacio de nombres y una forma de relacionarse con el resto de bosques.</li> </ol> Ejemplo de Objetos en Active Directory. <ol> <li>Esquema, se refiere a la estructura de los objetos que forman la base de datos. Usa la t\u00e9cnica clase/objeto para definir la estructura de un objeto. Si se crean dos objetos usuarios, ambos tendr\u00e1n los mismos atributos (estructura), pero diferentes valores de atributos.</li> <li>Sitio, conjunto de objetos equipo que se encuentran relacionados de una forma l\u00f3gica, geogr\u00e1fica o t\u00e9cnica particular y que necesitan un subconjunto de normas diferentes al resto.</li> <li>Relaciones de confianza, son un m\u00e9todo de comunicaci\u00f3n segura entre dominios, \u00e1rboles y bosques, que permiten a los usuarios autentificarse en otra parte del directorio a la que no pertenece.</li> </ol> <p>Note</p> <p>Para nombrar a todos estos objetos que componen la red, los servicios de directorio definen un espacio de nombres un\u00edvoco, e identifican a cada uno de estos objetos con un nombre \u00fanico en todo el directorio.</p> <ul> <li>La tecnolog\u00eda utilizada para crear este espacio de nombres es la DNS (Domain Name Server), y su funcionamiento es similar al de Internet. </li> <li>Cada uno de los objetos del directorio posee un DN (Distinguished Name) que lo identifica de forma un\u00edvoca del resto de elementos del directorio.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#ventajas","title":"Ventajas","text":"<ul> <li>los servicios de directorio, ofrecen una capa de abstracci\u00f3n para facilitar el acceso a los objetos. Se debe indicar una \u00fanica ubicaci\u00f3n en donde se dirigir\u00e1n las peticiones de informaci\u00f3n. No importa si la informaci\u00f3n solicitada se encuentra o no en ese emplazamiento.</li> <li>Autonom\u00eda, Es posible que toda la informaci\u00f3n no est\u00e9 contenida en un \u00fanico equipo por cuestiones de rendimiento, escalabilidad o idiosincrasia del sistemas inform\u00e1tico. En estos casos crear un subconjunto de la informaci\u00f3n contenida en los servicios de directorio parece una buena opci\u00f3n y dotarlos de las herramientas necesarias para su gesti\u00f3n aut\u00f3noma.</li> <li>Si se permite el s\u00edmil, es el Google del sistema inform\u00e1tico que se gestiona.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#servicios-de-directorio-destacables","title":"Servicios de directorio destacables","text":"<ol> <li>Active Directory, ideado por Microsoft e implementado desde su versi\u00f3n Microsoft Windows 2000 que usaba tecnolog\u00eda propietaria, para m\u00e1s tarde adaptar el protocolo LDAP a su servicio.</li> <li>OpenLDAP, recibe el nombre del protocolo hom\u00f3nimo que gestiona el intercambio de informaci\u00f3n. Es uno de los m\u00e1s usados en sistemas basados en GNU/Linux.</li> <li>SambaLDAP, un servicio compuesto por un conjunto de protocolos (OpenLDAP, Kerberos y Samba) que permite la f\u00e1cil coexistencia de entre sistemas operativos diferentes.</li> <li>Otros: Novell Directory Services, Red Hat Directory Server o Apache Directory Server.</li> </ol> <p>Note</p> <p>En resumen, un servicio de directorio ofrece toda la informaci\u00f3n de los recursos de la red a trav\u00e9s de una \u00fanica ubicaci\u00f3n. Para ello convierte cada recurso en un objeto y almacena su informaci\u00f3n en una base de datos jer\u00e1rquica y, opcionalmente, distribuida. La gesti\u00f3n de estos datos se realiza a trav\u00e9s de un protocolo determinado por la versi\u00f3n del servicio de directorio escogido.</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#ldap","title":"LDAP","text":"<p>El LDAP (Lightweight Directory Access Protocol) es un protocolo a nivel de aplicaci\u00f3n que da acceso a un servicio de directorio ordenado y distribuido para la b\u00fasqueda de la informaci\u00f3n de un entrono de red.</p> <ul> <li> <p>En la d\u00e9cada de los 80, la especificaci\u00f3n de directorio X.500 vi\u00f3 la luz. El protocolo que daba acceso a la informaci\u00f3n contenida en \u00e9l, fue DAP (Directory Access Protocol) y estaba basado en la pila de protocolos OSI (Open Systems Interconexion). Gracias al auge de Internet, la pila de protocolos TCP/IP cobraron especial protagonismo y su uso fue generalizado en cualquier infraestructura de red, incluidas las LAN.</p> </li> <li> <p>Ante esta situaci\u00f3n, en 1993 se implement\u00f3 el protocolo LDAP que utilizaba la pila de protocolos TCP/IP para el acceso a la informaci\u00f3n contenido en un servicio de directorio. El funcionamiento de LDAP es relativamente simple: un cliente se inicia una sesi\u00f3n en un servidor LDAP solicitando alguna informaci\u00f3n.</p> </li> </ul> Esquema de funcionamiento del protocolo LDAP <p>Conclusi\u00f3n</p> <ul> <li>LDAP, es un protocolo que ofrece el acceso a un servicio de directorio implementado sobre un entorno de red, con el objeto de acceder a una determinada informaci\u00f3n. Puede ejecutarse sobre TCP/IP o sobre cualquier otro servicio de transferencia orientado a la conexi\u00f3n.</li> <li>Podemos considerarlo como un sistema de almacenamiento de red al que se pueden realizar consultas.</li> </ul> <ul> <li>Antes de trabajar con LDAP, hay varios conceptos importantes que deben entenderse.\u00a0El primer paso importante para dar el acceso comentado se basa en la autentificaci\u00f3n de usuarios.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#autenticar-usuarios","title":"AUTENTICAR USUARIOS","text":"<p>Existen diferentes formas de autenticar usuarios en una red linux, pero una de las m\u00e1s usadas es la combinaci\u00f3n de tres herramientas diferentes: NSS, PAM y LDAP.</p> <ul> <li>La idea consiste en disponer de un servidor que facilite la acci\u00f3n de autenticar usuarios, de modo, que \u00e9stos recurran al servidor cada vez que un cliente necesite identificarse. De esta forma, la cuenta de usuario no es espec\u00edfica de un equipo cliente, si no que ser\u00e1 v\u00e1lida en cualquier equipo de la red que haya sido debidamente configurado.</li> </ul> Herramientas autenticaci\u00f3n usuarios en Unix"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#pam","title":"PAM","text":"<p>Pluggable Authentication Module (PAM): o m\u00f3dulo de autenticaci\u00f3n conectable en espa\u00f1ol, es un mecanismo para integrar m\u00faltiples esquemas de autenticaci\u00f3n de bajo nivel en una interfaz de programaci\u00f3n de aplicaciones (API) de alto nivel.</p> <ul> <li> <p>Es decir, Establece una interfaz entre los programas de usuario y distintos m\u00e9todos de autenticaci\u00f3n. De esta forma, el m\u00e9todo de autenticaci\u00f3n, se hace transparente para los programas.</p> </li> <li> <p>La idea se basa en la creaci\u00f3n de m\u00f3dulos de autenticaci\u00f3n. Esto hace que, sin realizar modificaciones en el sistema, podamos utilizar m\u00e9todos que vayan desde el uso t\u00edpico de un nombre de usuario y una contrase\u00f1a, hasta aceptar contrase\u00f1as de un solo uso, restringir el acceso a determinados horarios o establecer pol\u00edticas de autenticaci\u00f3n espec\u00edficas para cada usuario o grupos de usuarios.</p> </li> </ul> Esquema de la estructura PAM <p>Note</p> <p>En la actualidad, PAM es el m\u00e9todo que utilizan la mayor\u00eda de las aplicaciones y herramientas de UNIX para autenticar usuarios.</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#nss","title":"NSS","text":"<p>Name Service Switch es un servicio que permite la resoluci\u00f3n de nombres de usuario y contrase\u00f1as (o grupos) mediante el acceso a diferentes or\u00edgenes de informaci\u00f3n.</p> <ul> <li>En condiciones normales, esta informaci\u00f3n se encuentra en los archivos locales del sistema operativo, en concreto en <ul> <li>/etc/passwd, /etc/shadow y /etc/group</li> </ul> </li> <li>pero puede proceder de otras fuentes, como DNS (Domain Name System), NIS (Network Information Service), LDAP (Lightweight Directory Access Protocol) o WINS (Windows Internet Name Service).</li> </ul> <p>Note</p> <p>Este servicio esta gestionado desde el fichero: /etc/nsswitch.conf</p>"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#cheat-sheet-ldap","title":"Cheat Sheet LDAP","text":"<p>En el siguiente sub-apartado se realizar\u00e1 la instalaci\u00f3n y configuraci\u00f3n del servicio OpenLDAP.</p> <ul> <li>En primer lugar se muestran unas tablas resumen de definiciones de elementos y siglas que pueden ser \u00fatiles para dicha instalaci\u00f3n. De todas formas en el punto 4.3. Modelo de Informaci\u00f3n de LDAP se estudiar\u00e1n m\u00e1s en detalle.</li> </ul> Elemento LDAP Definici\u00f3n entry una colecci\u00f3n de informaci\u00f3n sobre una entidad attribute conserva los datos para una entrada object\u00adClass elementos de esquema que especifican colecciones de tipos de atributos que pueden estar relacionados con un tipo particular de objeto, proceso u otra entidad dn identifica de forma \u00fanica esa entrada y su posici\u00f3n en la jerarqu\u00eda del \u00e1rbol de informaci\u00f3n del directorio (DIT) rdn la parte relativa de un nombre distintivo (DN) oid una cadena que se utiliza para identificar de forma \u00fanica varios elementos en el protocolo LDAP Atributos Definici\u00f3n cn common name name name, same as cn dn distin\u00adguished name dc domain component manager manager company company department department o organi\u00adzation ou organi\u00adzat\u00adional unit uid user id descri\u00adption descri\u00adption displa\u00adyName display name givenName first name sn surname title job title location location l location street\u00adAddress first line of address postalCode zip code c country st state homephone home phone number mobile mobile phone number teleph\u00adone\u00adNumber office phone number"},{"location":"01_INTRO_SOR/ayudaASO/041_Introduccion_SDyLDAP.html#actividades","title":"Actividades","text":"<p>Instalaci\u00f3n y configuraci\u00f3n b\u00e1sica del servidor Open LDAP</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html","title":"DOCKER REPASO","text":"Figura 1: Logo Docker. <p>Docker (estibador en ingl\u00e9s) es un Sistema de Virtualizaci\u00f3n de Aplicaciones mediante contenedores, creado por Solomon Hykes y su equipo de ingenieros.</p> <ul> <li>En 2013 se convirti\u00f3 en un proyecto de software libre (licencia Apache) en el que participan cada vez m\u00e1s empresas. </li> <li>La versi\u00f3n 1.0 se public\u00f3 en junio de 2014 y ha tenido un desarrollo muy r\u00e1pido.</li> <li>En marzo de 2017, Docker anunci\u00f3 un desarrollo todav\u00eda m\u00e1s r\u00e1pido, pasando a publicar una nueva versi\u00f3n cada mes. La numeraci\u00f3n de las versiones adopt\u00f3 al formato AA.MM (la primera fue Docker 17.03).</li> <li>En julio de 2018, Docker anunci\u00f3 que volv\u00edan a un desarrollo m\u00e1s pausado. A partir de Docker 18.09 habr\u00eda una versi\u00f3n \"estable\" cada seis meses.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#conceptos-previos","title":"Conceptos Previos","text":""},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#virtualizacion-hipervisor","title":"Virtualizaci\u00f3n: Hipervisor","text":"<p>En general, el objetivo de la virtualizaci\u00f3n es poder utilizar simult\u00e1neamente en un mismo ordenador dos o m\u00e1s sistemas operativos. Por lo tanto, para poder hablar de virtualizaci\u00f3n tienen que estar funcionando a la vez varios sistemas operativos.</p> <p>Note</p> <ul> <li>De acuerdo con esta definici\u00f3n, instalar dos sistemas operativos en un ordenador (Windows y Linux, por ejemplo) y poder elegir uno u otro mediante un arranque dual no se considera virtualizaci\u00f3n, puesto que mediante un arranque dual no podemos ejecutar a la vez ambos sistemas.</li> <li>Y tampoco ser\u00eda virtualizaci\u00f3n la simulaci\u00f3n, que consiste en imitar el aspecto visual del sistema imitado. Por ejemplo, podr\u00edamos instalar un tema de escritorio en GNOME o KDE que imitara el escritorio de Windows. El problema de esta simulaci\u00f3n ser\u00eda que realmente no estar\u00edamos utilizando Windows sino simplemente algo que parece Windows. As\u00ed que, por ejemplo, no podr\u00edamos instalar una aplicaci\u00f3n de Windows puesto que el sistema operativo ser\u00eda Linux, que no acepta instaladores de Windows.</li> </ul> <p>A tener en cuenta</p> <ul> <li>Los sistemas operativos son los encargados de la gesti\u00f3n del hardware y requieren un control completo del mismo, por lo que dos sistemas operativos no pueden en principio estar funcionando a la vez sobre el mismo hardware.</li> <li>La soluci\u00f3n para la virtualizaci\u00f3n es la existencia de un hipervisor (en ingl\u00e9s, hypervisor).</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#ventajas-virtualizacion","title":"Ventajas Virtualizaci\u00f3n","text":"<p>La virtualizaci\u00f3n tiene muchas aplicaciones interesantes:</p> <ul> <li>La m\u00e1s habitual es poder ejecutar aplicaciones que no est\u00e1n disponibles para el sistema operativo host, pero s\u00ed para otro sistema operativo que se instalar\u00eda como guest.</li> <li>La virtualizaci\u00f3n permite la conservaci\u00f3n del software. Debido al progreso del hardware, los procesadores antiguos dejan de fabricarse y los sistemas operativos y aplicaciones antiguos dejan de desarrollarse y dejan de funcionar en el hardware moderno. Pero si el sistema operativo puede instalarse como guest, puede seguir utiliz\u00e1ndose para siempre.</li> <li>La virtualizaci\u00f3n permite depurar y comprobar el funcionamiento de los programas y los sistemas operativos. Si un programa provoca un fallo de funcionamiento total, si se est\u00e1 ejecutando como guest, el sistema host puede recoger informaci\u00f3n sobre el motivo del fallo.</li> <li>La virtualizaci\u00f3n permite un mejor aprovechamiento del hardware, ya que un mismo ordenador puede contener muchos sistemas guests utilizados por usuarios diferentes, aislados unos de otros.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#hipervisor","title":"Hipervisor","text":"<p>El hipervisor es la pieza fundamental de la virtualizaci\u00f3n. Tradicionalmente, se distinguen dos tipos de hipervisores:</p> <ul> <li>Los hipervisores de tipo 1, denominados \u00abhipervisores bare metal\u00bb, dichos hipervisores est\u00e1n en contacto directo con el hardware de la m\u00e1quina, sin necesidad de ning\u00fan sistema operativo previo.</li> <li>Los hipervisores de tipo 2, denominados \u00abalojados\u00bb, y son una aplicaci\u00f3n m\u00e1s del sistema operativo instalado en la m\u00e1quina y el hipervisor accede al hardware de la m\u00e1quina a trav\u00e9s de ese sistema operativo.</li> </ul> Tipos de Hipervisor. <p>Note</p> <ul> <li>En el caso de los hipervisores de tipo 2, el sistema operativo que tiene el control del hardware recibe el nombre de host (anfitri\u00f3n). Es el sistema operativo que se instal\u00f3 primero en el ordenador y el que se pone en marcha al arrancar el ordenador. Los dem\u00e1s sistemas operativos reciben el nombre de guests (hu\u00e9spedes) y pueden ejecutarse o no a voluntad del usuario.</li> <li>En el caso de los hipervisores de tipo 1 no hay un sistema operativo host, todos los sistemas operativos son guests del hipervisor.</li> </ul> <p>Example</p> <ul> <li>Tipo 1: ejemplos de este tipo de hipervisores son VMware ESXi o Xen, los cuales son utilizados a nivel de centro de datos. Hyper-V de Microsoft se puede considerar un hipervisor de tipo 1, porque aunque necesita que est\u00e9 instalado primero Windows para poder instalar Hyper-V, una vez instalado convierte a Windows en un guest m\u00e1s de Hyper-V (aunque con acceso prioritario con respecto al resto de guests). </li> <li>Tipo 1/Tipo 2: KVM, al estar integrado en el kernel de Linux, se puede considerar tanto de tipo 1 como de tipo 2. </li> <li>Tipo 2: VirtualBox es un hipervisor de tipo 2.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#contenedores","title":"Contenedores","text":"<p>El problema de los hipervisores y las m\u00e1quinas virtuales es que cada m\u00e1quina virtual es independiente de las dem\u00e1s. Al no reutilizarse ning\u00fan componente, se ocupa mucho espacio tanto en disco como en memoria y el tiempo de ejecuci\u00f3n siempre ser\u00e1 mayor que si s\u00f3lo hubiera un sistema operativo (sobre todo en el caso de hipervisores de tipo 2).</p> <p>Para resolver este problema se crearon los contenedores en los que se utilizan mecanismos existentes en el sistema operativo para aislar las aplicaciones, pero compartiendo el mayor n\u00famero posible de componentes del sistema operativo o incluso de las aplicaciones.</p> <ul> <li>Como definici\u00f3n, Un contenedor es el equivalente a una m\u00e1quina virtual de la virtualizaci\u00f3n cl\u00e1sica, pero mucho m\u00e1s ligera porque utiliza recursos del sistema operativo del host. </li> <li>Las aplicaciones de cada contenedor \"ven\" un sistema operativo, que puede ser diferente en cada contenedor, pero quien realiza el trabajo es el sistema operativo com\u00fan que hay por debajo.</li> </ul> <p>Note</p> <ul> <li>Los contenedores suelen ser elementos ef\u00edmeros. La facilidad con la que pueden crearse y ponerse en marcha hace m\u00e1s f\u00e1cil crear un nuevo contenedor que modificar uno ya existente. Por ello, los datos generados por las aplicaciones no se suelen guardar en los contenedores, sino fuera de ellos. </li> <li>Su ligereza hace m\u00e1s f\u00e1cil tener varios contenedores con una aplicaci\u00f3n en cada uno de ellos que tener un \u00fanico contenedor con varias aplicaciones en \u00e9l. Por ello, un aspecto importante de los contenedores es su orquestaci\u00f3n, es decir, la administraci\u00f3n simult\u00e1nea de muchos contenedores, una de las herramientas m\u00e1s utilizadas es Kubernetes.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#maquinas-virtuales-vs-contenedores","title":"M\u00e1quinas Virtuales VS Contenedores","text":"Contenedores Vs M\u00e1quinas Virtuales."},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#microservicios","title":"Microservicios","text":"<p>Uno de los objetivos principales de la configuraci\u00f3n e implantaci\u00f3n de contenedores es solucionar los problemas de:</p> <ul> <li>Errores de dependencias entre diferentes Sistemas Operativos de los trabajadores y m\u00e1quinas de puesta en marcha.</li> <li>Evitar la Elevada carga y capacidad de las M\u00e1quinas Virtuales.</li> <li> <p>Ca\u00edda de todos los servicios instalados de forma monol\u00edtica en los servidores.</p> </li> <li> <p>Tipos de despliegue:</p> <ul> <li>SOA (Service Oriented Architecture) \u2192 Diferentes M\u00e1quinas una con cada Servicio conectadas.</li> <li>Monol\u00edtico \u2192 Todos los servicios en la misma m\u00e1quina.</li> <li>MicroServicios \u2192 Divisi\u00f3n m\u00e1s peque\u00f1a de los servicios.</li> </ul> </li> </ul> Monol\u00edtico Vs Microservicios."},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#caracteristicas-principales-contenedores","title":"Caracter\u00edsticas principales Contenedores","text":"<p>En resumen los contenedores:</p> <ul> <li>Consisten en Agrupar y Aislar Aplicaciones o grupos de aplicaciones que se ejecutan sobre un mismo n\u00facleo de sistema operativo.</li> <li>Su caracter\u00edstica principal se basa en su propio sistema de archivos ejecutable en cualquier Sistema Operativo.</li> <li>No es necesario emular el HW y SW completo como en las m\u00e1quinas virtuales, por lo tanto son mucho m\u00e1s ligeros, comparten el m\u00e1ximo de componentes con el sistema operativo host, y su rapidez, ya que gracias a que apenas a\u00f1aden capas adicionales consiguen casi velocidades nativas.</li> <li>Soluciona problemas de espacio y compatibilidades a la hora de puesta en marcha en servidores de producci\u00f3n.</li> <li>Los contenedores suelen ser elementos ef\u00edmeros.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#caracteristicas-principales-de-docker","title":"Caracter\u00edsticas principales de Docker","text":"<p>Por lo tanto se define Docker como...</p> <p>Un proyecto de c\u00f3digo abierto que automatiza el despliegue de aplicaciones dentro de contenedores de software, proporcionando una capa adicional de abstracci\u00f3n y automatizaci\u00f3n de virtualizaci\u00f3n de aplicaciones en m\u00faltiples sistemas operativos.\u200b</p> <p>Sus principales caracter\u00edsticas son:</p> <ul> <li>Docker es una API amigable del tipo Open Source.</li> <li>Genera un proceso aislado del resto de los procesos de la m\u00e1quina gracias a: Ejecutar sobre su propio sistema de ficheros, con su propio espacio de usuarios y procesos, y sus propias interfaces de red... </li> <li>Es Modular ya que esta dividido en varios componentes.</li> <li>Es portable e inmutable utilizando la plataforma DockerHub.</li> <li>Su es lema \u201cBuild, Ship and Run, any app,\u201d.</li> </ul> Lema Docker. <p>Note</p> <p>Aunque un contenedor puede incluir cualquier n\u00famero de aplicaciones, lo habitual es que un contenedor contenga una sola aplicaci\u00f3n (y los programas necesarios para ponerse en marcha). </p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#arquitectura-docker","title":"Arquitectura Docker","text":"<ol> <li>Docker Engine (\"Motor\" del Gestor Docker): el cual basado en la arquitectura de Cliente-Servidor (que pueden estar en la misma m\u00e1quina, o en distintas), y realizada por mediante una API de REST que utiliza HTTP.<ul> <li>API REST: interfaz de programaci\u00f3n con un estilo de arquitectura software para sistemas hipermedia distribuidos como la World Wide Web.</li> </ul> </li> <li>\"Daemon Docker\" (Servicio): lleva a cabo Gesti\u00f3n y enlace de los componentes del gestor.</li> <li>Im\u00e1genes: Las im\u00e1genes son una especie de plantillas que contienen como m\u00ednimo todo el software que necesita la aplicaci\u00f3n para ponerse en marcha. est\u00e1n formadas por una colecci\u00f3n ordenada de: Sistemas Archivos, Repositorios, Comandos, Par\u00e1metros, Aplicaciones.</li> <li>Contenedores: son el conjunto de procesos que encapsulan e identifican a una Imagen. Pueden ser:<ul> <li>Creado, inicializado, parado, vuelto a ejecutar y destruido.</li> </ul> </li> <li>Registros son im\u00e1genes son guardadas en registros para: Almacenar o Distribuir.<ul> <li>Se realiza en Docker Hub y pueden ser  P\u00fablicos y Privados.</li> </ul> </li> </ol> Componentes de Docker. <p>Note</p> <ul> <li>El componente b\u00e1sico de Docker es el Docker Engine, pero Docker ofrece tambi\u00e9n una serie de herramientas para administrar, distribuir e instalar contenedores: Docker Compose, Docker Swarm.</li> <li>Las im\u00e1genes se pueden crear a partir de otras im\u00e1genes m\u00e1s b\u00e1sicas incluyendo software adicional en forma de capas. Todos los contenedores creados a partir de una imagen contienen el mismo software, aunque en el momento de su creaci\u00f3n se pueden personalizar algunos detalles</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#instalacion","title":"Instalaci\u00f3n","text":"<p>Para la Instalaci\u00f3n de Docker es recomendable seguir la documentaci\u00f3n oficial. Adem\u00e1s se recomienda Instalar m\u00e1quina Ubuntu Server \u00faltima versi\u00f3n e instalar Docker en ella.</p> <ul> <li>Docker for Mac:<ul> <li>Instalaci\u00f3n Mac</li> </ul> </li> <li>Docker for Windows:<ul> <li>Instalaci\u00f3n Windows</li> </ul> </li> <li>Docker for ubuntu:<ul> <li>Instalaci\u00f3n Ubuntu</li> </ul> </li> </ul> <p>Warning</p> <ul> <li>Docker empez\u00f3 estando disponible solamente para distribuciones GNU/Linux, pero desde junio de 2016 tambi\u00e9n est\u00e1 disponible como aplicaci\u00f3n nativa en Windows Server 2016 y Windows 10.</li> <li>Docker utiliza la virtualizaci\u00f3n ofrecida por el sistema operativo. En el caso de Windows 10, eso significa que para usar Docker de forma nativa hay que activar Hyper-V que, por desgracia, es incompatible con VirtualBox. Para poder utilizar Docker en Windows 7 o en Windows 10 sin Hyper-V, Docker ofrece desde agosto de 2015 Docker Toolbox, que realmente es una m\u00e1quina virtual (que se ejecuta en VirtualBox) que contiene Docker.</li> <li>Otra opci\u00f3n ser\u00eda utilizar Podman</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#ejemplo-instalacion-en-ubuntu-server","title":"Ejemplo Instalaci\u00f3n en Ubuntu server","text":"<ul> <li>A continuaci\u00f3n se muestra la instalaci\u00f3n aconsejada para Ubuntu Server utilizando el m\u00e9todo de repositorios:</li> </ul> <ol> <li>En primer lugar se actualizan los paquetes y se instalan los paquetes para utilizar el repositorio sobre HTTPS:</li> </ol> <pre><code>sudo apt-get update\napt-get install ca-certificates curl gnupg lsb-release\n</code></pre> <ol> <li>Se a\u00f1ade la clave GPG oficial de Docker:</li> </ol> <pre><code>mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n</code></pre> <ol> <li>Se configura el repositorio:</li> </ol> <pre><code>echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n</code></pre> <ul> <li>Se realiza de nuevo una actualizaci\u00f3n.</li> </ul> <pre><code>sudo apt-get update\n</code></pre> <ol> <li>Instalaci\u00f3n propia del Engine de Docker y Docker Compose:</li> </ol> <pre><code>apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n</code></pre> <ol> <li>Comprobamos que est\u00e1 correctamente bien instalado ejecutando el contenedor \"Hello World\"</li> </ol> <pre><code>docker run hello-world\n</code></pre>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#principales-comandos","title":"Principales Comandos","text":"<p>A continuaci\u00f3n se muestran los comandos m\u00e1s utilizados:</p> Comando Acci\u00f3n Comando Acci\u00f3n <code>docker info</code> obtener informaci\u00f3n relativa a docker <code>docker start</code> (docker container start) inicia la ejecuci\u00f3n <code>docker run</code> (docker container run) crea y ejecuta el contenedor <code>docker rm</code> (docker container eliminar) elimina el contenedor <code>docker build</code> crea una imagen <code>docker cp</code> (docker container copiar) <code>docker ps</code> muestra la lista de contenedores creados <code>docker logs</code> (docker container logs) muestra los errores <code>docker inspect</code> (docker container inspect) informaci\u00f3n detallada de los contenedores <code>docker stats</code> (docker container stats) muestra el estado <code>docker stop</code> (docker container stop) detiene la ejecuci\u00f3n del contenedor <code>docker system prune</code> limpiar todo el sistena de contenedores im\u00e1genes y volumenes <ul> <li>Chuleta de Comandos</li> </ul> Chuleta Docker."},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#primer-contenedor","title":"Primer Contenedor","text":"<p>A continuaci\u00f3n se muestra un ejemplo guiado de la creaci\u00f3n del contenedor \"Hello World\"</p> <ol> <li>Comprobaci\u00f3n que inicialmente no hay ning\u00fan contenedor creado (la opci\u00f3n <code>-a</code> hace que se muestren tambi\u00e9n los contenedores detenidos, sin ella se muestran s\u00f3lo los contenedor que est\u00e9n en marcha):</li> </ol> <p><pre><code>sudo docker ps -a\n</code></pre> o tambi\u00e9n</p> <pre><code>sudo docker container ls -a\n</code></pre> <ol> <li>Compruebe que inicialmente tampoco disponemos de ninguna imagen:</li> </ol> <pre><code>sudo docker image ls\n</code></pre> <p>Note</p> <p>Docker crea los contenedores a partir de im\u00e1genes locales (ya descargadas), pero si al crear el contenedor no se dispone de la imagen local, Docker descarga la imagen de su repositorio.</p> <ol> <li>La orden m\u00e1s simple para crear un contenedor sigue esta estructura:</li> </ol> <pre><code>sudo docker run IMAGEN\n</code></pre> <p>Example</p> <pre><code>sudo docker run hello-world\n</code></pre> <p>Note</p> <p>Como no tenemos todav\u00eda la imagen en nuestro ordenador, Docker descarga la imagen, crea el contenedor y lo pone en marcha. En este caso, la aplicaci\u00f3n que contiene el contenedor hello-world simplemente escribe un mensaje de salida al arrancar e inmediatamente se detiene el contenedor.</p> <p>Si listamos de nuevo imagenes y contenedores, las veremos creadas.</p> <ul> <li>Cada contenedor tiene un identificador (ID) y un nombre distinto. Docker \"bautiza\" los contenedores con un \"nombre peculiar\", compuesto de un adjetivo y un apellido.</li> <li>Podemos crear tantos contenedores como queramos a partir de una imagen. Una vez la imagen est\u00e1 disponible localmente, Docker no necesita descargarla y el proceso de creaci\u00f3n del contenedor es inmediato (aunque en el caso de hello-world la descarga es r\u00e1pida, con im\u00e1genes m\u00e1s grandes la descarga inicial puede tardar un rato).</li> </ul> <p>Tip</p> <ul> <li>Normalmente se aconseja usar siempre la opci\u00f3n <code>-d</code>, que arranca el contenedor en segundo plano (detached) y permite seguir teniendo acceso a la shell (aunque con hello-world no es estrictamente necesario porque el contenedor hello-world se detiene autom\u00e1ticamente tras mostrar el mensaje).</li> <li>Al crear el contenedor hello-world con la opci\u00f3n <code>-d</code> no se muestra el mensaje, simplemente muestra el identificador completo del contenedor.</li> </ul> <ul> <li> <p>Los contenedores se pueden destruir mediante el comando rm, haciendo referencia a ellos mediante su nombre o su id. No es necesario indicar el id completo, basta con escribir los primeros caracteres (de manera que no haya ambig\u00fcedades).</p> </li> <li> <p>Adem\u00e1s podemos dar nombre a los contenedores al crearlos:</p> </li> </ul> <pre><code>sudo docker run -d --name=hola-1 hello-world\n</code></pre>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#volumenes","title":"Vol\u00famenes","text":"<p>Docker simplifica enormemente la creaci\u00f3n de contenedores, y eso lleva a tratar los contenedores como un elemento ef\u00edmero, que se crea cuando se necesita y que no importa que se destruya puesto que puede ser reconstruido una y otra vez a partir de su imagen.</p> <p>Warning</p> <p>Pero si la aplicaci\u00f3n o aplicaciones incluidas en el contenedor generan datos y esos datos se guardan en el propio contenedor, en el momento en que se destruyera el contenedor perder\u00edamos esos datos.</p> <ul> <li> <p>El objetivo principal de los volumenes es no perder datos si borro el contenedor y mejorar rendimiento del Docker.  Para conseguir la persistencia de los datos, se pueden emplear dos t\u00e9cnicas:</p> <ol> <li> <p>Los directorios enlazados (bind), en la que la informaci\u00f3n se guarda fuera de Docker, en la m\u00e1quina host (por ejemplo si lo ejecutamos en la m\u00e1quina virtual de Ubuntu o la m\u00e1quina f\u00edsica de Lliurex en clase).</p> </li> <li> <p>Los vol\u00famenes, en la que la informaci\u00f3n se guarda mediante Docker, pero en unos elementos llamados vol\u00famenes, independientes de las im\u00e1genes y los contenedores. Adem\u00e1s los volumens se pueden catalogar en dos tipos.</p> <ol> <li>Volu\u0301menes de Datos: es como si montar\u00e1 un disco en el contenedor y por defecto se realizan en un path temporal.</li> <li>Volu\u0301menes de Host: Mismo concepto pero indic\u00e1ndole el path.</li> </ol> </li> </ol> </li> </ul> <p>Tip</p> <p>Aconsejable utilizar la t\u00e9cnica de volumenes, ya que, La ventaja frente a los directorios enlazados es que pueden ser gestionados por Docker. Otro detalle importante es que el acceso al contenido de los vol\u00famenes s\u00f3lo se puede hacer a trav\u00e9s de alg\u00fan contenedor que utilice el volumen.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#ventajas-volumenes","title":"Ventajas Vol\u00famenes","text":"<p>Los vol\u00famenes tienen varias ventajas sobre los directorios enlazados:</p> <ul> <li>Los vol\u00famenes son m\u00e1s f\u00e1ciles de respaldar o migrar que enlazar montajes.</li> <li>Puede administrar vol\u00famenes mediante los comandos de la CLI de Docker o la API de Docker.</li> <li>Los vol\u00famenes funcionan tanto en contenedores de Linux como de Windows.</li> <li>Los vol\u00famenes se pueden compartir de forma m\u00e1s segura entre varios contenedores.</li> <li>Los controladores de volumen le permiten almacenar vol\u00famenes en hosts remotos o proveedores en la nube, para cifrar el contenido de los vol\u00famenes o para agregar otras funciones.</li> <li>Los nuevos vol\u00famenes pueden tener su contenido precargado por un contenedor.</li> <li>Los vol\u00famenes en Docker Desktop tienen un rendimiento mucho mayor que los directorios enlazados de hosts de Mac y Windows.</li> </ul> <p>Note</p> <p>Adem\u00e1s, los vol\u00famenes suelen ser una mejor opci\u00f3n que los datos persistentes en la capa de escritura de un contenedor, porque un volumen no aumenta el tama\u00f1o de los contenedores que lo usan y el contenido del volumen existe fuera del ciclo de vida de un contenedor determinado.</p> Gr\u00e1fico t\u00e9cnicas de persistencia de datos. <p>Note</p> <p>Los vol\u00famenes son independientes de los contenedores, por lo que tambi\u00e9n podemos conservar los datos aunque se destruya el contenedor, reutilizarlos con otro contenedor, etc.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#opciones","title":"Opciones","text":"<ul> <li>Opciones:</li> </ul> <pre><code>`Docker volume (create|Is|inspect|rm)`\n</code></pre> <ul> <li>para crear el volumen a la vez que creamos y ejecutamos un contenedor se utilzan las opciones <code>v</code> o <code>--mount</code></li> </ul> <p>En general, <code>--mount</code> m\u00e1s expl\u00edcito y detallado. La mayor diferencia es que la sintaxis de <code>-v</code> combina todas las opciones juntas en un campo, mientras que la sintaxis <code>--mount</code>  las separa. A continuaci\u00f3n se muestra una comparaci\u00f3n de la sintaxis de cada \"flag\".</p> <ul> <li> <p><code>-v</code> o <code>--volume</code> : consta de tres campos, separados por dos puntos ( :). Los campos deben estar en el orden correcto y el significado de cada campo no es inmediatamente obvio.</p> <ul> <li>En el caso de vol\u00famenes con nombre, el primer campo es el nombre del volumen y es \u00fanico en una m\u00e1quina host determinada. Para vol\u00famenes an\u00f3nimos, se omite el primer campo.</li> <li>El segundo campo es la ruta donde se monta el archivo o directorio en el contenedor.</li> <li>El tercer campo es opcional y es una lista de opciones separadas por comas, como <code>ro</code> (readonly). </li> </ul> </li> <li> <p><code>--mount</code>: Consta de varios pares clave-valor, separados por comas (cada uno formado por una = dupla). La sintaxis de <code>--mount</code> es m\u00e1s detallada que <code>-v</code> o <code>--volume</code>; adem\u00e1s el orden de las claves no es significativo, por lo tanto el valor de las \"flags\" son m\u00e1s f\u00e1ciles de entender.  <li>Valores de las duplas:<ul> <li>type: puede ser <code>bind</code>, <code>volume</code> o <code>tmpfs</code>.</li> <li>source: Para vol\u00famenes con nombre, este es el nombre del volumen. Para vol\u00famenes an\u00f3nimos, este campo se omite. Puede especificarse como source o src.</li> <li>destination: toma como valor de la ruta en el archivo o directorio est\u00e1 montado en el contenedor. Puede ser especificado como destination, <code>dst</code> o <code>target</code>.</li> <li>readonly: si est\u00e1 presente, hace que el montaje de enlace se monte en el contenedor como de solo lectura. Puede especificarse como <code>readonly</code> o <code>ro</code>.</li> <li>volume-opt se puede especificar m\u00e1s de una vez, toma un par clave-valor que consta del nombre de la opci\u00f3n y su valor. Ejemplo: <code>volume-opt=type=nfs</code></li> </ul> </li> <p>Note</p> <p>Todas las opciones de vol\u00famenes est\u00e1n disponibles para los indicadores <code>--mount</code> y <code>-v</code>, por que a la hora de elegir uno u otro depende del t\u00e9cnico para su facilidad de configuraci\u00f3n donde por su sintaxis a priori ser\u00eda mejor <code>--mount</code>.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#ejemplo","title":"Ejemplo","text":"<p>A continuaci\u00f3n se muestra un ejemplo de creaci\u00f3n del servidor web NGINX.</p> <p>Example</p> <pre><code>docker run -d \\\n--name nginx1 -p 8080:80 \\\n--mount type=volume,source=myvol1,target=/usr/share/nginx/html \\\nnginx:latest\n</code></pre> <p>Note</p> <ul> <li>Si en lugar de la opci\u00f3n <code>-p 8080:80</code> se utiliza la opci\u00f3n <code>-P</code> hace que Docker asigne de forma aleatoria un puerto de la m\u00e1quina virtual al puerto asignado a Nginx en el contenedor.</li> </ul> <ul> <li>Si se creara una p\u00e1gina de incio del apache diferente a la de defecto podr\u00edamos copiarla en el volumen y esta cambiar\u00eda:</li> </ul> <pre><code>nano index.html\n</code></pre> <ul> <li>Nueva p\u00e1gina de inicio:</li> </ul> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"es\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\"&gt;\n  &lt;title&gt;Apache en Docker&lt;/title&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;h1&gt;\u00a1Hola Mundo!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <ul> <li> <p>Para cambiar la p\u00e1gina de inicio del apache se debe copiar dentro del volumen creado. <pre><code>docker cp index.html nginx1:/usr/share/nginx/html\n</code></pre></p> </li> <li> <p>Si accedemos al servidor apache aparecer\u00e1 la nueva p\u00e1gina. </p> </li> </ul> <p>Warning</p> <p>Si aparece el error forbiden 403, es debido a permisos del index.html, debemos entrar en container y cambiar los permisos.</p> <pre><code>docker exec -it nginx1 /bin/bash\n</code></pre> <pre><code>cd /usr/share/nginx/html\nchown -R root:root index.html\n</code></pre> <ul> <li> <p>Adem\u00e1s podemos crear un nuevo contenedor con este volumen: <pre><code>docker run -d \\\n    --name nginx2 -p 8080:80 \\\n    --mount type=volume,source=myvol1,target=/usr/share/nginx/html \\\n    nginx:latest\n</code></pre></p> </li> <li> <p>Se comprueba que el nuevo contenedor muestra la nueva p\u00e1gina index.html</p> </li> </ul> <p>Warning</p> <p>Si se intenta borrar el volumen del ejemplo anterior mientras los contenedores est\u00e1n en marcha, Docker muestra un mensaje de error que indica los contenedores afectados.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#redes","title":"Redes","text":"<p>Cuando se crean diferentes servicios o aplicaciones en contenedores distintos (siguiendo la premisa de microservicios), estos no estas conectados entre s\u00ed, en el caso que necesitar\u00e1n conexi\u00f3n se utilizar\u00edan \"redes Docker\". Este mecanismo funciona de manera distinta seg\u00fan la red docker donde est\u00e9n conectados los contenedores.</p> Representaci\u00f3n Redes Docker."},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#opciones-y-tipos","title":"Opciones y tipos","text":"<ul> <li>Opciones:</li> </ul> <p><code>docker network (create | Is | inspect | rm)</code></p> <p>A continuaci\u00f3n se introducen los distintos tipos de redes que nos ofrece docker:</p> <ul> <li>Bridge \u2192 por defecto. Todos los contenedores est\u00e1n en la misma red, separada del Host.</li> <li>Host \u2192 Cuando quiero que los contenedores est\u00e9n en mi misma red.</li> <li>None \u2192 contenedores aislados.</li> </ul> Escenario de ejemplo de una Red Docker. <p>Warning</p> <p>El uso de contenedores conectados a la red por defecto no est\u00e1 recomendado en entornos de producci\u00f3n. se podr\u00edan enlazar contenedores con el bridge por defecto con el flag <code>--link</code>.</p> <p>Tip</p> <p>La opci\u00f3n recomendable es definir una red bridge y crear los contenedores conectados a dicha red. El mayor problema es que ambos contenedores compartir\u00edan las variables de entorno y esto puede causar problemas de desarrollo.</p> <ul> <li> <p>Por ejemplo: <pre><code>docker network create mired\n</code></pre></p> </li> <li> <p>Se crean los contenedores conectados a dicha red: <pre><code>docker run -d --name servidor_mysql --network mired \\\n-e MYSQL_DATABASE=bd_wp -e MYSQL_USER=user_wp -e MYSQL_PASSWORD=asdasd \\\n-e MYSQL_ROOT_PASSWORD=asdasd mariadb\ndocker run -d --name servidor --network mired javierhernandez/aplicacionweb:v1\n</code></pre></p> </li> </ul> <p>Note</p> <p>En este caso no se comparten las variables de entorno.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#nextcloud","title":"NextCloud","text":"<p>Nextcloud hace referencia al conjunto de herramientas software de c\u00f3digo abierto con arquitectura cliente-servidor, que permiten la creaci\u00f3n de servicios de alojamiento de archivos en servidores privados.</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Los archivos Nextcloud son almacenados en estructuras de directorio convencionales y se pueden acceder a trav\u00e9s del protocolo WebDAV si es necesario.</li> <li>Los archivos son encriptados en la transmisi\u00f3n y opcionalmente durante el almacenamiento.</li> <li>Los usuarios pueden manejar calendarios (CalDAV), contactos (CardDAV), tareas programadas y reproducir contenido multimedia (Ampache).</li> <li>Permite la administraci\u00f3n de usuarios y grupos de usuarios (v\u00eda OpenID o LDAP) y definir permisos de acceso.</li> <li>Posibilidad de a\u00f1adir aplicaciones (de un solo clic) y conexiones con Dropbox, Google Drive y Amazon S3.</li> <li>Disponibilidad de acceso a diferentes bases de datos mediante SQLite, MariaDB, MySQL, Oracle Database, y PostgreSQL.</li> </ul> <p>Nota</p> <p>WebDAV es un grupo de trabajo del Internet Engineering Task Force (IETF). El t\u00e9rmino significa \"Autor\u00eda y versionado distribuidos por Web\" (Web Distributed Authoring and Versioning), y se refiere al protocolo (m\u00e1s precisamente, a la extensi\u00f3n del protocolo) que el grupo defini\u00f3. Este protocolo proporciona funcionalidades para crear, cambiar y mover documentos en un servidor remoto (t\u00edpicamente un servidor web).</p>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#actividades-tipo-practicastrabajos-aea","title":"Actividades tipo Pr\u00e1cticas/trabajos (AEA)","text":""},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#pt63-instalacion-y-configuracion-de-nextcloud-mediante-docker","title":"PT63. Instalaci\u00f3n y configuraci\u00f3n de NextCloud mediante Docker","text":"<ul> <li>Estamos trabajando en una empresa que tiene la necesidad de compartir recursos (carpetas documentos, im\u00e1genes...), tanto entre las personas dentro de la empresa como con clientes fuera de \u00e9sta.</li> <li>Para haceros valer dentro de la empresa indic\u00e1is que pod\u00e9is montar un servidor NextCloud en unos pocos minutos para solventar dicho problema.</li> <li>La empresa cuenta con un equipo Linux que hace de servidor, decid\u00eds hacer uso de docker para levantar el servicio NextCloud de una forma muy r\u00e1pida y sencilla.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#premisas","title":"Premisas","text":"<ul> <li>El servicio docker se debe levantar en la red 192.168.20.0/24.</li> <li>Debe tener la traducci\u00f3n est\u00e1tica del puerto 80 de la m\u00e1quina anfitriona al puerto 80 del contenedor.</li> <li>Debe tener un volumen asociado llamado \"volNextCloud\".</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#investiga","title":"Investiga","text":"<ul> <li>Crea el contenedor Nextcloud \u00bfAl crear el contenedor se ha generado autom\u00e1ticamente alg\u00fan volumen? \u00bfCu\u00e1l?</li> <li>Dentro del sistema anfitri\u00f3n (lliurex/Windows) \u00bfD\u00f3nde est\u00e1 guardado el fichero subido previamente?</li> <li>\u00bfEste contenedor es persistente? \u00bfQu\u00e9 significa que el contenedor es persistente? \u00bfC\u00f3mo lo has comprobado?</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#pruebas","title":"Pruebas","text":"<ul> <li>Sube un fichero de prueba, comprueba si est\u00e1 en la carpeta volumen creada. En caso de no estar:</li> <li>Prueba a subir un fichero a la plataforma NextCloud. Acto seguido dentro del contenedor busca en que directorio se ha guardado dicho fichero.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#ayuda","title":"Ayuda","text":"<ul> <li>P\u00e1gina oficial para la Instalaci\u00f3n en ubuntu en el siguiente enlace Instalaci\u00f3n en Ubuntu Documentaci\u00f3n</li> <li>Lee la documentaci\u00f3n sobre la imagen NextCloud que hay en Dockerhub Nextcloud_Docker.</li> </ul>"},{"location":"01_INTRO_SOR/ayudaASO/068_DockerIntroNextCloud.html#soluciones","title":"Soluciones","text":"<p>Soluci\u00f3n Pr\u00e1ctica NextCloud-Docker</p>"},{"location":"02_INTRO_SAMBA/index.html","title":"M\u00f3dulo: Implantaci\u00f3n de sistemas operativos","text":""},{"location":"02_INTRO_SAMBA/index.html#ud-15-samba","title":"UD 15 - Samba","text":"<ul> <li>UD 15 - Samba</li> <li>Introducci\u00f3</li> <li>Gestionar Samba des de la consola</li> <li>Arxius de registre de Samba</li> <li>Refer\u00e8ncies</li> <li>Instal\u00b7laci\u00f3 del servei Samba</li> <li>Instal\u00b7lar paquets necessaris pel servei Samba</li> <li>Arxiu de configuraci\u00f3 de Samba</li> <li>Actualitzar la informaci\u00f3 del servei Samba</li> <li>Gesti\u00f3 de Samba (comandes i arxius)</li> <li>Configuraci\u00f3 general</li> <li>Altres seccions</li> <li>Gesti\u00f3 d'usuaris Samba (mode consola)</li> <li>Configuraci\u00f3 general d'usuaris</li> <li>Comandes per gestionar usuaris</li> <li>Transformar usuaris Samba en usuaris Linux</li> <li>Comprovar els usuaris Samba</li> <li>Compartici\u00f3 de carpetes amb Samba (mode consola)</li> <li>Compartici\u00f3 d'arxius i carpetes</li> <li>Configuraci\u00f3 de recursos compartits</li> <li>Combinar propietaris i permisos locals amb usuaris i permisos Samba</li> <li>Determinar els permisos efectius</li> <li>Accedir des de Windows a carpetes compartides amb Linux (Samba)</li> <li>Accedir a una carpeta compartida amb Samba</li> <li>Connectar una unitat de xarxa a una carpeta compartida amb Samba</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#introduccio","title":"Introducci\u00f3","text":"<p>Samba \u00e9s un servei que permet compartir recursos d'un sistema Linux (arxius, carpetes i impressores) utilitzant un protocol equivalent al que utilitza Windows (SMB/CIFS).</p> <p>Aix\u00f2 fa possible que es pugui accedir a aquests recursos des de clients Windows.</p> <p>Tamb\u00e9 es podr\u00e0 accedir a aquests recursos des de Linux si es t\u00e9 instal\u00b7lat el client samba smbclient.</p>"},{"location":"02_INTRO_SAMBA/index.html#gestionar-samba-des-de-la-consola","title":"Gestionar Samba des de la consola","text":"<p>Amb la comanda smbpasswd es poden gestionar els usuaris i m\u00e0quines Samba.</p> <p>Tamb\u00e9 es poden editar directament els seg\u00fcents arxius de configuraci\u00f3 de Samba:</p> <ul> <li>/etc/samba/smb.conf: arxiu de configuraci\u00f3 global i dels recursos compartits.</li> <li>/etc/samba/smbusers: arxiu per transformar usuaris Samba en usuaris Linux.</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#arxius-de-registre-de-samba","title":"Arxius de registre de Samba","text":"<p>Els arxius de registre (logs) de Samba es troben per defecte a la carpeta /var/log/samba/, per\u00f2 es pot canviar amb el par\u00e0metre log file de la secci\u00f3 [global] de l'arxiu /etc/samba/smb.conf.</p>"},{"location":"02_INTRO_SAMBA/index.html#referencies","title":"Refer\u00e8ncies","text":"<p>Samba Wiki</p>"},{"location":"02_INTRO_SAMBA/index.html#installacio-del-servei-samba","title":"Instal\u00b7laci\u00f3 del servei Samba","text":""},{"location":"02_INTRO_SAMBA/index.html#installar-paquets-necessaris-pel-servei-samba","title":"Instal\u00b7lar paquets necessaris pel servei Samba","text":"<p>Primer de tot cal instal\u00b7lar el paquet samba que \u00e9s el servei equivalent a SMB/CIFS.</p> <pre><code>apt update\napt install samba\n</code></pre> <p>Tamb\u00e9 cal tenir instal\u00b7lats els paquets attr i acl. Aquests paquests serveixen per gestionar els permisos que utilitza Windows en les carpetes.</p> <p>Per comprovar si estan instal\u00b7lats i que les particions els estan utilitzant:</p> <p><pre><code>tune2fs -l /dev/sda1 | grep acl\nDefault mount options:    user_xattr acl\n</code></pre> Si no \u00e9s aix\u00ed, cal instal\u00b7lar-los...</p> <pre><code>apt install attr acl\n</code></pre> <p>...i afegir els par\u00e0metres user_xattr i acl al muntar les carpetes, sigui manualment o en l'arxiu /etc/fstab:</p> <pre><code>UUID=01764068-1aa6-4a00-9b22-aeb801061962   /       ext4   errors=remount-ro,user_xattr,acl   0   1\nUUID=ca736112-8647-4a7d-8b12-5e80dc78915f   /home   ext4   defaults,user_xattr,acl            0   2\n</code></pre>"},{"location":"02_INTRO_SAMBA/index.html#arxiu-de-configuracio-de-samba","title":"Arxiu de configuraci\u00f3 de Samba","text":"<p>Abans de comen\u00e7ar a fer canvis en la configuraci\u00f3 de qualsevol servei, \u00e9s recomanable fer una c\u00f2pia de l'arxiu original:</p> <pre><code>cp /etc/samba/smb.conf /etc/samba/smb.conf.bak\n</code></pre> <p>Quan es facin canvis en aquest arxiu, \u00e9s molt recomanable utilitzar la comanda testparm per comprovar que l'arxiu de configuraci\u00f3 de Samba \u00e9s correcte (en cas contrari, pot ser que el servei no s'engegui):</p> <p>FALTACAPTURA</p>"},{"location":"02_INTRO_SAMBA/index.html#actualitzar-la-informacio-del-servei-samba","title":"Actualitzar la informaci\u00f3 del servei Samba","text":"<p>Com passa amb tots els serveis de Linux, sempre que es facin canvis en els arxius de configuraci\u00f3, cal reiniciar el servei o tornar a carregar la configuraci\u00f3.</p> <p>En el cas de Samba, despr\u00e9s de fer qualsevol modificaci\u00f3 que afecti als usuaris o als recursos compartits, \u00e9s molt convenient reiniciar Samba.</p> <p>Algunes de les accions que poden afectar al servei s\u00f3n:</p> <ul> <li>Editar els arxius smb.conf o smbusers.</li> <li>Afegir, modificar (canvi de grup, contrasenya...) o eliminar usuaris Samba i usuaris Linux.</li> </ul> <p>El servei que cal reiniciar \u00e9s smbd:</p> <pre><code>systemctl restart smbd\n</code></pre> <p>Si nom\u00e9s s'ha modificat la configuraci\u00f3 es pot tornar a carregar amb la seg\u00fcent comanda:</p> <pre><code>smbcontrol all reload-config\n</code></pre>"},{"location":"02_INTRO_SAMBA/index.html#gestio-de-samba-comandes-i-arxius","title":"Gesti\u00f3 de Samba (comandes i arxius)","text":""},{"location":"02_INTRO_SAMBA/index.html#configuracio-general","title":"Configuraci\u00f3 general","text":"<p>L'arxiu principal de configuraci\u00f3 (/etc/samba/smb.conf) est\u00e0 dividit en diferents seccions. Cada secci\u00f3 comen\u00e7a amb una etiqueta amb el seu nom ([secci\u00f3]).</p> <p>La secci\u00f3 [global] \u00e9s la de configuraci\u00f3 general, i els par\u00e0metres m\u00e9s importants que cont\u00e9 s\u00f3n: <pre><code>[global]\n    workgroup = WORKGROUP\n    server string = %h server (Samba, Ubuntu)\n    server role = standalone server\n    security = user\n</code></pre></p> <ul> <li>workgroup: nom del grup de treball.</li> <li>server string: nom del servidor Samba (%h equival al nom de la m\u00e0quina).</li> <li>server role: mode en qu\u00e8 funciona el servidor (servidor de recursos compartits, servidor de domini...)</li> <li>security: mode d'autenticaci\u00f3 (el valor per defecte user, indica que cal autenticar-se amb el nom d'usuari i contrasenya).</li> </ul> <p>Les l\u00ednies que comencen amb # o amb ; \u00e9s com si no hi fossin. S\u00f3n l\u00ednies de comentaris o de par\u00e0metres amb valors per defecte.</p>"},{"location":"02_INTRO_SAMBA/index.html#altres-seccions","title":"Altres seccions","text":"<p>La resta de seccions s\u00f3n de recursos compartits:</p> <ul> <li>[printers]: cont\u00e9 la configuraci\u00f3 general sobre el sistema d'impressi\u00f3.</li> <li>[print$]: \u00e9s una carpeta compartida on es poden guardar drivers de Windows per impressores.</li> </ul> <pre><code>[printers]\n    comment = All Printers\n    path = /var/spool/samba\n    browseable = no\n    printable = yes\n;   read only = yes\n...\n\n[print$]\n    comment = Printer Drivers\n    path = /var/lib/samba/printers\n;   browseable = yes\n;   read only = yes\n...\n</code></pre> <p>Tamb\u00e9 hi ha altres resursos compartits que estan comentats perqu\u00e8 nom\u00e9s s'utilitzen en altres modes de funcionament, per exemple com a servidor de domini.</p>"},{"location":"02_INTRO_SAMBA/index.html#gestio-dusuaris-samba-mode-consola","title":"Gesti\u00f3 d'usuaris Samba (mode consola)","text":""},{"location":"02_INTRO_SAMBA/index.html#configuracio-general-dusuaris","title":"Configuraci\u00f3 general d'usuaris","text":"<p>Dins l'arxiu /etc/samba/smb.conf, en la secci\u00f3 [global], hi ha alguns par\u00e0metres generals relacionats amb els usuaris. Els principals s\u00f3n els seg\u00fcents:</p> <ul> <li>username map: arxiu on es guarda la relaci\u00f3 entre usuaris Samba i usuaris Linux.</li> <li>guest ok: s'accepta l'usuari an\u00f2nim (Invitado) de Windows.</li> <li>guest account: l'usuari an\u00f2nim es converteix en l'usuari nobody de Linux.</li> </ul> <pre><code>username map = /etc/samba/smbusers\nguest ok = yes\nguest account = nobody\n</code></pre>"},{"location":"02_INTRO_SAMBA/index.html#comandes-per-gestionar-usuaris","title":"Comandes per gestionar usuaris","text":"<ul> <li>smbpasswd -a usuariSMB: crea un usuari Samba i la seva contrasenya. Ha d'existir un usuari Linux amb el mateix nom de l'usuari Samba.</li> <li>smbpasswd -x usuariSMB: elimina un usuari Samba.</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#transformar-usuaris-samba-en-usuaris-linux","title":"Transformar usuaris Samba en usuaris Linux","text":"<p>Per poder transformar usuaris cal afegir el par\u00e0metre </p> <pre><code>username map = /etc/samba/smbusers \n</code></pre> <p>dins la secci\u00f3 [global] de l'arxiu /etc/samba/smb.conf.</p> <p>Per defecte, Samba utilitza el mateix nom d'usuari Windows per accedir als recursos compartits en Linux. Si es vol transformar un usuari Windows en un usuari Linux concret cal editar l'arxiu /etc/samba/smbusers.</p> <p>A continuaci\u00f3 hi ha un exemple amb el qu\u00e8 es podria posar en aquest arxiu (els usuaris de Linux es posen a l'esquerra del s\u00edmbol =, i els de Samba a la dreta):</p> <pre><code>root = Administrador director    # es pot relacionar un usuari Linux amb m\u00e9s d'un usuari Samba\nprofe = profe director    # ERROR: usuari Samba (director) duplicat\nalumne = alumne1    # el usuari Samba no t\u00e9 perqu\u00e8 tenir el mateix nom que l'usuari Linux\nprofes = @profes    # el grup profes de Samba es transformar\u00e0 en el grup profes de Linux\nnobody = *    # qualsevol usuari Samba que no estigui en la llista es transformar\u00e0 en l'usuari nobody de Linux\n</code></pre> <p>Un usuari Linux pot estar associat a m\u00e9s d'un usuari Samba, per\u00f2 no al rev\u00e9s. Els grups de Samba s'han de posar amb una @ al davant.</p> <p>L'usuari Linux (a l'esquerra de =) tamb\u00e9 ha d'estar a la base de dades de Samba; en cas contrari, l'usuari Samba es transformar\u00e0 en usuari an\u00f2nim (nobody/nogroup).</p> <p>No \u00e9s necessari posar en aquest arxiu els usuaris que tenen el mateix nom Samba i Linux (per exemple, no \u00e9s necessari posar profe = profe).</p>"},{"location":"02_INTRO_SAMBA/index.html#comprovar-els-usuaris-samba","title":"Comprovar els usuaris Samba","text":"<p>Les comandes a utilitzar s\u00f3n:</p> <ul> <li>pdbedit -L: per veure els usuaris Samba.</li> <li>cat /etc/samba/smbusers: per veure les transformacions d'usuaris.</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#comparticio-de-carpetes-amb-samba-mode-consola","title":"Compartici\u00f3 de carpetes amb Samba (mode consola)","text":""},{"location":"02_INTRO_SAMBA/index.html#comparticio-darxius-i-carpetes","title":"Compartici\u00f3 d'arxius i carpetes","text":"<p>Les principals opcions que s'han de configurar s\u00f3n:</p> <ul> <li>Nom del recurs compartit: el nom que s'ha d'utilitzar quan s'hi accedeix de forma remota.</li> <li>Ruta local: on es troba l'arxiu o carpeta que es vol compartir.</li> <li>Visibilitat: si ser\u00e0 visible de forma remota.</li> <li>Permisos: nom\u00e9s lectura o lectura i escriptura.</li> <li>Accessibilitat: si ser\u00e0 accessible per a tothom o nom\u00e9s a una llista d'usuaris i/o grups.</li> <li>Permetre o no l'acc\u00e9s a un usuari an\u00f2nim.</li> <li>Limitar l'acc\u00e9s a determinades m\u00e0quines.</li> <li>Excepcions: si el recurs \u00e9s nom\u00e9s de lectura, afegir usuaris que tamb\u00e9 podran escriure-hi (i viceversa).</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#configuracio-de-recursos-compartits","title":"Configuraci\u00f3 de recursos compartits","text":"<p>Normalment, els recursos compartits es posen al final de l'arxiu /etc/samba/smb.conf.</p> <p>La configuraci\u00f3 de cada recurs es posa dins d'una secci\u00f3. El nom de la secci\u00f3 ser\u00e0 el nom del recurs compartit, i els par\u00e0metres de compartici\u00f3 s'escriuran en les l\u00ednies seg\u00fcents.</p> <p>Els par\u00e0metres m\u00e9s importants s\u00f3n la ruta local de la carpeta que es vol compartir (par\u00e0metre path) i el mode de compartici\u00f3 (writeable o read only). Nom\u00e9s es pot posar un d'aquests dos \u00faltims par\u00e0metres: tots dos serveixen per indicar el mode de compartici\u00f3 per\u00f2 amb l'efecte contrari un de l'altre (writable = no seria el mateix que read only = yes).</p> <pre><code>[compartida]\n    path = /srv/samba/compartida\n    read only = yes\n</code></pre> <p>Algunes configuracions avan\u00e7ades no es poden fer amb el programa Samba i s'han de fer amb altres programes o editant l'arxiu de configuraci\u00f3:</p> <pre><code>[compartida]\n    path = /srv/samba/compartida\n    writeable = no\n    valid users = @profes, alumne, root\n    write list = root\n</code></pre> <p>En aquest exemple es veuen un parell de dades que no es poden configurar amb el programa Samba:</p> <ul> <li>En el par\u00e0metre valid users s'ha afegit el grup profes.</li> <li>Per indicar que \u00e9s un grup se li ha afegit el s\u00edmbol @ al davant.</li> <li>Si no es posa aquest par\u00e0metre, vol dir que tots els usuaris podran accedir al recurs compartit.</li> <li>S'ha afegit el par\u00e0metre write list = root. Aix\u00f2 indica que, tot i que el recurs nom\u00e9s \u00e9s de lectura (writeable = no), qualsevol usuari o grup que afegim en aquest par\u00e0metre tindr\u00e0 perm\u00eds d'escriptura (en aquest cas nom\u00e9s el root).</li> </ul> <p>Tamb\u00e9 es pot fer que el perm\u00eds per defecte sigui d'escriptura (writeable = yes) i posar en el par\u00e0metre read list els usuaris que nom\u00e9s han de tenir perm\u00eds de lectura:</p> <pre><code>[compartida]\n    path = /srv/samba/compartida\n    writeable = yes\n    valid users = @profes, alumne, root\n    read list = alumne\n</code></pre> <p>Els usuaris i grups que es posen en aquests par\u00e0metres, han de ser usuaris i grups de Linux, no de Samba.</p> <p>Si es configuren els par\u00e0metres write list o read list, els usuaris que hi posem tamb\u00e9 han d'estar a valid users (o no posar aquest par\u00e0metre).</p>"},{"location":"02_INTRO_SAMBA/index.html#combinar-propietaris-i-permisos-locals-amb-usuaris-i-permisos-samba","title":"Combinar propietaris i permisos locals amb usuaris i permisos Samba","text":"<p>Una forma senzilla de configurar els permisos desitjats \u00e9s:</p> <ul> <li>En els permisos locals, posar tots els permisos a tothom.</li> <li>En els permisos de compartici\u00f3 de Samba, indicar els usuaris que hi tenen acc\u00e9s i amb quins permisos.</li> </ul> <p>Aix\u00f2 \u00e9s el contrari del qu\u00e8 es feia al compartir carpetes en Windows (SMB/CIFS) i en Linux (NFS). Encara que pugui semblar perill\u00f3s, es fa aix\u00ed perqu\u00e8 els permisos Samba s\u00f3n m\u00e9s detallats que els permisos Linux i perqu\u00e8, en principi, en el servidor no han d'entrar usuaris que no siguin administradors.</p>"},{"location":"02_INTRO_SAMBA/index.html#determinar-els-permisos-efectius","title":"Determinar els permisos efectius","text":"<p>Quan s'accedix a un recurs compartit amb Samba, cal utilitzar l'identificador i la contrasenya configurats en la base de dades d'usuaris de Samba, no amb usuaris Linux.</p> <p>Per determinar els permisos que tindr\u00e0 l'usuari, Samba realitza les seg\u00fcents comprovacions:</p> <ul> <li>Comprova si l'usuari es troba a la llista d'usuaris Samba.</li> <li>Comprova si l'usuari t\u00e9 perm\u00eds per accedir al recurs compartit i quin tipus de perm\u00eds (nom\u00e9s lectura o lectura i escriptura).</li> <li>Converteix l'usuari Samba en l'usuari Linux relacionat.</li> <li>Determina els permisos triant els m\u00e9s restrictius entre els permisos que t\u00e9 l'usuari Samba sobre el recurs compartit i els permisos que t\u00e9 l'usuari Linux sobre la carpeta local.</li> <li>Si l'usuari final \u00e9s el root i en els permisos de compartici\u00f3 pot llegir i escriure, tindr\u00e0 tots els permisos independentment dels permisos locals.</li> </ul>"},{"location":"02_INTRO_SAMBA/index.html#accedir-des-de-windows-a-carpetes-compartides-amb-linux-samba","title":"Accedir des de Windows a carpetes compartides amb Linux (Samba)","text":""},{"location":"02_INTRO_SAMBA/index.html#accedir-a-una-carpeta-compartida-amb-samba","title":"Accedir a una carpeta compartida amb Samba","text":"<p>Es fa de la mateixa forma que per accedir a una carpeta compartida en un altre Windows: Com accedir a una carpeta compartida</p> <p>Si l'usuari actual de Windows no t\u00e9 permisos, demanar\u00e0 que introdu\u00efm el nom i la contrasenya d'un usuari que s\u00ed en tingui (s'ha d'haver creat l'usuari en Samba, preferiblement amb la mateixa contrasenya que t\u00e9 en Windows!).</p> <p>Encara que Windows demani l'usuari i contrasenya, \u00e9s possible que no el pugui validar. En aquests casos, el millor \u00e9s tancar la sessi\u00f3 i entrar amb l'usuari que tingui perm\u00eds per accedir a la carpeta compartida.</p> <p>Quan es creen arxius o carpetes des del client, en el servidor es crearan amb l'usuari Linux relacionat amb l'usuari Samba. Per exemple, si l'usuari Administrador d'un client Windows (relacionat amb l'usuari root de Linux) ha creat un arxiu en el servidor Linux, el propietari ser\u00e0 el root, per\u00f2 des del client es veur\u00e0 que el propietari \u00e9s \\USXXX\\root.</p> <p>Tamb\u00e9 es pot accedir a aquests recursos compartits des d'un client Linux, sempre que tingui smbclient instal\u00b7lat.</p>"},{"location":"02_INTRO_SAMBA/index.html#connectar-una-unitat-de-xarxa-a-una-carpeta-compartida-amb-samba","title":"Connectar una unitat de xarxa a una carpeta compartida amb Samba","text":"<p>Es fa de la mateixa forma que per connectar una carpeta compartida en un altre Windows: Com connectar una unitat de xarxa a una carpeta compartida</p> <p>Obra publicada con Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0 Autor: Pere S\u00e1nchez</p>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html","title":"Introducci\u00f3n Samba","text":""},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#introduccion","title":"Introducci\u00f3n","text":"<p>Conocimiento previo</p> <ul> <li>SMB (Server Message Block) protocolo de red que permite compartir archivos, impresoras, etc\u00e9tera, entre nodos de una red de computadoras que usan el sistema operativo Microsoft Windows. </li> <li>Este protocolo pertenece a la capa de aplicaci\u00f3n en el modelo TCP/IP y fue renombrado posteriormente a CIFS (Common Internet File System).</li> </ul> <p>Samba es una implementaci\u00f3n libre del protocolo SMB para sistemas de tipo UNIX, para el cual se destaca:</p> <ul> <li>Se basa en un conjunto de aplicaciones de GNU/Linux cuyo principal objetivo es conectar computadoras con diferentes sistemas operativos como pueden ser GNU/Linux, Mac OS X o Unix para actuar como servidores o clientes de los diferentes servicios de compartici\u00f3n de recursos.</li> <li>Tambi\u00e9n permite validar usuarios haciendo de Controlador Principal de Dominio (PDC), como miembro de dominio e incluso como un dominio Active Directory para redes basadas en Windows; aparte de ser capaz de servir colas de impresi\u00f3n, directorios compartidos y autentificar con su propio archivo de usuarios.</li> </ul>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#caracteristicas","title":"Caracter\u00edsticas","text":"<p>Entre los sistemas tipo Unix en los que se puede ejecutar Samba, est\u00e1n las distribuciones:</p> <ul> <li>GNU/Linux. </li> <li>Solaris.</li> <li>Las diferentes variantes BSD entre las que podemos encontrar el Mac OS X Server de Apple.</li> </ul> <p>Como se ha comentado Samba es una implementaci\u00f3n de servicios y protocolos, entre los que destacan: </p> <ul> <li>NetBIOS sobre TCP/IP (NetBT). </li> <li>SMB (Server Message Block).</li> <li>DCE/RPC o m\u00e1s concretamente, MSRPC. </li> <li>El servidor WINS tambi\u00e9n conocido como el servidor de nombres de NetBIOS. </li> <li>La suite de protocolos del dominio NT o NTLM, para autentificaci\u00f3n. </li> <li>La base de datos del gestor de cuentas seguras SAM. </li> <li>El servicio Local Security Authority LSA o autoridad de seguridad local.</li> <li>Recientemente el Logon de entrada de Active Directory, que incluye una versi\u00f3n modificada de Kerberos </li> <li>Y una versi\u00f3n modificada de LDAP. </li> </ul> <p>Advertencia</p> <p>Todos estos servicios y protocolos son frecuentemente referidos de un modo incorrecto como NetBIOS o SMB.</p> <p>Propina</p> <p>A partir de la versi\u00f3n 4.10.0 de samba se ofrece soporte completo para Python 3 y aunque mantiene compatibilidad con Python 2, esta debe ser configurada de manera expl\u00edcita,\u200b sin embargo, a futuro, dicho soporte a Python 2 ser\u00e1 retirado.</p>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#introduccion-a-la-configuracion-del-servicio-samba-en-ubuntu","title":"Introducci\u00f3n a la configuraci\u00f3n del servicio SAMBA en Ubuntu","text":"<p>Toda la configuraci\u00f3n de Samba se encuentra en el fichero <code>/etc/samba/smb.conf</code> \u2192 DOCUMENTACI\u00d3N OFICIAL .</p> <p>NOTA</p> <p>Existen multitud de opciones pero tan solo se analizar\u00e1n las imprescindibles para la compartici\u00f3n de recursos. Las l\u00edneas que comiencen con <code>#</code> o <code>;</code> est\u00e1n comentadas y el servicio no las tendr\u00e1 en cuenta. </p> <p>Este fichero tiene varios apartados, con opciones que se comentar\u00e1n a continuaci\u00f3n:</p> <ul> <li><code>[global]</code> cuyas opciones generales son:</li> </ul> Variable Descripci\u00f3n workgroup Esta variable ha de almacenar el nombre del grupo de trabajo o dominio que usamos en nuestra red. server string Permite reconocer el equipo dentro del dominio. Por defecto tiene como valor el nombre del servidor. hosts allow Especifica desde qu\u00e9 direcciones IP se podr\u00e1 acceder al servicio. Si se especifica  192.168. todas las direcciones que empiecen de ese modo tendr\u00e1n acceso al recurso. Se puede establecer direcciones IP completas. hosts deny Especifica los rangos no permitidos, del mismo modo que host allow. security, Especifica el nivel de seguridad con el que se puede acceder. <ul> <li><code>[autentication]</code>, donde se destaca server role, el cual indica la forma en la que va a trabajar el servidor Samba:</li> </ul> Variable Descripci\u00f3n standalone server Modo por defecto, act\u00faa como un servidor de ficheros y directorios compartidos pero no como servidor de dominio. member server similar al anterior con la diferencia que a\u00f1adimos al equipo a un dominio ya existente y por tanto su funcionamiento se ver\u00e1 afectado por las reglas de \u00e9ste. Esta opci\u00f3n requiere a\u00f1adir las l\u00edneas security=ADM, para indicar que el control de acceso lo gestionar\u00e1 el  controlador de dominio, y realm =NOMBREDOMINIO.COM para indicar el nombre de dominio al que pertenece el servidor. Adem\u00e1s, hay que comentar la l\u00ednea workgroup ya que no pertenecemos a un grupo de trabajo. AD domain controler act\u00faa como un controlador de dominio."},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#creacion-directorio-compartido","title":"Creaci\u00f3n Directorio Compartido","text":"<ul> <li>Para crear un directorio compartido es necesario a\u00f1adir una nueva secci\u00f3n del siguiente modo:</li> </ul> <pre><code>[compartidoUser1]\ncomment = Carpeta compartida \npath = /media/compartido/user1\nguest ok = Yes\nread only = Yes\nwrite list = @Ceos, administrador, user1 \ndirectory mask = 0755\n</code></pre> <p>NOTA</p> <ul> <li>Estas  l\u00edneas  crean  un  recurso  compartido  con  el  nombre compartidoUser1  en  el  directorio /media/compartido/user1 de solo lectura, con acceso de invitado, los usuarios administrador y user1 pueden escribir  y el grupo @Ceos tambi\u00e9n. </li> <li>Adem\u00e1s, se aplicar\u00e1 una m\u00e1scara de permisos autom\u00e1tica de 0755 a los ficheros y carpetas que se creen en este recurso.</li> </ul> <ul> <li>Las opciones m\u00e1s relevantes son:</li> </ul> Variable Descripci\u00f3n [X]: Nombre del recurso a compartir, normalmente un directorio. Comment: Comentario que describe el directorio que se est\u00e1 compartiendo. Path: Es la carpeta que se quiere compartir. Puede ser cualquier carpeta del servidor, no obstante, por est\u00e1ndar las carpetas compartidas de un servidor suelen encontrarse dentro del directorio /srv. guest ok Permite el acceso como usuario invitado. Su valor puede ser Yes o No. public Equivalente del par\u00e1metro guest ok. browseable Permitir\u00e1 mostrar este recurso en las listas de recursos compartidos. Su valor puede ser Yes o No. writable Permitir\u00e1 la escritura. Su valor puede ser Yes o No. valid users Especifica qu\u00e9 usuarios o grupos pueden acceder al recurso compartido. Mirar valores en la Nota a continuaci\u00f3n de esta tabla. write list Usuarios o grupos pueden acceder con permiso de escritura. admin users Usuarios o grupos pueden acceder con permisos administrativos. Create Mask: Indica los permisos de los ficheros creados por los clientes. Por defecto 0744 (todos los permisos para usuario propietario y solo permiso de lectura para grupo y otros usuarios). directory mask Define que permisos en el sistema tendr\u00e1n los subdirectorios creados dentro del recurso. <p>Especificaci\u00f3n de los valores de <code>valid users</code></p> <ul> <li>nombres de usuarios separados por comas</li> <li>nombres de grupo precedidos por una @</li> <li>%S indica que solo el usuario cuyo nombre sea igual al de ese directorio, tiene acceso (\u00fatil para las carpetas personales de usuario)</li> </ul> <p>Advertencia</p> <p>Una vez a\u00f1adido el recurso, es necesario reiniciar el servicio para que se apliquen los cambios</p> <pre><code>systemctl restart smbd\n</code></pre> <ul> <li>Por \u00faltimo, para acceder al recurso desde el cliente se realizar\u00e1 a trav\u00e9s de cualquier navegador o explorador de archivos de archivos usando el protocolo smb especificando el usuario, la direcci\u00f3n del recurso y su nombre del siguiente modo:</li> </ul> <pre><code>smb://usuario1@servidorubuntu/compartido1\n</code></pre>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#integracion-de-permisos","title":"Integraci\u00f3n de permisos","text":"<p>La gesti\u00f3n de permisos de usuarios y grupos es sustancialmente diferente en Sistemas Unix y en Sistemas Microsoft Windows. A continuaci\u00f3n se describen las diferencias.</p>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#permisos-unix","title":"Permisos Unix","text":"<ul> <li>En los Sistemas Unix, la gesti\u00f3n de los permisos que los usuarios y los grupos de usuarios tienen sobre los archivos se realiza mediante un sencillo esquema de tres tipos de permisos (lectura, escritura y ejecuci\u00f3n) aplicables a tres tipos de usuarios (propietario, grupo propietario y resto), los cuales se denominan trios de permisos. </li> </ul> <p>En la siguiente figura se puede observar su funcionamiento:</p> <p>Ventajas</p> <ul> <li>Este sencillo esquema se desarroll\u00f3 en los a\u00f1os 70 y a\u00fan hoy resulta adecuado para la gran mayor\u00eda de los sistemas en red que podamos encontrar en cualquier tipo de organizaci\u00f3n, desde peque\u00f1as redes a las m\u00e1s grandes.</li> <li>Es cierto que tiene algunas limitaciones pero la ventaja de ser sencillo hace que su administraci\u00f3n sea f\u00e1cil y su rendimiento muy elevado.</li> </ul>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#permisos-windows","title":"Permisos Windows","text":"<ul> <li>En los Sistemas Microsoft Windows, la gesti\u00f3n de los permisos que los usuarios y los grupos de usuarios tienen sobre los archivos, se realiza mediante un complejo esquema de listas de control de acceso ACLs (Access Control Lists) para cada carpeta y cada archivo. </li> </ul> <p>Ventajas</p> <ul> <li>El sistema de ACLs tiene la ventaja de ser mucho m\u00e1s flexible que el sistema Unix ya que se pueden establecer m\u00e1s tipos de permisos, establecer permisos solo a algunos usuarios y algunos grupos, denegar permisos, etc..., pero como hemos comentado anteriormente, en la mayor\u00eda de los casos, con las prestaciones del Sistema Unix es suficiente.</li> </ul> <p>Desventajas</p> <p>En el lado contrario, el sistema de ACLs es m\u00e1s complejo de administrar y m\u00e1s lento ya que antes de acceder a las carpetas o archivos, el sistema debe comprobar listas mientras que en Unix hace una operaci\u00f3n l\u00f3gica de los bits que especifican los permisos lo cual es much\u00edsimo m\u00e1s r\u00e1pido.</p> <ul> <li>En particular el acceso a una carpeta se determina por dos tipos de permisos:</li> </ul> <p>Tipos de permisos para Samba</p> <ul> <li>De recurso compartido definidos tan solo a carpetas.</li> <li>De red o NTFS (New Technology File System) definidos tanto en carpetas como en archivos.</li> </ul> <p>Advertencia</p> <p>Los permisos de recurso compartido suelen utilizarse para administrar equipos con sistemas de archivos FAT32 (File Allocation Table) o posterior, por lo que quedan desterrados en sistemas operativos de red y por tanto se usan los permisos de red NTFS. </p>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#permisos-samba","title":"Permisos Samba","text":"<p>Samba tiene tambi\u00e9n implementado el sistema de ACLs y se gestiona utilizando el comando <code>smbcacls</code>, no obstante, la recomendaci\u00f3n es utilizar el sistema de gesti\u00f3n de permisos de Unix.</p> <p>consejo</p> <p>Para realizar una gesti\u00f3n eficaz de usuarios, grupos y permisos, se recomienda utilizar los permisos de Unix que permiten asignar permisos de lectura, escritura y ejecuci\u00f3n al usuario propietario del archivo, al grupo propietario del archivo y al resto de usuarios del sistema.</p> <p>advertencia</p> <ul> <li>Puede ocurrir que exista contradicci\u00f3n entre los permisos del sistema Unix y los permisos del recurso compartido en samba, por ejemplo, podemos tener una carpeta compartida llamada almacen-software con permisos Unix de lectura, escritura y ejecuci\u00f3n para todos, en cambio si en el archivo de configuraci\u00f3n de samba, dicho recurso tiene el par\u00e1metro read only = yes, no ser\u00e1 posible realizar cambios ya que est\u00e1 compartido con permiso de 'solo lectura'. </li> <li>Cuando los permisos Unix se contradicen con los permisos samba, el permiso efectivo es el m\u00e1s restrictivo de los dos.</li> </ul>"},{"location":"02_INTRO_SAMBA/021_IntroSamba.html#referencia","title":"Referencia","text":"<p>Wikipedia Oficial de Samba</p> <p>Se recomienda leer la documentaci\u00f3n oficial del servicio en ENLACE WIKI SAMBA</p>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html","title":"Instalaci\u00f3n y configuraci\u00f3n inicial de Samba","text":"<p>Partiendo de la situaci\u00f3n de aprendizaje, desde el departamento TIC de NetOS nos encargan una instalaci\u00f3n y configuraci\u00f3n de una carpeta compartida en las aulas del IES Severo Ochoa d'Elx, la carpeta debe estar compartida en el ordenador del profesor compartiendo acceso los ordenadores de los alumnos, los cuales tienen una distribuci\u00f3n dual de Windows y linux.</p> <ul> <li>Es la primera vez que utilizas Samba y decides realizar unos pasos previos siguiendo la gu\u00eda adjunta a continuaci\u00f3n:</li> </ul> <p>Requisitos</p> <p>Se necesitan tres m\u00e1quinas virtuales: </p> <p>Informaci\u00f3n de las M\u00e1quinas Virtuales</p> <ul> <li>El Ubuntu Server del enlace de one drive de Aules, se descarga y se importa a Virtualbox. Si ya lo tienes de la UT anterior se debe utilizar la instant\u00e1nea limpia de la MV</li> <li>Microsoft Windows 11 Professional con el mismo procedimiento, que actuar\u00e1 como cliente. Es buena idea que realices instant\u00e1neas de las m\u00e1quinas para tener copias de seguridad en caso de emergencia.</li> <li>Linux Lite tambi\u00e9n como cliente y se obtiene con el mismo procedimiento.</li> </ul> <p>Configuraci\u00f3n de red</p> <ul> <li>Crea una Red NAT en VirtualBox e introduce en ella las tres m\u00e1quinas que has creado. Como nombre ponle tu segundo apellido.</li> <li>Para acceder a las MVs por ssh se debe hacer un t\u00fanel con redirecci\u00f3n puertos.</li> </ul>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html#instalacion-ubuntu-server","title":"Instalaci\u00f3n Ubuntu Server","text":"<pre><code>sudo apt install samba\n</code></pre>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html#configuracion-de-carpetas-compartidas","title":"Configuraci\u00f3n de carpetas compartidas","text":"<ol> <li> <p>Editamos el fichero de configuraci\u00f3n: <code>/etc/samba/smb.conf</code></p> </li> <li> <p>Al final del archivo de configuraci\u00f3n a\u00f1adiremos una nueva entrada con el directorio a compartir:</p> </li> </ol> <pre><code>[ejercicio1]\n    comment = Prueba Ejercicio 1\n    path = /srv/samba/ejercicio1\n    browsable = yes\n    guest ok = yes\n    read only = yes\n    create mask = 0764\n    directory mask = 0764\n</code></pre> <ol> <li>Creamos el directorio que \u00edbamos a compartir y cambiamos los permisos para que no de conflicto.</li> </ol> <pre><code>sudo mkdir -p /srv/samba/ejercicio1\nsudo chmod 764 /srv/samba/ejercicio1/\n</code></pre> <ol> <li>Siempre que modifiquemos el fichero de configuraci\u00f3n debemos reiniciar el servicio:</li> </ol> <pre><code>sudo systemctl restart smbd\n</code></pre>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html#acceso-desde-linux","title":"Acceso desde Linux","text":"<p>a trav\u00e9s de cualquier navegador de archivos usando el protocolo smb especificando el usuario, la direcci\u00f3n del recurso y su nombre del siguiente modo:</p> <pre><code>smb://usuario1@servidorubuntu/compartido1\n</code></pre>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html#acceso-desde-cliente-windows","title":"Acceso desde Cliente Windows","text":"<ol> <li>Abrimos un explorador de directorios.</li> <li>Seleccionamos Red (Network)</li> <li>Puede que tengamos que habilitar el descubrimiento de redes:</li> </ol> <p>Como alternativa, en caso de no descubrir el equipo podemos abrir un explorador de directorio y colocar en la barra de direcciones <code>\\\\IP_Servidor</code></p>"},{"location":"02_INTRO_SAMBA/022_InstalacionSamba.html#pt21-practica-instalacion-y-configuracion-inicial-de-samba","title":"PT21 Pr\u00e1ctica Instalaci\u00f3n y configuraci\u00f3n inicial de Samba","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE5, CE7 y CE9 del RA1 de SOR.</p> <p>Advertencia</p> <p>Razona todas las respuestas, en caso de que la respuesta sea debido a unos permisos indica que permisos tiene y donde han sido determinados.</p> <p>Tareas</p> <p>A partir de la gu\u00eda adjunta realiza un video con los pasos realizados y un informe con los siguientes apartados:</p> <ol> <li>Sigue todos los pasos del manual (apartado anterior) para conseguir compartir ficheros. Adjunta una captura de la secci\u00f3n del fichero de configuraci\u00f3n de samba donde se muestre la configuraci\u00f3n del recurso compartido.</li> <li>Desde el servidor, crea un fichero hola.txt en la carpeta <code>/srv/samba/ejercicio1</code>.</li> <li>Desde el cliente windows accede al servidor mediante un explorador de directorios e intenta abrir el documento \u00bfExiste alg\u00fan problema para ello? Razona tu respuesta.</li> <li>Seguidamente modifica el fichero e intenta guardarlo. \u00bfQu\u00e9 ocurre? \u00bfPor qu\u00e9?</li> <li>Ahora, desde el cliente Windows, intenta crear un fichero. \u00bfTe deja? \u00bfPuedes leer y escribir en \u00e9l? \u00bfPor qu\u00e9?</li> <li>Desde el servidor, modifica los permisos de <code>/srv/samba/ejercicio1/hola.txt</code> para que tenga los siguientes permisos rwxr\u2014rwx, ahora desde el cliente Windows prueba a modificar el contenido de dicho fichero. \u00bfQu\u00e9 ocurre y por qu\u00e9? Si no te deja escribir y guardar los cambios, indica que deber\u00edas cambiar para que puedas hacerlo.</li> <li>Crea una carpeta en el servidor <code>/srv/samba/ejercicio2</code>. Comparte dicha carpeta, a\u00f1adiendo una nueva entrada en el fichero de configuraci\u00f3n de samba. La carpeta debe ser navegable, se debe poder acceder sin credenciales, debe tener permisos  de lectura/escritura y adem\u00e1s los ficheros creados por los clientes podr\u00e1n ser modificados, le\u00eddos y ejecutados por cualquiera. Por otro lado, los directorios creados por los clientes solo podr\u00e1n ser modificados por el usuario propietario, mientras que el resto de usuarios/grupos no tendr\u00e1n ning\u00fan permiso. Muestra la configuraci\u00f3n realizada.</li> <li>Desde un cliente Windows (como usuario propietario) intenta acceder a la carpeta ejercicio2 y crear un documento llamado \u201cmiSamba.txt\u201d. Acto seguido, vuelve al servidor e intenta modificar el fichero (SIN SER SUDO) \u00bfExiste alg\u00fan problema? \u00bfPor qu\u00e9?</li> <li>Ahora desde el cliente (Windows) crea un directorio llamado \u201cSOR\u201d. Vuelve al servidor e intenta crear un fichero \u201csor.txt\u201d dentro de SOR (SIN SER SUDO). \u00bfQu\u00e9 ocurre? \u00bfQu\u00e9 permisos tiene la carpeta \u201cSOR\u201d?.</li> <li>Realiza los mismos acceso desde la m\u00e1quina Lubuntu Client. Demuestra que has realizado dichos accesos.</li> </ol>"},{"location":"02_INTRO_SAMBA/023_DockerComposeSamba.html","title":"Docker Compose Samba","text":"<p>En la UT1 se realiz\u00f3 la instalaci\u00f3n de docker y creaci\u00f3n de contenedores de la imagen de NextCloud. En los \u00faltimos comandos de las pr\u00e1cticas realizadas, se necesitaban una gran cantidad de argumentos para la configuraci\u00f3n del contenedor en una red y aplicar un volumen al mismo. Este hecho repercut\u00eda en una sintaxis demasiado extensa de dichos comandos.</p> <p>Para una gesti\u00f3n mejorada de los comandos extensos de <code>docker run</code> destaca una herramienta de Docker denominada Docker-Compose, la cual ayuda a definir, ejecutar y conectar aplicaciones de m\u00faltiples contenedores, mediante un archivo YAML.</p> <p>En esta secci\u00f3n se detalla esta herramienta de docker para aplicarla a una imagen de Samba.</p>"},{"location":"02_INTRO_SAMBA/023_DockerComposeSamba.html#docker-compose","title":"Docker-compose","text":"<p>Flujo de trabajo</p> <p>Contenedores\u2192 docker run \u2192 docker_compose.yml</p> <ul> <li> <p>Docker-compose es otro proyecto open source que permite definir aplicaciones multi-contenedor de una manera sencilla y declarativa.</p> </li> <li> <p>Es una alternativa m\u00e1s c\u00f3moda al uso de los comandos docker run, que resultan un tanto tediosos cuando trabajamos con aplicaciones de varios componentes.</p> </li> <li> <p>Se define un fichero <code>docker-compose.yml</code> que se puede observar en el ejemplo realizado en la pr\u00e1ctica en el \u00faltimo apartado.</p> </li> </ul> <p>Propina</p> <p>Ficheros YAML</p> <p>Example</p> <p>A continuaci\u00f3n se muestra un ejemplo para la realizaci\u00f3n de la pr\u00e1ctica de ampliaci\u00f3n: Instalaci\u00f3n Wordpress</p> <ol> <li>Primer Paso: instalaci\u00f3n de Docker-compose.</li> </ol> <ul> <li>Install Docker Compose</li> </ul> <pre><code>apt-get install docker-compose\n</code></pre> <ol> <li>Segundo paso: Crear directorio del proyecto y dentro el archivo <code>yaml</code>.</li> </ol> <pre><code>mkdir -p $HOME/my_wordpress &amp;&amp; \\\ncd $HOME/my_wordpress\n</code></pre> <ol> <li>Tercer paso: se crea y edita el <code>yaml</code>.</li> </ol> <pre><code>cat &lt;&lt; EOF &gt; $HOME/my_wordpress/docker-compose.yml\nversion: \"3.9\"\n\nservices:\n  db:\n    image: mysql:5.7\n    volumes:\n      - db_data:/var/lib/mysql\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: somewordpress\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: wordpress\n      MYSQL_PASSWORD: wordpress\n\n  wordpress:\n    depends_on:\n      - db\n    image: wordpress:latest\n    volumes:\n      - wordpress_data:/var/www/html\n    ports:\n      - \"8000:80\"\n    restart: always\n    environment:\n      WORDPRESS_DB_HOST: db:3306\n      WORDPRESS_DB_USER: wordpress\n      WORDPRESS_DB_PASSWORD: wordpress\n      WORDPRESS_DB_NAME: wordpress\nvolumes:\n  db_data: {}\n  wordpress_data: {}\nEOF\n</code></pre> <ol> <li>Cuarto paso: en la carpeta creada del proyecto se ejecuta el comando de <code>docker-compose up -d</code></li> </ol> <pre><code>docker-compose up -d\n</code></pre> <p>Comprobaci\u00f3n</p> <p>Se comprueba que se ha creado el contenedor y se abre el navegador para comprobar que est\u00e1 disponible la instalaci\u00f3n de wordpress.</p>"},{"location":"02_INTRO_SAMBA/023_DockerComposeSamba.html#pt22-samba-mediante-docker-compose","title":"PT22. Samba mediante Docker compose","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE61, CE62, CE63, CE64, CE65, CE9 del RA6 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>En la instalaci\u00f3n de la carpeta compartida en el IES Severo Ochoa d'Elx de la PT21, uno de los profesores encargados de la revisi\u00f3n de la instalaci\u00f3n solicita si es posible realizar la instalaci\u00f3n de una forma m\u00e1s r\u00e1pida y sencilla, debido a los conocimientos en docker decides utilizar la herramienta Docker-Compose.</p> <p>Tarea</p> <p>A partir del <code>docker-compose</code> adjunto realiza un video con los pasos a realizar a continuaci\u00f3n.</p>"},{"location":"02_INTRO_SAMBA/023_DockerComposeSamba.html#desde-el-servidor","title":"Desde el servidor","text":"<ul> <li>Crea un contenedor con el servicio de Samba mediante la gu\u00eda adjunta.</li> <li>Comprueba que el contenedor corriendo.</li> </ul> <p>Se va a realizar unos pasos previos para preparar el entorno. En primer lugar creamos las carpetas donde alojar el proyecto:</p> <pre><code>mkdir -p $HOME/docker/samba/compartido &amp;&amp; \\\ncd $HOME/docker/samba\n</code></pre> <p>A continuaci\u00f3n se da permisos de escritura y lectura a la carpeta compartida:</p> <pre><code>chmod 777 -R $HOME/docker/samba/compartido\n</code></pre> <p>Ahora se crea el fichero de configuraci\u00f3n <code>docker-compose.yml</code> mediante la imagen de docker lanzando el siguiente comando:</p> <pre><code>cat &lt;&lt; EOF &gt; $HOME/docker/samba/docker-compose.yml\nversion: '3.4'\n\nservices:\n  samba:\n    container_name: samba\n    image: dperson/samba:latest\n    environment:\n      TZ: 'Europe/Brussels'\n    networks:\n      - default\n    ports:\n      - \"137:137/udp\"\n      - \"138:138/udp\"\n      - \"139:139/tcp\"\n      - \"445:445/tcp\"\n    read_only: true\n    tmpfs:\n      - /tmp\n    restart: always\n    stdin_open: true\n    tty: true\n    volumes:\n      - $HOME/docker/samba/compartido:/sordata:z\n    command: '-s \"DockerSambaCompartida;/sordata\" -n'\n\nnetworks:\n  default:\nEOF\n</code></pre> <p>Aclaraciones</p> <ul> <li>La l\u00ednea de <code>volumes</code> monta la carpeta creada inicialmente en el <code>/home</code> en la carpeta sordata en el contenedor.</li> <li>La opci\u00f3n z le dice a Docker que el contenido del volumen se compartir\u00e1 entre contenedores. </li> </ul> <p>Principales par\u00e1metros a modificar para adaptarlos a nuestro sistema y configuraci\u00f3n especifica:</p> Par\u00e1metro Funci\u00f3n ~/docker/samba/compartido:/sordata Definimos ruta donde alojamos los ficheros compartidos 137:137 Puerto protocolo NetBios 138:138 Puerto protocolo NetBios 139:139 Puerto protocolo SMB 445:445 Puerto protocolo SMB restart: always Habilitamos que tras reiniciar la maquina anfitri\u00f3n vuelva a cargar el servicio <p>Una vez configurado, se levanta el contenedor para ser creado y ejecutado mediante compose:</p> <pre><code>docker-compose up -d\n</code></pre>"},{"location":"02_INTRO_SAMBA/023_DockerComposeSamba.html#desde-el-cliente","title":"Desde el cliente","text":"<p>Tarea</p> <p>Explica en el video los siguientes apartados:</p> <ul> <li>Accede a la carpeta compartida en un cliente, puede ser tu propio Host.</li> <li>Crea un archivo de texto de prueba desde el servidor, entra al contenedor, servidor y cliente para confirmar que se ha creado.</li> <li>\u00bfQu\u00e9 pasa si paras y destruyes el contenedor? \u00bfPor qu\u00e9?.</li> </ul>"},{"location":"02_INTRO_SAMBA/024_RefuerzoAmpliacion.html","title":"Refuerzo y Ampliaci\u00f3n","text":"<p>A continuaci\u00f3n se definen las actividades de refuerzo y ampliaci\u00f3n de la UT2</p>"},{"location":"02_INTRO_SAMBA/024_RefuerzoAmpliacion.html#refuerzo","title":"Refuerzo","text":""},{"location":"02_INTRO_SAMBA/024_RefuerzoAmpliacion.html#pt23-generar-carpeta-compartida-con-acceso-total","title":"PT23. Generar carpeta compartida con acceso total","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE5, CE7 y CE9 del RA1 de SOR.</p> <p>Tareas</p> <p>A partir de la gu\u00eda adjunta en la pr\u00e1ctica PT21 realiza una carpeta compartida en el servicio de samba que tenga permisos totales desde cualquier usuario, haz pruebas. Realiza un v\u00eddeo con los pasos realizados.</p>"},{"location":"02_INTRO_SAMBA/024_RefuerzoAmpliacion.html#ampliacion","title":"Ampliaci\u00f3n","text":""},{"location":"02_INTRO_SAMBA/024_RefuerzoAmpliacion.html#pt24-generar-carpeta-con-permisos-desde-docker-compose-samba","title":"PT24. Generar carpeta con permisos desde Docker Compose Samba.","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE61, CE62, CE63, CE64, CE65, CE9 del RA6 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>Siguiendo la situaci\u00f3n de aprendizaje, de PT22, ahora la necesidad es crear una carpeta accesible por cualquier usuario din necesidad de autentificaci\u00f3n, y otra por el usuario Robert cuyas caracter\u00edsticas son: navegable y con autentificaci\u00f3n</li> </ul> <p>Tareas</p> <p>Realiza un v\u00eddeo con los pasos para configurar las carpetas que se indican en la situaci\u00f3n de aprendizaje mediante Docker compose.</p> <p>Ayuda</p> <p>Para conseguir la configuraci\u00f3n de las carpetas puedes investigar el siguiente archivo <code>yaml</code> de docker compose Docker Compose dperson, con la siguiente explicaci\u00f3n del archivo en el foro de Docker Foro Docker Compose dperson</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html","title":"062 IntroSamba","text":""},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html#introduccion","title":"Introducci\u00f3n","text":"<p>Como ya se ha visto con anterioridad, Samba es un conjunto de aplicaciones para GNU/Linux que implementan el protocolo de comunicaci\u00f3n SMB utilizado por Microsoft Windows para compartir carpetas e impresoras.</p> <ul> <li>Permite a sistemas GNU/ Linux compartir carpetas como si de un sistema Microsoft Windows se tratara.</li> </ul> <p>Tip</p> <p>Se recomienda leer la documentaci\u00f3n oficial del servicio en ENLACE WIKI SAMBA</p> <p>En un servidor de archivos, el acceso a una carpeta puede estar determinado por dos conjuntos de entradas de permisos:</p> <ul> <li>los permisos de recurso compartido definidos tan solo a carpetas.</li> <li>los permisos de red o NTFS (New Technology File System) definidos tanto en carpetas como en archivos.</li> </ul> <p>NOTA</p> <p>En sistemas operativos basados en GNU/Linux la gesti\u00f3n de los grupos y privilegios se hace a trav\u00e9s de los comandos samba-tool user y samba-tool group.</p> <ul> <li> <p>Los permisos de recurso compartido suelen utilizarse para administrar equipos con sistemas de archivos FAT32 (File Allocation Table) o posterior, por lo que quedan desterrados en sistemas operativos de red. </p> </li> <li> <p>Con la aparici\u00f3n del sistema de archivos NTFS (New Technology File System), se incluyeron nuevos tipos de permisos asignables a carpetas, y adem\u00e1s, tambi\u00e9n a ficheros. </p> </li> </ul> <p>A tener en cuenta</p> <p>Ambos sistemas de permisos conviven en entornos de Microsoft por lo que puede ser un tema delicado cuando se interfieran.</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html#introduccion-a-la-configuracion-del-servicio-samba-en-ubuntu","title":"Introducci\u00f3n a la configuraci\u00f3n del servicio SAMBA en Ubuntu","text":"<p>Toda la configuraci\u00f3n de Samba se encuentra en el fichero <code>/etc/samba/smb.conf</code> \u2192 DOCUMENTACI\u00d3N OFICIAL .</p> <p>NOTA</p> <p>Existen multitud de opciones pero tan solo se analizar\u00e1n las imprescindibles para la compartici\u00f3n de recursos. Las l\u00edneas que comiencen con # o ; est\u00e1n comentadas y el servicio no las tendr\u00e1 en cuenta. </p> <p>Este fichero tiene varios apartados, con opciones que se comentar\u00e1n a continuaci\u00f3n:</p> <ul> <li>[global], se especifican opciones generales:</li> </ul> Variable Descripci\u00f3n workgroup Esta variable ha de almacenar el nombre del grupo de trabajo o dominio que usamos en nuestra red. server string Permite reconocer el equipo dentro del dominio. Por defecto tiene como valor el nombre del servidor. hosts allow Especifica desde qu\u00e9 direcciones IP se podr\u00e1 acceder al servicio. Si se especifica  192.168. todas las direcciones que empiecen de ese modo tendr\u00e1n acceso al recurso. Se puede establecer direcciones IP completas. hosts deny Especifica los rangos no permitidos, del mismo modo que host allow. security, Especifica el nivel de seguridad con el que se puede acceder. <ul> <li>[autentication], donde se destaca server role \u2192 indica la forma en la que va a trabajar el servidor Samba:</li> </ul> Variable Descripci\u00f3n standalone server Modo por defecto, act\u00faa como un servidor de ficheros y directorios compartidos pero no como servidor de dominio. member server similar al anterior con la diferencia que a\u00f1adimos al equipo a un dominio ya existente y por tanto su funcionamiento se ver\u00e1 afectado por las reglas de \u00e9ste. Esta opci\u00f3n requiere a\u00f1adir las l\u00edneas security=ADM, para indicar que el control de acceso lo gestionar\u00e1 el  controlador de dominio, y realm =NOMBREDOMINIO.COM para indicar el nombre de dominio al que pertenece el servidor. Adem\u00e1s, hay que comentar la l\u00ednea workgroup ya que no pertenecemos a un grupo de trabajo. AD domain controler act\u00faa como un controlador de dominio."},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html#creacion-directorio-compartido","title":"Creaci\u00f3n Directorio Compartido","text":"<ul> <li>Para crear un directorio compartido es necesario a\u00f1adir una nueva secci\u00f3n del siguiente modo:</li> </ul> <pre><code>[compartidoUser1]\ncomment = Carpeta compartida \npath = /media/compartido/user1\nguest ok = Yes\nread only = Yes\nwrite list = @Ceos, administrador, user1 directory mask = 0755\n</code></pre> <p>NOTA</p> <ul> <li>Estas  l\u00edneas  crean  un  recurso  compartido  con  el  nombre compartidoUser1  en  el  directorio /media/compartido/user1 de solo lectura, con acceso de invitado, los usuarios administrador y user1 pueden escribir  y el grupo @Ceos tambi\u00e9n. </li> <li>Adem\u00e1s, se aplicar\u00e1 una m\u00e1scara de permisos autom\u00e1tica de 0755 a los ficheros y carpetas que se creen en este recurso.</li> </ul> <ul> <li>Las opciones m\u00e1s relevantes son:</li> </ul> Variable Descripci\u00f3n guest ok Permite el acceso como usuario invitado. Su valor puede ser Yes o No. public Equivalente del par\u00e1metro guest ok. browseable Permitir\u00e1 mostrar este recurso en las listas de recursos compartidos. Su valor puede ser Yes o No. writable Permitir\u00e1 la escritura. Su valor puede ser Yes o No. valid users Especifica qu\u00e9 usuarios o grupos pueden acceder al recurso compartido. Mirar valores en la Nota a continuaci\u00f3n de esta tabla. write list Usuarios o grupos pueden acceder con permiso de escritura. admin users Usuarios o grupos pueden acceder con permisos administrativos. directory mask Define que permisos en el sistema tendr\u00e1n los subdirectorios creados dentro del recurso. <p>NOTA: valores <code>valid users</code></p> <ul> <li>nombres de usuarios separados por comas</li> <li>nombres de grupo precedidos por una @</li> <li>%S indica que solo el usuario cuyo nombre sea igual al de ese directorio, tiene acceso (\u00fatil para las carpetas personales de usuario)</li> </ul> <p>A tener en cuenta</p> <ul> <li>Una vez a\u00f1adido el recurso, es necesario reiniciar el servicio para que se apliquen los cambios</li> </ul> <pre><code>systemctl restart smbd\n</code></pre> <ul> <li>Por \u00faltimo, para acceder al recurso se realizar\u00e1 a trav\u00e9s de cualquier navegador de archivos usando el protocolo smb especificando el usuario, la direcci\u00f3n del recurso y su nombre del siguiente modo:</li> </ul> <pre><code>smb://usuario1@servidorubuntu/compartido1\n</code></pre>"},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html#actividades-de-clase-aea","title":"Actividades de clase (AEA)","text":""},{"location":"02_INTRO_SAMBA/AyudaASO/062_IntroSamba.html#ac62-instalacion-y-configuracion-basica-de-samba","title":"AC62. Instalaci\u00f3n y configuraci\u00f3n b\u00e1sica de Samba","text":"<p>Instalaci\u00f3n Servidor Samba</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html","title":"HERRAMIENTAS DOCKER","text":"<p>Existen dos opciones destacables en Docker para agilizar el despliegue de Im\u00e1genes y contenedores: Dockerfile y Docker-compose</p> <ul> <li>Dockerfile: es un archivo de texto plano que contiene una serie de instrucciones necesarias para crear una imagen que, posteriormente, se convertir\u00e1 en una sola aplicaci\u00f3n utilizada para un determinado prop\u00f3sito.</li> </ul> <p>Summary</p> <p>Im\u00e1genes\u2192 docker build \u2192 docker_file</p> <ul> <li>Docker-compose: es una herramienta que permite simplificar el uso de Docker. A partir de archivos <code>yaml</code> es mas sencillo crear contenedores, conectarlos, habilitar puertos, vol\u00famenes, etc.</li> </ul> <p>Summary</p> <p>Contenedores\u2192 docker run \u2192 docker_compose.yml</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html#dockerfile","title":"Dockerfile","text":"<p>Las instrucciones principales que pueden utilizarse en un Dockerfile son:</p> <ul> <li>Ver tambi\u00e9n: Best practices for writing Dockerfiles</li> </ul> <p>Example</p> <p>A continuaci\u00f3n se muestra un ejemplo para la realizaci\u00f3n de la pr\u00e1ctica de ampliaci\u00f3n extraido de Apache oficial de docker.</p> <ol> <li>Primer paso: generar imagen con un Dockerfile.</li> </ol> <ul> <li> <p>Se crea el archivo de texto dockerfile. <pre><code>touch dockerfile\nnano dockerfile\n</code></pre></p> </li> <li> <p>Ejemplo edici\u00f3n Dockerfile.</p> </li> </ul> <pre><code># syntax=docker/dockerfile:1\nFROM nginx:alpine\nRUN apk update\nCOPY index.html/ /usr/share/nginx/html/\n</code></pre> <p>Nota</p> <p>Se puede probar a introducir el volumen en el docker file: <code>VOLUME /myvol1</code></p> <ul> <li>Se crea la imagen y el contenedor. <pre><code>docker build -t fcojavierhernandez/my-nginx-alpine .\ndocker run -dit --name my-nginx-alpine -p 8081:80 fcojavierhernandez/my-nginx-alpine\n</code></pre></li> </ul> <p>Warning</p> <ul> <li>Mucho cuidado con el \u00faltimo punto de la instucci\u00f3n de build, tiene un espacio antes. Es el \u00faltimo argumento (y el \u00fanico imprescindible) es el nombre del archivo Dockerfile que tiene que utilizar para generar la imagen. Como en este caso se encuentra en el mismo directorio y tiene el nombre predeterminado Dockerfile, se puede escribir simplemente punto (<code>.</code>).</li> <li>Para indicar el nombre de la imagen se debe a\u00f1adir la opci\u00f3n <code>-t</code>. El nombre de la imagen debe seguir el patr\u00f3n <code>nombre-de-usuario/nombre-de-imagen</code>. Si la imagen s\u00f3lo se va a utilizar localmente, el nombre de usuario y de la imagen pueden ser cualquier palabra.</li> </ul> <ol> <li>Segundo paso: subir imagen al Docker Hub.</li> </ol> <ul> <li>Se debe generar una cuenta de Docker Hub con la cuenta corporativa de Office 365: Sign Up</li> <li>Con el comando <code>docker login</code>, se realiza el acceso a la plataforma desde el terminal, introduciendo usuario y contrase\u00f1a. <pre><code>docker login\n</code></pre></li> </ul> <p>Advertencia</p> <p>Se debe acceder con el nic no con la cuenta de correo.</p> <ul> <li>Con el comando <code>docker push</code>, se realiza el \"Upload\" de la imagen.</li> </ul> <pre><code>docker push fcojavierhernandez/my-nginx-alpine\n</code></pre> <ul> <li>Por \u00faltimo Se debe comprobar accediendo a la plataforma de Docker Hub.</li> </ul>"},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html#docker-compose","title":"Docker-compose","text":"<ul> <li> <p>Docker-compose es otro proyecto open source que permite definir aplicaciones muilti-contenedor de una manera sencilla y declarativa.</p> </li> <li> <p>Es una alternativa m\u00e1s c\u00f3moda al uso de los comandos docker run y docker build, que resultan un tanto tediosos cuando trabajamos con aplicaciones de varios componentes.</p> </li> <li> <p>Se define un fichero <code>docker-compose.yml</code> que se puede observar en el ejemplo realizado en la pr\u00e1ctica en el \u00faltimo apartado.</p> </li> </ul> <p>Example</p> <p>A continuaci\u00f3n se muestra un ejemplo para la realizaci\u00f3n de la pr\u00e1ctica de ampliaci\u00f3n: Instalaci\u00f3n Wordpress</p> <ol> <li>Primer Paso: instalaci\u00f3n de Docker-compose.</li> </ol> <ul> <li>Install Docker Compose</li> </ul> <pre><code>apt-get install docker-compose\n</code></pre> <ol> <li>Segundo paso: Crear directorio del proyecto y dentro el archivo <code>yaml</code>.</li> </ol> <pre><code>mkdir my_wordpress\ntouch docker-compose.yml\nnano docker-compose.yml\n</code></pre> <ol> <li>Tercer paso: se edita el <code>yaml</code>.</li> </ol> <pre><code>version: \"3.9\"\n\nservices:\n  db:\n    image: mysql:5.7\n    volumes:\n      - db_data:/var/lib/mysql\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: somewordpress\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: wordpress\n      MYSQL_PASSWORD: wordpress\n\n  wordpress:\n    depends_on:\n      - db\n    image: wordpress:latest\n    volumes:\n      - wordpress_data:/var/www/html\n    ports:\n      - \"8000:80\"\n    restart: always\n    environment:\n      WORDPRESS_DB_HOST: db:3306\n      WORDPRESS_DB_USER: wordpress\n      WORDPRESS_DB_PASSWORD: wordpress\n      WORDPRESS_DB_NAME: wordpress\nvolumes:\n  db_data: {}\n  wordpress_data: {}\n</code></pre> <ol> <li>Cuarto paso: en la carpeta creada del proyecto se ejecuta el comando de <code>docker-compose up -d</code></li> </ol> <pre><code>docker-compose up -d\n</code></pre> <p>Comprobaci\u00f3n</p> <p>Se comprueba que se ha creado el contenedor y se abre el navegador para comprobar que est\u00e1 disponible la instalaci\u00f3n de wordpress.</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html#actividades-tipo-practicastrabajos-ap","title":"Actividades tipo Pr\u00e1cticas/trabajos (AP)","text":""},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html#pt64-nfs-mediante-docker-compose","title":"PT64. NFS mediante Docker compose","text":"<p>A partir del <code>docker-compose</code> adjunto realiza un informe con los siguientes apartados:</p> <ul> <li>Crea un contenedor con el servicio de NFS. Adjunta captura con el contenedor corriendo.</li> <li>Monta la carpeta compartida de forma autom\u00e1tica en un cliente. Adjunta capturas de los pasos a realizar.</li> </ul> <p>Consejo</p> <p>Montar la carpeta desde el ra\u00edz del servidor a cualquier carpeta.</p> <p>\u00bfPor qu\u00e9 se puede montar la carpeta desde la ra\u00edz del servidor? Te puedes apoyar en las notas de la imagen de NFS para contestar. Imagen en el siguiente enlace: itsthenetwork/nfs-server-alpine</p> <ul> <li>Crea un archivo de texto de prueba, entra al contenedor o servidor y confirma que se ha creado.</li> <li> <p>\u00bfQu\u00e9 pasa si paras y destruyes el contenedor? \u00bfC\u00f3mo se podr\u00eda solucionar?.</p> </li> <li> <p>NFS docker-compose:</p> </li> </ul> <pre><code>version: \"2.1\"\nservices:\n  # https://hub.docker.com/r/itsthenetwork/nfs-server-alpine\n  nfs:\n    image: itsthenetwork/nfs-server-alpine:12\n    container_name: nfs\n    restart: unless-stopped\n    privileged: true\n    environment:\n      - SHARED_DIRECTORY=/data\n    volumes:\n      - /data/nfs-storage:/data\n    ports:\n      - 2049:2049\n</code></pre>"},{"location":"02_INTRO_SAMBA/AyudaASO/069_HerramientasDocker.html#soluciones","title":"Soluciones","text":"<p>Soluci\u00f3n Pr\u00e1ctica NFS-DockerCompose</p>"},{"location":"02_INTRO_SAMBA/AyudaASO/Practica14_samba.html","title":"AC62. Instalaci\u00f3n y preparaci\u00f3n Servidor Samba","text":""},{"location":"02_INTRO_SAMBA/AyudaASO/Practica14_samba.html#instalacion","title":"Instalaci\u00f3n","text":"<pre><code>sudo apt install samba\n</code></pre>"},{"location":"02_INTRO_SAMBA/AyudaASO/Practica14_samba.html#configuracion-de-carpetas-compartidas","title":"Configuraci\u00f3n de carpetas compartidas","text":"<ol> <li> <p>Editamos el fichero de configuraci\u00f3n: <code>/etc/samba/smb.conf</code></p> </li> <li> <p>Al final del archivo de configuraci\u00f3n a\u00f1adiremos una nueva entrada con el directorio a compartir:</p> </li> </ol> <pre><code>[ejercicio1]\n    comment = Prueba Ejercicio 1\n    path = /srv/samba/ejercicio1\n    browsable = yes\n    guest ok = yes\n    read only = yes\n    create mask = 0764\n    directory mask = 0764\n</code></pre> <ol> <li>Creamos el directorio que \u00edbamos a compartir y cambiamos los permisos para que no de conflicto.</li> </ol> <pre><code>sudo mkdir -p /srv/samba/ejercicio1\nsudo chmod 764 /srv/samba/ejercicio1/\n</code></pre> <ol> <li>Siempre que modifiquemos el fichero de configuraci\u00f3n debemos reiniciar el servicio:</li> </ol> <pre><code>sudo systemctl restart smbd\n</code></pre>"},{"location":"02_INTRO_SAMBA/AyudaASO/Practica14_samba.html#acceso-desde-cliente-windows","title":"Acceso desde Cliente Windows","text":"<ol> <li>Abrimos un explorador de directorios.</li> <li>Seleccionamos Red (Network)</li> <li>Puede que tengamos que habilitar el descubrimiento de redes:</li> </ol> <p>Como alternativa, en caso de no descubrir el equipo podemos abrir un explorador de directorio y colocar en la barra de direcciones <code>\\\\IP_Servidor</code></p>"},{"location":"02_INTRO_SAMBA/AyudaASO/Practica14_samba.html#cuestiones-sobre-la-practica","title":"Cuestiones sobre la pr\u00e1ctica","text":"<p>Razona todas las respuestas, en caso de que la respuesta sea debido a unos permisos indica que permisos tiene y donde han sido determinados.</p> <ol> <li>Sigue todos los pasos del manual (apartado anterior) para conseguir compartir ficheros. Adjunta una captura de la secci\u00f3n del fichero de configuraci\u00f3n de samba donde se muestre la configuraci\u00f3n del recurso compartido.</li> <li>Desde el servidor, crea un fichero hola.txt en la carpeta <code>/srv/samba/ejercicio1</code>.</li> <li>Desde el cliente windows accede al servidor mediante un explorador de directorios e intenta abrir el documento \u00bfExiste alg\u00fan problema para ello? Razona tu respuesta.</li> <li>Seguidamente modifica el fichero e intenta guardarlo. \u00bfQu\u00e9 ocurre? \u00bfPor qu\u00e9?</li> <li>Ahora, desde el cliente Windows, intenta crear un fichero. \u00bfTe deja? \u00bfPuedes leer y escribir en \u00e9l? \u00bfPor qu\u00e9?</li> <li>Desde el servidor, modifica los permisos de <code>/srv/samba/ejercicio1/hola.txt</code> para que tenga los siguientes permisos rwxr\u2014rwx, ahora desde el cliente Windows prueba a modificar el contenido de dicho fichero. \u00bfQu\u00e9 ocurre y por qu\u00e9? Si no te deja escribir y guardar los cambios, indica que deber\u00edas cambiar para que puedas hacerlo.</li> <li>Crea una carpeta en el servidor <code>/srv/samba/ejercicio2</code>. Comparte dicha carpeta, a\u00f1adiendo una nueva entrada en el fichero de configuraci\u00f3n de samba. La carpeta debe ser navegable, se debe poder acceder sin credenciales, debe tener permisos  de lectura/escritura y adem\u00e1s los ficheros creados por los clientes podr\u00e1n ser modificados, le\u00eddos y ejecutados por cualquiera. Por otro lado, los directorios creados por los clientes solo podr\u00e1n ser modificados por el usuario propietario, mientras que el resto de usuarios/grupos no tendr\u00e1n ning\u00fan permiso. Muestra la configuraci\u00f3n realizada.</li> <li>Desde un cliente Windows (como usuario propietario) intenta acceder a la carpeta ejercicio2 y crear un documento llamado \u201cmiTesoro.txt\u201d. Acto seguido, vuelve al servidor e intenta modificar el fichero (SIN SER SUDO) \u00bfExiste alg\u00fan problema? \u00bfPor qu\u00e9?</li> <li>Ahora desde el cliente (Windows) crea un directorio llamado \u201cMairon\u201d. Vuelve al servidor e intenta crear un fichero \u201cSauron.txt\u201d dentro de Mairon (SIN SER SUDO). \u00bfQu\u00e9 ocurre? \u00bfQu\u00e9 permisos tiene la carpeta \u201cMairon\u201d?.</li> </ol>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html","title":"Secciones y Usuarios en SAMBA","text":""},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#secciones","title":"Secciones","text":"<p>Aunque en la UT anterior ya se comentaron par\u00e1metros de algunas de las secciones del archivo de configuraci\u00f3n de Samba, es importante desarrollar m\u00e1s en profundidad las diferentes opciones que nos brinda Samba a trav\u00e9s de dichas secciones.</p> <p>Dentro del fichero de configuraci\u00f3n <code>/etc/samba/smb.conf</code> encontramos diversas secciones, entre las que se destacan tres:</p> <ul> <li><code>[global]</code>: Es la secci\u00f3n principal que nos permite configurar los par\u00e1metros generales del servicio. Las opciones especificadas aqu\u00ed afectan a cualquier recurso compartido. </li> </ul> <p>Advertencia</p> <p>A tener en cuenta, si una misma opci\u00f3n se declara en la secci\u00f3n global y en otra secci\u00f3n, por ejemplo una carpeta compartida con el nombre <code>ejercicio1</code>, tendr\u00e1 mayor peso la de la secci\u00f3n m\u00e1s espec\u00edfica, es decir, la especificada en la secci\u00f3n llamada <code>ejercicio1</code>.</p> <ul> <li><code>[homes]</code>: Esta secci\u00f3n permite compartir las carpetas home de cada usuario, para que cada usuario pueda acceder a su carpeta home por la red. </li> </ul> <p>consejo</p> <p>Se puede indicar las opciones para el <code>/home</code> de los usuarios existentes en el servidor. De tal forma que podr\u00edamos acceder a nuestro <code>/home</code> desde cualquier m\u00e1quina del grupo de trabajo de la siguiente forma: <code>\\\\IP_SERVIDOR\\usuario</code> \u2192 (file://IP_SERVIDOR/usuario)</p> <ul> <li><code>[printers]</code>: Permite compartir impresoras en red.</li> </ul>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#parametros","title":"Par\u00e1metros","text":"<p>Puesto que editando el archivo <code>smb.conf</code> se pueden configurar m\u00e1s de 300 par\u00e1metros, dando lugar a miles de configuraciones, esta gu\u00eda se limitar\u00e1 a analizar los par\u00e1metros m\u00e1s relevantes</p> <ol> <li>En la secci\u00f3n <code>[global]</code> se especifican las siguientes opciones generales:</li> </ol> Variable Descripci\u00f3n workgroup Esta variable ha de almacenar el nombre del grupo de trabajo o dominio que usamos en nuestra red. server string Permite reconocer el equipo dentro del dominio. Por defecto tiene como valor el nombre del servidor. hosts allow Especifica desde qu\u00e9 direcciones IP se podr\u00e1 acceder al servicio. Si se especifica  192.168. todas las direcciones que empiecen de ese modo tendr\u00e1n acceso al recurso. Se puede establecer direcciones IP completas. hosts deny Especifica los rangos no permitidos, del mismo modo que host allow. security, Especifica el nivel de seguridad con el que se puede acceder. <p>Ejemplo [global]</p> <pre><code>    [global]\n    # Seguridad por usuarios\n    security = user\n    # Grupo de trabajo 'Aula5'\n    workgroup = Aula5 \n    # Las contrase\u00f1as se deber\u00e1n enviar encriptadas \n    encrypt passwords = yes\n    # Samba ser\u00e1 servidor wins\n    wins support = yes\n    # Nivel y longitud m\u00e1xima del archivo de registro\n    log level = 1 \n    max log size = 1000\n    # Por defecto, lectura y escritura\n    read only = no\n    # Se comparten tambi\u00e9n las impresoras\n    load printers = yes\n</code></pre> <ul> <li>M\u00e1s ejemplos:</li> </ul> <p><code>hosts allow/deny</code>: Permite restringir el acceso por IP:</p> <p>Ejemplo1</p> <p>Permitir Redes <pre><code>hosts allow = 192.168.2.0/24 192.168.3.0/24\n</code></pre></p> <p>Ejemplo2</p> <p>Permitir IP espec\u00edfica <pre><code>hosts allow = 192.168.2.5 192.168.3.100 192.168.3.200\n</code></pre></p> <p>Ejemplo1</p> <p>Permitir acceso a todos los hosts que comiencen por 192.168. <pre><code>hosts allow = 192.168.\n</code></pre></p> <p>Ejemplo1</p> <p>Deniega acceso a todos los hosts que comiencen por 10. <pre><code>hosts deny = 10.\n</code></pre></p> <ul> <li>Su funcionamiento es de arriba abajo, como las listas de acceso. Es decir, si tenemos:</li> </ul> <pre><code>hosts allow = 127.0.0.1 192.168.2.0/24 192.168.3.0/24\nhosts deny = 127.0.0.1 192.168.2.0/24 192.168.3.0/24\n</code></pre> <p>El que cuenta es el primero que coincida, por tanto s\u00ed permitir\u00eda el acceso.</p> <ol> <li>En la secci\u00f3n <code>[homes]</code> se muestra el siguiente ejemplo:</li> </ol> <p>Ejemplo</p> <pre><code>    [homes] \n    # Comentario\n    comment = Carpetas home \n    # No explorables\n    browsable = no \n    # M\u00e1scara de creaci\u00f3n de archivos (rxw------)\n    create mask = 0700 \n    # M\u00e1scara de creaci\u00f3n de carpetas\n    directory mask = 0700\n</code></pre> <ol> <li>En la secci\u00f3n <code>[printers]</code> se muestra el siguiente ejemplo:</li> </ol> <p>Ejemplo</p> <pre><code>    [printers] \n    path = /var/tmp \n    printable = yes\n    min print space = 2000\n</code></pre>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#usuarios","title":"Usuarios","text":"<ul> <li> <p>Para que esa administraci\u00f3n sea posible, Samba dispone de su propia base de datos de <code>usuarios samba</code> pero como los usuarios utilizan otros recursos del servidor como carpetas e impresoras, es necesario que est\u00e9n creados en el sistema Unix.</p> </li> <li> <p>Resumiendo, podemos decir que para poder ser usuario de samba, es necesario disponer de una cuenta de usuario en Unix y de una cuenta de usuario en samba.</p> </li> </ul> <p>Gesti\u00f3n usuarios</p> <ul> <li>La gesti\u00f3n de usuarios de samba se puede realizar de dos formas: </li> <li>con el comando <code>smbpasswd</code>. Con dicho comando, entre otras cosas podremos crear y eliminar usuarios, cambiar su contrase\u00f1a, etc.</li> <li>A trav\u00e9s de los comandos samba-tool user y samba-tool group.</li> </ul> <ul> <li>Inicialmente se van a realizar con la primera opci\u00f3n.</li> </ul>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#creacion-de-un-usuario-de-samba-con-smbpasswd","title":"Creaci\u00f3n de un usuario de samba con smbpasswd","text":"<p>Para crear un usuario de samba se puede utilizar el comando <code>smbpasswd</code>, pero antes debemos haber creado el usuario en Unix.</p> <p>Ejemplo</p> <pre><code># Creaci\u00f3n del usuario pepe\nsudo useradd pepe\n# Si se desea que pepe pueda disfrutar de los servicios samba, debemos crear a pepe como usuario de samba ejecutando el siguiente comando:\nsudo smbpasswd -a pepe\n# Con la opci\u00f3n -a indicamos que a\u00f1ada al usuario. \n# Acto seguido nos preguntar\u00e1 dos veces la contrase\u00f1a que deseamos poner al usuario. Lo razonable es que sea la misma contrase\u00f1a que tiene el usuario en Unix. \n</code></pre>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#eliminar-un-usuario-de-samba","title":"Eliminar un usuario de samba","text":"<p>Para eliminar un usuario de samba debemos ejecutar <code>smbpasswd</code> con la opci\u00f3n <code>-x</code>, </p> <p>Ejemplo</p> <pre><code># Eliminar un usuario de samba\nsudo smbpasswd -x pepe\n# Inmediatamente el usuario habr\u00e1 desaparecido de la base de datos de 'usuarios samba' aunque seguir\u00e1 siendo un usuario de Unix.\n</code></pre> <ol> <li>Otras opciones de <code>smbpasswd</code></li> </ol> <ul> <li><code>-d</code>: Deshabilitar un usuario</li> <li><code>-e</code>: Habilitar un usuario.</li> <li><code>-m</code>: Indica que es una cuenta de m\u00e1quina (equipo)</li> <li><code>-n</code>: Usuario sin password.</li> </ul> <p>Note</p> <p>La \u00faltima opci\u00f3n Necesita par\u00e1metro null passwords = yes en secci\u00f3n 'global' del archivo de configuraci\u00f3n de samba</p>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#el-usuario-invitado","title":"El usuario Invitado","text":"<p>Cuando accedemos como \u201cinvitado\u201d (guest ok) por defecto accedemos como el usuario <code>nobody:nogroup</code>. Esto se puede modificar usando el siguiente par\u00e1metro:</p> <pre><code>force user = javi\nforce group = alumnos\n</code></pre> <p>Opci\u00f3n</p> <p>De esta forma cuando accedamos al sistema como invitado accederemos como el usuario <code>javi</code> que tiene el grupo principal alumnos.</p>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#restriccion-por-usuarios","title":"Restricci\u00f3n por usuarios","text":"<p>En caso de que no permitamos el acceso de invitados (guest ok = no) el servidor nos solicitar\u00e1 nuestras credenciales:</p> <ul> <li>Por otra parte se puede restringir los usuarios que pueden tener acceso a un recurso:</li> </ul> <pre><code>valid users = javi pepe jorge\ninvalid users = root @profesores @root\n</code></pre> <p>Nota</p> <p>El <code>\u201c@\u201d</code> indica que se hace referencia a un grupo. Por tanto ning\u00fan usuario perteneciente al grupo root o de profesores puede acceder.</p> <ul> <li>Adem\u00e1s se pueden crear usuarios administradores.</li> </ul> <pre><code>admin users = javi\n</code></pre> <p>NOTA:</p> <p>Los usuarios dentro de esta lista actuar\u00e1n como <code>root</code>.</p> <p>NOTA:</p> <p>Si un usuario est\u00e1 en el listado de \u201cvalid users\u201d y en el de \u201cinvalid users\u201d se le deniega el acceso.</p>"},{"location":"03_USERS_SAMBA/031_SambaSecUsers.html#autentificacion-en-samba-a-traves-de-usuarios","title":"Autentificaci\u00f3n en Samba a trav\u00e9s de usuarios","text":"<p>Para autentificarse en <code>Samba</code> a trav\u00e9s de usuarios se deben cumplir 2 requisitos:</p> <ol> <li>El usuario debe existir en el sistema <code>/etc/passwd</code></li> </ol> <pre><code>sudo useradd -s /bin/true \u201cusuario\u201d\n</code></pre> <p>Nota</p> <p>De esta forma no se crea el <code>/home</code> del usuario y no se permite el acceso al sistema si no es a trav\u00e9s de Samba. Es decir, el usuario no se podr\u00eda conectar a trav\u00e9s de <code>ssh</code> o localmente.</p> <ol> <li>El usuario debe existir en el servicio de samba. Para listar los usuarios se utiliza el comando <code>pbedit -L</code>.</li> </ol> <pre><code>sudo smbpasswd \u2013a \u201cusuario\u201d\n</code></pre> <p>NOTA:</p> <p>La contrase\u00f1a es recomendable que sea diferente a la usada en el sistema.</p> <ul> <li>Listar usuarios dados de alta en SAMBA:</li> </ul> <pre><code>pdbedit -L\n</code></pre>"},{"location":"03_USERS_SAMBA/032_CreacionUsersSamba.html","title":"Creaci\u00f3n de usuarios y grupos","text":""},{"location":"03_USERS_SAMBA/032_CreacionUsersSamba.html#pt31-creacion-de-usuarios-y-grupos","title":"PT31 Creaci\u00f3n de usuarios y grupos","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE4, CE5, CE6, CE7, y CE8 del RA2 de SOR.</p> <p>Advertencia</p> <p>Razona todas las respuestas, en caso de que la respuesta sea debido a unos permisos indica que permisos tiene y donde han sido determinados.</p>"},{"location":"03_USERS_SAMBA/032_CreacionUsersSamba.html#enunciado","title":"Enunciado","text":"<p>Partiendo de la situaci\u00f3n de aprendizaje, desde el departamento TIC de NetOS nos encargan crear la infraestructura de directorios y usuarios para los diferentes departamentos de una empresa de cr\u00eda de berberechos salvajes denominada BerbeWild S.A. desde un sevidor linux Ubuntu Server. </p> <p>Nota</p> <p>Cabe destacar que el escenarios de la empresa es heterog\u00e9neo ya que existen diferentes tipos de sistemas operativos de propietarios (Windows) y libre licencia (Lubuntu).</p> <ul> <li>Por estas razones se decide utilizar el servicio Samba y realizar unos pasos previos siguiendo la gu\u00eda adjunta a continuaci\u00f3n:</li> </ul> <p>Requisitos</p> <p>Se necesitan las tres m\u00e1quinas virtuales utilizadas en el apartado 2.2 Instalaci\u00f3n y configuraci\u00f3n inicial de Samba en configuraci\u00f3n Red NAT.</p> <p>Tareas</p> <ul> <li>Esta pr\u00e1ctica tiene como objetivo la creaci\u00f3n de usuarios y grupos por un lado en el sistema y por otro en el servicio de directorio Samba, aunque inicialmente se debe crear la estructura de directorios de la organizaci\u00f3n.</li> <li>A partir de las premisas adjunta realiza un video con los pasos realizados y un informe con los siguientes apartados.</li> <li>Haz pruebas de inicio de sesi\u00f3n en al menos un cliente por departamento para comprobar que las cuentas funcionan.</li> </ul>"},{"location":"03_USERS_SAMBA/032_CreacionUsersSamba.html#premisas","title":"Premisas","text":"<ol> <li>BerbeWild S.A. esa posee una estructura en departamentos de esta forma:</li> </ol> <ul> <li>Un departamento encargado de la gerencia de la empresa. El sistema utilizado por este departamento es Lubuntu 22_04.</li> <li>Otro se encargar\u00e1 de la administraci\u00f3n de la empresa. Es normal que ante la amplitud de tareas que este departamento posee se divida en varios sub-departamentos: finanzas, n\u00f3minas y contabilidad. Este departamento destaca por utilizar el sistema operativo Windows 11.</li> <li>Otra de las actividades que seguro necesitar\u00e1s en tu empresa ser\u00e1 la gesti\u00f3n de mercadot\u00e9cnia con sistema operativo Windows 11.</li> <li>Adem\u00e1s, debes contar con un buen servicio t\u00e9cnico que realice las tareas de dise\u00f1o, implementaci\u00f3n y mantenimiento de la infraestructura inform\u00e1tica. El sistema utilizado por este departamento es Lubuntu 22_04.</li> </ul> <p>N\u00famero de usuarios por departamento y rol</p> <p>Cada uno de estos departamentos posee dos empleados, uno de ellos ser\u00e1 el responsable.</p> <p>Nota</p> <p>Utiliza datos inventados para la informaci\u00f3n personal. Puedes usar esta web para obtener datos personales ficticios: GeneraData.</p> <ol> <li>Crea un grupo por cada departamento y sub-departamento e introduce en ellos a cada uno de los usuarios que corresponda.</li> </ol> <p>Ejemplo</p> <p>Los usuarios de gerencia en el grupo gerencia.</p> <ol> <li>Los usuarios deben tener estas limitaciones:</li> </ol> <ul> <li>El usuario debe cambiar su contrase\u00f1a en el siguiente inicio de sesi\u00f3n.</li> <li>El usuario no podr\u00e1 cambiar la contrase\u00f1a hasta que no transcurran 7 d\u00edas desde la \u00faltima vez que la modific\u00f3.</li> <li>Cualquier usuario debe cambiar su contrase\u00f1a transcurridos treinta d\u00edas.</li> <li>El sistema avisar\u00e1 con una semana de antelaci\u00f3n del cambio de contrase\u00f1a.</li> </ul>"},{"location":"03_USERS_SAMBA/032_CreacionUsersSamba.html#guia","title":"Gu\u00eda","text":"<p>El esquema de la organizaci\u00f3n es:</p> <p>Consejo</p> <p>Genera los directorios para la empresa, podr\u00edas utilizar el comando <code>mkdir -p /PATH</code>.</p> <ol> <li>En un primer paso se crean los grupos y usuarios en el sistema para luego tenerlos \"agregados tambi\u00e9n en el servicio de Samba\". Se muestra la creaci\u00f3n de dos usuarios en el sistema del departamento de servicio t\u00e9cnico a modo de ejemplo:</li> </ol> <ul> <li>Generaci\u00f3n de grupo de servicio t\u00e9cnico \"TIC\":</li> </ul> <pre><code>sudo groupadd TIC\n</code></pre> <ul> <li>Usuario administrador \"responsable\" debe tener permisos de superusuario:</li> </ul> <pre><code>sudo useradd admin -m -G sudo -s /bin/bash\n</code></pre> <ul> <li>Usuario \"nivel bajo\":</li> </ul> <pre><code>sudo useradd usuario -m -g TIC -s /bin/bash\n</code></pre> <p>Por otro lado, se generan los usuarios en Samba, los cuales se pueden realizar de dos formas:</p> <ul> <li>Mediante smbpasswd:</li> </ul> <pre><code>sudo smbpasswd -a admin\n</code></pre> <ul> <li>A trav\u00e9s de comandos de samba-tool.</li> </ul> <pre><code>sudo samba-tool user create admin\n</code></pre> <p>Nota: Este ejemplo se realiza para todos los usuarios planteados en la organizaci\u00f3n.</p> <ol> <li>La creaci\u00f3n de grupos tambi\u00e9n se realiza en el servicio samba mediante samba-tool.</li> </ol> <ul> <li>En el sistema.</li> </ul> <pre><code>sudo samba-tool group add admin\n</code></pre> <ul> <li>Se a\u00f1aden los usuarios al grupo.</li> </ul> <pre><code>sudo samba-tool group addmembers TIC usuario\n</code></pre> <ol> <li>Para las restricciones de contrase\u00f1a se puede realizar en un solo comando o en el sistema o por samba, se muestra por sistema:</li> </ol> <pre><code>sudo chage -d 0 -m 7 -M 30 -W 7 usuario\n</code></pre> <ul> <li>Para comprobarlo se puede ejecutar:</li> </ul> <pre><code>sudo chage -l usuario\n</code></pre> <p>Nota</p> <p>Investiga los argumentos del comando <code>chage</code> para relacionarlos con las premisas del punto 3.</p>"},{"location":"03_USERS_SAMBA/033_GestionUsersSamba.html","title":"Gesti\u00f3n de secciones y usuarios en Samba","text":""},{"location":"03_USERS_SAMBA/033_GestionUsersSamba.html#pt32-gestion-de-secciones-y-usuarios-en-samba","title":"PT32 Gesti\u00f3n de secciones y usuarios en Samba","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE6, y CE9 del RA2 de SOR.</p> <p>Advertencia</p> <p>Razona todas las respuestas, en caso de que la respuesta sea debido a unos permisos indica que permisos tiene y donde han sido determinados.</p> <p>Tareas</p> <ul> <li>A partir de la PT31 los siguientes apartados:</li> <li>Adjunta un v\u00eddeo con los pasos realizados y un informe.</li> </ul>"},{"location":"03_USERS_SAMBA/033_GestionUsersSamba.html#secciones-samba","title":"Secciones SAMBA","text":"<p>NOTA:</p> <ul> <li>Recuerda reiniciar el servicio de samba tras modificar el fichero smb.conf.</li> <li>Estate atento para eliminar las l\u00edneas comentadas, las cuales comienzan por <code>\u201c#\u201d</code> y <code>\u201c;\u201d</code></li> </ul> <ol> <li>Haz que todos los <code>/homes</code> de los usuarios sean navegables, que cualquiera pueda acceder sin credenciales y que solo tengan permisos de lectura. Recuerda que tambi\u00e9n deber\u00e1s tener en cuenta los permisos dentro del servidor Linux. Haz captura de la configuraci\u00f3n realizada en <code>smb.conf</code> y del explorador de Windows accediendo a tu <code>/home</code> de Ubuntu.</li> <li>Cambia en el servidor, en la secci\u00f3n [homes], la opci\u00f3n read only a no. Haz una captura de los permisos de tu carpeta <code>/home</code>. Prueba a crear un fichero desde Windows. \u00bfQu\u00e9 sucede y por qu\u00e9?</li> <li>Indica la configuraci\u00f3n del servicio m\u00e1s adecuada si quisiera permitir \u00fanicamente los equipos de la red 172.16.0.0/16 (Supuesta IP de las m\u00e1quinas de la organizaci\u00f3n, configurada en la RED NAT por defecto). \u00bfSigues teniendo acceso desde el cliente? \u00bfPor qu\u00e9?</li> <li>Ahora genera secciones con las carpetas generadas para BerbeWild S.A. y realiza los permisos necesarios para que solo accedan los usuarios de los grupos correspondientes.</li> </ol>"},{"location":"03_USERS_SAMBA/033_GestionUsersSamba.html#usuarios-samba","title":"Usuarios SAMBA","text":"<ol> <li>Prueba a crear un usuario con <code>smbpasswd</code> sin que \u00e9ste exista en el sistema Linux. \u00bfQu\u00e9 sucede? Adjunta una captura.</li> <li>Crea el usuario leonardo en el grupo de TIC en el sistema linux, ten en cuenta que dicho usuario solo debe ser capaz de acceder al sistema a trav\u00e9s de Samba. Posteriormente cr\u00e9alo para Samba. Visualiza los usuarios de samba y f\u00edjate en el <code>UID</code> asignado al usuario reci\u00e9n creado \u00bftiene el mismo UID que en el sistema Linux (<code>/etc/passwd</code>)? Adjunta capturas de todo el proceso.</li> <li>Cierra la sesi\u00f3n actual en el servidor (exit) e intenta iniciar sesi\u00f3n con el usuario \u201cleonardo\u201d \u00bfQu\u00e9 sucede y por qu\u00e9?</li> <li>Edita en el servidor la secci\u00f3n [homes] con \u201cforce user = root\u201d. Reinicia el servicio. Intenta crear, desde el cliente de Windows, \"logueandote\" como leonardo un documento en el escritorio del <code>/home</code> compartido. \u00bfTe permite crearlo? \u00bfPor qu\u00e9? \u00bfQu\u00e9 permisos y usuario propietario tiene el fichero creado? Adjunta capturas a las explicaciones.</li> <li>Cambia la configuraci\u00f3n en el servidor de la carpeta \u201c<code>/home/leonardo/serviciotecnico</code>\u201d para que no permita el acceso de invitados y solo permita al usuario \u201cleonardo\u201d. Muestra la configuraci\u00f3n. Intenta acceder desde el cliente Windows con las credenciales de tu usuario \u00bfQu\u00e9 sucede? Adjunta capturas de pantalla.</li> <li>Comprueba el acceso y no acceso de los usuarios de BerbeWild S.A. a los diferentes directorios creados.</li> </ol>"},{"location":"03_USERS_SAMBA/034_RefuerzoAmpliacion.html","title":"Refuerzo y Ampliaci\u00f3n","text":"<p>A continuaci\u00f3n se definen las actividades de refuerzo y ampliaci\u00f3n de la UT3</p>"},{"location":"03_USERS_SAMBA/034_RefuerzoAmpliacion.html#refuerzo","title":"Refuerzo","text":""},{"location":"03_USERS_SAMBA/034_RefuerzoAmpliacion.html#pt33-configuracion-usuarios-y-grupos","title":"PT33. Configuraci\u00f3n Usuarios y grupos","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE4, CE5, CE6, CE7, y CE8 del RA2 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>desde la misma situaci\u00f3n de aprendizaje, de PT31 se debe tener en cuenta la creaci\u00f3n de un departamento m\u00e1s en la empresa, en concreto el de marketing realiza:</li> </ul> <p>Tareas</p> <p>Genera dos usuarios con permisos totales en el directorio de dicho departamento.</p>"},{"location":"03_USERS_SAMBA/034_RefuerzoAmpliacion.html#ampliacion","title":"Ampliaci\u00f3n","text":""},{"location":"03_USERS_SAMBA/034_RefuerzoAmpliacion.html#pt_34-creacion-usuarios-shellscripting","title":"PT_34 Creaci\u00f3n usuarios Shellscripting","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE4, CE5, CE6, CE7, y CE8 del RA2 de SOR.</p> <p>Enunciado</p> <p>En NetOS ha gustado la forma en la que has solucionado el proyecto de BerbeWild S.A. y piensan que ser\u00eda oportuno generar una forma de generalizar el proceso.</p> <p>Tareas</p> <p>Tu coordinadora del departamento de TIC te pide que realices un script que gener\u00e9 los directorios, usuarios y grupos (en el sistema y en el servicios Samba) para cualquier empresa.</p> <p>Ayuda</p> <p>Te puedes ayudar en los siguientes apuntes UT1 ShellScripting</p>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html","title":"Introducci\u00f3n Samba Domain Controller","text":"<p>La organizaci\u00f3n de una red de trabajo empresarial supone un reto organizativo que el administrador del sistema debe afrontar con garant\u00edas de \u00e9xito. </p> <p>Principio</p> <p>Si no se concibe un ordenador sin sistema operativo que lo administre, tampoco debe existir una red de cierta entidad sin sistema operativo en red que la gestione.</p> <ul> <li>Para ello se dispone de herramientas organizativas como los Servicios de Directorio.</li> <li>Entre los principales servicios de directorio destacan SAMBA Domain Controller y Active Directory, ambos basados en el protocolo LDAP, y los cuales ofrecen una amplia gama de herramientas que facilitan la organizaci\u00f3n de recursos de una red.</li> <li>En concreto en esta Unidad de Trabajo (UT) se desarrolla Samba Domain Controller, el cual emula al controlador de dominio de un dominio Windows, conocido como Active Directory Domain Services (AD DS).</li> </ul>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#servicios-de-directorio","title":"Servicios de directorio","text":"<p>En primer lugar...</p> <p>Antes de profundizar en Samba DC es importante desarrollar los principales conceptos de los servicios de directorio.</p> <p>Los servicios de directorios, son un conjunto de aplicaciones que guardan y administran toda la informaci\u00f3n sobre los elementos de una red.</p> <ul> <li>Cada recurso de la red se considera como un objeto, donde su informaci\u00f3n se almacena como atributos.</li> <li>Para la gesti\u00f3n de esta informaci\u00f3n, el servicio de directorio establece una serie de permisos de acceso y condiciones de seguridad que la salvaguardan esta informaci\u00f3n.</li> <li>Ofrecen una infraestructura para localizar, manejar, administrar, y organizar los componentes y recursos comunes de una red.</li> </ul> <p>Nota</p> <p>Los recursos pueden ser: vol\u00famenes, carpetas, archivos, impresoras, usuarios, grupos, dispositivos, n\u00fameros de tel\u00e9fono y un largo etc\u00e9tera.</p> <p>Resumen</p> <p>Un servicio de directorio ofrece toda la informaci\u00f3n de los recursos de la red a trav\u00e9s de una \u00fanica ubicaci\u00f3n. Para ello convierte cada recurso en un objeto y almacena su informaci\u00f3n en una base de datos jer\u00e1rquica y, opcionalmente, distribuida. La gesti\u00f3n de estos datos se realiza a trav\u00e9s de un protocolo determinado por la versi\u00f3n del servicio de directorio escogido.</p>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#principales","title":"Principales","text":"<ol> <li>Active Directory, ideado por Microsoft e implementado desde su versi\u00f3n Microsoft Windows 2000 que usaba tecnolog\u00eda propietaria, para m\u00e1s tarde adaptar el protocolo LDAP a su servicio.</li> <li>OpenLDAP, recibe el nombre del protocolo hom\u00f3nimo que gestiona el intercambio de informaci\u00f3n. Es uno de los m\u00e1s usados en sistemas basados en GNU/Linux.</li> <li>SambaDC, un servicio compuesto por un conjunto de protocolos (OpenLDAP, Kerberos y Samba) que permite la f\u00e1cil coexistencia de entre sistemas operativos diferentes.</li> <li>Otros: Novell Directory Services, Red Hat Directory Server o Apache Directory Server.</li> </ol>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#componentes","title":"Componentes","text":"<p>Los servicios de directorios contienen diferentes objetos relacionados entre s\u00ed, y que ser\u00e1 conveniente familiarizarse con ellos:</p> <ol> <li>Directorio, es un repositorio \u00fanico para la informaci\u00f3n relativa a los objetos de una organizaci\u00f3n.</li> <li>Dominio, es una colecci\u00f3n de objetos dentro de un directorio.</li> <li>Objeto, cualquiera de los elementos que forman parte del directorio. Pueden ser recursos, usuarios, equipos, relaciones de confianza, servidores, unidades organizativas entre otros. En general todos estos objetos se clasifican en tres categor\u00edas:<ol> <li>usuarios, identificados a trav\u00e9s del binomio nombre/contrase\u00f1a y que pueden organizarse en grupos.</li> <li>recursos, elementos que los usuarios pueden usar para el correcto desarrollo de su actividad.</li> <li>servicios, que son funciones a los que el usuario tienen acceso como el correo electr\u00f3nico, copias de seguridad en la nube, conexi\u00f3n Internet entre otros.</li> </ol> </li> <li>Unidad organizativa, es un contendedor de objetos que permite organizarlos en subconjuntos de forma jer\u00e1rquica. Facilita la organizaci\u00f3n de los dominios.</li> </ol> Unidades Organizativas en Active Directory <ol> <li>Grupo, conjunto de objetos usuario. Al igual que las unidades organizativas, facilitan la organizaci\u00f3n y administraci\u00f3n de los objetos, los grupos lo hacen con objetos tipo usuario.</li> <li>Controlador de dominio, equipo que contiene la base de datos de objetos para un determinado dominio, incluida la informaci\u00f3n de seguridad y la responsabilidad de la autenticaci\u00f3n de objetos de su \u00e1mbito de gobierno.</li> <li>Cat\u00e1logo global, base de datos con la informaci\u00f3n de todos los objetos que contiene el directorio. Esta informaci\u00f3n habitualmente se divide entre los controladores de dominio siendo \u00e9stos responsables del mantenimiento de su parte de esta informaci\u00f3n.</li> <li>Maestro de operaciones, existen un conjunto de operaciones que deben estar centralizadas para mantener la consistencia del sistema. El equipo encargado de esas operaciones obtiene este rol espec\u00edfico. Seg\u00fan el caso puede ser un equipo independiente que controle estas operaciones o asignar estas tareas a un equipo existente.</li> <li>\u00c1rbol, un conjunto de dominios dependientes de una ra\u00edz com\u00fan y que tienen una estructura jer\u00e1rquica. Se caracterizan por tener un espacio de nombres com\u00fan (un servidor DNS propio). El objetivo de esta fragmentaci\u00f3n de la estructura es replicar s\u00f3lo la informaci\u00f3n necesaria y disminuir el tr\u00e1fico de red.</li> </ol> Objetos en Active Directory. <ol> <li>Bosque, se trata del mayor contenedor l\u00f3gico dentro del directorio, conteniendo a todos los \u00e1rboles dentro de su \u00e1mbito. Cada uno de estos contenedores posee su propio espacio de nombres y una forma de relacionarse con el resto de bosques.</li> </ol> Ejemplo de Objetos en Active Directory. <ol> <li>Esquema, se refiere a la estructura de los objetos que forman la base de datos. Usa la t\u00e9cnica clase/objeto para definir la estructura de un objeto. Si se crean dos objetos usuarios, ambos tendr\u00e1n los mismos atributos (estructura), pero diferentes valores de atributos.</li> <li>Sitio, conjunto de objetos equipo que se encuentran relacionados de una forma l\u00f3gica, geogr\u00e1fica o t\u00e9cnica particular y que necesitan un subconjunto de normas diferentes al resto.</li> <li>Relaciones de confianza, son un m\u00e9todo de comunicaci\u00f3n segura entre dominios, \u00e1rboles y bosques, que permiten a los usuarios autentificarse en otra parte del directorio a la que no pertenece.</li> </ol> <p>Nota</p> <p>Para nombrar a todos estos objetos que componen la red, los servicios de directorio definen un espacio de nombres un\u00edvoco, e identifican a cada uno de estos objetos con un nombre \u00fanico en todo el directorio.</p> <ul> <li>La tecnolog\u00eda utilizada para crear este espacio de nombres es la DNS (Domain Name Server), y su funcionamiento es similar al de Internet. </li> <li>Cada uno de los objetos del directorio posee un DN (Distinguished Name) que lo identifica de forma un\u00edvoca del resto de elementos del directorio.</li> </ul>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#ventajas","title":"Ventajas","text":"<ul> <li>los servicios de directorio, ofrecen una capa de abstracci\u00f3n para facilitar el acceso a los objetos. Se debe indicar una \u00fanica ubicaci\u00f3n en donde se dirigir\u00e1n las peticiones de informaci\u00f3n. No importa si la informaci\u00f3n solicitada se encuentra o no en ese emplazamiento.</li> <li>Autonom\u00eda, Es posible que toda la informaci\u00f3n no est\u00e9 contenida en un \u00fanico equipo por cuestiones de rendimiento, escalabilidad o idiosincrasia del sistemas inform\u00e1tico. En estos casos crear un subconjunto de la informaci\u00f3n contenida en los servicios de directorio parece una buena opci\u00f3n y dotarlos de las herramientas necesarias para su gesti\u00f3n aut\u00f3noma.</li> </ul>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#samba-dc","title":"Samba DC","text":"<p>Referencia</p> <p>Seg\u00fan Samba Wiki las principales caracter\u00edsticas de Samba DC son:</p> <ul> <li>Samba puede servir como controlador de dominio (DC) de Active Directory (AD) a partir de la versi\u00f3n 4.0 (lanzada en 2012).</li> <li>Samba opera en el nivel funcional forestal de Windows Server 2008 R2, que es m\u00e1s que suficiente para gestionar empresas sofisticadas que utilizan Windows 10/11 con estrictos requisitos de cumplimiento (incluido el NIST 800-171).</li> <li>Integra el servidor LDAP como back-end de Active Directory (AD).</li> <li>Proporciona soporte experimental para el MIT Kerberos.</li> </ul> <p>Dentro del compendio de aplicaciones que en el que se basa Samba se destacan LDAP y Kerberos, las cuales se definen a continuaci\u00f3n.</p>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#ldap","title":"LDAP","text":"<p>El LDAP (Lightweight Directory Access Protocol) es un protocolo a nivel de aplicaci\u00f3n que da acceso a un servicio de directorio ordenado y distribuido para la b\u00fasqueda de la informaci\u00f3n de un entrono de red.</p> <ul> <li> <p>En la d\u00e9cada de los 80, la especificaci\u00f3n de directorio X.500 vi\u00f3 la luz. El protocolo que daba acceso a la informaci\u00f3n contenida en \u00e9l, fue DAP (Directory Access Protocol) y estaba basado en la pila de protocolos OSI (Open Systems Interconexion). Gracias al auge de Internet, la pila de protocolos TCP/IP cobraron especial protagonismo y su uso fue generalizado en cualquier infraestructura de red, incluidas las LAN.</p> </li> <li> <p>Ante esta situaci\u00f3n, en 1993 se implement\u00f3 el protocolo LDAP que utilizaba la pila de protocolos TCP/IP para el acceso a la informaci\u00f3n contenido en un servicio de directorio. El funcionamiento de LDAP es relativamente simple: un cliente se inicia una sesi\u00f3n en un servidor LDAP solicitando alguna informaci\u00f3n.</p> </li> </ul> Esquema de funcionamiento del protocolo LDAP <p>Conclusi\u00f3n</p> <ul> <li>LDAP, es un protocolo que ofrece el acceso a un servicio de directorio implementado sobre un entorno de red, con el objeto de acceder a una determinada informaci\u00f3n. Puede ejecutarse sobre TCP/IP o sobre cualquier otro servicio de transferencia orientado a la conexi\u00f3n.</li> <li>Podemos considerarlo como un sistema de almacenamiento de red al que se pueden realizar consultas.</li> </ul>"},{"location":"04_SAMBA_DC/041_Introduccion_SambaDC.html#kerberos","title":"Kerberos","text":"<p>Kerberos es un protocolo de autenticaci\u00f3n de redes de ordenador creado por el MIT que permite a dos ordenadores en una red insegura demostrar su identidad mutuamente de manera segura.</p> Logo Kerberos <p>Se caracteriza por:</p> <ul> <li>Se basa en el modelo de cliente-servidor.</li> <li>Brinda autenticaci\u00f3n mutua: tanto cliente como servidor verifican la identidad uno del otro. </li> <li>Los mensajes de autenticaci\u00f3n est\u00e1n protegidos mediante criptograf\u00eda de clave sim\u00e9trica.</li> </ul>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html","title":"Instalaci\u00f3n y Configuraci\u00f3n Samba DC","text":"<p>A continuaci\u00f3n se muestra una gu\u00eda de Instalaci\u00f3n y configuraci\u00f3n de Samba Domain Controller.</p>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#guia-samba-dc-ubuntu-server","title":"Gu\u00eda Samba DC Ubuntu Server","text":"<p>Los objetivos de esta gu\u00eda son:</p> <ul> <li>Preparaci\u00f3n del servidor.</li> <li>Instalar el Controlador de Dominio en Samba.</li> <li>Acceder y crear clientes.</li> </ul> <p>Webgraf\u00eda</p>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#recordatorio-controlador-de-dominio-dc","title":"Recordatorio Controlador de Dominio (DC)","text":"<ul> <li>Es un servidor que se ocupa de permitir el acceso de determinados usuarios a recursos compartidos del dominio.</li> <li>Un dominio es un grupo de recursos (equipos, ficheros, usuarios, impresoras, etc.) dentro de una red. El acceso a dicho dominio o las pol\u00edticas de seguridad de todos esos recursos es administrada por el controlador de dominio.</li> <li>Habitualmente se implementan en Windows Server, aunque tambi\u00e9n se pueden implementar en Linux bajo samba.</li> <li>En una implementaci\u00f3n adecuada, se despliega m\u00e1s de un controlador de dominio a la vez que act\u00faan como uno (cluster) de esta forma se dota al servicio de redundancia y alta disponibilidad, es decir, que si se produce una aver\u00eda en un control de dominio el servicio sigue activo pues hay otro/s controladores activos.</li> <li>Los dominios usan rutas de nombres similares a los DNS, tienen una ruta absoluta FQDN (Full Qualified Domain Name) y una ruta relativa PQDN (Partially Qualified Domain Name).</li> </ul> <p>NOTA:</p> <p>Independientemente del sistema operativo usado necesitaremos de otros servicios para complementar, a continuaci\u00f3n se enumeran:</p> <ul> <li>LDAP: Ser\u00e1 la base de datos que alberga la informaci\u00f3n de los usuarios.</li> <li>Kerberos: Se encarga de la seguridad a nivel de autentificaci\u00f3n segura de los usuarios.</li> <li>DNS: Habitualmente el acceso al dominio se hace a trav\u00e9s de un nombre de dominio. El servicio DNS permite la resoluci\u00f3n de ese nombre de dominio al direccionamiento IP.</li> <li>NTP: Es el servicio que se encarga de la sincronizaci\u00f3n del reloj de cada m\u00e1quina.</li> </ul>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#preparacion","title":"Preparaci\u00f3n","text":"<p>Antes de la instalaci\u00f3n del Controlador de Dominio o Domain Controler DC mediante <code>Samba</code>, es necesaria, la preparaci\u00f3n del servidor a nivel de red y dominio. Para ello se detallan los siguientes pasos:</p> <ol> <li>Restaura un snapshot \"limpio\" de tu m\u00e1quina virtual de <code>Ubuntu 22.04</code> y se realiza un update.</li> </ol> Comprobaci\u00f3n versi\u00f3n Ubuntu. <ol> <li>Configura la m\u00e1quina virtual en formato \u201cNat Network\u201d.</li> </ol> <ol> <li>A continuaci\u00f3n se establece el nombre de host del servidor este caso <code>profesor.aso.local</code> y se a\u00f1ade el servidor al archivo de hosts.</li> </ol> <p>CUIDADO</p> <ul> <li>Se debe cambiar profesor por el nombre de la alumna o alumno.</li> <li>Se debe cambiar aso por sor.</li> </ul> <p>3.1. Cambio de nombre de hosts a profesor.</p> <pre><code>hostnamectl set-hostname profesor\n</code></pre> <p>3.2. El fichero <code>/etc/hosts</code> es como un servicio DNS local, es decir, tiene una serie de pares <code>nombres/IP</code> que resuelve localmente.   1. Realiza una copia de seguridad del fichero <code>/etc/hosts</code>.   2. Modifica el fichero original (<code>/etc/hosts</code>) para que resuelva el nombre de tu m\u00e1quina y tu FQDN en este caso <code>profesor.aso.local</code>.   3. Comprueba con un ping a los nombres que funciona y te contesta con la IP.</p> <p>Por ejemplo</p> <p>Inicialmente En este caso el servidor se llama aso, por lo tanto si se realiza un ping a <code>aso</code> antes de modificar el /etc/hosts la m\u00e1quina debe saber resolverlo a la IP <code>127.0.1.1</code> que por defecto en ubuntu se utiliza para determinar la direcci\u00f3n IP que corresponde al nombre de host.</p> <ul> <li>En este caso el fichero modificado quedar\u00eda:</li> </ul> <pre><code>127.0.0.1 localhost\n192.168.2.4 profesor.aso.local profesor\n\n# The following lines are desirable for IPv6 capable hosts\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre> <p>Cuidado</p> <p>La nueva IP es la recibida en el servidor del <code>DHCP</code> de la RedNAT configurada.</p> <p>3.3. Ejecuci\u00f3n y comprobaci\u00f3n.</p> <pre><code># verifica FQDN\nhostname -f\n\n# verifica FQDN si resuelve a la IP del servidor\nping -c3 profesor.aso.local\n</code></pre> Modificaci\u00f3n del /etc/hosts y comprobaciones de ping. <ol> <li>Se configura la resoluci\u00f3n de nombres en el archivo <code>resolv.conf</code> encargado de redireccionar las peticiones de <code>DNS</code>.</li> </ol> <p>A tener en cuenta</p> <ul> <li>Para realizar un dominio de b\u00fasqueda (Search Domain), el cual nos va a permitir que si el servidor recibe una b\u00fasqueda de petici\u00f3n de un recurso, por ejemplo \u201cmaquina01\u201d, autom\u00e1ticamente el servidor va intentar buscar por el nombre de dominio completo: \u201cmaquina01.aso.com\u201d. Es decir, intenta resolver una ruta relativa de dominio (<code>PQDN</code>) a una ruta absoluta de dominio (<code>FQDN</code>).</li> <li>Recordatorio: se debe de aplicar los cambios con netplan apply.</li> </ul> <p>a. Se desactiva el servicio de resoluci\u00f3n de DNS.</p> <pre><code># Para y desactiva el servicio de resoluci\u00f3n de DNS\nsudo systemctl disable --now systemd-resolved\n\n# Elimina el link simb\u00f3lico de /etc/resolv.conf\nsudo unlink /etc/resolv.conf\n</code></pre> <p>b. Se crea un nuevo <code>resolv</code></p> <pre><code># Crea un nuevo archivo /etc/resolv.conf\nnano /etc/resolv.conf\n</code></pre> <p>c. Se introduce las siguientes l\u00edneas en el archivo nuevo.</p> <pre><code># Samba server IP address\nnameserver 192.168.2.4\n\n# fallback resolver Quad9\nnameserver 9.9.9.9\n\n# Dominio principal de Samba\nsearch aso.local\n</code></pre> <p>Cuidado</p> <p>La IP es la recibida en el servidor del <code>DHCP</code> de la RedNAT configurada</p> <p>d. Se hace inmutable el archivo para evitar que cualquier instalaci\u00f3n de otros servicios lo modifique autom\u00e1ticamente.</p> <pre><code># add attribute immutable to the file /etc/resolv.conf\nsudo chattr +i /etc/resolv.conf\n</code></pre> Configuraci\u00f3n de resoluci\u00f3n de nombres."},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#instalacion-samba-dc","title":"Instalaci\u00f3n Samba-DC","text":"<ol> <li>Se instalan los siguientes paquetes:</li> </ol> <pre><code>sudo apt-get update -y\nsudo apt-get install -y acl attr samba samba-dsdb-modules samba-vfs-modules smbclient winbind libpam-winbind libnss-winbind libpam-krb5 krb5-config krb5-user chrony net-tools\n</code></pre> <p>Donde se destacan los siguientes:</p> <ol> <li>Samba \u2192 En el paquete ya viene integrado un m\u00f3dulo de <code>LDAP</code> para almacenar los usuarios.</li> <li>krb5-config \u2192 Es la configuraci\u00f3n de <code>Kerberos</code> que usaremos en samba. Habr\u00e1 que instalarlo m\u00e1s adelante.</li> <li>winbind \u2192 Paquete necesario para que un cliente de <code>Windows</code> se pueda autentificar en nuestro sistema DC en Linux.</li> <li>smbclient \u2192 Se instala el cliente samba, simplemente para tener ciertos comandos de consulta, realmente no es necesario para montar el servidor.</li> </ol> <p>Durante la instalaci\u00f3n del Kerberos nos pedir\u00e1 3 cosas principalmente:</p> <ol> <li>El reino (realm): se indicar\u00e1 el mismo que el dominio configurado en el archivo de configuraci\u00f3n de red.</li> <li>La IP del servidor Kerberos: FQDN.</li> <li>La IP para la administraci\u00f3n del Kerberos: FQDN.</li> </ol> <p>Nota</p> <p>En este caso el servidor de kerberos va a estar en el propio controlador de dominio, pero en otra situaci\u00f3n se podr\u00eda tratar de una m\u00e1quina independiente.</p> Instalaci\u00f3n samba y paquetes necesarios. <ol> <li>A continuaci\u00f3n se necesita detener varios servicios instalados con anterioridad y que ahora ser\u00e1n gestionados a trav\u00e9s de Samba. Se paran y se deshabilitan.</li> </ol> <pre><code># stop and disable samba services - smbd, nmbd, and winbind\nsudo systemctl disable --now smbd nmbd winbind\n</code></pre> <ol> <li>Se activa el servicio samba-ad-dc mediante los siguientes comandos:</li> </ol> <pre><code>systemctl unmask samba-ad-dc\nsystemctl enable samba-ad-dc\n</code></pre> Instalaci\u00f3n samba y paquetes necesarios."},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#configuracion-samba-dc","title":"Configuraci\u00f3n Samba-DC","text":"<ol> <li>Antes de pasar a configurar Samba, es conveniente guardar el fichero de configuraci\u00f3n original, por si hubiera que retomar la instalaci\u00f3n desde este punto:</li> </ol> <pre><code>sudo mv /etc/samba/smb.conf /etc/samba/smb.conf.copia\n</code></pre> <ol> <li>El siguiente paso es configurar el controlador de dominio de <code>Samba</code> mediante el uso de samba-tool.</li> </ol> <pre><code>samba-tool domain provision --use-rfc2307 --interactive\n</code></pre> <p>Nota</p> <ul> <li>Dentro de la configuraci\u00f3n coger\u00e1 el reino/dominio del servidor, por lo tanto no se tiene que rellenar nada, excepto la parte de DNS forwarder que se usar\u00e1 Quad9, el cual es DNS recursivo p\u00fablico global que tiene como objetivo proteger a los usuarios del malware y el phishing. (9.9.9.9).</li> <li>La raz\u00f3n de esta configuraci\u00f3n es porque el servidor actuar\u00e1 como DNS, pero si no se puede resolver una p\u00e1gina pasaremos la solicitud de resoluci\u00f3n al servidor DNS forwarder (9.9.9.9).</li> </ul> <p>Advertencia</p> <p>Como contrase\u00f1a de administrador necesita tener una may\u00fascula/min\u00fascula/n\u00famero/longitud de 8. El usuario por defecto es \u201cadministrator\u201d, en este caso se usar\u00e1 AsoAula5</p> <ul> <li>Si todo ha salido bien, se crear\u00e1 el fichero <code>smb.conf</code> acorde con la configuraci\u00f3n:</li> </ul> Configuraci\u00f3n Samba y comprobaci\u00f3n. <ul> <li>[global]: Donde se puede observar todos los datos de configuraci\u00f3n del dominio, adem\u00e1s de los roles para los que se ha creado (DC-AD).</li> <li>[netlogon]: Ya ha creado de forma autom\u00e1tica la carpeta para los scripts de inicio de sesi\u00f3n de los clientes.</li> <li>[sysvol]: El sysvol es reponsable de replicar las GPOs (Pol\u00edticas de Grupos) aplicadas en el editor de directivas de grupo, todos los cambios y GPOs nuevos son replicados por all\u00ed.</li> </ul> <ol> <li>Ahora se instala Kerberos, antes solo se hab\u00eda asociado la configuraci\u00f3n a <code>Samba</code> (reino, dns, password, etc). Para ello se realiza una copia de seguridad de la configuraci\u00f3n actual y se sobrescribe la realizada por Samba.</li> </ol> <pre><code># Renombra la configuraci\u00f3n por defecto de Kerberos a krb5.conf.original\nsudo mv /etc/krb5.conf /etc/krb5.conf.original\n\n# Copia la configuraci\u00f3n generada samba-tool\nsudo cp /var/lib/samba/private/krb5.conf /etc/krb5.conf\n</code></pre> Configuraci\u00f3n Kerberos. <ol> <li>Se incializa el servicio de Samba</li> </ol> <pre><code># start samba-ad-dc service\nsudo systemctl start samba-ad-dc\n\n# verify samba-ad-dc service\nsudo systemctl status samba-ad-dc\n</code></pre> Inicia Samba y comprueba. <ol> <li>Se configura la sincronizaci\u00f3n del tiempo para que el servidor este en hora, con el objetivo de realizar de forma adecuada tareas de resoluci\u00f3n de incidencias.</li> </ol> <p>5.1. Se establecen los permisos para NTP (Network Time Protocol). En la instalaci\u00f3n de Samba se utiliz\u00f3 el paquete <code>chrony</code>, el cual es una implementaci\u00f3n del Network Time Protocol. Es una alternativa a ntpd, que es una implementaci\u00f3n de referencia de NTP. A continuaci\u00f3n se muestran los comando para dar los permisos adecuados a <code>chrony</code>.</p> <pre><code># Permite al grupo _chrony leer en el directorio ntp_signd\nsudo chown root:_chrony /var/lib/samba/ntp_signd/\n\n# Cambia los permisos en el directorio ntp_signd.\nsudo chmod 750 /var/lib/samba/ntp_signd/\n</code></pre> <p>5.2 Configuraci\u00f3n de <code>Chrony</code>, dentro del archivo de configuraci\u00f3n <code>/etc/chrony/chrony.conf</code> se a\u00f1aden las siguientes l\u00edneas:</p> <pre><code># bind el servicio de chrony a la direcci\u00f3n IP del Samba AD.\nbindcmdaddress 192.168.2.4\n\n# Permite a los clientes de la red conectar al Chrony NTP server en este caso:\nallow 192.168.2.0/24\n\n# Especifica el directorio del ntpsigndsocket para el Samba AD.\nntpsigndsocket /var/lib/samba/ntp_signd\n</code></pre> <p>5.3 Se reinicia el servicio y se comprueba su estado.</p> <pre><code># Reinicia el servicio chronyd.\nsudo systemctl restart chronyd\n\n# Verifica el estado de chronyd\nsudo systemctl status chronyd\n</code></pre> Instalaci\u00f3n y configuraci\u00f3n de chronyd."},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#comprobacion-del-samba-active-directory","title":"Comprobaci\u00f3n del Samba Active Directory","text":"<ol> <li>Verificaciones del dominio.</li> </ol> <pre><code># Verifica el Dominio\nhost -t A aso.local\n\n# Verifica el FQDN\nhost -t A profesor.aso.local\n</code></pre> <ol> <li>Comprobaci\u00f3n de <code>Kerberos</code> y <code>ldap</code>.</li> </ol> <pre><code># Comprobaci\u00f3n del registro SRV para _kerberos. \nhost -t SRV _kerberos._udp.aso.local\n\n# Comprobaci\u00f3n del registro SRV para _ldap\nhost -t SRV _ldap._tcp.aso.local\n</code></pre> <p>NOTA</p> <p>El registro <code>SRV</code> es un registro de recursos del sistema de nombres de dominio (<code>DNS</code>). Se usa para identificar equipos que hospedan servicios.</p> <ol> <li>Comprobar el <code>login</code> con el usuario <code>administrator</code> con el comando <code>kinit</code>.</li> </ol> <pre><code># Autenticate a Kerberos con el usuario administrator.\nkinit administrator@ASO.LOCAL\n\n# Verifica la lista de accesos.\nklist\n</code></pre> <p>Cuidado</p> <p>A tener en cuenta las may\u00fasculas del dominio en el comando <code>kinit</code>.</p> Comprobaciones"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#creacion-y-acceso-de-usuarios","title":"Creaci\u00f3n y acceso de usuarios","text":"<p>Existen diferentes formas de crear usuarios, se destacan dos:</p> <ol> <li>Mediante comandos de <code>Samba</code>.</li> <li>A trav\u00e9s de la herramienta de gesti\u00f3n <code>RSAT</code>.</li> </ol> <p>En esta secci\u00f3n se describe el primer m\u00e9todo:</p>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#crear-usuario-con-samba-tool","title":"Crear usuario con samba-tool","text":"<ul> <li>En este caso se utiliza los comandos de samba-tool para crear el usuario:</li> </ul> <pre><code># Crea un nuevo usuario en Samba.\nsudo samba-tool user create javi\n\n# Comprueba los usuarios de Samba.\nsudo samba-tool user list\n</code></pre> <p>Nota</p> <p>Como se ha explicado en secciones anteriores los usuarios creado en <code>Samba</code> deben estar creados tambi\u00e9n en el sistema.</p>"},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#acceso-al-samba-dc-desde-un-windows-client","title":"Acceso al Samba-DC desde un Windows Client","text":""},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#configuracion-de-dns-y-comprobacion","title":"Configuraci\u00f3n de DNS y comprobaci\u00f3n","text":"<ul> <li>Se accede al cliente, en este caso Windows 10 y se configuran los <code>DNS</code> del <code>Samba-DC</code>.</li> </ul> Configuraci\u00f3n DNS de Samba-DC en WinClient. <ul> <li>Por otro lado se pueden comprobar los DNS mediante comandos de PowerShell.</li> </ul> <pre><code># En Powershell\nGet-DnsClientServerAddress\n\n# ping al AD domain profesor.aso.local\nping profesor.aso.local\n\n# ping al AD domain aso.local\nping aso.local\n</code></pre> Comprobaci\u00f3n DNS con PowerShell."},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#anadir-cliente-al-active-directory-con-powershell","title":"A\u00f1adir cliente al Active Directory con PowerShell","text":"<ul> <li>El siguiente paso es a\u00f1adir el Cliente al Controlador de Dominio, y en este caso lo vamos a hacer por PowerShell con el siguiente comando:</li> </ul> <pre><code># A\u00f1ade Windows 10 al Active Directory usando POWERSHELL\nAdd-Computer -DomainName \"aso.local\" -Restart\n</code></pre> A\u00f1adir cliente al dominio mediante PowerShell. <p>Nota</p> <p>Al reiniciar debe aparecer el login para el Dominio.</p> <ul> <li>Comprobaci\u00f3n de usuarios en el DC desde el Windows Client.</li> </ul> Comprobaci\u00f3n usuarios desde W10."},{"location":"04_SAMBA_DC/042_InstallConfigSambaDC.html#acceso-samba-dc-desde-un-fedora","title":"Acceso Samba-DC desde un fedora","text":"<p>Ubuntu Server</p> <p>En el Ubuntu Server es necesario a\u00f1adir repositorios.</p> <ol> <li>En Ubuntu Server, es necesario a\u00f1adir los repositorios del \"Universe\".</li> </ol> <pre><code>sudo add-apt-repository universe\nsudo add-apt-repository multiverse\nsudo apt update\n</code></pre> <p>Cliente</p> <p>En el cliente.</p> <ol> <li>Se Establece nombre de host.</li> </ol> <pre><code>sudo hostnamectl set-hostname fedora.aso.local\n</code></pre> <ol> <li>En Fedora, se edita la configuraci\u00f3n Resolved.</li> </ol> <pre><code>nano /etc/systemd/resolved.conf\n\n# A\u00f1ade las siguientes l\u00edneas\n[Resolve]\nDNS=192.168.2.4 9.9.9.9 8.8.8.8\n\n# Guarda y reinicia el servicio.\nsudo systemctl restart systemd-resolved\n</code></pre> <p>Ubuntu Server</p> <p>De nuevo en el Ubuntu Server es necesario a\u00f1adir unos paquetes.</p> <ol> <li>Se Instalan los paquetes necesarios (solo Ubuntu)</li> </ol> <pre><code>sudo apt -y install realmd libnss-sss libpam-sss sssd sssd-tools adcli samba-common-bin oddjob oddjob-mkhomedir packagekit\n</code></pre> <p>Cliente</p> <p>Ya en el cliente.</p> <ol> <li>(Opcional) Descubrir dominio.</li> </ol> <pre><code>sudo realm discover aso.local\n</code></pre> <ol> <li>Se a\u00f1ade al dominio.</li> </ol> <pre><code>sudo realm join -U Administrator aso.local\n</code></pre> <p>Nota</p> <p>Al reiniciar el cliente se podr\u00e1 iniciar sesi\u00f3n como usuario del dominio.</p>"},{"location":"04_SAMBA_DC/043_GestionRecursosSambaDC.html","title":"Gesti\u00f3n de recursos compartidos en Samba DC","text":""},{"location":"04_SAMBA_DC/043_GestionRecursosSambaDC.html#pt41-gestion-de-recursos-compartidos-en-samba-dc","title":"PT41. Gesti\u00f3n de recursos compartidos en Samba DC","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE6 y CE7 del RA4 de SOR.</p> <p>Tareas</p> <ul> <li>Adjunta diferentes v\u00eddeos con las principales secciones realizadas para desarrollar los recursos compartidos en Samba DC descritos en el siguiente enunciado.</li> </ul> <p>Tal y como se plantea en la situaci\u00f3n de aprendizaje trabajas para el departamento TIC de NetOS, y acaba de aparecer el siguiente proyecto para la integraci\u00f3n de Samba DC.</p> <p>Instalaci\u00f3n y configuraci\u00f3n de Samba DC en un servidor Linux con sistema operativo <code>Ubuntu 22.04.</code> de la empresa dedicada a la venta de material fotogr\u00e1fico Area Studio, la cual cuenta con setenta empleados, pero durante el proceso de instalaci\u00f3n se crean los usuarios responsables de departamento los indicados en la tabla siguiente: </p> Nombre Apellido Inicio de sesi\u00f3n Posici\u00f3n Contrase\u00f1a Eduard Casavella eduard.casavella Gerente casavella1 Pep Terr\u00f3n pep.terron Responsable IT terron1 Fran Delgado fran.delgado Administraci\u00f3n delgado1 Marcos Sabates marcos.sabates Comercial sabates1 Irene Masot irene.masot RR HH masot1 <p>Pasos a realizar:</p> <ul> <li>Instala y configura Samba DC apoy\u00e1ndote en la gu\u00eda de la <code>secci\u00f3n 4.2</code>.</li> <li>Crea los usuarios en la empresa con los datos indicados en la tabla.</li> <li>Genera una estructura de carpetas de empresa (a desarrollar) de los diferentes departamentos y aplica niveles de seguridad de acceso a los mismos. Recuerda los conocimientos adquiridos en la UT anterior.</li> <li>Comprueba el acceso de dichos usuarios desde un cliente Windows y el acceso adecuado a los directorios creados de cada departamento.</li> </ul>"},{"location":"04_SAMBA_DC/044_RefuerzoAmpliacion.html","title":"Refuerzo y Ampliaci\u00f3n","text":"<p>A continuaci\u00f3n se definen las actividades de refuerzo y ampliaci\u00f3n de la UT4</p>"},{"location":"04_SAMBA_DC/044_RefuerzoAmpliacion.html#refuerzo","title":"Refuerzo","text":""},{"location":"04_SAMBA_DC/044_RefuerzoAmpliacion.html#pt42-samba-dc-directorios","title":"PT42. Samba DC directorios","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE6 y CE7 del RA4 de SOR.</p> <p>Tareas</p> <p>A partir de la gu\u00eda adjunta en la pr\u00e1ctica PT41 realiza la organizaci\u00f3n y configuraci\u00f3n de los los directorios de los departamentos (4 al menos) de una empresa ficticia mediante Samba DC, realiza una serie de restricciones entre al menos dos usuarios de la empresa. Realiza un v\u00eddeo con los pasos realizados.</p>"},{"location":"04_SAMBA_DC/044_RefuerzoAmpliacion.html#ampliacion","title":"Ampliaci\u00f3n","text":""},{"location":"04_SAMBA_DC/044_RefuerzoAmpliacion.html#pt43-samba-dc-con-docker-compose","title":"PT43. Samba DC con Docker Compose","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE61, CE62, CE63, CE64, CE65, CE9 del RA6 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <ul> <li>Tu coordinadora en NetOS te solicita que realices un docker compose para la instalaci\u00f3n de Samba DC de una forma r\u00e1pida y eficiente</li> </ul> <p>Tareas</p> <p>Realiza un archivo yaml con el Docker compose de Samba DC.</p>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html","title":"SAMBA DOMAIN CONTROLLER","text":""},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#actividades-tipo-proyecto-aea","title":"Actividades tipo Proyecto (AEA)","text":""},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#pr61-introduccion-y-configuracion-de-samba-dc","title":"PR61. Introducci\u00f3n y configuraci\u00f3n de Samba DC","text":"<p>Tal y como se plantea en la situaci\u00f3n de aprendizaje trabajas para el departamento TIC de ASOps, y acaban de aparecer los siguientes proyectos para la integraci\u00f3n de Samba DC.</p> <p>Instalaci\u00f3n y configuraci\u00f3n de Samba DC en los siguientes servidores Linux:</p> <ul> <li>Red Hat.</li> <li>Centos.</li> <li>Debian.</li> <li>Fedora.</li> <li>OpenSuse</li> </ul> <p>Debes de elegir la distribuci\u00f3n a implementar Samba DC y desarrollar con tu grupo para poder loguear clientes Windows y compartir recursos entre ellos. Tareas a realizar:</p> <ul> <li>Desarrollad un informe con las capturas explicadas de los principales pasos de esta gu\u00eda y sus comprobaciones.</li> <li>A\u00f1adid un usuario mediante Webmin. Reinicia W10 y logueate con este nuevo usuario.</li> <li>Eligid de entre estas dos distribuciones de Linux Red Hat, Manjaro o Fedora para a\u00f1adir el cliente al AD y loguearte con alguno de los usuarios configurados.</li> <li>Genera una estructura de carpetas de empresa (a desarrollar) de los diferentes departamentos y aplica niveles de seguridad de acceso a los mismos.</li> </ul> <p>Nota</p> <p>A\u00f1adid capturas con sus correspondientes aclaraciones en cada aparatado.</p>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#guia-samba-dc-ubuntu-server","title":"Gu\u00eda Samba DC Ubuntu Server","text":"<p>Los objetivos de esta gu\u00eda son:</p> <ul> <li>Preparaci\u00f3n del servidor.</li> <li>Instalar el Controlador de Dominio en Samba.</li> <li>Acceder y Crear clientes de windows.</li> <li>Activar la aplicaci\u00f3n de gesti\u00f3n RSAT.</li> </ul> <p>Webgraf\u00eda</p>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#recordatorio-controlador-de-dominio-dc","title":"Recordatorio Controlador de Dominio (DC).","text":"<ul> <li>Es un servidor que se ocupa de permitir el acceso de determinados usuarios a recursos compartidos del dominio.</li> <li>Un dominio es un grupo de recursos (equipos, ficheros, usuarios, impresoras, etc.) dentro de una red. El acceso a dicho dominio o las pol\u00edticas de seguridad de todos esos recursos es administrada por el controlador de dominio.</li> <li>Habitualmente se implementan en Windows Server, aunque tambi\u00e9n se pueden implementar en Linux bajo samba.</li> <li>En una implementaci\u00f3n adecuada, se despliega m\u00e1s de un controlador de dominio a la vez que act\u00faan como uno (cluster) de esta forma se dota al servicio de redundancia y alta disponibilidad, es decir, que si se produce una aver\u00eda en un control de dominio el servicio sigue activo pues hay otro/s controladores activos.</li> <li>Los dominios usan rutas de nombres similares a los DNS, tienen una ruta absoluta FQDN (Full Qualified Domain Name) y una ruta relativa PQDN (Partially Qualified Domain Name).</li> </ul> <p>NOTA:</p> <p>Independientemente del sistema operativo usado necesitaremos de otros servicios para complementar, a continuaci\u00f3n se enumeran:</p> <ul> <li>LDAP: Ser\u00e1 la base de datos que alberga la informaci\u00f3n de los usuarios.</li> <li>Kerberos: Se encarga de la seguridad a nivel de autentificaci\u00f3n segura de los usuarios.</li> <li>DNS: Habitualmente el acceso al dominio se hace a trav\u00e9s de un nombre de dominio. El servicio DNS permite la resoluci\u00f3n de ese nombre de dominio al direccionamiento IP.</li> <li>NTP: Es el servicio que se encarga de la sincronizaci\u00f3n del reloj de cada m\u00e1quina.</li> </ul>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#preparacion","title":"Preparaci\u00f3n","text":"<p>Antes de la instalaci\u00f3n del Controlador de Dominio o Domain Controler DC mediante <code>Samba</code>, es necesaria, la preparaci\u00f3n del servidor a nivel de red y dominio. Para ello se detallan los siguientes pasos:</p> <ol> <li>Restaura un snapshot \"limpio\" de tu m\u00e1quina virtual de <code>Ubuntu 22.04</code> y se realiza un update.</li> </ol> Comprobaci\u00f3n versi\u00f3n Ubuntu. <ol> <li>Configura la m\u00e1quina virtual en formato \u201cNat Network\u201d.</li> </ol> <ol> <li>A continuaci\u00f3n se establece el nombre de host del servidor este caso <code>profesor.aso.local</code> y se a\u00f1ade el servidor al archivo de hosts.</li> </ol> <p>CUIDADO</p> <p>Se debe cambiar profesor por el nombre de la alumna o alumno.</p> <p>3.1. Cambio de nombre de hosts a profesor.</p> <pre><code>hostnamectl set-hostname profesor\n</code></pre> <p>3.2. El fichero <code>/etc/hosts</code> es como un servicio DNS local, es decir, tiene una serie de pares <code>nombres/IP</code> que resuelve localmente.   1. Realiza una copia de seguridad del fichero <code>/etc/hosts</code>.   2. Modifica el fichero original (<code>/etc/hosts</code>) para que resuelva el nombre de tu m\u00e1quina y tu FQDN en este caso <code>profesor.aso.local</code>.   3. Comprueba con un ping a los nombres que funciona y te contesta con la IP.</p> <p>Por ejemplo</p> <p>Inicialmente En este caso el servidor se llama aso, por lo tanto si se realiza un ping a <code>aso</code> antes de modificar el /etc/hosts la m\u00e1quina debe saber resolverlo a la IP <code>127.0.1.1</code> que por defecto en ubuntu se utiliza para determinar la direcci\u00f3n IP que corresponde al nombre de host.</p> <ul> <li>En este caso el fichero modificado quedar\u00eda:</li> </ul> <pre><code>127.0.0.1 localhost\n192.168.2.4 profesor.aso.local profesor\n\n# The following lines are desirable for IPv6 capable hosts\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre> <p>Cuidado</p> <p>La nueva IP es la recibida en el servidor del <code>DHCP</code> de la RedNAT configurada.</p> <p>3.3. Ejecuci\u00f3n y comprobaci\u00f3n.</p> <pre><code># verifica FQDN\nhostname -f\n\n# verifica FQDN si resuelve a la IP del servidor\nping -c3 profesor.aso.local\n</code></pre> Modificaci\u00f3n del /etc/hosts y comprobaciones de ping. <ol> <li>Se configura la resoluci\u00f3n de nombres en el archivo <code>resolv.conf</code> encargado de redireccionar las peticiones de <code>DNS</code>.</li> </ol> <p>A tener en cuenta</p> <ul> <li>Para realizar un dominio de b\u00fasqueda (Search Domain), el cual nos va a permitir que si el servidor recibe una b\u00fasqueda de petici\u00f3n de un recurso, por ejemplo \u201cmaquina01\u201d, autom\u00e1ticamente el servidor va intentar buscar por el nombre de dominio completo: \u201cmaquina01.aso.com\u201d. Es decir, intenta resolver una ruta relativa de dominio (<code>PQDN</code>) a una ruta absoluta de dominio (<code>FQDN</code>).</li> <li>Recordatorio: se debe de aplicar los cambios con netplan apply.</li> </ul> <p>a. Se desactiva el servicio de resoluci\u00f3n de DNS.</p> <pre><code># Para y desactiva el servicio de resoluci\u00f3n de DNS\nsudo systemctl disable --now systemd-resolved\n\n# Elimina el link simb\u00f3lico de /etc/resolv.conf\nsudo unlink /etc/resolv.conf\n</code></pre> <p>b. Se crea un nuevo <code>resolv</code></p> <pre><code># Crea un nuevo archivo /etc/resolv.conf\nnano /etc/resolv.conf\n</code></pre> <p>c. Se introduce las siguientes l\u00edneas en el archivo nuevo.</p> <pre><code># Samba server IP address\nnameserver 192.168.2.4\n\n# fallback resolver Quad9\nnameserver 9.9.9.9\n\n# Dominio principal de Samba\nsearch aso.local\n</code></pre> <p>Cuidado</p> <p>La IP es la recibida en el servidor del <code>DHCP</code> de la RedNAT configurada</p> <p>d. Se hace inmutable el archivo para evitar que cualquier instalaci\u00f3n de otros servicios lo modifique autom\u00e1ticamente.</p> <pre><code># add attribute immutable to the file /etc/resolv.conf\nsudo chattr +i /etc/resolv.conf\n</code></pre> Configuraci\u00f3n de resoluci\u00f3n de nombres."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#instalacion-samba-dc","title":"Instalaci\u00f3n Samba-DC","text":"<ol> <li>Se instalan los siguientes paquetes:</li> </ol> <pre><code>sudo apt-get update -y\nsudo apt-get install -y acl attr samba samba-dsdb-modules samba-vfs-modules smbclient winbind libpam-winbind libnss-winbind libpam-krb5 krb5-config krb5-user chrony net-tools\n</code></pre> <p>Donde se destacan los siguientes:</p> <ol> <li>Samba \u2192 En el paquete ya viene integrado un m\u00f3dulo de <code>LDAP</code> para almacenar los usuarios.</li> <li>krb5-config \u2192 Es la configuraci\u00f3n de <code>Kerberos</code> que usaremos en samba. Habr\u00e1 que instalarlo m\u00e1s adelante.</li> <li>winbind \u2192 Paquete necesario para que un cliente de <code>Windows</code> se pueda autentificar en nuestro sistema DC en Linux.</li> <li>smbclient \u2192 Se instala el cliente samba, simplemente para tener ciertos comandos de consulta, realmente no es necesario para montar el servidor.</li> </ol> <p>Durante la instalaci\u00f3n del Kerberos nos pedir\u00e1 3 cosas principalmente:</p> <ol> <li>El reino (realm): se indicar\u00e1 el mismo que el dominio configurado en el archivo de configuraci\u00f3n de red.</li> <li>La IP del servidor Kerberos: FQDN.</li> <li>La IP para la administraci\u00f3n del Kerberos: FQDN.</li> </ol> <p>Nota</p> <p>En este caso el servidor de kerberos va a estar en el propio controlador de dominio, pero en otra situaci\u00f3n se podr\u00eda tratar de una m\u00e1quina independiente.</p> Instalaci\u00f3n samba y paquetes necesarios. <ol> <li>A continuaci\u00f3n se necesita detener varios servicios instalados con anterioridad y que ahora ser\u00e1n gestionados a trav\u00e9s de Samba. Se paran y se deshabilitan.</li> </ol> <pre><code># stop and disable samba services - smbd, nmbd, and winbind\nsudo systemctl disable --now smbd nmbd winbind\n</code></pre> <ol> <li>Se activa el servicio samba-ad-dc mediante los siguientes comandos:</li> </ol> <pre><code>systemctl unmask samba-ad-dc\nsystemctl enable samba-ad-dc\n</code></pre> Instalaci\u00f3n samba y paquetes necesarios."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#configuracion-samba-dc","title":"Configuraci\u00f3n Samba-DC","text":"<ol> <li>Antes de pasar a configurar Samba, es conveniente guardar el fichero de configuraci\u00f3n original, por si hubiera que retomar la instalaci\u00f3n desde este punto:</li> </ol> <pre><code>sudo mv /etc/samba/smb.conf /etc/samba/smb.conf.copia\n</code></pre> <ol> <li>El siguiente paso es configurar el controlador de dominio de <code>Samba</code> mediante el uso de samba-tool.</li> </ol> <pre><code>samba-tool domain provision --use-rfc2307 --interactive\n</code></pre> <p>Nota</p> <ul> <li>Dentro de la configuraci\u00f3n coger\u00e1 el reino/dominio del servidor, por lo tanto no se tiene que rellenar nada, excepto la parte de DNS forwarder que se usar\u00e1 Quad9, el cual es DNS recursivo p\u00fablico global que tiene como objetivo proteger a los usuarios del malware y el phishing. (9.9.9.9).</li> <li>La raz\u00f3n de esta configuraci\u00f3n es porque el servidor actuar\u00e1 como DNS, pero si no se puede resolver una p\u00e1gina pasaremos la solicitud de resoluci\u00f3n al servidor DNS forwarder (9.9.9.9).</li> </ul> <p>Advertencia</p> <p>Como contrase\u00f1a de administrador necesita tener una may\u00fascula/min\u00fascula/n\u00famero/longitud de 8. El usuario por defecto es \u201cadministrator\u201d, en este caso se usar\u00e1 AsoAula5</p> <ul> <li>Si todo ha salido bien, se crear\u00e1 el fichero <code>smb.conf</code> acorde con la configuraci\u00f3n:</li> </ul> Configuraci\u00f3n Samba y comprobaci\u00f3n. <ul> <li>[global]: Donde se puede observar todos los datos de configuraci\u00f3n del dominio, adem\u00e1s de los roles para los que se ha creado (DC-AD).</li> <li>[netlogon]: Ya ha creado de forma autom\u00e1tica la carpeta para los scripts de inicio de sesi\u00f3n de los clientes.</li> <li>[sysvol]: El sysvol es reponsable de replicar las GPOs (Pol\u00edticas de Grupos) aplicadas en el editor de directivas de grupo, todos los cambios y GPOs nuevos son replicados por all\u00ed.</li> </ul> <ol> <li>Ahora se instala Kerberos, antes solo se hab\u00eda asociado la configuraci\u00f3n a <code>Samba</code> (reino, dns, password, etc). Para ello se realiza una copia de seguridad de la configuraci\u00f3n actual y se sobrescribe la realizada por Samba.</li> </ol> <pre><code># Renombra la configuraci\u00f3n por defecto de Kerberos a krb5.conf.original\nsudo mv /etc/krb5.conf /etc/krb5.conf.original\n\n# Copia la configuraci\u00f3n generada samba-tool\nsudo cp /var/lib/samba/private/krb5.conf /etc/krb5.conf\n</code></pre> Configuraci\u00f3n Kerberos. <ol> <li>Se incializa el servicio de Samba</li> </ol> <pre><code># start samba-ad-dc service\nsudo systemctl start samba-ad-dc\n\n# verify samba-ad-dc service\nsudo systemctl status samba-ad-dc\n</code></pre> Inicia Samba y comprueba. <ol> <li>Se configura la sincronizaci\u00f3n del tiempo para que el servidor este en hora, con el objetivo de realizar de forma adecuada tareas de resoluci\u00f3n de incidencias.</li> </ol> <p>5.1. Se establecen los permisos para NTP (Network Time Protocol). En la instalaci\u00f3n de Samba se utiliz\u00f3 el paquete <code>chrony</code>, el cual es una implementaci\u00f3n del Network Time Protocol. Es una alternativa a ntpd, que es una implementaci\u00f3n de referencia de NTP. A continuaci\u00f3n se muestran los comando para dar los permisos adecuados a <code>chrony</code>.</p> <pre><code># Permite al grupo _chrony leer en el directorio ntp_signd\nsudo chown root:_chrony /var/lib/samba/ntp_signd/\n\n# Cambia los permisos en el directorio ntp_signd.\nsudo chmod 750 /var/lib/samba/ntp_signd/\n</code></pre> <p>5.2 Configuraci\u00f3n de <code>Chrony</code>, dentro del archivo de configuraci\u00f3n <code>/etc/chrony/chrony.conf</code> se a\u00f1aden las siguientes l\u00edneas:</p> <pre><code># bind el servicio de chrony a la direcci\u00f3n IP del Samba AD.\nbindcmdaddress 192.168.2.4\n\n# Permite a los clientes de la red conectar al Chrony NTP server en este caso:\nallow 192.168.2.0/24\n\n# Especifica el directorio del ntpsigndsocket para el Samba AD.\nntpsigndsocket /var/lib/samba/ntp_signd\n</code></pre> <p>5.3 Se reinicia el servicio y se comprueba su estado.</p> <pre><code># Reinicia el servicio chronyd.\nsudo systemctl restart chronyd\n\n# Verifica el estado de chronyd\nsudo systemctl status chronyd\n</code></pre> Instalaci\u00f3n y configuraci\u00f3n de chronyd."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#comprobacion-del-samba-active-directory","title":"Comprobaci\u00f3n del Samba Active Directory","text":"<ol> <li>Verificaciones del dominio.</li> </ol> <pre><code># Verifica el Dominio\nhost -t A aso.local\n\n# Verifica el FQDN\nhost -t A profesor.aso.local\n</code></pre> <ol> <li>Comprobaci\u00f3n de <code>Kerberos</code> y <code>ldap</code>.</li> </ol> <pre><code># Comprobaci\u00f3n del registro SRV para _kerberos. \nhost -t SRV _kerberos._udp.aso.local\n\n# Comprobaci\u00f3n del registro SRV para _ldap\nhost -t SRV _ldap._tcp.aso.local\n</code></pre> <p>NOTA</p> <p>El registro <code>SRV</code> es un registro de recursos del sistema de nombres de dominio (<code>DNS</code>). Se usa para identificar equipos que hospedan servicios.</p> <ol> <li>Comprobar el <code>login</code> con el usuario <code>administrator</code> con el comando <code>kinit</code>.</li> </ol> <pre><code># Autenticate a Kerberos con el usuario administrator.\nkinit administrator@ASO.LOCAL\n\n# Verifica la lista de accesos.\nklist\n</code></pre> <p>Cuidado</p> <p>A tener en cuenta las may\u00fasculas del dominio en el comando <code>kinit</code>.</p> Comprobaciones"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#creacion-y-acceso-de-usuarios","title":"Creaci\u00f3n y acceso de usuarios","text":"<p>Existen diferentes formas de crear usuarios, se destacan dos:</p> <ol> <li>Mediante comandos de <code>Samba</code>.</li> <li>A trav\u00e9s de la herramienta de gesti\u00f3n <code>RSAT</code>.</li> </ol> <p>A continuaci\u00f3n se describen ambos m\u00e9todos:</p>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#crear-usuario-con-samba-tool","title":"Crear usuario con samba-tool","text":"<ul> <li>En este caso se utiliza los comandos de samba-tool para crear el usuario:</li> </ul> <pre><code># Crea un nuevo usuario en Samba.\nsudo samba-tool user create javi\n\n# Comprueba los usuarios de Samba.\nsudo samba-tool user list\n</code></pre> <p>Nota</p> <p>Como se ha explicado en secciones anteriores los usuarios creado en <code>Samba</code> deben estar creados tambi\u00e9n en el sistema.</p>"},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#acceso-al-samba-dc-desde-un-windows-client","title":"Acceso al Samba-DC desde un Windows Client","text":""},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#configuracion-de-dns-y-comprobacion","title":"Configuraci\u00f3n de DNS y comprobaci\u00f3n","text":"<ul> <li>Se accede al cliente, en este caso Windows 10 y se configuran los <code>DNS</code> del <code>Samba-DC</code>.</li> </ul> Configuraci\u00f3n DNS de Samba-DC en WinClient. <ul> <li>Por otro lado se pueden comprobar los DNS mediante comandos de PowerShell.</li> </ul> <pre><code># En Powershell\nGet-DnsClientServerAddress\n\n# ping al AD domain profesor.aso.local\nping profesor.aso.local\n\n# ping al AD domain aso.local\nping aso.local\n</code></pre> Comprobaci\u00f3n DNS con PowerShell."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#anadir-cliente-al-active-directory-con-powershell","title":"A\u00f1adir cliente al Active Directory con PowerShell","text":"<ul> <li>El siguiente paso es a\u00f1adir el Cliente al Controlador de Dominio, y en este caso lo vamos a hacer por PowerShell con el siguiente comando:</li> </ul> <pre><code># A\u00f1ade Windows 10 al Active Directory usando POWERSHELL\nAdd-Computer -DomainName \"aso.local\" -Restart\n</code></pre> A\u00f1adir cliente al dominio mediante PowerShell. <p>Nota</p> <p>Al reiniciar debe aparecer el login para el Dominio.</p> <ul> <li>Comprobaci\u00f3n de usuarios en el DC desde el Windows Client.</li> </ul> Comprobaci\u00f3n usuarios desde W10."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#descargar-y-activar-la-aplicacion-rsat","title":"Descargar y Activar la Aplicaci\u00f3n RSAT","text":"<p>RSAT (Remote Server Administration Tools) es una aplicaci\u00f3n cuyo objetivo es administrar el servidor pensada para instalarse en clientes que replica las herramientas disponibles en el controlador del dominio.</p> <p>La aplicaci\u00f3n se puede descargar del siguiente enlace RSAT</p> <ul> <li>Se descarga e instala:</li> </ul> Descarga e instalaci\u00f3n de RSAT en W10. <p>Nota</p> <ul> <li>Se debe reiniciar para que aparezca en herramientas administrativas, las aplicaciones del AD.</li> </ul> <ul> <li>Otra opci\u00f3n de instalaci\u00f3n de diferentes paquetes.</li> </ul> Herramientas del AD. Herramientas del AD II."},{"location":"04_SAMBA_DC/AyudaASO/064_SambaDC.html#acceso-samba-dc-desde-un-fedora","title":"Acceso Samba-DC desde un fedora","text":"<p>Ubuntu Server</p> <p>En el Ubuntu Server es necesario a\u00f1adir repositorios.</p> <ol> <li>En Ubuntu Server, es necesario a\u00f1adir los repositorios del \"Universe\".</li> </ol> <pre><code>sudo add-apt-repository universe\nsudo add-apt-repository multiverse\nsudo apt update\n</code></pre> <p>Cliente</p> <p>En el cliente.</p> <ol> <li>Se Establece nombre de host.</li> </ol> <pre><code>sudo hostnamectl set-hostname fedora.aso.local\n</code></pre> <ol> <li>En Fedora, se edita la configuraci\u00f3n Resolved.</li> </ol> <pre><code>nano /etc/systemd/resolved.conf\n\n# A\u00f1ade las siguientes l\u00edneas\n[Resolve]\nDNS=192.168.2.4 9.9.9.9 8.8.8.8\n\n# Guarda y reinicia el servicio.\nsudo systemctl restart systemd-resolved\n</code></pre> <p>Ubuntu Server</p> <p>De nuevo en el Ubuntu Server es necesario a\u00f1adir unos paquetes.</p> <ol> <li>Se Instalan los paquetes necesarios (solo Ubuntu)</li> </ol> <pre><code>sudo apt -y install realmd libnss-sss libpam-sss sssd sssd-tools adcli samba-common-bin oddjob oddjob-mkhomedir packagekit\n</code></pre> <p>Cliente</p> <p>Ya en el cliente.</p> <ol> <li>(Opcional) Descubrir dominio.</li> </ol> <pre><code>sudo realm discover aso.local\n</code></pre> <ol> <li>Se a\u00f1ade al dominio.</li> </ol> <pre><code>sudo realm join -U Administrator aso.local\n</code></pre> <p>Nota</p> <p>Al reiniciar el cliente se podr\u00e1 iniciar sesi\u00f3n como usuario del dominio.</p>"},{"location":"05_VAGRANT/051_VagrantIntro.html","title":"Introducci\u00f3n a Entornos de desarrollo virtualizados - Vagrant","text":""},{"location":"05_VAGRANT/051_VagrantIntro.html#introduccion-vagrant","title":"Introducci\u00f3n Vagrant","text":"<p>Actualmente el auge del desarrollo de aplicaciones en sistemas virtualizados requiere del despliegue, conectividad y flexibilidad de sistemas heterog\u00e9neos en escenarios de desarrollo de trabajo y producci\u00f3n.</p> <p>Una de las herramientas m\u00e1s utilizadas por los SRE (Site Reliability Engineer) es Vagrant, para conseguir el objetivo principal de crear sistemas de software altamente confiables y escalables. Vagrant es una herramienta para la creaci\u00f3n y configuraci\u00f3n de entornos de desarrollo virtualizados que cubre las necesidades comentadas.</p> <p>Motivado por dicha relevancia a continuaci\u00f3n se introduce la herramienta de Devops Vagrant.</p>"},{"location":"05_VAGRANT/051_VagrantIntro.html#que-es-vagrant","title":"\u00bfQu\u00e9 es Vagrant?","text":"<ul> <li>Es una herramienta para construir entornos de desarrollo simples, con un flujo de trabajo f\u00e1cil de usar y un enfoque en la automatizaci\u00f3n replicable. Permite crear y destruir los escenarios en repetidas ocasiones sin gran esfuerzo.</li> <li>Esencialmente, es una capa de software instalada entre una herramienta de virtualizaci\u00f3n (como VirtualBox, Docker, Hyper-V) y una m\u00e1quina virtual.</li> <li>Por lo tanto, es un software para automatizar las operaciones que se realizan con los hipervisores:</li> </ul> <p>Por ejemplo</p> <ul> <li>Crear, configurar, parar, suspender y destruir ma\u0301quinas virtuales.</li> <li>Gestionar redes.</li> <li>Compartir espacios de disco entre guest y host.</li> <li>Manejar distintos tipos de hipervisores.</li> </ul> <ul> <li>Es un software de c\u00f3digo libre disponible bajo una licencia <code>MIT</code>. El c\u00f3digo fuente est\u00e1 disponible en Github.</li> <li>Fue desarrollado originalmente por Mitchell Hashimoto en 2010. A partir de Vagrant se creo Hashicorp en 2012.</li> </ul> <p>HASHICORP</p> <p>Aplicaciones de Hashicorp</p> <ul> <li>Packer (ima\u0301genes de vagrant)</li> <li>Consul (descubrimiento de servicios)</li> <li>Terraform (aprovisionamiento)</li> <li>Vault (seguridad)</li> <li>Nomad (despliegue contenedores)</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Puede integrarse con herramientas de gesti\u00f3n de la configuraci\u00f3n, automatizando la provisio\u0301n de software de la ma\u0301quina virtual.</li> <li>Forma parte del conjunto de aplicaciones utilizadas en \"infraestructura como c\u00f3digo\", mediante un fichero de texto que puede formar parte del co\u0301digo fuente del proyecto, por lo que puede subirse al control de versiones y ser compartido por todos los desarrolladores, dicho fichero es denominado Vagrant file.</li> <li>Soluciona problemas de incidencias de desarrollo entre diferentes sistemas.</li> </ul> <p>Incidencias</p> <p>El problema de configurar escenarios a mano conlleva un trabajo tedioso y provoca errores, dando lugar al reproche de En mi m\u00e1quina funciona.</p> <p>Soluci\u00f3n</p> <ul> <li>Vagrant: para Distribuir de forma separada ima\u0301genes \u201climpias\u201d de OS y la configuracio\u0301n completa en un fichero de texto que es el que se distribuye por el grupo de trabajo.</li> <li>Reduce el tiempo de configuraci\u00f3n del entorno de desarrollo, aumenta la paridad de desarrollo/producci\u00f3n y hace que la excusa de \"funciona en mi m\u00e1quina\" sea una reliquia del pasado.</li> <li>A menudo se utiliza en el desarrollo de software para garantizar que todos los miembros del equipo est\u00e9n construyendo para la misma configuraci\u00f3n. </li> <li>No solo comparte entornos, sino que tambi\u00e9n comparte c\u00f3digo. Esto permite que el c\u00f3digo de un desarrollador trabaje en el sistema de otro, haciendo posible el desarrollo colaborativo y cooperativo.</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#vagrant-vs-docker","title":"Vagrant vs. Docker","text":"<ul> <li><code>Vagrant</code> es una herramienta centrada en proporcionar un flujo de trabajo de entorno de desarrollo coherente en m\u00faltiples sistemas operativos, trabajando sobre los hipervisores. </li> <li>Docker es una gesti\u00f3n de contenedores que puede ejecutar software de forma consistente siempre y cuando exista un sistema de contenedorizaci\u00f3n.</li> <li>Los contenedores son generalmente m\u00e1s ligeros que las m\u00e1quinas virtuales, por lo que iniciar y detener los contenedores es extremadamente r\u00e1pido. Docker utiliza la funcionalidad de contenedorizaci\u00f3n nativa en macOS, Linux y Windows. </li> <li>Para entornos de microservicios pesados, Docker puede ser atractivo porque puede iniciar f\u00e1cilmente una sola m\u00e1quina virtual Docker e iniciar muchos contenedores por encima de eso muy r\u00e1pidamente. Este es un buen caso de uso para Docker. </li> <li><code>Vagrant</code> tambi\u00e9n puede hacer esto con el proveedor de Docker. Un beneficio principal para Vagrant es un flujo de trabajo consistente, pero hay muchos casos en los que un flujo de trabajo de Docker puro tiene sentido.</li> <li>Tanto Vagrant como Docker tienen una vasta biblioteca de \"im\u00e1genes\" o \"boxes\" para elegir.</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#instalacion-vagrant","title":"Instalaci\u00f3n Vagrant","text":"<p>Para la instalaci\u00f3n el mejor consejo es acudir a la documentaci\u00f3n oficial, en el siguiente enlace se pueden obtener los comandos de instalaci\u00f3n de Vagrant para los diferentes tipos de sistemas operativos:</p> <p>INSTALACI\u00d3N VAGRANT</p> <p>Nota</p> <p>En este caso se realiza la ejecuci\u00f3n de los comandos para la instalaci\u00f3n por repositorios en las distribuciones de Ubuntu/debian.</p> <ol> <li>Descarga de las GPG: GNU Privacy Guard es una herramienta de cifrado y firmas digitales.</li> </ol> <pre><code>wget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg\n</code></pre> <ol> <li>Introducci\u00f3n de la firma en los repositorios: mediante el comando echo se a\u00f1ade la firma digital al <code>sources.list</code></li> </ol> <pre><code>echo \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/hashicorp.list\n</code></pre> <ol> <li>Actualizaci\u00f3n de repositorios e instalaci\u00f3n de Vagrant.</li> </ol> <pre><code>sudo apt update &amp;&amp; sudo apt install vagrant\n</code></pre> <ol> <li>Confirmaci\u00f3n de la instalaci\u00f3n</li> </ol> <pre><code>vagrant -v\n</code></pre>"},{"location":"05_VAGRANT/051_VagrantIntro.html#configuracion-del-proyecto-vagrant","title":"Configuraci\u00f3n del proyecto Vagrant","text":"<p>Para tener una m\u00e1quina virtual totalmente utilizable con Ubuntu 18.04 LTS de 64 bits, solo se necesitan los siguientes dos comandos:</p> <ol> <li>Empieza por crear un directorio para almacenar tu archivo Vagrant:</li> </ol> <pre><code>sudo mkdir vagrant-test\n</code></pre> <pre><code>cd vagrant-test\n</code></pre> <ol> <li>Se inicializa una maquina virtual, Descargando una distribuci\u00f3n del VAGRANT HUB.</li> </ol> <pre><code>vagrant init hashicorp/bionic64\n</code></pre> <p>Nota</p> <p>Este comando descarga una <code>Vagrantbox</code> y genera un <code>vagrantfile</code> en el directorio del proyecto.</p> <p>Vagrantbox</p> <ul> <li>La unidad b\u00e1sica en una configuraci\u00f3n de Vagrant se llama <code>box</code> o <code>Vagrantbox</code>. Esta es una imagen completa e independiente de un entorno de sistema operativo.</li> <li>Una <code>Vagrantbox</code> es un clon de una imagen b\u00e1sica del sistema operativo. El uso de un clon acelera el proceso de lanzamiento y aprovisionamiento.</li> </ul> <p>vagrantfile</p> <p>Un <code>Vagrantfile</code> es un archivo de Ruby que le indica a Vagrant que cree, dependiendo de c\u00f3mo se ejecute, nuevas m\u00e1quinas o <code>Vagrantbox</code>.</p> <ol> <li>Antes de poder continuar con el siguiente paso, aseg\u00farate de que Vagrant haya creado un <code>Vagrantfile</code>.</li> </ol> <pre><code>ls -al\n</code></pre> <ol> <li>Se arranca la m\u00e1quina virtual.</li> </ol> <pre><code>vagrant up\n</code></pre> <ol> <li>Se puede acceder por ssh a la m\u00e1quina virtual.</li> </ol> <pre><code>vagrant ssh\n</code></pre> Creaci\u00f3n del proyecto de Vagrant, inicializaci\u00f3n de MV y comprobaci\u00f3n."},{"location":"05_VAGRANT/051_VagrantIntro.html#configuracion-basica","title":"Configuraci\u00f3n b\u00e1sica","text":"<p>Por defecto, Vagrant almacena las VMs \u2018boxed\u2019 en la ruta <code>~/.vagrant.d</code>. Estas \u2018boxes\u2019 suelen ser ficheros de gran tama\u00f1o, y podemos considerarlas como una \u2018imagen modelo\u2019 de las MVs que tendremos en ejecuci\u00f3n. Se pueden compartir entre diferentes usuarios, con el objetivo de optimizar el espacio utilizado en disco.</p> <p>La ubicaci\u00f3n del directorio principal de Vagrant puede modificarse a trav\u00e9s de la variable de entorno VAGRANT_HOME. Por ejemplo, a trav\u00e9s del siguiente comando:</p> <pre><code>export VAGRANT_HOME=/ruta/al/directorio\n</code></pre> <p>Ejemplo</p> <p>Como puedes mover tus archivos <code>Vagrant</code> y m\u00e1quinas virtuales <code>VirtualBox</code> de tu carpeta de inicio a un disco duro externo:</p> <ol> <li>Copia el directorio <code>.vagrant.d</code> de tu carpeta personal (<code>~/.vagrant.d</code>) al disco externo (Y renombra la carpeta a <code>vagrant_home</code>:</li> </ol> <pre><code>cp -R ~/.vagrant.d /Volumes/[VOLUME_NAME]/vagrant_home\"\n</code></pre> <ol> <li>Elimina el directorio <code>.vagrant.d</code> fde la carpeta personal:</li> </ol> <pre><code>rm -rf ~/vagrant.d\n</code></pre> <ol> <li>Edita tu archivo <code>.bash_profile</code>, y a\u00f1ade la siguiente l\u00ednea:</li> </ol> <pre><code>export VAGRANT_HOME=\"/Volumes/[VOLUME_NAME]/vagrant_home\"\n</code></pre> <ul> <li>Para editarlo directamente:</li> </ul> <pre><code>echo 'export VAGRANT_HOME=\"/Volumes/[VOLUME_NAME]/vagrant_home' &gt;&gt; ~/.bash_profile\n</code></pre> <p>advertencia</p> <p>Para hacerlo permanente y no solo valga para una sesi\u00f3n, es necesario introducirlo en el <code>.bash_profile</code></p> <ol> <li>Abre VirtualBox, vaya a Preferencias y establezca la carpeta de m\u00e1quina predeterminada en una ubicaci\u00f3n en su disco duro externo (por ejemplo una nueva carpeta llamada \"VMs VirtualBox\").</li> </ol>"},{"location":"05_VAGRANT/051_VagrantIntro.html#crear-una-mv-ya-configurada","title":"Crear una MV ya configurada","text":"<p>Hay <code>Boxes</code> subidas al Vagrant Cloud que no solo aportan un Sistema Operativo \"limpio\" sino que a parte tienen configurada alguna aplicaci\u00f3n o servicio, para a\u00f1adirlas correctamente su Vagrantfile viene especificado en el <code>git</code> que aparece en la descripci\u00f3n de la <code>box</code>.</p> <p>Ejemplo</p> <p>rasmus/php7dev</p> <p>Para realizar un uso adecuado de est\u00e1 caja se clona el repositorio que contiene el Vagrantfile configurado con las caracter\u00edsticas de esta imagen:</p> <pre><code> git clone https://github.com/rlerdorf/php7dev.git\n</code></pre> <p>Una vez clonado aparece la carpeta descargada donde podemos apreciar los archivos de <code>Vagrantfile</code> y de configuraci\u00f3n <code>.yml</code>, como se observa a continuaci\u00f3n.</p> Vagrantfile y .yml de la Caja descargada. <p>Nota</p> <p>Una vez realizado el Vagrant up se puede acceder al servicio de <code>PHP</code></p>"},{"location":"05_VAGRANT/051_VagrantIntro.html#principales-comandos-vagrant","title":"Principales comandos Vagrant","text":"<p>En la DOCUMENTACI\u00d3N OFICIAL se encuentran todos los comandos de Vagrant, en los siguiente apartados se realiza un resumen de los m\u00e1s utilizados.</p> <p>Advertencia</p> <p>\u00a1Aseg\u00farate de estar en el mismo directorio que Vagrantfile cuando ejecutes estos comandos!</p>"},{"location":"05_VAGRANT/051_VagrantIntro.html#crear-una-mv","title":"Crear una MV","text":"<ul> <li><code>vagrant init</code>           -- Inicializa Vagrant con un <code>Vagrantfile</code> y . /.vagrant directorio, sin imagen base especificada. Antes de poder hacer vagrant up, tendr\u00e1s que especificar una imagen base en el <code>Vagrantfile</code>.</li> <li><code>vagrant init &lt;boxpath&gt;</code> -- Inicializa Vagrant con una caja espec\u00edfica. Para encontrar una caja, accede al  public Vagrant box catalog. Cuando encuentres uno que te guste, reemplaza su nombre con <code>boxpath</code>. Por ejemplo, <code>vagrant init ubuntu/trusty64</code>.</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#empezar-una-mv","title":"Empezar una MV","text":"<ul> <li><code>vagrant up</code>                  -- comienza el entorno de vagrant (tambi\u00e9n disposiciones solo sobre el PRIMER vagrant up).</li> <li><code>vagrant resume</code>              -- reanudar una m\u00e1quina suspendida (vagrant up tambi\u00e9n se puede utilizar).</li> <li><code>vagrant provision</code>           -- uerza el reaprovisionamiento de la m\u00e1quina de vagrant.</li> <li><code>vagrant reload</code>              -- reinicia la m\u00e1quina vagrant, carga la nueva configuraci\u00f3n de <code>Vagrantfile</code></li> <li><code>vagrant reload --provision</code>  -- reinicie la m\u00e1quina virtual y fuerce el aprovisionamiento</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#accediendo-a-una-maquina-vagrant","title":"Accediendo a una m\u00e1quina Vagrant","text":"<ul> <li><code>vagrant ssh</code>           -- se conecta a la m\u00e1quina a trav\u00e9s de <code>SSH</code></li> <li><code>vagrant ssh &lt;boxname&gt;</code> -- Si le das un nombre a tu box en tu Vagrantfile, puedes acceder via <code>ssh</code> sustituyendo el boxname por el nombre. Funciona desde cualquier directorio.</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#parando-una-mv","title":"Parando una MV","text":"<ul> <li><code>vagrant halt</code>        -- detiene la m\u00e1quina de vagrant.</li> <li><code>vagrant suspend</code>     -- suspende una m\u00e1quina virtual (recuerda el estado).</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#limpiando-una-mv","title":"limpiando una MV","text":"<ul> <li><code>vagrant destroy</code>     -- detiene y elimina todos los rastros de la m\u00e1quina de Vagrant.</li> <li><code>vagrant destroy -f</code>   -- lo mismo que lo anterior, sin confirmaci\u00f3n.</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#boxes","title":"Boxes","text":"<ul> <li><code>vagrant box list</code>              -- ver una lista de todas las cajas instaladas en tu ordenador.</li> <li><code>vagrant box add &lt;name&gt; &lt;url&gt;</code>  -- descarga una imagen de caja en tu ordenador.</li> <li><code>vagrant box outdated</code>          -- comprueba si hay actualizaciones en la vagrant box.</li> <li><code>vagrant box remove &lt;name&gt;</code>   -- elimina una caja de la m\u00e1quina</li> <li><code>vagrant package</code>               -- empaqueta un virtualbox env en ejecuci\u00f3n en una caja reutilizable</li> </ul>"},{"location":"05_VAGRANT/051_VagrantIntro.html#guarda-el-progreso","title":"Guarda el Progreso","text":"<p>-<code>vagrant snapshot save [options] [vm-name] &lt;name&gt;</code> -- vm-name is often <code>default</code>. Permite guardar una instant\u00e9nea</p>"},{"location":"05_VAGRANT/051_VagrantIntro.html#tips","title":"Tips","text":"<ul> <li><code>vagrant -v</code>                    -- consigue la versi\u00f3n vagrant</li> <li><code>vagrant status</code>                -- estado de las salidas de vagrant machine</li> <li><code>vagrant global-status</code>         -- stado de las salidas de todas las vagrant machines</li> <li><code>vagrant global-status --prune</code> -- igual que el anterior, pero las entradas no son v\u00e1lidas</li> <li><code>vagrant provision --debug</code>     -- usa la bandera de depuraci\u00f3n para aumentar la verbosidad de la salida</li> <li><code>vagrant push</code>                  -- \u00a1s\u00ed, vagrant se puede configurar para implementar c\u00f3digo! deploy code!</li> <li><code>vagrant up --provision | tee provision.log</code>  -- Ejecuta <code>vagrant up</code>, fuerza el aprovisionamiento y registra toda la salida en un archivo</li> </ul>"},{"location":"05_VAGRANT/052_VagrantConfig.html","title":"Configuraci\u00f3n Vagrant","text":"<p>La configuraci\u00f3n de un escenario concreto se realiza de forma bastante simple mediante modificaciones en el <code>Vagrantfile</code>, que est\u00e1 escrito en formato Ruby.</p> <p>El Vagrantfile es un archivo de Ruby utilizado para configurar Vagrant por proyecto. La funci\u00f3n principal de Vagrantfile es describir las m\u00e1quinas virtuales necesarias para un proyecto, as\u00ed como la forma de configurar y aprovisionar estas m\u00e1quinas.</p> <p>Los scripts Vagrantfiles est\u00e1n destinados a ser comprometidos directamente bajo el control de versiones. La idea es que cuando un desarrollador sincroniza su fichero vagrantfile, simplemente con lanzar el comando <code>vagrant up</code> obtiene un entorno virtual totalmente aprovisionado para desarrollar ese producto.</p>"},{"location":"05_VAGRANT/052_VagrantConfig.html#vagrantfile","title":"Vagrantfile","text":"<p>Para montar una m\u00e1quina virtual con Vagrant tenemos que tener obligatoriamente un archivo llamado Vagrantfile. La sintaxis del script Vagrantfile es Ruby , pero el conocimiento del lenguaje de programaci\u00f3n Ruby no es necesario para realizar modificaciones en el Vagrantfile, ya que es en su mayor\u00eda s\u00f3lo se realizan asignaciones simples de variables. Este fichero define:</p> <ul> <li>El box que servir\u00e1 de plantilla de la m\u00e1quina virtual.</li> <li>Las caracter\u00edsticas de la m\u00e1quina virtual.</li> <li>Conjunto de comandos que queremos que se ejecuten al crear la m\u00e1quina. Suelen ser los pasos de instalaci\u00f3n de aplicaciones y copias de datos desde carpetas compartidas en la m\u00e1quina host a la m\u00e1quina virtual.</li> </ul> <p>Consejo</p> <p>Para visualizar por consola la lista de m\u00e1quina virtuales en virtual box se puede utilizar el comando: <code>VBoxManage list vms</code></p> <p>Nota</p> <p>Realmente la configuraci\u00f3n que se aplica es la aplicaci\u00f3n en serie de varios <code>Vagranfiles</code>, tal como se explica en en la documentaci\u00f3n oficial en Load Order and Merging, aunque lo m\u00e1s habitual es que se cargue el <code>Vagrantfile</code> que incluye el box y el que exista en el directorio de trabajo, siendo este \u00faltimo el que se modifica en la mayor\u00eda de los casos.</p>"},{"location":"05_VAGRANT/052_VagrantConfig.html#modificaciones-de-la-maquina-virtual","title":"Modificaciones de la m\u00e1quina virtual","text":"<ul> <li>Las modificaciones se configuran en el espacio de nombres <code>config.vm</code>, prefijo que antecede a los par\u00e1metros en este caso, <code>por ejemplo</code> para modificar el hostname de la m\u00e1quina se utiliza:</li> </ul> <pre><code>config.vm.hostname = \"UbuntuServer22_Vagrant\"\n</code></pre> Generar hostname a la MV de Vagrant. <p>Nota</p> <p>El resto de par\u00e1metros que se pueden modificar los encontramos en la documentaci\u00f3n de Vagrant: Machine Settings, dejando en este caso para secciones posteriores algunos de los aspectos que necesitan m\u00e1s desarrollo como la configuraci\u00f3n de la red o la configuraci\u00f3n integrada de la m\u00e1quina virtual mediante shell scripts o mediante aplicaciones como <code>Ansible</code> o <code>Puppet</code>.</p> <ul> <li>Los par\u00e1metros relativos a las caracter\u00edsticas de hardware de la m\u00e1quina virtual dependen del proveedor en Vagrant y en el caso de VirtualBox se definen mediante una sub-secci\u00f3n desde donde se realizan las modificaciones apropiadas en un Vagrantfile. Por ejemplo para cambiar el nombre de la m\u00e1quina virtual, la memoria RAM asignada y el n\u00famero de n\u00facleos virtuales.</li> </ul> <pre><code> config.vm.provider \"virtualbox\" do |vb|\n     vb.name = \"nombre\"\n     vb.memory = \"512\"\n     vb.cpus = 2\n   end\n</code></pre> <ul> <li>Como la forma habitual de gestionar m\u00e1quinas virtuales en <code>Vagrant</code> es mediante la l\u00ednea de comandos y accediendo a ellas a trav\u00e9s de ssh, no tiene mucho sentido que se arranque una interfaz gr\u00e1fica, pero en algunas ocasiones es conveniente. Para activar la interfaz gr\u00e1fica de usuario al levantar la m\u00e1quina, se debe a\u00f1adir la siguiente l\u00ednea al <code>Vagrantfile</code>.</li> </ul> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     vb.gui = true     \n   end\n</code></pre>"},{"location":"05_VAGRANT/052_VagrantConfig.html#directorio-compartido","title":"Directorio compartido","text":"<p>Por defecto cuando se ejecuta una MV con Vagrant se crea una carpeta compartida entre el Anfitri\u00f3n y la MV. en este caso:</p> Directorio compartido por defecto en Vagrant. En la MV de Vagrant se observa el Vagrantfile. <p>Generar archivos</p> <p>Si se genera un archivo en esta carpeta se generar\u00eda tambi\u00e9n en el anfitri\u00f3n.</p> <p>Advertencia</p> <p>Existen casos en los cuales la carpeta compartida no se sincroniza correctamente, para solucionarlo existen las siguientes alternativas:</p> <ul> <li>Mediante <code>rsync</code>, la cual es una aplicaci\u00f3n libre para sistemas de tipo Unix y Microsoft Windows que ofrece transmisi\u00f3n eficiente de datos incrementales. Para realizar la configuraci\u00f3n Con Vagrant har\u00edamos:</li> </ul> <pre><code>config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\"\n</code></pre> <ul> <li>Y lanzar en el <code>host</code> el comando:</li> </ul> <pre><code>vagrant rsync-auto\n</code></pre> <p>Nota</p> <p>La sincronizaci\u00f3n se lleva a cabo desde host a guest</p> <ul> <li>Otras alternativas son <code>NFS</code> o <code>SMB</code> de forma bidireccional:</li> </ul> <pre><code>config.vm.synced_folder \".\", \"/vagrant\", type: \"nfs\"\n</code></pre> <p>Advertencia</p> <p>Se requiere un servidor NFS (o SMB) en el host =&gt; se requiere red privada</p>"},{"location":"05_VAGRANT/052_VagrantConfig.html#aprovisionamiento-ligero-thin-provisioning","title":"Aprovisionamiento ligero (thin provisioning)","text":"<ul> <li> <p>Para los casos de necesidad de clonar muchas m\u00e1quinas se aconseja utilizar el Aprovisionamiento ligero (thin provisioning), el cual es una t\u00e9cnica muy utilizada en diferentes sistemas de virtualizaci\u00f3n.</p> </li> <li> <p>Dicha t\u00e9cnica consiste en crear un disco de imagen de m\u00e1quina virtual que incluya s\u00f3lo las modificaciones respecto a una imagen base, consiguiendo un ahorro significativo de espacio en disco a costa de una peque\u00f1a penalizaci\u00f3n en rendimiento. </p> </li> <li> <p>A continuaci\u00f3n se muestra la configuraci\u00f3n de un Vagrantfile para que realiza el <code>aprovisionamiento ligero</code>.</p> </li> </ul> <ol> <li>Revisamos cuanto ocupa la MV de ejemplo de hashicorp.</li> </ol> <ol> <li>Para hacer la creaci\u00f3n de la m\u00e1quina ligera clonada se realiza en una carpeta a parte un nuevo proyecto y a\u00f1adimos las siguientes l\u00edneas al <code>Vagrantfile</code>.</li> </ol> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     vb.name = \"ligera\"\n     vb.linked_clone = true\n   end\n</code></pre> Configuraci\u00f3n de aprovisionamiento ligero."},{"location":"05_VAGRANT/052_VagrantConfig.html#redireccion-de-puertos","title":"Redirecci\u00f3n de puertos","text":"<ul> <li> <p>Si se necesita habilitar puertos para determinados servicios a instalar en la MV, se puede realizar una redirecci\u00f3n de puertos. </p> </li> <li> <p>Por ejemplo si adem\u00e1s de utilizar la redirecci\u00f3n de puertos de <code>ssh</code> que utiliza Vagrant se deber\u00eda a\u00f1adir la siguiente l\u00ednea:</p> </li> </ul> <pre><code>config.vm.network \"forwarded_port\", guest: 80, host: 8080\n</code></pre> <p>Comprobaci\u00f3n</p> <p>Para comprobarlo se instalar\u00eda un NGINX en la m\u00e1quina y acceder\u00edamos al servicio por el puerto configurado.</p>"},{"location":"05_VAGRANT/052_VagrantConfig.html#anadir-disco-adicional","title":"A\u00f1adir disco adicional","text":"<p>Una de las configuraciones m\u00e1s utilizadas en los escenarios de entornos virtualizados es la adici\u00f3n de discos adicionales para obtener diferentes tipos de configuraciones como puede ser la redundancia de datos mediante t\u00e9cnicas de <code>RAID</code>.</p> <p>En este caso Vagrant no dispone de comandos ni configuraciones para realizarlo, por lo que se debe a\u00f1adir la programaci\u00f3n necesaria en el <code>VagrantFile</code> que actue directamente al Virtualbox.</p> <p>Ejemplo</p> <p>Creaci\u00f3n de una m\u00e1quina virtual que tenga un disco adicional de 500 GiB. Para ello se puede utilizar el siguiente c\u00f3digo:</p> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     file_to_disk = 'tmp/disk.vdi'\n     unless File.exist?(file_to_disk)\n       vb.customize ['createhd', \n                     '--filename', file_to_disk, \n                     '--size', 500 * 1024]\n     end\n     vb.customize ['storageattach', :id, \n                   '--storagectl', 'SATAController', \n                   '--port', 1, \n                   '--device', 0, \n                   '--type', 'hdd', \n                   '--medium', file_to_disk]\n   end\n</code></pre> <p>Advertencia</p> <ul> <li>Este tipo de configuraciones en las que se pone de forma expl\u00edcita las caracter\u00edsticas de la m\u00e1quina virtual no son ni mucho menos generales, en el caso anterior se est\u00e1 poniendo de forma concreta el puerto <code>SATA</code> al que conectar el disco y el nombre del controlador <code>SATA</code>, caracter\u00edsticas que pueden variar de una m\u00e1quina virtual a otra. </li> <li>Por lo tanto Es recomendable inicialmente comprobar el nombre del controlador de <code>SATA</code> que en el caso de VirtualBox se puede hacer con el siguiente comando de VBoxManage</li> </ul> <pre><code>VBoxManage showvminfo NOMBRE_MV\n</code></pre> Comprobaci\u00f3n del nombre del controlador de SATA y creaci\u00f3n del disco adicional. <ul> <li>Despu\u00e9s de levantar el Vagrant o realizar un <code>reload</code>, se comprueba la configuraci\u00f3n:</li> </ul> <pre><code>lsblk\nls -hl tmp/\n</code></pre> Comprobaci\u00f3n de la creaci\u00f3n del disco adicional."},{"location":"05_VAGRANT/052_VagrantConfig.html#gestion-de-instantaneas","title":"Gesti\u00f3n de instant\u00e1neas","text":"<ul> <li>Para generar y recuperar instant\u00e1neas en <code>Vagrant</code> se utiliza el comando <code>vagrant snapshot</code> seguido de la acci\u00f3n a realizar o bien guardar o recuperar.</li> </ul> <p>Ejemplo</p> <p>Partiendo de un escenario de vagrant con una MV que tenga instalada un NGINX y un reenv\u00edo de puertos. Se genera una <code>snapshot</code> para realizar alg\u00fan cambio y restaurar la captura guardada.</p> <ul> <li>Comandos:</li> </ul> <pre><code># se genera la captura.\nvagrant snapshot save nginx-limpio\n\n# se comprueba que se ha creado.\nvagrant snapshot list\n\n# Despu\u00e9s de realizar alg\u00fan cambio se restaura.\nvagrant snapshot restore nginx-limpio\n</code></pre> <p>Consejo</p> <p>Existe un m\u00e9todo m\u00e1s sencillo de realizar instant\u00e1neas, es mediante el comando <code>vagrant snapshot push</code> que va almacenando instant\u00e1neas cada vez que se invoca y se recupera la m\u00e1s reciente con <code>vagrant snapshot pop</code>.</p>"},{"location":"05_VAGRANT/052_VagrantConfig.html#redes","title":"Redes","text":"<ul> <li> <p>Por defecto Vagrant realiza los pasos necesarios en la m\u00e1quina virtual para que sea accesible a trav\u00e9s de una red virtual desde el equipo anfitri\u00f3n y tenga acceso a Internet, es decir le configura una red.</p> </li> <li> <p>Esta configuraci\u00f3n l\u00f3gicamente va a variar en funci\u00f3n del proveedor, pero en el caso de VirtualBox se trata de una red de tipo NAT con el direccionamiento inicial 10.0.2.0/24. Las opciones de redes son:</p> </li> </ul>"},{"location":"05_VAGRANT/052_VagrantConfig.html#red-privada","title":"Red privada","text":"<p>En algunas ocasiones aparece la necesidad de utilizar un direccionamiento IP espec\u00edfico en una m\u00e1quina virtual o a\u00f1adir una red virtual adicional, por lo que en muchos casos es adecuado a\u00f1adir una red privada, tal como se explica en Private Networks.</p> <p>Ejemplo</p> <pre><code>config.vm.network \"private_network\", ip: \"192.168.55.10\"\n</code></pre>"},{"location":"05_VAGRANT/052_VagrantConfig.html#red-publica","title":"Red p\u00fablica","text":"<p>Para vagrant una red p\u00fablica es una red en modo puente (bridged network) conectada al exterior, t\u00edpicamente ser\u00eda poner en la misma red la m\u00e1quina anfitriona y la m\u00e1quina virtual. M\u00e1s detalles en Public Networks</p> <p>Ejemplo</p> <pre><code>config.vm.network  \"public_network\", bridge: \"eth0\"\n</code></pre>"},{"location":"05_VAGRANT/052_VagrantConfig.html#multi-maquinas","title":"Multi-m\u00e1quinas","text":"<ul> <li>Se puede extender la configuraci\u00f3n de un escenario virtual con vagrant a aquellos casos en los que haya m\u00e1s de una m\u00e1quina virtual y esto se hace con estructuras como la siguiente en el Vagrantfile:</li> </ul> <pre><code>Vagrant.configure(\"2\") do |config|\n  config.vm.define \"Server\" do |m1|\n    m1.vm.box = \"Ecodev/ubuntu-server-2204\"\n  end\n  config.vm.define \"Client\" do |m2|\n    m2.vm.box = \"hashicorp/bionic64\"\n  end\nend\n</code></pre> <ul> <li>Al existir m\u00e1s de una m\u00e1quina virtual, muchas de las instrucciones que hemos visto hasta ahora deben incluir el nombre de la m\u00e1quina como par\u00e1metro, por ejemplo si hici\u00e9ramos:</li> </ul> <pre><code>vagrant ssh Server\n</code></pre> <p>Ejemplo</p> <p>Crea un escenario para una aplicaci\u00f3n web en la que ubicamos en una m\u00e1quina el servidor Ubuntu 22 conectado a una red p\u00fablica exterior y una m\u00e1quina con un cliente en una m\u00e1quina no accesible desde el exterior. Para que ambas m\u00e1quinas est\u00e9n interconectadas entre s\u00ed, crea la red privada <code>10.0.100.0/24</code> a la que estar\u00e1n conectadas ambas m\u00e1quinas.</p> <pre><code>Vagrant.configure(\"2\") do |config|\n     config.vm.define \"ServerMulti1\" do |nodo1|\n       nodo1.vm.box = \"Ecodev/ubuntu-server-2204\"\n       nodo1.vm.hostname = \"UbuntuServerMulti\"\n       nodo1.vm.network \"public_network\", bridge: \"en0\"\n       nodo1.vm.network \"private_network\", ip: \"10.0.100.101\"\n     end\n     config.vm.define \"ClientMulti1\" do |nodo2|\n       nodo2.vm.box = \"hashicorp/bionic64\"\n       nodo2.vm.hostname = \"ClienteMulti\"\n       nodo2.vm.network \"private_network\", ip: \"10.0.100.102\"\n     end\n   end\n</code></pre>"},{"location":"05_VAGRANT/052_VagrantConfig.html#pt51-introduccion-a-entornos-de-desarrollo-mediante-vagrant","title":"PT51. Introducci\u00f3n a entornos de desarrollo mediante Vagrant","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Las actividades de esta pr\u00e1ctica contribuyen a los criterios de evaluaci\u00f3n del RA1: CE1, CE2, CE6, CE8 y CE9, del RA4: CE2 y CE5, y del RA6: CE1, CE2, CE3, CE4, CE5, CE6 y CE9 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Reflexionando despu\u00e9s de los proyectos realizados en NetOS, te das cuenta que a la hora de realizar las pruebas de las configuraciones en laboratorio, has perdido mucho tiempo en preparar los escenarios de pruebas de las m\u00e1quinas virtuales antes de desplegarlas en los clientes, por lo tanto decides probar la herramienta software Vagrant para desarrollar los entornos virtualizados de una forma r\u00e1pida y flexible. Inicialmente realizas una \"toma de contacto\" con la aplicaci\u00f3n con el objetivo de adquirir los conocimientos b\u00e1sicos en Vagrant.</p> <p>Tarea</p> <p>Realiza los siguientes tareas introductorias a Vagrant.</p> <ol> <li>Monta el escenario necesario para trabajar con <code>Vagrant</code>.</li> </ol> <ul> <li>Instala <code>Vagrant</code>.</li> <li>Realiza un primer proyecto.</li> <li>Externaliza la carpeta de boxes a un disco externo (si es posible).</li> <li>Crea y destruye varias MVs.</li> </ul> <ol> <li> <p>Genera un Vagrantfile multim\u00e1quina con un servidor web y un cliente que pueda acceder al servidor de forma privada. El servidor debe tener salida a Internet. Comprueba que tiene acceso al <code>index.html</code> del servidor web y modif\u00edcalo.</p> </li> <li> <p>Crea un entorno de desarrollo portable con Vagrant con algunas de las boxes ma\u0301s utilizadas del cata\u0301logo (por ejemplo ubuntu/xenial64 o centos7):</p> </li> </ol> <ul> <li>Prueba los distintos tipos de <code>synced folders</code>. Comprueba si, para tu plataforma, en cada uno de ellos funciona adecuadamente los enlaces simbo\u0301licos y la sincronizacio\u0301n en uno y otro sentido:</li> <li>Shared folder de virtualbox \u25b9 Rsync</li> <li>NFS</li> <li>Prueba a compartir por los m\u00e9todos anteriores carpetas de tu equipo en otras ubicaciones de la ma\u0301quina guest.</li> </ul> <p>NOTA</p> <p>usa vagrant reload cada vez que cambies la configuracio\u0301n.</p> <ol> <li>Crea una m\u00e1quina con un NGINX y un reenv\u00edo de puertos, Genera una <code>Snapshot</code> haz alg\u00fan cambio en el <code>index.html</code>. Regenera la captura y comprueba que el index.html est\u00e1 como de inicio.</li> </ol>"},{"location":"05_VAGRANT/053_VagrantAprov.html","title":"Aprovisionamiento Vagrant","text":"<p>En escenarios con un numero elevado de m\u00e1quinas, por ejemplo los servidores y clientes en un IES, los cuales se cuentan como decenas de equipos, la tarea de configuraci\u00f3n de servicios en dichos equipos se convierte en tediosa. Para solucionar este inconveniente existen herramientas de la gesti\u00f3n de la configuraci\u00f3n (configuration management systems) como <code>puppet</code>, <code>chef</code> o <code>ansible</code>.</p> <p>El campo de las herramientas de la gesti\u00f3n de la configuraci\u00f3n es muy amplio y su explicaci\u00f3n detallada sale del \u00e1mbito de este m\u00f3dulo, por lo que simplemente se realiza una breve introducci\u00f3n al respecto. En el caso de vagrant la soluci\u00f3n que se ha encontrado es muy razonable, ya que en lugar de desarrollar una nueva herramienta <code>Hashicorp</code> ha optado por una soluci\u00f3n m\u00e1s adecuada y razonable: integrarlas todas con vagrant.</p> <p>En este caso se va a trabajar el \"aprovisionamiento\" con <code>scripts</code> y <code>ansible</code>.</p> <p>Nota</p> <p>Para realizar el aprovisionamiento <code>Ansible</code> se necesita profundizar en esta plataforma cuyo estudio queda fuera de competencia de este m\u00f3dulo, por lo tanto a continuaci\u00f3n se explica el aprovisionamiento con <code>scripts</code> de bash.</p>"},{"location":"05_VAGRANT/053_VagrantAprov.html#aprovisionamiento-con-scripts","title":"Aprovisionamiento con Scripts","text":"<p>A continuaci\u00f3n se muestran unos breves ejemplos de aprovisionamiento de MVs con Scripts.</p> <p>El objetivo es realizar un entorno de <code>Vagrant</code> sencillo en el que tras arrancar una m\u00e1quina se realiza una actualizaci\u00f3n de la lista de paquetes y se efect\u00faan las actualizaciones de aquellos paquetes necesarios mediante apt-get.</p> <p>Ejemplo 1 Actualizar Sistema Operativo</p> <ol> <li>Se crea el fichero <code>actualizar.sh</code> ubicado en el mismo directorio que el Vagrantfile y con el siguiente contenido:</li> </ol> <pre><code>#!/bin/bash\napt-get update\nDEBIAN_FRONTEND=noninteractive apt-get -y upgrade\n</code></pre> <ol> <li>Se crea el siguiente Vagrant file.</li> </ol> <pre><code>Vagrant.configure(\"2\") do |config|\n  config.vm.box = \"Ecodev/ubuntu-server-2204\"\n  config.vm.provision \"shell\", path: \"actualizar.sh\"\nend\n</code></pre> <p>Ejemplo 2 Instalar Docker</p> <p>si queremos instalar Docker en la imagen virtual como ya vimos en un post anterior Instalar Docker Ubuntu Podr\u00edamos a\u00f1adir lo siguiente:</p> <pre><code>  config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n      apt-get update\n      apt-get install apt-transport-https ca-certificates curl software-properties-common\n      curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n      sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n      apt-get update\n      apt-get install -y docker-ce\n\n      #A\u00f1ada al usuario al grupo docker.\n      sudo usermod -aG docker $USER \n  SHELL\n</code></pre>"},{"location":"05_VAGRANT/053_VagrantAprov.html#pt52-automatizacion-de-servicios-de-recursos-compartidos","title":"PT52. Automatizaci\u00f3n de servicios de recursos compartidos","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE6 y CE7 del RA4 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Tras las primeras pruebas con Vagrant te das cuenta de su gran potencial y decides compartir la experiencia con tus compa\u00f1eros a los cuales propones la siguiente prueba de laboratorio.</p> <p>Realiza un proyecto por grupos de 2 para realizar una exposici\u00f3n del siguiente punto:</p> <ol> <li>Despliega un sistema heterog\u00e9neo con Vagrant, para a continuaci\u00f3n aprovisionar el sistema generado con un servicio Samba-DC mediante \"scripts\". En la exposici\u00f3n se deben adjuntar las comprobaciones necesarias del correcto funcionamiento del servicio.</li> </ol> <p>Nota</p> <p>los sistemas heterog\u00e9neos a elegir son los mismos que la pr\u00e1ctica PT51.</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html","title":"Despliegue de Sistemas Heterog\u00e9neos con Vagrant","text":""},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#justificacion","title":"Justificaci\u00f3n","text":"<p>Actualmente el auge del desarrollo de aplicaciones en sistemas virtualizados requiere del despliegue, conectividad y flexibilidad de sistemas heterog\u00e9neos en escenarios de desarrollo de trabajo y producci\u00f3n.</p> <p>Una de las herramientas m\u00e1s utilizadas por los SRE (Site Reliability Engineer) es Vagrant, para conseguir el objetivo principal de crear sistemas de software altamente confiables y escalables. Vagrant es una herramienta para la creaci\u00f3n y configuraci\u00f3n de entornos de desarrollo virtualizados que cubre las necesidades comentadas.</p> <p>Motivado por dicha relevancia a continuaci\u00f3n se introduce la herramienta de Devops Vagrant.</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#introduccion-vagrant","title":"Introducci\u00f3n Vagrant","text":""},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#que-es-vagrant","title":"\u00bfQu\u00e9 es Vagrant?","text":"<ul> <li>Es una herramienta para construir entornos de desarrollo simples, con un flujo de trabajo f\u00e1cil de usar y un enfoque en la automatizaci\u00f3n replicable. Permite crear y destruir los escenarios en repetidas ocasiones sin gran esfuerzo.</li> <li>Esencialmente, es una capa de software instalada entre una herramienta de virtualizaci\u00f3n (como VirtualBox, Docker, Hyper-V) y una m\u00e1quina virtual.</li> <li>Por lo tanto, es un software para automatizar las operaciones que se realizan con los hipervisores:</li> </ul> <p>Por ejemplo</p> <ul> <li>Crear, configurar, parar, suspender y destruir ma\u0301quinas virtuales.</li> <li>Gestionar redes.</li> <li>Compartir espacios de disco entre guest y host.</li> <li>Manejar distintos tipos de hipervisores.</li> </ul> <ul> <li>Es un software de c\u00f3digo libre disponible bajo una licencia <code>MIT</code>. El c\u00f3digo fuente est\u00e1 disponible en Github.</li> <li>Fue desarrollado originalmente por Mitchell Hashimoto en 2010. A partir de Vagrant se creo Hashicorp en 2012.</li> </ul> <p>HASHICORP</p> <p>Aplicaciones de Hashicorp</p> <ul> <li>Packer (ima\u0301genes de vagrant)</li> <li>Consul (descubrimiento de servicios)</li> <li>Terraform (aprovisionamiento)</li> <li>Vault (seguridad)</li> <li>Nomad (despliegue contenedores)</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Puede integrarse con herramientas de gesti\u00f3n de la configuraci\u00f3n, automatizando la provisio\u0301n de software de la ma\u0301quina virtual.</li> <li>Forma parte del conjunto de aplicaciones utilizadas en \"infraestructura como c\u00f3digo\", mediante un fichero de texto que puede formar parte del co\u0301digo fuente del proyecto, por lo que puede subirse al control de versiones y ser compartido por todos los desarrolladores, dicho fichero es denominado Vagrant file.</li> <li>Soluciona problemas de incidencias de desarrollo entre diferentes sistemas.</li> </ul> <p>Incidencias</p> <p>El problema de configurar escenarios a mano conlleva un trabajo tedioso y provoca errores, dando lugar al reproche de En mi m\u00e1quina funciona.</p> <p>Soluci\u00f3n</p> <ul> <li>Vagrant: para Distribuir de forma separada ima\u0301genes \u201climpias\u201d de OS y la configuracio\u0301n completa en un fichero de texto que es el que se distribuye por el grupo de trabajo.</li> <li>Reduce el tiempo de configuraci\u00f3n del entorno de desarrollo, aumenta la paridad de desarrollo/producci\u00f3n y hace que la excusa de \"funciona en mi m\u00e1quina\" sea una reliquia del pasado.</li> <li>A menudo se utiliza en el desarrollo de software para garantizar que todos los miembros del equipo est\u00e9n construyendo para la misma configuraci\u00f3n. </li> <li>No solo comparte entornos, sino que tambi\u00e9n comparte c\u00f3digo. Esto permite que el c\u00f3digo de un desarrollador trabaje en el sistema de otro, haciendo posible el desarrollo colaborativo y cooperativo.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#vagrant-vs-docker","title":"Vagrant vs. Docker","text":"<ul> <li><code>Vagrant</code> es una herramienta centrada en proporcionar un flujo de trabajo de entorno de desarrollo coherente en m\u00faltiples sistemas operativos, trabajando sobre los hipervisores. </li> <li>Docker es una gesti\u00f3n de contenedores que puede ejecutar software de forma consistente siempre y cuando exista un sistema de contenedorizaci\u00f3n.</li> <li>Los contenedores son generalmente m\u00e1s ligeros que las m\u00e1quinas virtuales, por lo que iniciar y detener los contenedores es extremadamente r\u00e1pido. Docker utiliza la funcionalidad de contenedorizaci\u00f3n nativa en macOS, Linux y Windows. </li> <li>Para entornos de microservicios pesados, Docker puede ser atractivo porque puede iniciar f\u00e1cilmente una sola m\u00e1quina virtual Docker e iniciar muchos contenedores por encima de eso muy r\u00e1pidamente. Este es un buen caso de uso para Docker. </li> <li><code>Vagrant</code> tambi\u00e9n puede hacer esto con el proveedor de Docker. Un beneficio principal para Vagrant es un flujo de trabajo consistente, pero hay muchos casos en los que un flujo de trabajo de Docker puro tiene sentido.</li> <li>Tanto Vagrant como Docker tienen una vasta biblioteca de \"im\u00e1genes\" o \"boxes\" para elegir.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#instalacion-vagrant","title":"Instalaci\u00f3n Vagrant","text":"<p>Para la instalaci\u00f3n el mejor consejo es acudir a la documentaci\u00f3n oficial, en el siguiente enlace se pueden obtener los comandos de instalaci\u00f3n de Vagrant para los diferentes tipos de sistemas operativos:</p> <p>INSTALACI\u00d3N VAGRANT</p> <p>Nota</p> <p>En este caso se realiza la ejecuci\u00f3n de los comandos para la instalaci\u00f3n por repositorios en las distribuciones de Ubuntu/debian.</p> <ol> <li>Descarga de las GPG: GNU Privacy Guard es una herramienta de cifrado y firmas digitales.</li> </ol> <pre><code>wget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg\n</code></pre> <ol> <li>Introducci\u00f3n de la firma en los repositorios: mediante el comando echo se a\u00f1ade la firma digital al <code>sources.list</code></li> </ol> <pre><code>echo \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/hashicorp.list\n</code></pre> <ol> <li>Actualizaci\u00f3n de repositorios e instalaci\u00f3n de Vagrant.</li> </ol> <pre><code>sudo apt update &amp;&amp; sudo apt install vagrant\n</code></pre> <ol> <li>Confirmaci\u00f3n de la instalaci\u00f3n</li> </ol> <pre><code>vagrant -v\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#configuracion-del-proyecto-vagrant","title":"Configuraci\u00f3n del proyecto Vagrant","text":"<p>Para tener una m\u00e1quina virtual totalmente utilizable con Ubuntu 18.04 LTS de 64 bits, solo se necesitan los siguientes dos comandos:</p> <ol> <li>Empieza por crear un directorio para almacenar tu archivo Vagrant:</li> </ol> <pre><code>sudo mkdir vagrant-test\n</code></pre> <pre><code>cd vagrant-test\n</code></pre> <ol> <li>Se inicializa una maquina virtual, Descargando una distribuci\u00f3n del VAGRANT HUB.</li> </ol> <pre><code>vagrant init hashicorp/bionic64\n</code></pre> <p>Nota</p> <p>Este comando descarga una <code>Vagrantbox</code> y genera un <code>vagrantfile</code> en el directorio del proyecto.</p> <p>Vagrantbox</p> <ul> <li>La unidad b\u00e1sica en una configuraci\u00f3n de Vagrant se llama <code>box</code> o <code>Vagrantbox</code>. Esta es una imagen completa e independiente de un entorno de sistema operativo.</li> <li>Una <code>Vagrantbox</code> es un clon de una imagen b\u00e1sica del sistema operativo. El uso de un clon acelera el proceso de lanzamiento y aprovisionamiento.</li> </ul> <p>vagrantfile</p> <p>Un <code>Vagrantfile</code> es un archivo de Ruby que le indica a Vagrant que cree, dependiendo de c\u00f3mo se ejecute, nuevas m\u00e1quinas o <code>Vagrantbox</code>.</p> <ol> <li>Antes de poder continuar con el siguiente paso, aseg\u00farate de que Vagrant haya creado un <code>Vagrantfile</code>.</li> </ol> <pre><code>ls -al\n</code></pre> <ol> <li>Se arranca la m\u00e1quina virtual.</li> </ol> <pre><code>vagrant up\n</code></pre> <ol> <li>Se puede acceder por ssh a la m\u00e1quina virtual.</li> </ol> <pre><code>vagrant ssh\n</code></pre> Creaci\u00f3n del proyecto de Vagrant, inicializaci\u00f3n de MV y comprobaci\u00f3n."},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#configuracion-basica","title":"Configuraci\u00f3n b\u00e1sica","text":"<p>Por defecto, Vagrant almacena las VMs \u2018boxed\u2019 en la ruta <code>~/.vagrant.d</code>. Estas \u2018boxes\u2019 suelen ser ficheros de gran tama\u00f1o, y podemos considerarlas como una \u2018imagen modelo\u2019 de las MVs que tendremos en ejecuci\u00f3n. Se pueden compartir entre diferentes usuarios, con el objetivo de optimizar el espacio utilizado en disco.</p> <p>La ubicaci\u00f3n del directorio principal de Vagrant puede modificarse a trav\u00e9s de la variable de entorno VAGRANT_HOME. Por ejemplo, a trav\u00e9s del siguiente comando:</p> <pre><code>export VAGRANT_HOME=/ruta/al/directorio\n</code></pre> <p>Ejemplo</p> <p>Como puedes mover tus archivos <code>Vagrant</code> y m\u00e1quinas virtuales <code>VirtualBox</code> de tu carpeta de inicio a un disco duro externo:</p> <ol> <li>Copia el directorio <code>.vagrant.d</code> de tu carpeta personal (<code>~/.vagrant.d</code>) al disco externo (Y renombra la carpeta a <code>vagrant_home</code>:</li> </ol> <pre><code>cp -R ~/.vagrant.d /Volumes/[VOLUME_NAME]/vagrant_home\"\n</code></pre> <ol> <li>Elimina el directorio <code>.vagrant.d</code> fde la carpeta personal:</li> </ol> <pre><code>rm -rf ~/vagrant.d\n</code></pre> <ol> <li>Edita tu archivo <code>.bash_profile</code>, y a\u00f1ade la siguiente l\u00ednea:</li> </ol> <pre><code>export VAGRANT_HOME=\"/Volumes/[VOLUME_NAME]/vagrant_home\"\n</code></pre> <ul> <li>Para editarlo directamente:</li> </ul> <pre><code>echo 'export VAGRANT_HOME=\"/Volumes/[VOLUME_NAME]/vagrant_home' &gt;&gt; ~/.bash_profile\n</code></pre> <p>advertencia</p> <p>Para hacerlo permanente y no solo valga para una sesi\u00f3n, es necesario introducirlo en el <code>.bash_profile</code></p> <ol> <li>Abre VirtualBox, vaya a Preferencias y establezca la carpeta de m\u00e1quina predeterminada en una ubicaci\u00f3n en su disco duro externo (por ejemplo una nueva carpeta llamada \"VMs VirtualBox\").</li> </ol>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#crear-una-mv-ya-configurada","title":"Crear una MV ya configurada","text":"<p>Hay <code>Boxes</code> subidas al Vagrant Cloud que no solo aportan un Sistema Operativo \"limpio\" sino que a parte tienen configurada alguna aplicaci\u00f3n o servicio, para a\u00f1adirlas correctamente su Vagrantfile viene especificado en el <code>git</code> que aparece en la descripci\u00f3n de la <code>box</code>.</p> <p>Ejemplo</p> <p>rasmus/php7dev</p> <p>Para realizar un uso adecuado de est\u00e1 caja se clona el repositorio que contiene el Vagrantfile configurado con las caracter\u00edsticas de esta imagen:</p> <pre><code> git clone https://github.com/rlerdorf/php7dev.git\n</code></pre> <p>Una vez clonado aparece la carpeta descargada donde podemos apreciar los archivos de <code>Vagrantfile</code> y de configuraci\u00f3n <code>.yml</code>, como se observa a continuaci\u00f3n.</p> Vagrantfile y .yml de la Caja descargada. <p>Nota</p> <p>Una vez realizado el Vagrant up se puede acceder al servicio de <code>PHP</code></p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#principales-comandos-vagrant","title":"Principales comandos Vagrant","text":"<p>En la DOCUMENTACI\u00d3N OFICIAL se encuentran todos los comandos de Vagrant, en los siguiente apartados se realiza un resumen de los m\u00e1s utilizados.</p> <p>Advertencia</p> <p>\u00a1Aseg\u00farate de estar en el mismo directorio que Vagrantfile cuando ejecutes estos comandos!</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#crear-una-mv","title":"Crear una MV","text":"<ul> <li><code>vagrant init</code>           -- Inicializa Vagrant con un <code>Vagrantfile</code> y . /.vagrant directorio, sin imagen base especificada. Antes de poder hacer vagrant up, tendr\u00e1s que especificar una imagen base en el <code>Vagrantfile</code>.</li> <li><code>vagrant init &lt;boxpath&gt;</code> -- Inicializa Vagrant con una caja espec\u00edfica. Para encontrar una caja, accede al  public Vagrant box catalog. Cuando encuentres uno que te guste, reemplaza su nombre con <code>boxpath</code>. Por ejemplo, <code>vagrant init ubuntu/trusty64</code>.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#empezar-una-mv","title":"Empezar una MV","text":"<ul> <li><code>vagrant up</code>                  -- comienza el entorno de vagrant (tambi\u00e9n disposiciones solo sobre el PRIMER vagrant up).</li> <li><code>vagrant resume</code>              -- reanudar una m\u00e1quina suspendida (vagrant up tambi\u00e9n se puede utilizar).</li> <li><code>vagrant provision</code>           -- uerza el reaprovisionamiento de la m\u00e1quina de vagrant.</li> <li><code>vagrant reload</code>              -- reinicia la m\u00e1quina vagrant, carga la nueva configuraci\u00f3n de <code>Vagrantfile</code></li> <li><code>vagrant reload --provision</code>  -- reinicie la m\u00e1quina virtual y fuerce el aprovisionamiento</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#accediendo-a-una-maquina-vagrant","title":"Accediendo a una m\u00e1quina Vagrant","text":"<ul> <li><code>vagrant ssh</code>           -- se conecta a la m\u00e1quina a trav\u00e9s de <code>SSH</code></li> <li><code>vagrant ssh &lt;boxname&gt;</code> -- Si le das un nombre a tu box en tu Vagrantfile, puedes acceder via <code>ssh</code> sustituyendo el boxname por el nombre. Funciona desde cualquier directorio.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#parando-una-mv","title":"Parando una MV","text":"<ul> <li><code>vagrant halt</code>        -- detiene la m\u00e1quina de vagrant.</li> <li><code>vagrant suspend</code>     -- suspende una m\u00e1quina virtual (recuerda el estado).</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#limpiando-una-mv","title":"limpiando una MV","text":"<ul> <li><code>vagrant destroy</code>     -- detiene y elimina todos los rastros de la m\u00e1quina de Vagrant.</li> <li><code>vagrant destroy -f</code>   -- lo mismo que lo anterior, sin confirmaci\u00f3n.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#boxes","title":"Boxes","text":"<ul> <li><code>vagrant box list</code>              -- ver una lista de todas las cajas instaladas en tu ordenador.</li> <li><code>vagrant box add &lt;name&gt; &lt;url&gt;</code>  -- descarga una imagen de caja en tu ordenador.</li> <li><code>vagrant box outdated</code>          -- comprueba si hay actualizaciones en la vagrant box.</li> <li><code>vagrant box remove &lt;name&gt;</code>   -- elimina una caja de la m\u00e1quina</li> <li><code>vagrant package</code>               -- empaqueta un virtualbox env en ejecuci\u00f3n en una caja reutilizable</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#guarda-el-progreso","title":"Guarda el Progreso","text":"<p>-<code>vagrant snapshot save [options] [vm-name] &lt;name&gt;</code> -- vm-name is often <code>default</code>. Permite guardar una instant\u00e9nea</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#tips","title":"Tips","text":"<ul> <li><code>vagrant -v</code>                    -- consigue la versi\u00f3n vagrant</li> <li><code>vagrant status</code>                -- estado de las salidas de vagrant machine</li> <li><code>vagrant global-status</code>         -- stado de las salidas de todas las vagrant machines</li> <li><code>vagrant global-status --prune</code> -- igual que el anterior, pero las entradas no son v\u00e1lidas</li> <li><code>vagrant provision --debug</code>     -- usa la bandera de depuraci\u00f3n para aumentar la verbosidad de la salida</li> <li><code>vagrant push</code>                  -- \u00a1s\u00ed, vagrant se puede configurar para implementar c\u00f3digo! deploy code!</li> <li><code>vagrant up --provision | tee provision.log</code>  -- Ejecuta <code>vagrant up</code>, fuerza el aprovisionamiento y registra toda la salida en un archivo</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#vagrantfile","title":"Vagrantfile","text":"<p>Consejo</p> <p>Para visualizar por consola la lista de m\u00e1quina virtuales en virtual box se puede utilizar el comando: <code>VBoxManage list vms</code></p> <ul> <li>La configuraci\u00f3n de un escenario concreto se realiza de forma bastante simple mediante modificaciones en el <code>Vagrantfile</code>, que est\u00e1 escrito en formato Ruby, como ya se ha comentado.</li> </ul> <p>Nota</p> <p>Realmente la configuraci\u00f3n que se aplica es la aplicaci\u00f3n en serie de varios <code>Vagranfiles</code>, tal como se explica en en la documentaci\u00f3n oficial en Load Order and Merging, aunque lo m\u00e1s habitual es que se cargue el <code>Vagrantfile</code> que incluye el box y el que exista en el directorio de trabajo, siendo este \u00faltimo el que se modifica en la mayor\u00eda de los casos.</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#modificaciones-de-la-maquina-virtual","title":"Modificaciones de la m\u00e1quina virtual","text":"<ul> <li>Las modificaciones se configuran en el espacio de nombres <code>config.vm</code>, prefijo que antecede a los par\u00e1metros en este caso, <code>por ejemplo</code> para modificar el hostname de la m\u00e1quina se utiliza:</li> </ul> <pre><code>config.vm.hostname = \"UbuntuServer22_Vagrant\"\n</code></pre> Generar hostname a la MV de Vagrant. <p>Nota</p> <p>El resto de par\u00e1metros que se pueden modificar los encontramos en la documentaci\u00f3n de Vagrant: Machine Settings, dejando en este caso para secciones posteriores algunos de los aspectos que necesitan m\u00e1s desarrollo como la configuraci\u00f3n de la red o la configuraci\u00f3n integrada de la m\u00e1quina virtual mediante shell scripts o mediante aplicaciones como <code>Ansible</code> o <code>Puppet</code>.</p> <ul> <li>Los par\u00e1metros relativos a las caracter\u00edsticas de hardware de la m\u00e1quina virtual dependen del proveedor en Vagrant y en el caso de VirtualBox se definen mediante una sub-secci\u00f3n desde donde se realizan las modificaciones apropiadas en un Vagrantfile. Por ejemplo para cambiar el nombre de la m\u00e1quina virtual, la memoria RAM asignada y el n\u00famero de n\u00facleos virtuales.</li> </ul> <pre><code> config.vm.provider \"virtualbox\" do |vb|\n     vb.name = \"nombre\"\n     vb.memory = \"512\"\n     vb.cpus = 2\n   end\n</code></pre> <ul> <li>Como la forma habitual de gestionar m\u00e1quinas virtuales en <code>Vagrant</code> es mediante la l\u00ednea de comandos y accediendo a ellas a trav\u00e9s de ssh, no tiene mucho sentido que se arranque una interfaz gr\u00e1fica, pero en algunas ocasiones es conveniente. Para activar la interfaz gr\u00e1fica de usuario al levantar la m\u00e1quina, se debe a\u00f1adir la siguiente l\u00ednea al <code>Vagrantfile</code>.</li> </ul> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     vb.gui = true     \n   end\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#directorio-compartido","title":"Directorio compartido","text":"<p>Por defecto cuando se ejecuta una MV con Vagrant se crea una carpeta compartida entre el Anfitri\u00f3n y la MV. en este caso:</p> Directorio compartido por defecto en Vagrant. En la MV de Vagrant se observa el Vagrantfile. <p>Generar archivos</p> <p>Si se genera un archivo en esta carpeta se generar\u00eda tambi\u00e9n en el anfitri\u00f3n.</p> <p>Advertencia</p> <p>Existen casos en los cuales la carpeta compartida no se sincroniza correctamente, para solucionarlo existen las siguientes alternativas:</p> <ul> <li>Mediante <code>rsync</code>, la cual es una aplicaci\u00f3n libre para sistemas de tipo Unix y Microsoft Windows que ofrece transmisi\u00f3n eficiente de datos incrementales. Para realizar la configuraci\u00f3n Con Vagrant har\u00edamos:</li> </ul> <pre><code>config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\"\n</code></pre> <ul> <li>Y lanzar en el <code>host</code> el comando:</li> </ul> <pre><code>vagrant rsync-auto\n</code></pre> <p>Nota</p> <p>La sincronizaci\u00f3n se lleva a cabo desde host a guest</p> <ul> <li>Otras alternativas son <code>NFS</code> o <code>SMB</code> de forma bidireccional:</li> </ul> <pre><code>config.vm.synced_folder \".\", \"/vagrant\", type: \"nfs\"\n</code></pre> <p>Advertencia</p> <p>Se requiere un servidor NFS (o SMB) en el host =&gt; se requiere red privada</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#aprovisionamiento-ligero-thin-provisioning","title":"Aprovisionamiento ligero (thin provisioning)","text":"<ul> <li> <p>Para los casos de necesidad de clonar muchas m\u00e1quinas se aconseja utilizar el Aprovisionamiento ligero (thin provisioning), el cual es una t\u00e9cnica muy utilizada en diferentes sistemas de virtualizaci\u00f3n.</p> </li> <li> <p>Dicha t\u00e9cnica consiste en crear un disco de imagen de m\u00e1quina virtual que incluya s\u00f3lo las modificaciones respecto a una imagen base, consiguiendo un ahorro significativo de espacio en disco a costa de una peque\u00f1a penalizaci\u00f3n en rendimiento. </p> </li> <li> <p>A continuaci\u00f3n se muestra la configuraci\u00f3n de un Vagrantfile para que realiza el <code>aprovisionamiento ligero</code>.</p> </li> </ul> <ol> <li>Revisamos cuanto ocupa la MV de ejemplo de hashicorp.</li> </ol> <ol> <li>Para hacer la creaci\u00f3n de la m\u00e1quina ligera clonada se realiza en una carpeta a parte un nuevo proyecto y a\u00f1adimos las siguientes l\u00edneas al <code>Vagrantfile</code>.</li> </ol> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     vb.name = \"ligera\"\n     vb.linked_clone = true\n   end\n</code></pre> Configuraci\u00f3n de aprovisionamiento ligero."},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#redireccion-de-puertos","title":"Redirecci\u00f3n de puertos","text":"<ul> <li> <p>Si se necesita habilitar puertos para determinados servicios a instalar en la MV, se puede realizar una redirecci\u00f3n de puertos. </p> </li> <li> <p>Por ejemplo si adem\u00e1s de utilizar la redirecci\u00f3n de puertos de <code>ssh</code> que utiliza Vagrant se deber\u00eda a\u00f1adir la siguiente l\u00ednea:</p> </li> </ul> <pre><code>config.vm.network \"forwarded_port\", guest: 80, host: 8080\n</code></pre> <p>Comprobaci\u00f3n</p> <p>Para comprobarlo se instalar\u00eda un NGINX en la m\u00e1quina y acceder\u00edamos al servicio por el puerto configurado.</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#anadir-disco-adicional","title":"A\u00f1adir disco adicional","text":"<p>Una de las configuraciones m\u00e1s utilizadas en los escenarios de entornos virtualizados es la adici\u00f3n de discos adicionales para obtener diferentes tipos de configuraciones como puede ser la redundancia de datos mediante t\u00e9cnicas de <code>RAID</code>.</p> <p>En este caso Vagrant no dispone de comandos ni configuraciones para realizarlo, por lo que se debe a\u00f1adir la programaci\u00f3n necesaria en el <code>VagrantFile</code> que actue directamente al Virtualbox.</p> <p>Ejemplo</p> <p>Creaci\u00f3n de una m\u00e1quina virtual que tenga un disco adicional de 500 GiB. Para ello se puede utilizar el siguiente c\u00f3digo:</p> <pre><code>config.vm.provider \"virtualbox\" do |vb|\n     file_to_disk = 'tmp/disk.vdi'\n     unless File.exist?(file_to_disk)\n       vb.customize ['createhd', \n                     '--filename', file_to_disk, \n                     '--size', 500 * 1024]\n     end\n     vb.customize ['storageattach', :id, \n                   '--storagectl', 'SATAController', \n                   '--port', 1, \n                   '--device', 0, \n                   '--type', 'hdd', \n                   '--medium', file_to_disk]\n   end\n</code></pre> <p>Advertencia</p> <ul> <li>Este tipo de configuraciones en las que se pone de forma expl\u00edcita las caracter\u00edsticas de la m\u00e1quina virtual no son ni mucho menos generales, en el caso anterior se est\u00e1 poniendo de forma concreta el puerto <code>SATA</code> al que conectar el disco y el nombre del controlador <code>SATA</code>, caracter\u00edsticas que pueden variar de una m\u00e1quina virtual a otra. </li> <li>Por lo tanto Es recomendable inicialmente comprobar el nombre del controlador de <code>SATA</code> que en el caso de VirtualBox se puede hacer con el siguiente comando de VBoxManage</li> </ul> <pre><code>VBoxManage showvminfo NOMBRE_MV\n</code></pre> Comprobaci\u00f3n del nombre del controlador de SATA y creaci\u00f3n del disco adicional. <ul> <li>Despu\u00e9s de levantar el Vagrant o realizar un <code>reload</code>, se comprueba la configuraci\u00f3n:</li> </ul> <pre><code>lsblk\nls -hl tmp/\n</code></pre> Comprobaci\u00f3n de la creaci\u00f3n del disco adicional."},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#gestion-de-instantaneas","title":"Gesti\u00f3n de instant\u00e1neas","text":"<ul> <li>Para generar y recuperar instant\u00e1neas en <code>Vagrant</code> se utiliza el comando <code>vagrant snapshot</code> seguido de la acci\u00f3n a realizar o bien guardar o recuperar.</li> </ul> <p>Ejemplo</p> <p>Partiendo de un escenario de vagrant con una MV que tenga instalada un NGINX y un reenv\u00edo de puertos. Se genera una <code>snapshot</code> para realizar alg\u00fan cambio y restaurar la captura guardada.</p> <ul> <li>Comandos:</li> </ul> <pre><code># se genera la captura.\nvagrant snapshot save nginx-limpio\n\n# se comprueba que se ha creado.\nvagrant snapshot list\n\n# Despu\u00e9s de realizar alg\u00fan cambio se restaura.\nvagrant snapshot restore nginx-limpio\n</code></pre> <p>Consejo</p> <p>Existe un m\u00e9todo m\u00e1s sencillo de realizar instant\u00e1neas, es mediante el comando <code>vagrant snapshot push</code> que va almacenando instant\u00e1neas cada vez que se invoca y se recupera la m\u00e1s reciente con <code>vagrant snapshot pop</code>.</p>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#redes","title":"Redes","text":"<ul> <li> <p>Por defecto Vagrant realiza los pasos necesarios en la m\u00e1quina virtual para que sea accesible a trav\u00e9s de una red virtual desde el equipo anfitri\u00f3n y tenga acceso a Internet, es decir le configura una red.</p> </li> <li> <p>Esta configuraci\u00f3n l\u00f3gicamente va a variar en funci\u00f3n del proveedor, pero en el caso de VirtualBox se trata de una red de tipo NAT con el direccionamiento inicial 10.0.2.0/24. Las opciones de redes son:</p> </li> </ul>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#red-privada","title":"Red privada","text":"<p>En algunas ocasiones aparece la necesidad de utilizar un direccionamiento IP espec\u00edfico en una m\u00e1quina virtual o a\u00f1adir una red virtual adicional, por lo que en muchos casos es adecuado a\u00f1adir una red privada, tal como se explica en Private Networks.</p> <p>Ejemplo</p> <pre><code>config.vm.network \"private_network\", ip: \"192.168.55.10\"\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#red-publica","title":"Red p\u00fablica","text":"<p>Para vagrant una red p\u00fablica es una red en modo puente (bridged network) conectada al exterior, t\u00edpicamente ser\u00eda poner en la misma red la m\u00e1quina anfitriona y la m\u00e1quina virtual. M\u00e1s detalles en Public Networks</p> <p>Ejemplo</p> <pre><code>config.vm.network  \"public_network\", bridge: \"eth0\"\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#multi-maquinas","title":"Multi-m\u00e1quinas","text":"<ul> <li>Se puede extender la configuraci\u00f3n de un escenario virtual con vagrant a aquellos casos en los que haya m\u00e1s de una m\u00e1quina virtual y esto se hace con estructuras como la siguiente en el Vagrantfile:</li> </ul> <pre><code>Vagrant.configure(\"2\") do |config|\n  config.vm.define \"Server\" do |m1|\n    m1.vm.box = \"Ecodev/ubuntu-server-2204\"\n  end\n  config.vm.define \"Client\" do |m2|\n    m2.vm.box = \"hashicorp/bionic64\"\n  end\nend\n</code></pre> <ul> <li>Al existir m\u00e1s de una m\u00e1quina virtual, muchas de las instrucciones que hemos visto hasta ahora deben incluir el nombre de la m\u00e1quina como par\u00e1metro, por ejemplo si hici\u00e9ramos:</li> </ul> <pre><code>vagrant ssh Server\n</code></pre> <p>Ejemplo</p> <p>Crea un escenario para una aplicaci\u00f3n web en la que ubicamos en una m\u00e1quina el servidor Ubuntu 22 conectado a una red p\u00fablica exterior y una m\u00e1quina con un cliente en una m\u00e1quina no accesible desde el exterior. Para que ambas m\u00e1quinas est\u00e9n interconectadas entre s\u00ed, crea la red privada <code>10.0.100.0/24</code> a la que estar\u00e1n conectadas ambas m\u00e1quinas.</p> <pre><code>Vagrant.configure(\"2\") do |config|\n     config.vm.define \"ServerMulti1\" do |nodo1|\n       nodo1.vm.box = \"Ecodev/ubuntu-server-2204\"\n       nodo1.vm.hostname = \"UbuntuServerMulti\"\n       nodo1.vm.network \"public_network\", bridge: \"en0\"\n       nodo1.vm.network \"private_network\", ip: \"10.0.100.101\"\n     end\n     config.vm.define \"ClientMulti1\" do |nodo2|\n       nodo2.vm.box = \"hashicorp/bionic64\"\n       nodo2.vm.hostname = \"ClienteMulti\"\n       nodo2.vm.network \"private_network\", ip: \"10.0.100.102\"\n     end\n   end\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#actividades-de-clase-ap","title":"Actividades de clase (AP)","text":""},{"location":"05_VAGRANT/AyudaASO/065_VagrantIntro.html#ac64-introduccion-a-entornos-de-desarrollo-mediante-vagrant","title":"AC64. Introducci\u00f3n a entornos de desarrollo mediante Vagrant","text":"<p>Realiza los siguientes tareas introductorias a Vagrant.</p> <ol> <li>Monta el escenario necesario para trabajar con <code>Vagrant</code>.</li> </ol> <ul> <li>Instala <code>Vagrant</code>.</li> <li>Realiza un primer proyecto.</li> <li>Externaliza la carpeta de boxes a un disco externo (si es posible).</li> <li>Crea y destruye varias MVs.</li> </ul> <ol> <li> <p>Genera un Vagrantfile multim\u00e1quina con un servidor web y un cliente que pueda acceder al servidor de forma privada. El servidor debe tener salida a Internet. Comprueba que tiene acceso al <code>index.html</code> del servidor web y modif\u00edcalo.</p> </li> <li> <p>Crea un entorno de desarrollo portable con Vagrant con algunas de las boxes ma\u0301s utilizadas del cata\u0301logo (por ejemplo ubuntu/xenial64 o centos7):</p> </li> </ol> <ul> <li>Prueba los distintos tipos de <code>synced folders</code>. Comprueba si, para tu plataforma, en cada uno de ellos funciona adecuadamente los enlaces simbo\u0301licos y la sincronizacio\u0301n en uno y otro sentido:</li> <li>Shared folder de virtualbox \u25b9 Rsync</li> <li>NFS</li> <li>Prueba a compartir por los m\u00e9todos anteriores carpetas de tu equipo en otras ubicaciones de la ma\u0301quina guest.</li> </ul> <p>NOTA</p> <p>usa vagrant reload cada vez que cambies la configuracio\u0301n.</p> <ol> <li>Crea una m\u00e1quina con un NGINX y un reenv\u00edo de puertos, Genera una <code>Snapshot</code> haz alg\u00fan cambio en el <code>index.html</code>. Regenera la captura y comprueba que el index.html est\u00e1 como de inicio.</li> </ol>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html","title":"Configuraci\u00f3n Integrada de Sistemas Heterog\u00e9neos","text":""},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#justificacion","title":"Justificaci\u00f3n","text":"<p>En escenarios con un numero elevado de m\u00e1quinas, por ejemplo los servidores y clientes en un IES, los cuales se cuentan como decenas de equipos, la tarea de configuraci\u00f3n de servicios en dichos equipos se convierte en tediosa. Para solucionar este inconveniente existen herramientas de la gesti\u00f3n de la configuraci\u00f3n (configuration management systems) como <code>puppet</code>, <code>chef</code> o <code>ansible</code>.</p> <p>El campo de las herramientas de la gesti\u00f3n de la configuraci\u00f3n es muy amplio y su explicaci\u00f3n detallada sale del \u00e1mbito de este m\u00f3dulo, por lo que simplemente se realiza una breve introducci\u00f3n al respecto. En el caso de vagrant la soluci\u00f3n que se ha encontrado es muy razonable, ya que en lugar de desarrollar una nueva herramienta <code>Hashicorp</code> ha optado por una soluci\u00f3n m\u00e1s adecuada y razonable: integrarlas todas con vagrant.</p> <p>En este caso se va a trabajar el \"aprovisionamiento\" con scripts y <code>ansible</code>.</p>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#introduccion-ansible","title":"Introducci\u00f3n Ansible","text":""},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#que-es-ansible","title":"\u00bfQu\u00e9 es Ansible?","text":"<p>DOCUMENTACI\u00d3N OFICIAL</p> <ul> <li>Tecnologi\u0301a de software libre que nos permite aprovisionar sistemas.</li> <li>Mejoras significativas respecto a utilizar Shell scripts.</li> <li>Amplia gama de mo\u0301dulos para aprovisionar servidores.</li> <li>Herramienta declarativa. (NGINX installed)</li> <li>Sin necesidad de configurar agentes. SSH</li> </ul> <p>NOTA</p> <ul> <li>Con la arquitectura basada en agentes, los nodos deben instalar localmente un proceso de comunicaciones con la m\u00e1quina de control. </li> <li>Con la arquitectura sin agentes los nodos no necesitan instalar ni ejecutar en segundo plano ning\u00fan proceso que se comunique con la m\u00e1quina de control. </li> <li>Este tipo de arquitectura reduce la sobrecarga de la red y previene el uso de estrategias de control m\u00e1s agresivas por parte del servidor (como puede ser la realizaci\u00f3n de sondeos, con sus constantes operaciones de consulta).</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li> <p>Aprovisionamiento -&gt; Con Ansible se pueden aprovisionar las \u00faltimas plataformas en la nube, host virtualizados e hipervisores, dispositivos de red y servidores f\u00edsicos.</p> </li> <li> <p>Gesti\u00f3n de la configuraci\u00f3n -&gt; Establece y mantiene el rendimiento de los paquetes de software instalados y las ubicaciones y direcciones de red de los dispositivos de hardware.</p> </li> <li> <p>Despliegue de aplicaciones -&gt; Cuando se define la aplicaci\u00f3n con Ansible y se maneja su despliegue con Ansible Tower es posible llevar un control de todo el ciclo de vida de una aplicaci\u00f3n. Desde desarrollo hasta producci\u00f3n.</p> </li> <li> <p>Seguridad y Cumplimiento -&gt; Ansible permite definir las seguridad en los sistemas de forma sencilla. Utilizando la sintaxis de un Playbook es posible definir reglas de firewall, gesti\u00f3n de usuarios y grupos y pol\u00edticas de seguridad personalizadas en los sistemas que se est\u00e9n gestionando y adem\u00e1s posees un gran n\u00famero de m\u00f3dulos que ayudan en la labor.</p> </li> <li> <p>Orquestaci\u00f3n -&gt; Ansible se usa para orquestar los despliegues de OpenStack por ejemplo. Compa\u00f1\u00edas como Rackspace, CSC, HP, Cisco e IBM conf\u00edan en Ansible para mantener sus nubes OpenStack disponibles de manera simple y segura.</p> </li> </ul> <p>Nota</p> <ul> <li>OpenStack: es un proyecto de computaci\u00f3n en la nube para proporcionar una infraestructura como servicio (IaaS). Es un software libre y de c\u00f3digo abierto. Es decir, Cloud Computing Open Source.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#instalacion","title":"Instalaci\u00f3n","text":"<ul> <li>Para tener conexi\u00f3n a los servidores, es recomendable generar claves (p\u00fablica y privada) y copiar la p\u00fablica a los servidores que queremos configurar.</li> <li>Pasos instalaci\u00f3n -&gt; INSTALACI\u00d3N</li> </ul> <pre><code>sudo apt update\nsudo apt install software-properties-common\nsudo add-apt-repository --yes --update ppa:ansible/ansible\nsudo apt install ansible -y\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#arquitectura-ansible","title":"Arquitectura Ansible","text":"<p>Hay dos tipos de m\u00e1quinas necesarias en la arquitectura Ansible:</p> <ul> <li>Nodo del controlador </li> <li>Hosts gestionados.</li> </ul> <p>En la siguiente imagen se puede apreciar un esquema de la arquitectura de <code>Ansible</code>:</p> Arquitectura Ansible. <ul> <li>Los elementos principales de la arquitectura de Ansible son:</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#controlador","title":"Controlador","text":"<ul> <li>El nodo del controlador es la m\u00e1quina principal en la que se instala ansible. Todos los <code>Playbooks</code> se ejecutan desde un nodo de controlador. </li> <li>El nodo del controlador es el jefe de la arquitectura <code>ansible</code>.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#inventory","title":"Inventory","text":"<ul> <li>Todos los hosts administrados que estamos utilizando en el entorno ansible deben aparecer en un solo archivo simple, junto con las direcciones IP, ssh_password, ssh_user_name y muchos otros atributos de los hosts administrados. </li> <li>Ese archivo simple se conoce como Inventario en Ansible.</li> <li>La direcci\u00f3n del archivo de inventario debe darse en el archivo de configuraci\u00f3n ansible. </li> <li>El inventario puede ser din\u00e1mico y est\u00e1tico.</li> </ul> <p>Ejemplo</p> <pre><code>---\n[webservers]\nwww1.example.com\nwww2.example.com\n\n[dbservers]\ndb0.example.com\ndb1.example.com\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#playbooks","title":"Playbooks","text":"<ul> <li>Los \"manuales t\u00e9cnicos\" son archivos de texto simples escritos en el lenguaje <code>YAML</code> que consisten en una serie de ordenes de reproducci\u00f3n.</li> <li>Los Playbooks permiten realizar una serie de tareas en el orden en que se han escrito. </li> <li>Adem\u00e1s en ellos se almacenan el conjunto de instrucciones que se le dan al ansible para realizar una funcionalidad en particular.</li> <li>Un <code>Playbook</code> define el flujo de trabajo en una arquitectura ansible.</li> </ul> <p>Nota</p> <p><code>YAML</code> significa \"YAML Ain't Markup Language\" es un lenguaje de serializaci\u00f3n de datos que es un lenguaje f\u00e1cil de usar y se utiliza en la escritura de archivos JSON y playbooks.</p> <p>Ejemplo</p> <pre><code>---\n- hosts: webservers\n  serial: 5 # update 5 machines at a time\n  roles:\n  - common\n  - webapp\n\n- hosts: content_servers\n  roles:\n  - common\n  - content\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#module","title":"Module","text":"<ul> <li><code>Ansible</code> funciona conect\u00e1ndose a sus nodos y enviando scripts llamados \"M\u00f3dulos Ansibles\" a ellos.</li> <li><code>Ansible</code> ejecuta estos m\u00f3dulos (a trav\u00e9s de SSH por defecto) y los elimina cuando termina.</li> <li>La biblioteca de m\u00f3dulos puede residir en cualquier m\u00e1quina, y no se requieren servidores, demonios o bases de datos.</li> </ul> <p>Nota</p> <p>En ansible, hay cientos de m\u00f3dulos que se utilizan para realizar una amplia gama de tareas de automatizaci\u00f3n. Tambi\u00e9n podemos escribir nuestros propios m\u00f3dulos.</p> <p>Ejemplo</p> <p>C\u00f3mo conectarse a dispositivos RouterOS con la API de RouterOS</p> <pre><code>---\n- name: RouterOS test with API\n  hosts: localhost\n  gather_facts: false\n  vars:\n    hostname: 192.168.1.1\n    username: admin\n    password: test1234\n  tasks:\n    - name: Get \"ip address print\"\n      community.routeros.api:\n        hostname: \"{{ hostname }}\"\n        password: \"{{ password }}\"\n        username: \"{{ username }}\"\n        path: \"ip address\"\n        # The following options configure TLS/SSL.\n        # Depending on your setup, these options need different values:\n        tls: true\n        validate_certs: true\n        validate_cert_hostname: true\n        # If you are using your own PKI, specify the path to your CA certificate here:\n        # ca_path: /path/to/ca-certificate.pem\n      register: print_path\n\n    - name: Show IP address of first interface\n      ansible.builtin.debug:\n        msg: \"{{ print_path.msg[0].address }}\"\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#plugins","title":"Plugins","text":"<ul> <li>Los complementos aumentan la funcionalidad principal de Ansible. </li> <li>Mientras que los m\u00f3dulos se ejecutan en el sistema de destino en procesos separados (generalmente eso significa en un sistema remoto), los complementos se ejecutan en el nodo de control dentro del proceso <code>/usr/bin/ansible</code>. </li> <li>Los complementos ofrecen opciones y extensiones para las caracter\u00edsticas principales de Ansible: transformaci\u00f3n de datos, registro de la salida, conexi\u00f3n al inventario y m\u00e1s.</li> </ul>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#aprovisionamiento","title":"Aprovisionamiento","text":"<p>A continuaci\u00f3n se muestran unos breves ejemplos de aprovisionamiento de MVs con Scripts y <code>Ansible</code>.</p>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#vagrant-con-scripts","title":"Vagrant con Scripts","text":"<p>El objetivo es realizar un entorno de <code>Vagrant</code> sencillo en el que tras arrancar una m\u00e1quina se realiza una actualizaci\u00f3n de la lista de paquetes y se efect\u00faan las actualizaciones de aquellos paquetes necesarios mediante apt-get.</p> <ol> <li>Se crea el fichero <code>actualizar.sh</code> ubicado en el mismo directorio que el Vagrantfile y con el siguiente contenido:</li> </ol> <pre><code>#!/bin/bash\napt-get update\nDEBIAN_FRONTEND=noninteractive apt-get -y upgrade\n</code></pre> <ol> <li>Se crea el siguiente Vagrant file.</li> </ol> <pre><code>Vagrant.configure(\"2\") do |config|\n  config.vm.box = \"Ecodev/ubuntu-server-2204\"\n  config.vm.provision \"shell\", path: \"actualizar.sh\"\nend\n</code></pre>"},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#vagrant-con-ansible","title":"Vagrant con Ansible","text":"<p>Partiendo del mismo escenario que el anterior caso, pero ahora utilizando ansible, que debe estar instalado en la m\u00e1quina anfitriona.</p> <ol> <li>Se crea un fichero <code>site.yml</code> de configuraci\u00f3n de ansible para que se realice la actualizaci\u00f3n de paquetes:</li> </ol> <pre><code>---\n- name: actualizar\n  hosts: all\n  become: true\n  tasks:\n    - name: Ensure system is updated\n      apt: update_cache=yes upgrade=yes\n</code></pre> <ol> <li>El Vagrant file para aplicar la configuraci\u00f3n ser\u00eda:</li> </ol> <pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\n\nVagrant.configure(\"2\") do |config|\n  config.vm.box = \"Ecodev/ubuntu-server-2204\"\n  config.vm.provision \"ansible\" do |ansible|\n    ansible.playbook = \"site.yml\"\n  end\nend\n</code></pre> Actualizaci\u00f3n Vagrant con Ansible."},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#actividades-de-profundizacion-ap","title":"Actividades de profundizaci\u00f3n (AP)","text":""},{"location":"05_VAGRANT/AyudaASO/066_ConfigIntegra.html#pr62-automatizacion-de-servicios-de-recursos-compartidos","title":"PR62. Automatizaci\u00f3n de servicios de recursos compartidos","text":"<p>Realiza un proyecto por grupos de 3 para realizar una exposici\u00f3n en clase del siguiente punto:</p> <ol> <li>Despliega un sistema heterog\u00e9neo con Vagrant, para a continuaci\u00f3n aprovisionar, el sistema generado, un servicio Samba-DC. Se podr\u00e1 elegir entre aprovisionamiento con \"scripts\" o con Ansible. En la exposici\u00f3n se deben adjuntar las comprobaciones necesarias del correcto funcionamiento del servicio.</li> </ol> <p>Nota</p> <p>los sistemas heterog\u00e9neos a elegir son los mismos que el proyecto PR61.</p>"},{"location":"06_AD1/061_AD_Intro.html","title":"Directorio Activo en Windows Server","text":"<p>Cabe recordar que un servicio de directorio gestiona una base de datos organizada de modo jer\u00e1rquico con el objetivo de administrar de una manera sencilla los recursos de una red, almacenando informaci\u00f3n de cada elemento de la red de manera estructurada, lo que permite facilitar el proceso de b\u00fasqueda de los recursos y de autenticaci\u00f3n dentro de la red. </p> <p>Adem\u00e1s, en los siguientes apartados se recuerdan los elementos de los servicios de directorios ya vistos en Samba pero relacionados con Windows Server, en concreto en el servicio de Active directory.</p>"},{"location":"06_AD1/061_AD_Intro.html#estructura-fisica-de-active-directory","title":"Estructura f\u00edsica de Active Directory","text":"<p>El Directorio Activo o Active Directory (durante este m\u00f3dulo se utilizar\u00e1n indistintamente ambos nombres) forma parte del subsistema de seguridad de Windows Server ejecut\u00e1ndose en modo usuario. </p> Estructura f\u00edsica de AD <p>Note</p> <p>Las aplicaciones que se ejecutan en este modo no tienen acceso directo al sistema operativo ni al hardware, sino que como medida de seguridad, las peticiones realizadas a estos deben pasar previamente por un subsistema de seguridad y posteriormente por la capa de servicios ejecutivos.</p>"},{"location":"06_AD1/061_AD_Intro.html#arquitectura-del-subsistema-de-seguridad","title":"Arquitectura del subsistema de seguridad","text":"<p>Es un conjunto de componentes de seguridad que componen el modelo de seguridad de Windows. Estos componentes garantizan que las aplicaciones no puedan acceder a los recursos sin autenticaci\u00f3n y autorizaci\u00f3n. Los componentes del subsistema de seguridad se ejecutan en el contexto del proceso <code>Lsass.exe</code>, e incluyen lo siguiente:</p> <ul> <li>Autoridad de seguridad local.</li> <li>Servicio de inicio de sesi\u00f3n en red.</li> <li>Servicio de administrador de cuentas de seguridad.</li> <li>Servicio de servidor LSA (exige la aplicaci\u00f3n de directivas de seguridad local).</li> <li>Capa de Secure Sockets (Identificadores de sesiones seguros).</li> <li>Protocolo de autenticaci\u00f3n Kerberos v5 y protocolo de autenticaci\u00f3n NTLM.</li> </ul> <p>Nota</p> <ul> <li>Kerberos es un protocolo de autenticaci\u00f3n de redes de ordenador creado por el MIT que permite a dos ordenadores en una red insegura demostrar su identidad mutuamente de manera segura.</li> <li>NTLM: En una red de Windows, NT LAN Manager es un conjunto de protocolos de seguridad de Microsoft destinados a proporcionar autenticaci\u00f3n, integridad y confidencialidad a los usuarios. NTLM es el sucesor del protocolo de autenticaci\u00f3n en Microsoft LAN Manager, un producto anterior de Microsoft.</li> </ul>"},{"location":"06_AD1/061_AD_Intro.html#arquitectura-cliente-servidor","title":"Arquitectura cliente \u2013 servidor","text":"<p>Active Directory tambi\u00e9n esta basado en el modelo cliente-servidor es aquel en el que existen varios clientes, los cuales realizan peticiones a un servidor.</p> Esquema de red cliente servidor <p>Un servidor puede ser:</p> <ul> <li>Dedicado : La m\u00e1quina servidor s\u00f3lo se dedica a tareas de servicios en la red</li> <li>No dedicado : Adem\u00e1s de los servicios, la m\u00e1quina se puede usar como un puesto de trabajo m\u00e1s.</li> </ul>"},{"location":"06_AD1/061_AD_Intro.html#objetos-del-directorio-activo","title":"Objetos del Directorio Activo","text":"<p>El Directorio Activo es una implementaci\u00f3n concreta del protocolo LDAP. Este protocolo trata los elementos de la red como objetos. Los tipos de objetos b\u00e1sicos que existen en el Directorio Activo son:</p> <ul> <li>Usuarios.</li> <li>Grupos.</li> <li>Equipos.</li> <li>Dominios.</li> <li>Impresoras.</li> <li>Unidades Organizativas.</li> </ul> <p>Tip</p> <p>Sin embargo los administradores de sistemas pueden crear nuevos tipos de objetos o a\u00f1adir propiedades a alguna clase de los objetos modificando el esquema del Directorio Activo, para adaptar la estructura de la red a las necesidades particulares de la organizaci\u00f3n.</p>"},{"location":"06_AD1/061_AD_Intro.html#dominio","title":"Dominio","text":"<p>Representa un conjunto de equipos (clientes y servidores) que comparten una pol\u00edtica de seguridad y una base de datos com\u00fan. </p> <p>En concreto para el Directorio Activo de Windows:</p> <ul> <li>Componente fundamental de la estructura l\u00f3gica de Active Directory. </li> <li>Por definici\u00f3n, se trata de un conjunto de objetos de tipo equipo, usuario y otras clases de objetos que comparten una base de datos de directorio com\u00fan.</li> </ul> <p>Los servidores pueden ser:</p> <ul> <li> <p>Controladores de dominio : Contienen las cuentas de usuario y de otros datos del Directorio Activo. </p> <ul> <li>Debe haber al menos 1 por cada dominio.</li> </ul> </li> <li> <p>Servidores miembros del dominio : Se utilizan para almacenamiento de archivos y otros recursos compartidos en la red. No contienen informaci\u00f3n vital como cuentas de usuarios o pol\u00edticas de grupos.</p> </li> </ul> Servidores de Dominio"},{"location":"06_AD1/061_AD_Intro.html#diferencia-entre-grupo-de-trabajo-y-dominio","title":"Diferencia entre \"Grupo de Trabajo\" y \"Dominio\"","text":"<p>Cabe recordar la diferencia entre la gesti\u00f3n de usuarios con los Grupos de trabajo y Dominios.</p> <ul> <li>Grupo de trabajo: es un conjunto de ordenadores comunicados entre s\u00ed, que forman parte de un mismo grupo. No obstante toda la gesti\u00f3n de pol\u00edticas/grupos/usuarios/servicios/\u2026 son individuales por cada m\u00e1quina.El grupo de trabajo se configurar\u00eda en cada m\u00e1quina desde:</li> </ul> Configuraci\u00f3n \"Grupo de Trabajo\" y \"Dominio\". <ul> <li>Dominio permite gestionar usuarios, servicios, seguridad, recursos accesibles, etc.</li> </ul> <p>Note</p> <p>Es decir, en un directorio activo con dominio se crea un usuario y desde cualquier m\u00e1quina asociada al dominio se podr\u00eda registrar, en el caso de un grupo de trabajo deber\u00e1 estar creado el usuario manualmente en cada equipo del grupo de trabajo, y as\u00ed con las pol\u00edticas de grupo, etc. Por lo tanto con el grupo de trabajo aumentar\u00edamos la carga de gesti\u00f3n al en\u00e9simo usuario.</p>"},{"location":"06_AD1/061_AD_Intro.html#ventajasdesventajas-de-un-grupo-de-trabajo-frente-a-un-dominio","title":"Ventajas/Desventajas de un \"Grupo de Trabajo\" frente a un \"Dominio\"","text":"<ul> <li>Es m\u00e1s barato (no necesita un servidor y licencias).</li> <li>La gesti\u00f3n es mucho m\u00e1s tediosa porque tienes que hacerla equipo por equipo, mientras que en un dominio solo debes configurar el servidor, por tanto es menos escalable (imagina tener 200 ordenadores en un grupo de trabajo).</li> <li>El grupo de trabajo es mucho m\u00e1s inseguro , puesto que es m\u00e1s f\u00e1cil controlar pol\u00edticas de seguridad a trav\u00e9s de un servidor con pol\u00edticas generalizadas para todos los equipos, ya que no todos los usuarios tienen un conocimiento suficiente de inform\u00e1tica.</li> <li>Con el grupo de trabajo ser\u00e1 mucho m\u00e1s tedioso implementar servicios , por ejemplo un servidor de correo.</li> </ul>"},{"location":"06_AD1/061_AD_Intro.html#unidad-organizativa","title":"Unidad Organizativa","text":"<p>Las unidades organizativas nos ayudan a organizar los objetos de nuestro dominio (impresoras, usuarios, grupos, \u2026).</p> <ul> <li>Es parecido a la estructura de directorios (carpetas) de un sistema operativo, por ejemplo, dentro de nuestro dominio podemos tener una unidad organizativa por cada departamento de la empresa.</li> </ul> <p>En el siguiente ejemplo vemos un dominio con una unidad organizativa para usuarios de \"Contabilidad\", \"Recursos Humanos\", \"Inform\u00e1ticos\"y \"Marketing\".</p> Unidades Organizativas en Active Directory"},{"location":"06_AD1/061_AD_Intro.html#arboles","title":"\u00c1rboles:","text":"<p>Se da en redes muy grandes donde nos interesa segmentar en subdominios, de tal forma que el tr\u00e1fico o las peticiones de los usuarios al servidor de un subdominio, no se reciban en el servidor ra\u00edz, realizando de este modo un balanceo de carga de trabajo y ahorro en el ancho de banda de la red. No obstante la gesti\u00f3n sigue siendo centralizada desde el servidor ra\u00edz. Similar a DNS.</p> Objetos en Active Directory."},{"location":"06_AD1/061_AD_Intro.html#bosques","title":"Bosques","text":"<p>Un bosque es la uni\u00f3n de diferentes \u00e1rboles o dominios que conf\u00edan entre ellos, pero son dominios totalmente diferentes (USA.miempresa.com, EUROPA.miempresa.com y SPAIN.miempresa.com). </p> <ul> <li>Si se configura una confianza entre ellos los usuarios de un dominio tendr\u00e1n la posibilidad acceder a los recursos (o a ciertos recursos) de otro dominio que compartan el mismo bosque.</li> </ul> Ejemplo de Objetos en Active Directory."},{"location":"06_AD1/061_AD_Intro.html#roles-servicios","title":"Roles (Servicios)","text":"<p>Un rol de servidor es un conjunto de servicios que permiten a un equipo realizar una funci\u00f3n espec\u00edfica para varios usuarios u otros equipos de una red. B\u00e1sicamente est\u00e1 relacionado con el cometido de dicho servidor, un servidor puede tener m\u00faltiples roles.</p> <p>Ejemplos:</p> <ul> <li>Servidor DHCP.</li> <li>Servidor DNS.</li> <li>Servidor Active Directory.</li> <li>Servidor de virtualizaci\u00f3n (Hyper-V).</li> <li>Servidor Web.</li> <li>Acceso remoto.</li> <li>Servidor de impresi\u00f3n.</li> <li>Servidor de correo electr\u00f3nico.</li> </ul> <p>A su vez, un rol puede tener diferentes funcionalidades o subroles, los cuales pueden estar activados o no. Dichos \u201csubroles\u201d son servicios de rol. </p> <p>Example</p> <p>un Servidor DNS solo tiene una finalidad y, por lo tanto, no tienen servicios de rol disponibles. En cambio un Servicio de Archivos (para compartir ficheros) puede tener el servicio de rol para el protocolo NFS o no, es decir, puede tener habilitada la funci\u00f3n de servidor de ficheros NFS.</p> <p>Note</p> <p>Network File System, o NFS, es un protocolo de nivel de aplicaci\u00f3n, seg\u00fan el Modelo OSI. Es utilizado para sistemas de archivos distribuido en un entorno de red de computadoras de \u00e1rea local. Posibilita que distintos sistemas conectados a una misma red accedan a ficheros remotos como si se tratara de locales.</p> <ul> <li>Para Agregar Roles:</li> </ul> <p></p>"},{"location":"06_AD1/061_AD_Intro.html#servicios-de-ad-en-windows-server","title":"Servicios de AD en Windows Server","text":"<p>Cuando vayamos a a\u00f1adir nuestro rol de Active Directory al servidor, veremos que tenemos diferentes roles de Active Directory:</p> <p></p> <ul> <li> <p>Active Directory Lightweight Directory Services : Se trata de un Active Directory \"light\", no require de un dominio para su uso, simplemente alberga opciones/caracter\u00edsticas para ciertas aplicaciones que nos interese.</p> </li> <li> <p>Active Directory Rights Management Services : Nos ayuda a gestionar la protecci\u00f3n del acceso a nuestros ficheros del directorio activo. Por ejemplo si un documento se intenta abrir desde un usuario no autorizado.</p> </li> <li> <p>Servicios de certificados de Active Directory : Simplemente gestiona la creaci\u00f3n de certificados digitales. Es para entidades de certificaci\u00f3n oficial (seguridad inform\u00e1tica).</p> </li> <li> <p>Servicios de dominio de Active Directory: Este va a ser la opci\u00f3n que veremos en el m\u00f3dulo. Es el active directory relacionado con OpenLDAP de Linux.</p> </li> <li> <p>Servicio de federaci\u00f3n de Active Directory: Gestiona el acceso seguro desde dentro y desde fuera de tu red (Internet) a aplicaciones gestionadas en local por el servidor de Windows Active Directory. Obviamente con las credenciales de usuarios del active directory.</p> </li> </ul>"},{"location":"06_AD1/061_AD_Intro.html#base-de-datos-y-autentificacion","title":"Base de datos y Autentificaci\u00f3n","text":"<ul> <li>La base de datos de los usuarios, almacenada a trav\u00e9s de LDAP se almacena en los controladores de dominio. Adem\u00e1s el fichero \" ntds.dit\" ser\u00e1 el que almacene realmente dicha base de datos.</li> <li>La autenticaci\u00f3n de los usuarios se realizar\u00e1 a trav\u00e9s de Kerberos.</li> </ul>"},{"location":"06_AD1/062_WS_Config.html","title":"Configuraci\u00f3n B\u00e1sica Windows Server","text":"<p>Cuando se configura un Windows Server existen una serie de recomendaciones a realizar previamente a la instalaci\u00f3n de los diferentes roles a implementar, en este caso Active directory.</p> <p>A continuaci\u00f3n se muestran dichas recomendaciones.</p>"},{"location":"06_AD1/062_WS_Config.html#rastreador-de-eventos","title":"Rastreador de eventos","text":"<p>Un servidor, habitualmente, no debe apagarse o reiniciarse, al no ser que sea por un motivo de aver\u00eda o mantenimiento. Es por ello que cada vez que necesitemos reiniciarlo/apagarlo dejemos anotado a que es debido dicha acci\u00f3n.</p> <p>En Windows Server es recomendable usar \u201calt + f4\u201d para apagar, ya que nos permitir\u00e1 dejar una descripci\u00f3n de la raz\u00f3n por la que vamos a reiniciar/apagar el servidor. Obviamente esta descripci\u00f3n quedar\u00e1 almacenada en los logs y registros del sistema. </p>"},{"location":"06_AD1/062_WS_Config.html#actualizaciones","title":"Actualizaciones","text":"<p>En un servidor es muy importante que se mantenga actualizado, de lo contrario tendremos fallos de seguridad. No obstante, es importante que estas actualizaciones se realicen en horario de bajo impacto, ya que:</p> <ul> <li>Pueden ocupar parte del ancho de banda de nuestro servidor y los clientes pueden notar por ello una bajada del rendimiento.</li> <li>Vas a tener la CPU/RAM ocupada en actualizar los servicios en vez de atender las peticiones de clientes.</li> <li>Es posible que tras la actualizaci\u00f3n se realice un reinicio, si este reinicio no lo programamos en horas de bajo impacto, por ejemplo a las 03:00 am, supondr\u00e1 un corte en el servicio.</li> </ul>"},{"location":"06_AD1/062_WS_Config.html#configurar-horarios-de-reinicio","title":"Configurar horarios de reinicio","text":"<ul> <li>Se pueden configurar en \u201cConfiguraci\u00f3n de Windows Update\u201d y en \u201cCambiar horas activas\u201d</li> </ul> <p>En las horas activas elegiremos las horas en las que NO queremos que se reinicie el servidor, es decir, si estamos en una empresa que trabaja de 07:00 a 20:00,  \u00e9stas ser\u00e1n las horas activas. En caso de que sea una empresa 24/365, habr\u00eda que informar de un corte de servicio o tener duplicadas las m\u00e1quinas y que una soporte todo el trabajo mientras la otra se actualiza y viceversa.</p>"},{"location":"06_AD1/062_WS_Config.html#configurar-los-horarios-de-descarga-de-actualizaciones","title":"Configurar los horarios de descarga de actualizaciones","text":"<p>Se ejecutan las pol\u00edticas de grupo del equipo local. Para que salga la ventana de \u201cEjecutar\u201d lo m\u00e1s r\u00e1pido es tocar la tecla de Windows+R.</p> <p>Aunque lo veremos m\u00e1s adelante es importante que teng\u00e1is claro que las pol\u00edticas de grupo de un dominio prevalecen o tienen prioridad sobre las pol\u00edticas de grupo locales.</p> <p>Dentro de las directivas de grupo vamos a ir a:</p> <ul> <li>Configuraci\u00f3n del equipo local -&gt; Plantillas Administrativas -&gt; Componentes de Windows -&gt; Windows Update.</li> <li>Dentro de Windows Update elegiremos -&gt; Configurar Actualizaciones Autom\u00e1ticas.</li> </ul>"},{"location":"06_AD1/062_WS_Config.html#cuentas-locales-en-el-servidor","title":"Cuentas locales en el servidor","text":"<p>En un servidor, por defecto, \u00fanicamente la cuenta administrador activa. Las cuentas por defecto o de invitado est\u00e1n deshabilitadas (representadas con una flecha negra apuntando hacia abajo) por seguridad.</p> <p>No obstante, es posible que en nuestra empresa seamos m\u00e1s de un administrador del sistema y por tanto, es posible que cada administrador tenga su propia cuenta, por ejemplo para que quede registrado quien ha hecho cada acci\u00f3n dentro del servidor.</p> <p>Para crear cuentas locales vamos al icono de Windows de la barra de inicio y hacemos click en el bot\u00f3n derecho, eligiendo \u201cAdministraci\u00f3n de equipos\u201d.</p> <p>Seleccionando bot\u00f3n derecho se puede crear un usuario nuevo.</p> <p>Una vez creado el usuario, hay dos cosas que tenemos que tener en cuenta:</p> <ul> <li>Que tenga habilitado el acceso por escritorio remoto. Habitualmente los servidores de Windows Server se gestionan en remoto, ya que el servidor se encontrar\u00e1 en el CPD y el administrador en la oficina.</li> </ul> <ul> <li>Que tenga permisos de administrador, ya que al servidor solo acceder\u00e1n habitualmente nuestros compa\u00f1eros que sean tambi\u00e9n administradores del sistema.</li> </ul> <p>Buscaremos el grupo \u201cAdministradores\u201d y lo agregaremos al usuario.</p>"},{"location":"06_AD1/062_WS_Config.html#administrador-de-servidor","title":"Administrador de servidor","text":"<p>En el administrador de servidor podremos administrar todo:</p> <ul> <li>Servidores remotos.</li> <li>Servicios: DNS, NTP, DHCP, \u2026</li> <li>Notificaciones y alertas.</li> <li>Almacenamiento.</li> <li>Gestionar Copias de Seguridad.</li> <li>Monitorizaci\u00f3n del estado del servidor.</li> <li>Administraci\u00f3n de equipos / dispositivos.</li> </ul>"},{"location":"06_AD1/062_WS_Config.html#cambiar-nombre-al-servidor","title":"Cambiar nombre al servidor","text":"<p>Es importante indicar el nombre de nuestros equipos para que sea f\u00e1cil identificarlos. Debemos darles un nombre significativo, por ejemplo si este equipo va a ser un Controlador de Dominio y va a ser el primero, podemos ponerle \u201cDC01\u2026\u201d </p> <p>Tip</p> <p>Se recomienda no usar caracteres especiales en el nombre y por supuesto nada de espacios en blanco.</p> <p>Warning</p> <p>Es importante cambiar el nombre antes de tener configurado el Directorio Activo, ya que si no habr\u00e1 que cambiar todo lo relacionado con la resoluci\u00f3n de nombres (DNS).</p>"},{"location":"06_AD1/062_WS_Config.html#escritorio-remoto","title":"Escritorio Remoto","text":"<p>Habitualmente nuestro servidor estar\u00e1 en un CPD, posiblemente ser\u00e1 un servidor virtualizado. Lo que hace esencial configurar correctamente la herramienta pertinente para su administraci\u00f3n remota. En el caso de Windows Server, que cuenta con una buena interfaz gr\u00e1fica, haremos uso de Escritorio Remoto (RDP), del cual tenemos que ser consciente que es un servicio bastante atacado por ciberdelincuentes. Tambi\u00e9n se puede gestionar por consola a trav\u00e9s de PowerShell.</p> <p>Obviamente aparte de tener habilitado el Escritorio remoto, el usuario debe tener permisos de acceso remoto al servidor.</p> <p>Por defecto una misma cuenta de usuario solo puede conectarse una vez de forma simult\u00e1nea.</p>"},{"location":"06_AD1/062_WS_Config.html#configuracion-de-red","title":"Configuraci\u00f3n de Red","text":"<p>La configuraci\u00f3n de red se hace igual que un Windows Cliente. </p> <p>En cuanto a la m\u00e1quina virtual depender\u00e1 de nuestros recursos (memoria, CPU, discos SSD, gr\u00e1fica):</p> <ul> <li>M\u00e1quina virtual para  Windows 10 y para Windows Server 2019.</li> </ul>"},{"location":"06_AD1/062_WS_Config.html#seguridad-firewall","title":"Seguridad (Firewall)","text":"<p>Cada vez que arrancamos un servicio (Remote Desktop Protocol, DHCP, DNS, \u2026 ) se abren una serie de puertas (puertos de red). Los ciberdelincuentes atacan estos puertos \u201cabiertos\u201d para intentar conseguir acceso indebido.</p> <p>Por todo ello, es importante tener abiertas solo las puertas (puertos) estrictamente necesario, es decir, si nuestro servidor no va a hacer uso de un servicio DNS, no lo actives.</p> <p>Adem\u00e1s, una herramienta muy importante para controlar esto es el \u201cFirewall\u201d:</p> <p>Existir\u00e1n unas reglas diferentes dependiendo de la IP del equipo que realiza la petici\u00f3n:</p> <ul> <li>Si la IP viene de Internet (Red P\u00fablica).</li> <li>Si la IP viene de mi red local (Red Privada).</li> <li>Si la IP viene de un equipo asociado al dominio (Red Dominio).</li> </ul> <p>En la configuraci\u00f3n podemos decirle que bloquee el acceso a las aplicaciones dependiendo de la red  de  donde provengan, por ejemplo si en la red p\u00fablica bloqueamos todas las conexiones, querr\u00e1 decir que solo podremos administrar el servidor desde una red privada o red del dominio.</p> <p>No obstante, quiz\u00e1 queramos que ciertas aplicaciones s\u00ed sean accesibles desde la red p\u00fablica y otras no. En tal caso, deberemos a\u00f1adir reglas por aplicaciones:</p> <p>Por ejemplo indicar que solo se puede gestionar este equipo de forma remota desde una red privada.</p> <p>Tambi\u00e9n se pueden crear filtros avanzados:</p> <p>Por ejemplo aqu\u00ed vemos que el Escritorio Remoto actualmente est\u00e1 usando el puerto 3389 mediante UDP. Si no tiene el icono verde, es que no est\u00e1 habilitada la regla.</p> <p>Si hacemos doble click en cualquier regla podremos manipular:</p> <ul> <li>La aplicaci\u00f3n a la que afecta.</li> <li>Filtrar por usuarios, interfaces (al\u00e1mbricas, inal\u00e1mbricas, remotas), tipos de red (p\u00fablica, privada, dominio) o direccionamiento IP.</li> <li>Puerto y Protocolo (TCP o UDP) usado.</li> </ul> <p>Podemos crear nuestras propias reglas:</p> <p>Visor de Eventos.</p> <p>Esta herramienta nos mostrar\u00e1 la informaci\u00f3n del estado de las aplicaciones y servicios de nuestro servidor.</p> <p>Debemos habituarnos a ver el visor de eventos de forma regular para confirmar que nuestros servicios no est\u00e1n fallando o a punto de fallar.  El visor de eventos  tambi\u00e9n resulta \u00fatil para sacar la informaci\u00f3n en caso de que un servicio est\u00e9 fallando.</p> Visor de Eventos Windows Server. <p>Podemos filtrar los eventos por tiempo (\u00faltimas 24h, 1h, 30 min, \u2026), por aplicaci\u00f3n que ha generado el evento, usuarios, etc\u2026</p> Filtrar Eventos por tiempos. <p>Una cosa importante es la pol\u00edtica de eventos con las aplicaciones, especialmente aquellas que ofrecen un servicio y son m\u00e1s propicias a ser atacadas o m\u00e1s cr\u00edticas. Se asigna una cantidad de memoria que pueden usar los registros (logs), pasado esta capacidad se debe decidir si sobrescribir o no sobrescribir los logs. Lo habitual ser\u00eda no sobrescribir, pero debemos estar atentos a la capacidad total que van acumulando para ir elimin\u00e1ndolos manualmente o mediante un script cada cierto tiempo.</p> <p>Con el icono vaciar registro podemos borrar los eventos de la aplicaci\u00f3n seleccionada.</p> Borrar Eventos de la aplicaci\u00f3n. <p>En caso de tener un error del sistema podemos visualizarlos en la pesta\u00f1a de \u201cSistema\u201d, cada error registrado del sistema tiene un identificador (ID) que ser\u00e1 el que usemos en caso de querer buscar informaci\u00f3n del error en Internet.</p> <p>Es recomendable, mirar todos los d\u00edas el registro de eventos del sistema.</p> <p>Importante diferenciar entre un \u201cError\u201d y un \u201cWarning / Aviso\u201d, el primero es que ya ha habido un problema grave que debe ser resuelto, el segundo es una alerta de algo que deber\u00eda revisarse, pero que no ha ocasionado un problema cr\u00edtico.</p> Comprobar errores del sistema. <p>Al igual que con las aplicaciones podemos decidir qu\u00e9 hacer con los registros de eventos referidos al sistema:</p> Registros de Eventos del sistema."},{"location":"06_AD1/062_WS_Config.html#monitor-de-recursos","title":"Monitor de recursos","text":"<p>El monitor de recursos nos da informaci\u00f3n sobre la memoria libre, el rendimiento de la cpu, lecturas en disco, etc. Esto nos puede dar informaci\u00f3n si fuera necesario ampliar o mejorar alg\u00fan componente hardware de nuestro servidor.</p> <p>Si queremos analizar o monitorizar valores m\u00e1s espec\u00edficos debemos ir al monitor de rendimiento y a\u00f1adir a la gr\u00e1fica los datos que deseamos.</p> Estad\u00edsticas de datos seleccionados. <p>Podemos generar un resumen/informe de todo el sistema, referente al rendimiento de \u00e9ste:</p> Generaci\u00f3n informe I. Generaci\u00f3n informe II. Generaci\u00f3n informe III. <p>Podemos exportar a alg\u00fan fichero el resumen de todo el informe del rendimiento del sistema.</p> Generaci\u00f3n informe IV."},{"location":"06_AD1/062_WS_Config.html#nic-redundante","title":"NIC redundante","text":"<p>Una NIC (Network Interface Controller) no es m\u00e1s que un adaptador de red o tarjeta de red. Con una NIC redundante queremos decir que uno o m\u00e1s adaptadores de red trabajan como uno, pudiendo mejorar el ancho de banda total que puede cursar y dotando al sistema de una mayor disponibilidad, pues si uno de los adaptadores de red fallara, tendr\u00edamos otros y no se cortar\u00eda la conexi\u00f3n.</p> <p>Tip</p> <p>Es muy habitual en todos los servidores tener m\u00e1s de un adaptador de red.</p> <ul> <li>En el siguiente v\u00eddeo puedes encontrar una ayuda para realizar un NIC redundante</li> </ul> <p>PINCHA AQU\u00cd para video de Configuraci\u00f3n NIC Redundante</p>"},{"location":"06_AD1/062_WS_Config.html#pt61-configuracion-windows-server","title":"PT61. Configuraci\u00f3n Windows Server","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE5, CE7 y CE9 del RA1 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Partiendo de la Situaci\u00f3n de aprendizaje de PT41, la empresa Area Studio decide hacer un cambio de infraestructura, de Ubuntu Server a Windows Server para facilitar su administraci\u00f3n por los t\u00e9cnicos de mantenimiento propios los cuales son de nivel 1. </p> <p>Tarea</p> <p>Area Studio solicita de nuevo un proyecto a NetOS para instalar dicho Windows Server con Active Directory, el cual debes realizar. Inicialmente te propones pre-configurar el Windows Server con las siguientes premisas.</p> <ol> <li>\u00bfC\u00f3mo har\u00edas para filtrar en el visor de eventos todos los eventos cr\u00edticos de seguridad?</li> <li> <p>C\u00f3mo cambiar\u00edas las propiedades de un evento para que:</p> <ol> <li>Aumente la capacidad m\u00e1xima del registro a 50MB.</li> <li>No sobrescribiese cuando el log alcanzar\u00e1 la capacidad m\u00e1ximo, es decir, que archive el log.</li> <li>Indica cual es la ruta y el nombre del log seleccionado.</li> <li>\u00bfQu\u00e9 sucede si vas a dicha carpeta y abres con doble click el log seleccionado?</li> </ol> </li> <li> <p>Genera un informe de tu sistema.</p> </li> <li>Crea un Segundo adaptador de red en tu m\u00e1quina virtual de Windows Server 2019.</li> <li>Crea un equipo de NIC y muestra el proceso mediante un v\u00eddeo o mediante capturas de pantalla.</li> <li>Configura una IP fija en tu NIC virtual.</li> </ol>"},{"location":"06_AD1/063_AD_Install.html","title":"Instalaci\u00f3n de Active Directory","text":"<p>A continuaci\u00f3n se muestran los pasos para la instalaci\u00f3n de Active Directory.</p>"},{"location":"06_AD1/063_AD_Install.html#creacion-de-un-dominio","title":"Creaci\u00f3n de un dominio","text":"<p>El primer paso para la creaci\u00f3n del Active directory es crear un dominio; en el equipo Controlador de Dominio, y debe ser un equipo preparado para aguantar altas cargas de trabajo con una alta disponibilidad, y con un sistema operativo servidor instalado. </p> <ul> <li>Para crear un dominio hay que acceder al Administrador del Servidor y accedemos a -&gt;  Agregar Roles y Caracter\u00edsticas:</li> </ul> Creaci\u00f3n de un dominio I. <ul> <li>Aparece el asistente para comenzar con la creaci\u00f3n del dominio:</li> </ul> Creaci\u00f3n de un dominio II. <ul> <li>Se selecciona una instalaci\u00f3n basada en caracter\u00edsticas y roles.</li> </ul> Creaci\u00f3n de un dominio III. <ul> <li>Una vez seleccionada la instalaci\u00f3n basada en roles, se selecciona el servidor que ser\u00e1 donde vamos a instalar nuestro Active Directory:</li> </ul> Creaci\u00f3n de un dominio IV. <ul> <li>Se selecciona el rol Servicios de Dominio de Active Directory:</li> </ul> Creaci\u00f3n de un dominio V. <ul> <li>Aparecer\u00e1 marcado el rol tal y como muestra la siguiente figura:</li> </ul> Creaci\u00f3n de un dominio VI. Creaci\u00f3n de un dominio VII. <ul> <li>Se procede a realizar la instalaci\u00f3n. Cuando se agrega un nuevo rol, podemos hacer clic en la opci\u00f3n de reiniciar en caso de que fuera necesario. En caso que el rol o la caracter\u00edstica no fuera necesario un reinicio, no lo har\u00eda.</li> </ul> Creaci\u00f3n de un dominio VIII. <p>Un vez instalado, el asistente muestra que es necesario realizar una configuraci\u00f3n. En este caso hay que promover el servidor a un servidor de controlador de dominio. As\u00ed que se hace clic en la opci\u00f3n de promover servidor a controlador de dominio :</p> Creaci\u00f3n de un dominio IX. <ul> <li> <p>Se ejecuta el asistente, y las primeras pantallas ofrecen informaci\u00f3n \u00fatil para la creaci\u00f3n del dominio.</p> </li> <li> <p>Se selecciona Agregar un nuevo bosque.</p> </li> </ul> <p>Nota</p> <p>Un conjunto de dominios agrupados l\u00f3gicamente conforman un \u00e1rbol de dominios y un conjunto de \u00e1rboles de dominio agrupados l\u00f3gicamente conforman un bosque. En este caso se especifica el dominio sor.com en lugar de CEFIRE2019.LOCAL como indica en la imagen:</p> Agregar un nuevo Bosque. <ul> <li>A continuaci\u00f3n, aparece informaci\u00f3n sobre el nivel funcional del nuevo bosque. Seg\u00fan el nivel funcional que se establezca, se implementa un directorio activo compatible con versiones anteriores de Windows Server, pero m\u00e1s limitado en cuanto a funciones, o menos compatible con versiones antiguas, pero con mayores funcionalidades. </li> </ul> <p>Tip</p> <p>En nuestro caso, seleccionaremos el mayor nivel funcional (Windows Server 2016) ya que todos los controladores del dominio tendr\u00e1n instalado, al menos, Windows Server 2016. Tambi\u00e9n se a\u00f1ade la contrase\u00f1a para la restauraci\u00f3n del dominio, por defecto la misma que la del administrador.</p> Creaci\u00f3n de un dominio X. <ul> <li>La siguiente tarea que llevar\u00e1 a cabo el asistente para la creaci\u00f3n del dominio, ser\u00e1 preguntar por ciertas opciones adicionales del servidor, como por ejemplo la configuraci\u00f3n del servicio DNS. Como en nuestro caso no se tiene DNS, dejaremos que el asistente cree una zona de DNS para que nuestro dominio pueda funcionar.</li> </ul> Creaci\u00f3n de un dominio XI. <ul> <li>A continuaci\u00f3n aparece la ubicaci\u00f3n donde se guardar\u00e1 los objetos del AD, es decir, la base de datos:</li> </ul> Creaci\u00f3n de un dominio XII. <p>Seguidamente nos muestra las configuraciones que se van a realizar. </p> <p>Note</p> <p>Como se puede observar tambi\u00e9n se puede exportar el script para poder ejecutar los mismos comandos a trav\u00e9s de PowerShell:</p> Creaci\u00f3n de un dominio XIII. <p>En el siguiente paso se muestra un resumen de los Requisitos previos:</p> Comprobaci\u00f3n de requisitos previos. <ul> <li>Y finalmente se realiza la instalaci\u00f3n. La pantalla de inicio de sesi\u00f3n, ahora ser\u00e1 diferente, ya que aparece el dominio al que se va a iniciar la sesi\u00f3n del usuario:</li> </ul> <p>Note</p> <p>Nos aparecer\u00e1 SOR en lugar de CEFIRE2019</p> Nueva pantalla inicio de sesi\u00f3n con Dominio. <ul> <li>Una vez instalado, podemos iniciar sesi\u00f3n con el Administrador del dominio. Podemos comprobar que en el panel de Administrador de Servidor aparece nuestro dominio configurado sor.com en lugar de CEFIRE2019.LOCAL</li> </ul> Comprobaci\u00f3n Dominio en el Administrador del Servidor."},{"location":"06_AD1/063_AD_Install.html#unir-clientes-al-dominio","title":"Unir clientes al dominio","text":""},{"location":"06_AD1/063_AD_Install.html#anadir-maquinas-clientes-al-dominio","title":"A\u00f1adir m\u00e1quinas clientes al dominio","text":"<p>Para incluir en el dominio los equipos que actuar\u00e1n como cliente hay que configurar las propiedades de Internet de cada una de las m\u00e1quinas que vamos a unir al dominio, teniendo en cuenta que:</p> <p>Nota</p> <ul> <li>La direcci\u00f3n del controlador de dominio (que implementa funciones de DNS) en este ejemplo es la 192.168.5.1X, en tu caso ser\u00e1 la IP fija de la m\u00e1quina que le hayas asignado. </li> <li>Adem\u00e1s, en la red que se ha montado como ejemplo hay un elemento de interconexi\u00f3n con IP 192.168.100.1 que implementa las funciones de puerta de enlace y de DNS, por ese motivo se ha incluido como puerta de enlace predeterminada y como DNS secundario, sin embargo estos dos campos no son necesarios si \u00fanicamente queremos trabajar en el interior de una \u00fanica red.  </li> </ul> <p>A continuaci\u00f3n, en el siguiente ejemplo, se revisa la configuraci\u00f3n de la m\u00e1quina cliente Windows 10 que se valida en el dominio Windows Server 2019:</p> Configuraci\u00f3n red cliente Windows 10. <p>Advertencia</p> <ul> <li>La figura anterior es un ejemplo de configuraci\u00f3n, habr\u00e1 que adaptar la configuraci\u00f3n al rango utilizado en las m\u00e1quinas virtuales en Red NAT.</li> <li>Adem\u00e1s la m\u00e1quina cliente utilizada es Windows 11 en lugar de windows 10.</li> </ul> <ul> <li>Se comprueba tambi\u00e9n que desde la m\u00e1quina cliente podamos hacer ping a nuestro dominio, esto es al dominio sor.com. Para ello abrimos una terminal en la m\u00e1quina Windows 10 (Tecla Windows + R y luego cmd) y se comprueba que el ping al dominio funcione. </li> </ul> <p>Warning</p> <p>Es importante que este ping funcione, en caso contrario no se podr\u00e1 realizar la validaci\u00f3n en nuestro dominio.</p> ping al dominio. <ul> <li>Y ahora s\u00ed, ya se puede unir nuestra m\u00e1quina al dominio. Para ello, en Windows 10, se selecciona el bot\u00f3n de inicio y con el bot\u00f3n de la derecha del rat\u00f3n, se selecciona Sistema:</li> </ul> Unir cliente windows 10 a dominio I. <ul> <li>Se selecciona Conectar a la red del trabajo o colegio y nos aparecer\u00e1 la siguiente informaci\u00f3n:</li> </ul> Unir cliente windows 10 a dominio II. <ul> <li>Se presiona \"clic\" en Conectar:</li> </ul> Unir cliente windows 10 a dominio III. <ul> <li>Se selecciona la opci\u00f3n de Unir este dispositivo a un dominio local de Active Directory. Aparecer\u00e1 una ventana para introducir el nombre de dominio al que se debe conectar:</li> </ul> Unir cliente windows 10 a dominio IV. <p>En este caso, se introduce el nombre de dominio, sor.com en lugar de CEFIRE2019.LOCAL:</p> Unir cliente windows 10 a dominio V. <p>Advertencia</p> <p>Para poder realizar la validaci\u00f3n, hay que introducir la cuenta del Administrador del dominio y su contrase\u00f1a, importante que recuerdes esta contrase\u00f1a.</p> Unir cliente windows 10 a dominio VI. <ul> <li>Se selecciona que el administrador tenga los privilegios propios de administrador en la m\u00e1quina cliente, para ello se selecciona Tipo Cuenta y se marca la opci\u00f3n de Administrador. Se reinicia la m\u00e1quina y ya tenemos el cliente Windows 10 validado en el dominio.</li> </ul> Unir cliente windows 10 a dominio VI. <ul> <li>A partir de este momento, ya se puede iniciar sesi\u00f3n con cualquier usuario del dominio.</li> </ul> Unir cliente windows 10 a dominio VII. <ul> <li>Tambi\u00e9n se puede ver en el servidor, desde el panel del Administrador de Servidor la m\u00e1quina. Para ello, desde la m\u00e1quina Windows Server 2019, se accede al Administrador de Servidor --&gt; Herramientas --&gt; Usuarios y Equipos de Active Directory:</li> </ul> Unir cliente windows 10 a dominio VIII. <ul> <li>Se selecciona el dominio sor.com y luego Computers. Aparecer\u00e1 la m\u00e1quina cliente \"NombreM\u00e1quina\", si se selecciona, con el bot\u00f3n de la derecha del rat\u00f3n --&gt; propiedades. Aqu\u00ed se puede ver alguna informaci\u00f3n relativa a la m\u00e1quina conectada.</li> </ul> Unir cliente windows 10 a dominio IX."},{"location":"06_AD1/063_AD_Install.html#pt62-instalacion-de-active-directory","title":"PT62. Instalaci\u00f3n de Active Directory","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE5, CE7 y CE9 del RA1 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Partiendo de la Situaci\u00f3n de aprendizaje de PT61, y despu\u00e9s de la configuraci\u00f3n previa del Windows Server. </p> <p>Tarea</p> <p>Se debe proceder a la instalaci\u00f3n del Active Directory, realizando las siguientes premisas.</p> <ol> <li>Instalar y promocionar un servidor a controlador de dominio, en el Windows Server.</li> <li>Unir un equipo cliente al dominio con usuario de administrador.</li> </ol>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html","title":"Directorio Activo en Windows Server","text":"<p>Un servicio de directorio gestiona una base de datos organizada de modo jer\u00e1rquico con el objetivo de administrar de una manera sencilla los recursos de una red, almacenando informaci\u00f3n de cada elemento de la red de manera estructurada, lo que permite facilitar el proceso de b\u00fasqueda de los recursos y de autenticaci\u00f3n dentro de la red.</p>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#estructura-fisica-de-active-directory","title":"Estructura f\u00edsica de Active Directory","text":"<p>El Directorio Activo o Active Directory, durante este m\u00f3dulo se utilizar\u00e1n indistintamente ambos nombres; forma parte del subsistema de seguridad de Windows Server ejecut\u00e1ndose en modo usuario. </p> Estructura f\u00edsica de AD <p>Note</p> <p>Las aplicaciones que se ejecutan en este modo no tienen acceso directo al sistema operativo ni al hardware, sino que como medida de seguridad, las peticiones realizadas a estos deben pasar previamente por un subsistema de seguridad y posteriormente por la capa de servicios ejecutivos.</p>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#arquitectura-del-subsistema-de-seguridad","title":"Arquitectura del subsistema de seguridad","text":"<p>Es un conjunto de componentes de seguridad que componen el modelo de seguridad de Windows. Estos componentes garantizan que las aplicaciones no puedan acceder a los recursos sin autenticaci\u00f3n y autorizaci\u00f3n. Los componentes del subsistema de seguridad se ejecutan en el contexto del proceso <code>Lsass.exe</code>, e incluyen lo siguiente:</p> <ul> <li>Autoridad de seguridad local.</li> <li>Servicio de inicio de sesi\u00f3n en red.</li> <li>Servicio de administrador de cuentas de seguridad.</li> <li>Servicio de servidor LSA (exige la aplicaci\u00f3n de directivas de seguridad local).</li> <li>Capa de Secure Sockets (Identificadores de sesiones seguros).</li> <li>Protocolo de autenticaci\u00f3n Kerberos v5 y protocolo de autenticaci\u00f3n NTLM.</li> </ul> <p>Nota</p> <ul> <li>Kerberos es un protocolo de autenticaci\u00f3n de redes de ordenador creado por el MIT que permite a dos ordenadores en una red insegura demostrar su identidad mutuamente de manera segura.</li> <li>NTLM: En una red de Windows, NT LAN Manager es un conjunto de protocolos de seguridad de Microsoft destinados a proporcionar autenticaci\u00f3n, integridad y confidencialidad a los usuarios. NTLM es el sucesor del protocolo de autenticaci\u00f3n en Microsoft LAN Manager, un producto anterior de Microsoft.</li> </ul>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#arquitectura-cliente-servidor","title":"Arquitectura cliente \u2013 servidor","text":"<p>Active Directory tambi\u00e9n esta basado en el modelo cliente-servidor es aquel en el que existen varios clientes, los cuales realizan peticiones a un servidor.</p> Esquema de red cliente servidor <p>Un servidor puede ser:</p> <ul> <li>Dedicado : La m\u00e1quina servidor s\u00f3lo se dedica a tareas de servicios en la red</li> <li>No dedicado : Adem\u00e1s de los servicios, la m\u00e1quina se puede usar como un puesto de trabajo m\u00e1s.</li> </ul>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#objetos-del-directorio-activo","title":"Objetos del Directorio Activo","text":"<p>El Directorio Activo es una implementaci\u00f3n concreta del protocolo LDAP. Este protocolo trata los elementos de la red como objetos. Los tipos de objetos b\u00e1sicos que existen en el Directorio Activo son:</p> <ul> <li>Usuarios.</li> <li>Grupos.</li> <li>Equipos.</li> <li>Dominios.</li> <li>Impresoras.</li> <li>Unidades Organizativas.</li> </ul> <p>Tip</p> <p>Sin embargo los administradores de sistemas pueden crear nuevos tipos de objetos o a\u00f1adir propiedades a alguna clase de los objetos modificando el esquema del Directorio Activo, para adaptar la estructura de la red a las necesidades particulares de la organizaci\u00f3n.</p>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#dominio","title":"Dominio","text":"<p>Representa un conjunto de equipos (clientes y servidores) que comparten una pol\u00edtica de seguridad y una base de datos com\u00fan. </p> <p>En concreto para el Directorio Activo de Windows:</p> <ul> <li>Componente fundamental de la estructura l\u00f3gica de Active Directory. </li> <li>Por definici\u00f3n, se trata de un conjunto de objetos de tipo equipo, usuario y otras clases de objetos que comparten una base de datos de directorio com\u00fan.</li> </ul> <p>Los servidores pueden ser:</p> <ul> <li> <p>Controladores de dominio : Contienen las cuentas de usuario y de otros datos del Directorio Activo. </p> <ul> <li>Debe haber al menos 1 por cada dominio.</li> </ul> </li> <li> <p>Servidores miembros del dominio : Se utilizan para almacenamiento de archivos y otros recursos compartidos en la red. No contienen informaci\u00f3n vital como cuentas de usuarios o pol\u00edticas de grupos.</p> </li> </ul> Servidores de Dominio"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#diferencia-entre-grupo-de-trabajo-y-dominio","title":"Diferencia entre \"Grupo de Trabajo\" y \"Dominio\"","text":"<p>Cabe recordar la diferencia entre la gesti\u00f3n de usuarios con los Grupos de trabajo y Dominios.</p> <ul> <li>Grupo de trabajo: es un conjunto de ordenadores comunicados entre s\u00ed, que forman parte de un mismo grupo. No obstante toda la gesti\u00f3n de pol\u00edticas/grupos/usuarios/servicios/\u2026 son individuales por cada m\u00e1quina.El grupo de trabajo se configurar\u00eda en cada m\u00e1quina desde:</li> </ul> Configuraci\u00f3n \"Grupo de Trabajo\" y \"Dominio\". <ul> <li>Dominio como ya se ha visto (OpenLDAP) desde un servidor se puede gestionar todo, usuarios, servicios, seguridad, recursos accesibles, etc.</li> </ul> <p>Note</p> <p>Es decir, en un directorio activo con dominio se crea un usuario y desde cualquier m\u00e1quina asociada al dominio se podr\u00eda registrar, en el caso de un grupo de trabajo deber\u00e1 estar creado el usuario manualmente en cada equipo del grupo de trabajo, y as\u00ed con las pol\u00edticas de grupo, etc. Por lo tanto con el grupo de trabajo aumentar\u00edamos la carga de gesti\u00f3n al en\u00e9simo usuario.</p>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#ventajasdesventajas-de-un-grupo-de-trabajo-frente-a-un-dominio","title":"Ventajas/Desventajas de un \"Grupo de Trabajo\" frente a un \"Dominio\"","text":"<ul> <li>Es m\u00e1s barato (no necesita un servidor y licencias).</li> <li>La gesti\u00f3n es mucho m\u00e1s tediosa porque tienes que hacerla equipo por equipo, mientras que en un dominio solo debes configurar el servidor, por tanto es menos escalable (imagina tener 200 ordenadores en un grupo de trabajo).</li> <li>El grupo de trabajo es mucho m\u00e1s inseguro , puesto que es m\u00e1s f\u00e1cil controlar pol\u00edticas de seguridad a trav\u00e9s de un servidor con pol\u00edticas generalizadas para todos los equipos, ya que no todos los usuarios tienen un conocimiento suficiente de inform\u00e1tica.</li> <li>Con el grupo de trabajo ser\u00e1 mucho m\u00e1s tedioso implementar servicios , por ejemplo un servidor de correo.</li> </ul>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#unidad-organizativa","title":"Unidad Organizativa","text":"<p>Las unidades organizativas nos ayudan a organizar los objetos de nuestro dominio (impresoras, usuarios, grupos, \u2026).</p> <ul> <li>Es parecido a la estructura de directorios (carpetas) de un sistema operativo, por ejemplo, dentro de nuestro dominio podemos tener una unidad organizativa por cada departamento de la empresa.</li> </ul> <p>En el siguiente ejemplo vemos un dominio con una unidad organizativa para usuarios de \"Contabilidad\", \"Recursos Humanos\", \"Inform\u00e1ticos\"y \"Marketing\".</p> Unidades Organizativas en Active Directory"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#arboles","title":"\u00c1rboles:","text":"<p>Se da en redes muy grandes donde nos interesa segmentar en subdominios, de tal forma que el tr\u00e1fico o las peticiones de los usuarios al servidor de un subdominio no llegan al servidor ra\u00edz y por nos ayuda con el balanceo de carga de trabajo y ahorro en el ancho de banda de la red. No obstante la gesti\u00f3n sigue siendo centralizada desde el servidor ra\u00edz. Similar a DNS.</p> Objetos en Active Directory."},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#bosques","title":"Bosques","text":"<p>Un bosque es la uni\u00f3n de diferentes \u00e1rboles o dominios que conf\u00edan entre ellos, pero son dominios totalmente diferentes (USA.miempresa.com, EUROPA.miempresa.com y SPAIN.miempresa.com). </p> <ul> <li>Si se configura una confianza entre ellos los usuarios de un dominio tendr\u00e1n la posibilidad acceder a los recursos (o a ciertos recursos) de otro dominio que compartan el mismo bosque.</li> </ul> Ejemplo de Objetos en Active Directory."},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#roles-servicios","title":"Roles (Servicios)","text":"<p>Un rol de servidor es un conjunto de servicios que permiten a un equipo realizar una funci\u00f3n espec\u00edfica para varios usuarios u otros equipos de una red. B\u00e1sicamente est\u00e1 relacionado con el cometido de dicho servidor, un servidor puede tener m\u00faltiples roles.</p> <p>Ejemplos:</p> <ul> <li>Servidor DHCP.</li> <li>Servidor DNS.</li> <li>Servidor Active Directory.</li> <li>Servidor de virtualizaci\u00f3n (Hyper-V).</li> <li>Servidor Web.</li> <li>Acceso remoto.</li> <li>Servidor de impresi\u00f3n.</li> <li>Servidor de correo electr\u00f3nico.</li> </ul> <p>A su vez, un rol puede tener diferentes funcionalidades o subroles, los cuales pueden estar activados o no. Dichos \u201csubroles\u201d son servicios de rol. </p> <p>Example</p> <p>un Servidor DNS solo tiene una finalidad y, por lo tanto, no tienen servicios de rol disponibles. En cambio un Servicio de Archivos (para compartir ficheros) puede tener el servicio de rol para el protocolo NFS o no, es decir, puede tener habilitada la funci\u00f3n de servidor de ficheros NFS.</p> <p>Note</p> <p>Network File System, o NFS, es un protocolo de nivel de aplicaci\u00f3n, seg\u00fan el Modelo OSI. Es utilizado para sistemas de archivos distribuido en un entorno de red de computadoras de \u00e1rea local. Posibilita que distintos sistemas conectados a una misma red accedan a ficheros remotos como si se tratara de locales.</p> <ul> <li>Para Agregar Roles:</li> </ul> <p></p>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#servicios-de-ad-en-windows-server","title":"Servicios de AD en Windows Server","text":"<p>Cuando vayamos a a\u00f1adir nuestro rol de Active Directory al servidor, veremos que tenemos diferentes roles de Active Directory:</p> <p></p> <ul> <li> <p>Active Directory Lightweight Directory Services : Se trata de un Active Directory \"light\", no require de un dominio para su uso, simplemente alberga opciones/caracter\u00edsticas para ciertas aplicaciones que nos interese.</p> </li> <li> <p>Active Directory Rights Management Services : Nos ayuda a gestionar la protecci\u00f3n del acceso a nuestros ficheros del directorio activo. Por ejemplo si un documento se intenta abrir desde un usuario no autorizado.</p> </li> <li> <p>Servicios de certificados de Active Directory : Simplemente gestiona la creaci\u00f3n de certificados digitales. Es para entidades de certificaci\u00f3n oficial (seguridad inform\u00e1tica).</p> </li> <li> <p>Servicios de dominio de Active Directory: Este va a ser la opci\u00f3n que veremos en el m\u00f3dulo. Es el active directory que hemos visto con OpenLDAP en el apartado de Linux.</p> </li> <li> <p>Servicio de federaci\u00f3n de Active Directory: Gestiona el acceso seguro desde dentro y desde fuera de tu red (Internet) a aplicaciones gestionadas en local por el servidor de Windows Active Directory. Obviamente con las credenciales de usuarios del active directory.</p> </li> </ul>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#base-de-datos-y-autentificacion","title":"Base de datos y Autentificaci\u00f3n","text":"<ul> <li>La base de datos de los usuarios, almacenada a trav\u00e9s de LDAP se almacena en los controladores de dominio. Adem\u00e1s el fichero \" ntds.dit\" ser\u00e1 el que almacene realmente dicha base de datos.</li> <li>La autenticaci\u00f3n de los usuarios se realizar\u00e1 a trav\u00e9s de Kerberos.</li> </ul>"},{"location":"06_AD1/AyudaASO/051_ActiveDirectory.html#actividades","title":"Actividades","text":"<p>Proyecto Creaci\u00f3n Active Directory. El proyecto se realizar\u00e1 por grupos con el principal objetivo de emular la configuraci\u00f3n de instalaci\u00f3n de un Active Directory y comprobaci\u00f3n de login de usuarios seg\u00fan las directivas que se crear\u00e1n durante el proyecto, en sus diferentes apartados. </p> <ol> <li>Inicio del proyecto: Presentaci\u00f3n de un pdf con las siguientes premisas:</li> </ol> <ul> <li>Nombre de los componentes del grupo (m\u00ednimo 2, m\u00e1ximo 3).</li> <li>Definici\u00f3n de la Organizaci\u00f3n:<ul> <li>Nombre.</li> <li>Dominio.</li> <li>Unidades Organizativas, (m\u00ednimo 4).</li> <li>Usuarios y grupos (diferentes niveles, administradores, usuarios de OUs). Se deber\u00e1 generar informaci\u00f3n inventada para los usuarios. Para generar datos inventados PINCHA AQU\u00cd.</li> <li>Definici\u00f3n de directorios de cada OU.</li> <li>Realizar un mapa conceptual de la organizaci\u00f3n. Ejemplo:</li> </ul> </li> </ul> Ejemplo de Directorios de Organizaci\u00f3n. <p>NOTA</p> <p>Al final del proyecto se realizar\u00e1 una auditor\u00eda a cada grupo la nota ser\u00e1 la misma para los componentes del grupo.</p> <ol> <li>Gu\u00edas para realizar el proyecto.</li> </ol> <p>Gu\u00edas</p> <ol> <li>Windows Server</li> <li>Configuraci\u00f3n B\u00e1sica Windows Server</li> <li>Configuraci\u00f3n B\u00e1sica Windows Server II</li> <li>Instalaci\u00f3n Active Directory I</li> <li>Instalaci\u00f3n Active Directory II</li> <li>Administraci\u00f3n de Usuarios y Grupos</li> <li>Caso Pr\u00e1ctico: Creaci\u00f3n de una estructura en AD</li> <li>Permisos, directivas de grupo y perfiles I</li> <li>Permisos, directivas de grupo y perfiles II</li> </ol>"},{"location":"06_AD1/AyudaASO/Practica01_AD.html","title":"Windows Server","text":"<p>Instala la m\u00e1quina de Windows Server bajada de la plataforma Azure, comprobando antes los requisitos del sistema:</p>"},{"location":"06_AD1/AyudaASO/Practica01_AD.html#requisitos-del-sistema","title":"Requisitos del Sistema","text":"<p>Podemos ver los requisitos del sistema en: PINCHA AQU\u00cd (Requisitos del Sistema)</p> <p>B\u00e1sicamente los requerimientos m\u00ednimos son:</p> <ul> <li>Procesador 64 bits a 1,4GHz.</li> <li>RAM 2GB con entorno de escritorio.</li> <li>32GB de Disco Duro.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica01_AD.html#licencias-cal-client-access-licence","title":"Licencias CAL (Client Access Licence)","text":"<p>Existen 3 tipos de licencias CAL:</p> <ul> <li> <p>CAL de Usuario: Por cada usuario que est\u00e9 dado de alta en el dominio necesitaremos una licencia.</p> </li> <li> <p>CAL de dispositivo: Por cada dispositivo que registremos en el dominio (impresoras, ordenadores, tablets..) necesitaremos una licencia.</p> </li> <li> <p>CAL RDS (Remote Desktop Services):  Son licencias para el acceso mediante escritorio remoto mayormente. El que tengas una licencia que te permita acceder a un servicio remoto de un dispositivo, no te quita de que ese dispositivo tambi\u00e9n cuente con una licencia CAL.</p> </li> </ul> <p>Las RDS CAL se activan a trav\u00e9s del Administrador de licenciamiento (online), en cambio sobre las CAL de usuarios y dispositivos no hay un control, pero s\u00ed est\u00e1s obligado a llevar un registro en caso de una auditor\u00eda de software.</p> <p>Las licencias de dispositivo salen rentable si un mismo ordenador lo van a usar m\u00faltiples usuarios, mientras que si cada usuario va a usar un ordenador ser\u00e1 m\u00e1s rentable una licencia de usuario.</p> <p>Example</p> <p>En mi empresa tengo 40 empleados, pero hacen turnos de d\u00eda (8horas), tarde (8 horas) y noches (8 horas). Por tanto, los trabajadores no coinciden a la vez en la oficina, se decide usar licencias por dispositivo y que los trabajadores compartan ordenadores (dispositivos).</p> <p>Example</p> <p>En mi empresa cada trabajador dispone de un port\u00e1til y un ordenador fijo de oficina. Por tanto, como cada usuario tiene 1 o m\u00e1s dispositivos, es m\u00e1s rentable tener licencias por usuario.</p>"},{"location":"06_AD1/AyudaASO/Practica01_AD.html#versiones-de-windows-server","title":"Versiones de Windows Server","text":"<p>Existen 3 versiones, de m\u00e1s sencillo y barato a m\u00e1s caro, estos son: Essentials, Standard y Datacenter.</p> <ul> <li> <p>Essentials: S\u00f3lo permite 25 usuarios o 50 dispositivos y no son ampliables. Importante que no es necesario licencias CAL. Por otro lado s\u00f3lo permite instalar de nuevo el Windows Server en una m\u00e1quina virtual, por ejemplo para backup.</p> </li> <li> <p>Standard: Es pr\u00e1cticamente id\u00e9ntico a la versi\u00f3n Datacenter pero con alguna caracter\u00edstica m\u00e1s y solo permite 2 m\u00e1quinas virtuales con dicho Windows Server. Importante que todos los usuarios van por licencias CAL.</p> </li> <li> <p>Datacenter: No tiene limitaciones e incluye todas las caracter\u00edsticas, entre ellas:</p> </li> <li> <p>Software Defined Network: Permite la administraci\u00f3n y configuraci\u00f3n de equipos de red. Permite tambi\u00e9n una f\u00e1cil creaci\u00f3n de una red virtual para gestionar un sistema de m\u00e1quinas virtuales.</p> </li> <li>Direct Storage: Permite una f\u00e1cil gesti\u00f3n de la redundancia y alta disponibilidad (HA) del almacenamiento.</li> <li> <p>Host Guardian (HGS): Permite el uso de un TPM virtual para motivos de seguridad como podr\u00eda ser la encriptaci\u00f3n de los datos de mi servidor.</p> </li> <li> <p>LTSB (Long \u2013Term Servicing Branch): Simplemente son versiones con una garant\u00eda de actualizaciones de 10 a\u00f1os, es decir, se comprometen a ir sacando actualizaciones de seguridad y mantener el sistema operativo de esta versi\u00f3n por lo menos 10 a\u00f1os desde su compra.</p> </li> </ul> Caracter\u00edsticas de las Versiones de Windows Server"},{"location":"06_AD1/AyudaASO/Practica01_AD.html#azure","title":"Azure","text":"<p>Azure es la plataforma cloud de Microsoft. Esta plataforma cloud nos ofrece poder crear y gestionar servidores virtuales en dicha plataforma. Podemos gestionar la red virtual entre nuestros servidores virtuales, crear plataformas de desarrollo o integrar aplicaciones, gestionar el almacenamiento y las copias de seguridad,  monitorizaci\u00f3n de los servicios, etc. Todo esto de una forma sencilla con una interfaz de usuario.</p> <p>Las principales ventajas son:</p> <ul> <li>No necesitas comprar y mantener ning\u00fan \u201chardware\u201d, todo est\u00e1 en la nube, virtualizado en los equipos de Microsoft (Azure).</li> <li>Necesitas menos personal para el mantenimiento, ya que la parte hardware y de instalaci\u00f3n f\u00edsica no existen.</li> <li>Es m\u00e1s f\u00e1cil redundar los datos y tener tu sistema disponible para los clientes. Es decir, imagina que no usas Azure y tienes tu servidor en la empresa y hay un corte de suministro el\u00e9ctrico, los clientes se quedar\u00e1n sin servicio, por tanto no tienes una alta disponibilidad.</li> </ul> <p>La principal desventaja es que tus datos est\u00e1n en una empresa externa, la cual en principio no puede comercializar con dichos datos, ni siquiera acceder a ellos, no obstante es algo a tener en cuenta.</p>"},{"location":"06_AD1/AyudaASO/Practica01_AD.html#hyper-v","title":"Hyper-V","text":"<ul> <li>Hyper-V es un hipervisor de m\u00e1quinas virtuales, es decir, permite la creaci\u00f3n y gesti\u00f3n de m\u00e1quinas virtuales. Es un hipervisor de tipo 1 (bare metal), es decir, viene integrado en el propio sistema operativo y por tanto no requiere de instalaciones adicionales. </li> <li>Vmware o VirtualBox ser\u00edan un ejemplo de hipervisor de tipo 2, los cuales deben ser instalados encima del sistema operativo (Windows/MAC/Linux) de la m\u00e1quina anfitriona.</li> </ul> Tipos de Hipervisor."},{"location":"06_AD1/AyudaASO/Practica02_AD.html","title":"Configuraci\u00f3n B\u00e1sica Windows Server","text":""},{"location":"06_AD1/AyudaASO/Practica02_AD.html#puntos-de-guia","title":"Puntos de gu\u00eda","text":"<ol> <li>Crea un usuario con permisos de administrador.</li> <li>Configura el Escritorio Remoto para que el nuevo usuario pueda acceder y que adem\u00e1s solo se pueda acceder desde una red privada. A\u00f1ade una captura con el nuevo usuario accediendo en remoto al servidor y de la configuraci\u00f3n del firewall.</li> <li>\u00bfQu\u00e9 dos formas de gesti\u00f3n remota hay para Windows Server?</li> <li>\u00bfPodr\u00edamos gestionar a trav\u00e9s de Escritorio remoto 2 personas Windows Server a la vez con la misma cuenta?</li> <li>Explica la diferencia entre una regla de entrada del firewall y una regla de salida.</li> <li>Activa la regla de Entrada \u201cSupervisi\u00f3n de m\u00e1quina virtual (Solicitud de eco \u2013 ICMPv4 de entrada). Adem\u00e1s debes modificar dicha regla para que solo acepte solicitudes de equipos del dominio. Adjunta pantalla de ambas tareas.</li> <li>Comprueba que efectivamente puedes navegar desde el Windows Server. Crea una regla de salida que corte el tr\u00e1fico TCP a los puertos 80 y 443. A continuaci\u00f3n prueba a navegar. \u00bfQu\u00e9 sucede? \u00bfA qu\u00e9 hacen referencia los puertos 80 y 443? Adjunta pantallas de la configuraci\u00f3n de la regla. Finalmente deshabilita la regla para poder navegar, aunque un servidor Windows no tiene por qu\u00e9 tener ninguna necesidad de navegaci\u00f3n web.</li> </ol>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#rastreador-de-eventos","title":"Rastreador de eventos","text":"<p>Un servidor, habitualmente, no debe apagarse o reiniciarse, al no ser que sea por un motivo de aver\u00eda o mantenimiento. Es por ello que cada vez que necesitemos reiniciarlo/apagarlo dejemos anotado a que es debido dicha acci\u00f3n.</p> <p>En Windows Server es recomendable usar \u201calt + f4\u201d para apagar, ya que nos permitir\u00e1 dejar una descripci\u00f3n de la raz\u00f3n por la que vamos a reiniciar/apagar el servidor. Obviamente esta descripci\u00f3n quedar\u00e1 almacenada en los logs y registros del sistema. </p>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#actualizaciones","title":"Actualizaciones","text":"<p>En un servidor es muy importante que se mantenga actualizado, de lo contrario tendremos fallos de seguridad. No obstante, es importante que estas actualizaciones se realicen en horario de bajo impacto, ya que:</p> <ul> <li>Pueden ocupar parte del ancho de banda de nuestro servidor y los clientes pueden notar por ello una bajada del rendimiento.</li> <li>Vas a tener la CPU/RAM ocupada en actualizar los servicios en vez de atender las peticiones de clientes.</li> <li>Es posible que tras la actualizaci\u00f3n se realice un reinicio, si este reinicio no lo programamos en horas de bajo impacto, por ejemplo a las 03:00 am, supondr\u00e1 un corte en el servicio.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#configurar-horarios-de-reinicio","title":"Configurar horarios de reinicio","text":"<ul> <li>Se pueden configurar en \u201cConfiguraci\u00f3n de Windows Update\u201d y en \u201cCambiar horas activas\u201d</li> </ul> <p>En las horas activas elegiremos las horas en las que NO queremos que se reinicie el servidor, es decir, si estamos en una empresa que trabaja de 07:00 a 20:00,  \u00e9stas ser\u00e1n las horas activas. En caso de que sea una empresa 24/365, habr\u00eda que informar de un corte de servicio o tener duplicadas las m\u00e1quinas y que una soporte todo el trabajo mientras la otra se actualiza y viceversa.</p>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#configurar-los-horarios-de-descarga-de-actualizaciones","title":"Configurar los horarios de descarga de actualizaciones","text":"<p>Se ejecutan las pol\u00edticas de grupo del equipo local. Para que salga la ventana de \u201cEjecutar\u201d lo m\u00e1s r\u00e1pido es tocar la tecla de Windows+R.</p> <p>Aunque lo veremos m\u00e1s adelante es importante que teng\u00e1is claro que las pol\u00edticas de grupo de un dominio prevalecen o tienen prioridad sobre las pol\u00edticas de grupo locales.</p> <p>Dentro de las directivas de grupo vamos a ir a:</p> <ul> <li>Configuraci\u00f3n del equipo local -&gt; Plantillas Administrativas -&gt; Componentes de Windows -&gt; Windows Update.</li> <li>Dentro de Windows Update elegiremos -&gt; Configurar Actualizaciones Autom\u00e1ticas.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#cuentas-locales-en-el-servidor","title":"Cuentas locales en el servidor","text":"<p>En un servidor, por defecto, \u00fanicamente la cuenta administrador activa. Las cuentas por defecto o de invitado est\u00e1n deshabilitadas (representadas con una flecha negra apuntando hacia abajo) por seguridad.</p> <p>No obstante, es posible que en nuestra empresa seamos m\u00e1s de un administrador del sistema y por tanto, es posible que cada administrador tenga su propia cuenta, por ejemplo para que quede registrado quien ha hecho cada acci\u00f3n dentro del servidor.</p> <p>Para crear cuentas locales vamos al icono de Windows de la barra de inicio y hacemos click en el bot\u00f3n derecho, eligiendo \u201cAdministraci\u00f3n de equipos\u201d.</p> <p>Seleccionando bot\u00f3n derecho se puede crear un usuario nuevo.</p> <p>Una vez creado el usuario, hay dos cosas que tenemos que tener en cuenta:</p> <ul> <li>Que tenga habilitado el acceso por escritorio remoto. Habitualmente los servidores de Windows Server se gestionan en remoto, ya que el servidor se encontrar\u00e1 en el CPD y el administrador en la oficina.</li> </ul> <ul> <li>Que tenga permisos de administrador, ya que al servidor solo acceder\u00e1n habitualmente nuestros compa\u00f1eros que sean tambi\u00e9n administradores del sistema.</li> </ul> <p>Buscaremos el grupo \u201cAdministradores\u201d y lo agregaremos al usuario.</p>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#administrador-de-servidor","title":"Administrador de servidor","text":"<p>En el administrador de servidor podremos administrar todo:</p> <ul> <li>Servidores remotos.</li> <li>Servicios: DNS, NTP, DHCP, \u2026</li> <li>Notificaciones y alertas.</li> <li>Almacenamiento.</li> <li>Gestionar Copias de Seguridad.</li> <li>Monitorizaci\u00f3n del estado del servidor.</li> <li>Administraci\u00f3n de equipos / dispositivos.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#cambiar-nombre-al-servidor","title":"Cambiar nombre al servidor","text":"<p>Es importante indicar el nombre de nuestros equipos para que sea f\u00e1cil identificarlos. Debemos darles un nombre significativo, por ejemplo si este equipo va a ser un Controlador de Dominio y va a ser el primero, podemos ponerle \u201cDC01\u2026\u201d </p> <p>Tip</p> <p>Se recomienda no usar caracteres especiales en el nombre y por supuesto nada de espacios en blanco.</p> <p>Warning</p> <p>Es importante cambiar el nombre antes de tener configurado el Directorio Activo, ya que si no habr\u00e1 que cambiar todo lo relacionado con la resoluci\u00f3n de nombres (DNS).</p>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#escritorio-remoto","title":"Escritorio Remoto.","text":"<p>Habitualmente nuestro servidor estar\u00e1 en un CPD, posiblemente ser\u00e1 un servidor virtualizado. Lo que hace esencial configurar correctamente la herramienta pertinente para su administraci\u00f3n remota. En el caso de Windows Server, que cuenta con una buena interfaz gr\u00e1fica, haremos uso de Escritorio Remoto (RDP), del cual tenemos que ser consciente que es un servicio bastante atacado por ciberdelincuentes. Tambi\u00e9n se puede gestionar por consola a trav\u00e9s de PowerShell.</p> <p>Obviamente aparte de tener habilitado el Escritorio remoto, el usuario debe tener permisos de acceso remoto al servidor.</p> <p>Por defecto una misma cuenta de usuario solo puede conectarse una vez de forma simult\u00e1nea.</p>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#configuracion-de-red","title":"Configuraci\u00f3n de Red","text":"<p>La configuraci\u00f3n de red se hace igual que un Windows Cliente. </p> <p>En cuanto a la m\u00e1quina virtual depender\u00e1 de nuestros recursos (memoria, CPU, discos SSD, gr\u00e1fica):</p> <ul> <li>M\u00e1quina virtual para  Windows 10 y para Windows Server 2019.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica02_AD.html#seguridad-firewall","title":"Seguridad (Firewall)","text":"<p>Cada vez que arrancamos un servicio (Remote Desktop Protocol, DHCP, DNS, \u2026 ) se abren una serie de puertas (puertos de red). Los ciberdelincuentes atacan estos puertos \u201cabiertos\u201d para intentar conseguir acceso indebido.</p> <p>Por todo ello, es importante tener abiertas solo las puertas (puertos) estrictamente necesario, es decir, si nuestro servidor no va a hacer uso de un servicio DNS, no lo actives.</p> <p>Adem\u00e1s, una herramienta muy importante para controlar esto es el \u201cFirewall\u201d:</p> <p>Existir\u00e1n unas reglas diferentes dependiendo de la IP del equipo que realiza la petici\u00f3n:</p> <ul> <li>Si la IP viene de Internet (Red P\u00fablica).</li> <li>Si la IP viene de mi red local (Red Privada).</li> <li>Si la IP viene de un equipo asociado al dominio (Red Dominio).</li> </ul> <p>En la configuraci\u00f3n podemos decirle que bloquee el acceso a las aplicaciones dependiendo de la red  de  donde provengan, por ejemplo si en la red p\u00fablica bloqueamos todas las conexiones, querr\u00e1 decir que solo podremos administrar el servidor desde una red privada o red del dominio.</p> <p>No obstante, quiz\u00e1 queramos que ciertas aplicaciones s\u00ed sean accesibles desde la red p\u00fablica y otras no. En tal caso, deberemos a\u00f1adir reglas por aplicaciones:</p> <p>Por ejemplo indicar que solo se puede gestionar este equipo de forma remota desde una red privada.</p> <p>Tambi\u00e9n se pueden crear filtros avanzados:</p> <p>Por ejemplo aqu\u00ed vemos que el Escritorio Remoto actualmente est\u00e1 usando el puerto 3389 mediante UDP. Si no tiene el icono verde, es que no est\u00e1 habilitada la regla.</p> <p>Si hacemos doble click en cualquier regla podremos manipular:</p> <ul> <li>La aplicaci\u00f3n a la que afecta.</li> <li>Filtrar por usuarios, interfaces (al\u00e1mbricas, inal\u00e1mbricas, remotas), tipos de red (p\u00fablica, privada, dominio) o direccionamiento IP.</li> <li>Puerto y Protocolo (TCP o UDP) usado.</li> </ul> <p>Podemos crear nuestras propias reglas:</p>"},{"location":"06_AD1/AyudaASO/Practica03_AD.html","title":"Configuraci\u00f3n B\u00e1sica Windows Server II","text":""},{"location":"06_AD1/AyudaASO/Practica03_AD.html#puntos-de-guia","title":"Puntos de gu\u00eda","text":"<ol> <li>\u00bfC\u00f3mo har\u00edas para filtrar en el visor de eventos todos los eventos cr\u00edticos de seguridad?</li> <li>\u00bfC\u00f3mo cambiar\u00edas las propiedades de un evento para que?</li> <li>Aumente la capacidad m\u00e1xima del registro a 50MB.</li> <li>No sobrescribiese cuando el log alcanzar\u00e1 la capacidad m\u00e1ximo, es decir, que archive el log.</li> <li>Indica cual es la ruta y el nombre del log seleccionado.</li> <li>\u00bfQu\u00e9 sucede si vas a dicha carpeta y abres con doble click el log seleccionado?</li> <li>Genera un informe de tu sistema.</li> <li>Crea un Segundo adaptador de red en tu m\u00e1quina virtual de Windows Server 2019.</li> <li>Crea un equipo de NIC y muestra el proceso mediante un v\u00eddeo o mediante capturas de pantalla.</li> <li>Configura una IP fija en tu NIC virtual.</li> </ol> <p>Visor de Eventos.</p> <p>Esta herramienta nos mostrar\u00e1 la informaci\u00f3n del estado de las aplicaciones y servicios de nuestro servidor.</p> <p>Debemos habituarnos a ver el visor de eventos de forma regular para confirmar que nuestros servicios no est\u00e1n fallando o a punto de fallar.  El visor de eventos  tambi\u00e9n resulta \u00fatil para sacar la informaci\u00f3n en caso de que un servicio est\u00e9 fallando.</p> Visor de Eventos Windows Server. <p>Podemos filtrar los eventos por tiempo (\u00faltimas 24h, 1h, 30 min, \u2026), por aplicaci\u00f3n que ha generado el evento, usuarios, etc\u2026</p> Filtrar Eventos por tiempos. <p>Una cosa importante es la pol\u00edtica de eventos con las aplicaciones, especialmente aquellas que ofrecen un servicio y son m\u00e1s propicias a ser atacadas o m\u00e1s cr\u00edticas. Se asigna una cantidad de memoria que pueden usar los registros (logs), pasado esta capacidad se debe decidir si sobrescribir o no sobrescribir los logs. Lo habitual ser\u00eda no sobrescribir, pero debemos estar atentos a la capacidad total que van acumulando para ir elimin\u00e1ndolos manualmente o mediante un script cada cierto tiempo.</p> <p>Con el icono vaciar registro podemos borrar los eventos de la aplicaci\u00f3n seleccionada.</p> Borrar Eventos de la aplicaci\u00f3n. <p>En caso de tener un error del sistema podemos visualizarlos en la pesta\u00f1a de \u201cSistema\u201d, cada error registrado del sistema tiene un identificador (ID) que ser\u00e1 el que usemos en caso de querer buscar informaci\u00f3n del error en Internet.</p> <p>Es recomendable, mirar todos los d\u00edas el registro de eventos del sistema.</p> <p>Importante diferenciar entre un \u201cError\u201d y un \u201cWarning / Aviso\u201d, el primero es que ya ha habido un problema grave que debe ser resuelto, el segundo es una alerta de algo que deber\u00eda revisarse, pero que no ha ocasionado un problema cr\u00edtico.</p> Comprobar errores del sistema. <p>Al igual que con las aplicaciones podemos decidir qu\u00e9 hacer con los registros de eventos referidos al sistema:</p> Registros de Eventos del sistema. <p>Monitor de recursos.</p> <p>El monitor de recursos nos da informaci\u00f3n sobre la memoria libre, el rendimiento de la cpu, lecturas en disco, etc. Esto nos puede dar informaci\u00f3n si fuera necesario ampliar o mejorar alg\u00fan componente hardware de nuestro servidor.</p> <p>Si queremos analizar o monitorizar valores m\u00e1s espec\u00edficos debemos ir al monitor de rendimiento y a\u00f1adir a la gr\u00e1fica los datos que deseamos.</p> Estad\u00edsticas de datos seleccionados. <p>Podemos generar un resumen/informe de todo el sistema, referente al rendimiento de \u00e9ste:</p> Generaci\u00f3n informe I. Generaci\u00f3n informe II. Generaci\u00f3n informe III. <p>Podemos exportar a alg\u00fan fichero el resumen de todo el informe del rendimiento del sistema.</p> Generaci\u00f3n informe IV."},{"location":"06_AD1/AyudaASO/Practica03_AD.html#nic-redundante","title":"NIC redundante","text":"<p>Una NIC (Network Interface Controller) no es m\u00e1s que un adaptador de red o tarjeta de red. Con una NIC redundante queremos decir que uno o m\u00e1s adaptadores de red trabajan como uno, pudiendo mejorar el ancho de banda total que puede cursar y dotando al sistema de una mayor disponibilidad, pues si uno de los adaptadores de red fallara, tendr\u00edamos otros y no se cortar\u00eda la conexi\u00f3n.</p> <p>Tip</p> <p>Es muy habitual en todos los servidores tener m\u00e1s de un adaptador de red.</p> <ul> <li>En el siguiente v\u00eddeo puedes encontrar una ayuda para realizar un NIC redundante</li> </ul> <p>PINCHA AQU\u00cd para video de Configuraci\u00f3n NIC Redundante</p>"},{"location":"06_AD1/AyudaASO/Practica04_AD.html","title":"Instalaci\u00f3n de Active Directory I","text":"<p>Objetivos de esta pr\u00e1ctica:</p> <ul> <li>Instalar y promocionar un servidor a controlador de dominio</li> <li>Crear estructuras centralizadas de administraci\u00f3n de redes</li> <li>Unir equipos cliente al dominio</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica04_AD.html#creacion-de-un-dominio","title":"Creaci\u00f3n de un dominio","text":"<p>El primer paso para la creaci\u00f3n del Active directory es crear un dominio; en el equipo Controlador de Dominio, y debe ser un equipo preparado para aguantar altas cargas de trabajo con una alta disponibilidad, y con un sistema operativo servidor instalado. </p> <ul> <li>Para crear un dominio hay que acceder al Administrador del Servidor y accedemos a -&gt;  Agregar Roles y Caracter\u00edsticas:</li> </ul> Creaci\u00f3n de un dominio I. <ul> <li>Nos aparecer\u00e1 el asistente para comenzar con la creaci\u00f3n del dominio:</li> </ul> Creaci\u00f3n de un dominio II. <p>Seleccionaremos una instalaci\u00f3n basada en caracter\u00edsticas y roles. Tambi\u00e9n podemos hacer una instalaci\u00f3n a trav\u00e9s de servicios de acceso remoto, pero en nuestro caso realizaremos la instalaci\u00f3n en local.</p> Creaci\u00f3n de un dominio III. <p>Una vez seleccionada la instalaci\u00f3n basada en roles, seleccionaremos nuestro servidor que ser\u00e1 donde vamos a instalar nuestro Active Directory:</p> Creaci\u00f3n de un dominio IV. <p>Seleccionaremos el rol Servicios de Dominio de Active Directory:</p> Creaci\u00f3n de un dominio V. <p>Y nos aparecer\u00e1 marcado el rol tal y como muestra la siguiente figura:</p> Creaci\u00f3n de un dominio VI. Creaci\u00f3n de un dominio VII. <p>Y procedemos a realizar la instalaci\u00f3n. Cuando se agrega un nuevo rol, podemos hacer clic en la opci\u00f3n de reiniciar en caso de que fuera necesario. En caso que el rol o la caracter\u00edstica no fuera necesario un reinicio, no lo har\u00eda.</p> Creaci\u00f3n de un dominio VIII. <p>Un vez instalado, el asistente nos dice que es necesario realizar una configuraci\u00f3n. En este caso hay que promover nuestro servidor a un servidor de controlador de dominio. As\u00ed que haremos clic en la opci\u00f3n de promover servidor a controlador de dominio :</p> Creaci\u00f3n de un dominio IX. <p>Ejecutamos el asistente, y las primeras pantallas nos ofrecen informaci\u00f3n \u00fatil para la creaci\u00f3n del dominio.</p> <ul> <li>Seleccionamos Agregar un nuevo bosque.</li> </ul> <p>Note</p> <p>Un conjunto de dominios agrupados l\u00f3gicamente conforman un \u00e1rbol de dominios y un conjunto de \u00e1rboles de dominio agrupados l\u00f3gicamente conforman un bosque. En nuestro caso pondremos el dominio ASO2223.LOCAL en lugar de CEFIRE2019.LOCAL como indica en la imagen:</p> Agregar un nuevo Bosque. <p>A continuaci\u00f3n, nos aparece informaci\u00f3n sobre el nivel funcional del nuevo bosque. Seg\u00fan el nivel funcional que establezcamos, implementaremos un directorio activo compatible con versiones anteriores de Windows Server, pero m\u00e1s limitado en cuanto a funciones, o menos compatible con versiones antiguas, pero con mayores funcionalidades. </p> <p>Tip</p> <p>En nuestro caso, seleccionaremos el mayor nivel funcional (Windows Server 2016) ya que todos los controladores del dominio tendr\u00e1n instalado, al menos, Windows Server 2016. Tambi\u00e9n a\u00f1adiremos la contrase\u00f1a para la restauraci\u00f3n de nuestro dominio, por defecto la misma que la del administrador.</p> Creaci\u00f3n de un dominio X. <p>La siguiente tarea que llevar\u00e1 a cabo el asistente para la creaci\u00f3n del dominio, ser\u00e1 preguntar por ciertas opciones adicionales del servidor, como por ejemplo la configuraci\u00f3n del servicio DNS. Como en nuestro caso no tenemos DNS, dejaremos que el asistente cree una zona de DNS para que nuestro dominio pueda funcionar.</p> Creaci\u00f3n de un dominio XI. <p>A continuaci\u00f3n nos aparece la ubicaci\u00f3n donde se guardar\u00e1 los objetos de nuestro AD, es decir, la base de datos:</p> Creaci\u00f3n de un dominio XII. <p>Seguidamente nos muestra las configuraciones que se van a realizar. </p> <p>Note</p> <p>Como pod\u00e9is observar tambi\u00e9n se puede exportar el script para poder ejecutar los mismos comandos a trav\u00e9s de PowerShell:</p> Creaci\u00f3n de un dominio XIII. <p>En el siguiente paso se muestra un resumen de los Requisitos previos:</p> Comprobaci\u00f3n de requisitos previos. <p>Y finalmente realizar\u00edamos la instalaci\u00f3n. Nuestra pantalla de inicio de sesi\u00f3n, ahora ser\u00e1 diferente, ya que nos aparece el dominio al que vamos a iniciar la sesi\u00f3n del usuario:</p> <p>Note</p> <p>Nos aparecer\u00e1 ASO2223 en lugar de CEFIRE2019</p> Nueva pantalla inicio de sesi\u00f3n con Dominio. <p>Una vez instalado, podemos iniciar sesi\u00f3n con el Administrador del dominio. Podemos comprobar que en el panel de Administrador de Servidor aparece nuestro dominio configurado ASO2223.LOCAL en lugar de CEFIRE2019.LOCAL</p> Comprobaci\u00f3n Dominio n Administrador de Servidor."},{"location":"06_AD1/AyudaASO/Practica04_AD.html#creacion-de-dominio-en-server-core","title":"Creaci\u00f3n de dominio en Server Core","text":"<p>Se podr\u00eda hacer una instalaci\u00f3n sin experiencia de escritorio del Windows Server 2019 esto es una instalaci\u00f3n mucho m\u00e1s liviana que permite tener un servidor sin entorno gr\u00e1fico. A esta versi\u00f3n se le conoce como el nombre de Server Core. En este punto vamos a mostrar a realizar una instalaci\u00f3n de un dominio en una m\u00e1quina Server Core.</p> <p>Para hacer la instalaci\u00f3n, debemos seleccionar la opci\u00f3n de instalaci\u00f3n sin experiencia de escritorio:</p> Instalaci\u00f3n Server Core."},{"location":"06_AD1/AyudaASO/Practica04_AD.html#powershell-para-configurar-un-dominio","title":"PowerShell para configurar un dominio","text":"<p>Para configurar el dominio con PowerShell vamos a presentar unos scripts que permitir\u00e1n realizar la configuraci\u00f3n tanto de la m\u00e1quina como del Active Directory. Para entrar dentro del shell de PowerShell, teclearemos el comando powershell en la consola:</p> Entrar al PowerShell en el Server Core."},{"location":"06_AD1/AyudaASO/Practica04_AD.html#configuracion-inicial","title":"Configuraci\u00f3n inicial","text":"<p>Primero realizaremos la configuraci\u00f3n de la m\u00e1quina, a trav\u00e9s del siguiente script. </p> <p><code>ConfiguracionInicial.ps1</code> <pre><code>$nombreServer=\"ASO2223\"\n$dirIP=\"192.168.5.1X\"\n$redInterna=\"Ethernet 2\"\nRename-Computer -NewName $nombreServer\nGet-NetAdapter \u2013name $redInterna | Remove-NetIPAddress -Confirm:$false\nGet-NetAdapter \u2013name $redInterna | New-NetIPAddress \u2013addressfamily IPv4 \u2013ipaddress $dirIP \u2013prefixlength 24 \u2013type unicast\n</code></pre></p> <p>Warming</p> <p>Despu\u00e9s de la captura se debe reiniciar para aplicar los cambios.</p> <p>Donde se Puede observar:</p> <ul> <li>El nombre de m\u00e1quina en la variable <code>$nombreServer</code></li> <li>El adaptador de la red interna en $redInterna (Ejemplo en el script) y tambi\u00e9n la direcci\u00f3n IP de la red interna en <code>$dirIP</code>. </li> <li>El comando<code>_Rename-Computer -NewName $nombreServer</code> cambia el nombre del servidor. </li> <li>Los comandos: <ul> <li><code>_Get-NetAdapter \u2013__name $redInterna | Remove-NetIPAddress -Confirm:$false</code> </li> <li><code>_Get-NetAdapter \u2013name $redInterna | New-NetIPAddress \u2013addressfamily IPv4 \u2013ipaddress</code></li> <li><code>$dirIP \u2013prefixlength 24 \u2013type unicast</code>    Nos permiten a\u00f1adir la direcci\u00f3n IP de nuestra red interna.</li> </ul> </li> <li>Finalmente con <code>_Restart-Computer -force</code> reiniciamos la m\u00e1quina y tendremos configurado el nombre y el interfaz de la red interna.</li> </ul>"},{"location":"06_AD1/AyudaASO/Practica04_AD.html#instalar-controlador-de-dominio-con-powershell","title":"Instalar Controlador de dominio con powershell","text":"<p>Ahora vamos a promover nuestro servidor a controlador de dominio. Esto tambi\u00e9n lo vamos a realizar a trav\u00e9s de powershell mediante scripts. </p> <p><code>creaciondominio.ps1</code> <pre><code>$dominioFQDN = \"ASO2223CORE.LOCAL\"\n$dominioNETBIOS = \"ASO2223CORE\"\n$adminPass = \"aso2223.\"\nInstall-WindowsFeature AD-Domain-Services,DNS\nImport-module addsdeployment\nInstall-ADDSForest -DomainName $dominioFQDN -DomainNetBiosName $dominioNETBIOS -SafeModeAdministratorPassword (ConvertTo-SecureString -string $adminPass -AsPlainText -Force) -DomainMode WinThreshold -ForestMode WinThreshold -InstallDNS -Confirm:$false\n</code></pre></p> <p>Donde se Puede observar:</p> <ul> <li>En la variable <code>_$dominioFQDN_</code> pondremos nuestro nombre de dominio </li> <li>y en <code>_$dominioNETBIOS_</code> el nombre de dominio NETBIOS. </li> <li>El comando <code>_Install-WindowsFeature AD-Domain-Services,DNS_</code> instala los roles de AD y tambi\u00e9n de DNS.</li> <li>El comando<code>_Install-ADDSForest_</code> realiza la configuraci\u00f3n del dominio.</li> </ul> <p>Al ejecutarlo mostrar\u00eda por pantalla:</p> Creaci\u00f3n de dominio en Server Core. <p>Finalmente reiniciamos la m\u00e1quina y ya tenemos instalado nuestro controlador de dominio en una m\u00e1quina core con powershell. Notad que el inicio de sesi\u00f3n ahora ya es es ASO2223.LOCAL.</p> Nuevo Inicio Sesi\u00f3n en Server Core. <p>Para comprobar que todo se ha configurado de manera correcta, podemos iniciar sesi\u00f3n y ejecutar el comando sconfig. Nos muestra informaci\u00f3n relativa al nombre de m\u00e1quina, dominio y algunas otras opciones:</p> Utilidad de inspecci\u00f3n sconfig."},{"location":"06_AD1/AyudaASO/Practica04_AD.html#apagado-de-la-maquina","title":"Apagado de la m\u00e1quina","text":"<p>Note</p> <p>Para poder apagar la m\u00e1quina podemos hacer uso del comando <code>shutdown /p</code> o bien a trav\u00e9s de la <code>opci\u00f3n 14</code> de la utilidad <code>sconfig</code>.</p>"},{"location":"06_AD1/AyudaASO/Practica04_AD.html#unir-clientes-al-dominio","title":"Unir clientes al dominio","text":""},{"location":"06_AD1/AyudaASO/Practica04_AD.html#anadir-maquinas-clientes-al-dominio","title":"A\u00f1adir m\u00e1quinas clientes al dominio","text":"<p>Para incluir en el dominio los equipos que actuar\u00e1n como cliente hay que configurar las propiedades de Internet de cada una de las m\u00e1quinas que vamos a unir al dominio, teniendo en cuenta que:</p> <p>La direcci\u00f3n del controlador de dominio (que implementa funciones de DNS) es la 192.168.5.1X. La m\u00e1scara de subred es de 24 bits. </p> <p>Note</p> <p>En la red que se ha montado como ejemplo hay un elemento de interconexi\u00f3n con IP 192.168.100.1 que implementa las funciones de puerta de enlace y de DNS, por ese motivo se ha incluido como puerta de enlace predeterminada y como DNS secundario, sin embargo estos dos campos no son necesarios si \u00fanicamente queremos trabajar en el interior de una \u00fanica red. M\u00e1s adelante veremos instalaci\u00f3n de un servicio de DHCP y el enrutamiento, para que nuestro servidor pueda ofrecer a los clientes de la red interna una direcci\u00f3n de manera din\u00e1mica.</p> <p>A continuaci\u00f3n, en el siguiente ejemplo, se revisa la configuraci\u00f3n de la m\u00e1quina cliente Windows 10 que vamos a validar en el dominio Windows Server 2019 (utilizaremos la m\u00e1quina con interfaz gr\u00e1fica):</p> Configuraci\u00f3n red cliente Windows 10. <p>Note</p> <p>La figura anterior es un ejemplo de configuraci\u00f3n, habr\u00e1 que adapatarlo al rango utilizado en el Aula.</p> <p>Comprobaremos tambi\u00e9n que desde la m\u00e1quina cliente podamos hacer ping a nuestro dominio, esto es al dominio ASO2223.LOCAL. Para ello abrimos una terminal en la m\u00e1quina Windows 10 (Tecla Windows + R y luego cmd) y comprobamos que el ping al dominio funcione. </p> <p>Warning</p> <p>Es importante que este ping funcione, en caso contrario no se podr\u00e1 realizar la validaci\u00f3n en nuestro dominio.</p> ping al dominio. <p>Y ahora s\u00ed, ya podemos unir nuestra m\u00e1quina al dominio. Para ello, en Windows 10, seleccionaremos el bot\u00f3n de inicio y con el bot\u00f3n de la derecha del rat\u00f3n, seleccionaremos Sistema:</p> Unir cliente windows 10 a dominio I. <p>Seleccionamos Conectar a la red del trabajo o colegio y nos aparecer\u00e1 la siguiente informaci\u00f3n:</p> Unir cliente windows 10 a dominio II. <p>Hacemos clic en Conectar:</p> Unir cliente windows 10 a dominio III. <p>Seleccionamos la opci\u00f3n de Unir este dispositivo a un dominio local de Active Directory. Nos aparecer\u00e1 una ventana para introducir el nombre de dominio al que nos queremos conectar:</p> Unir cliente windows 10 a dominio IV. <p>En nuestro caso, introduciremos nuestro nombre de nominio, ASO2223.LOCAL en lugar de CEFIRE2019.LOCAL:</p> Unir cliente windows 10 a dominio V. <p>Para poder realizar la validaci\u00f3n, hay que introducir la cuenta del Administrador del dominio y su contrase\u00f1a, en nuestro caso, ser\u00e1 Administrador y como contrase\u00f1a cefire2019.</p> Unir cliente windows 10 a dominio VI. <p>Seleccionamos que nuestro administrador tenga los privilegios de administrador en la m\u00e1quina cliente, para ello selecionamos Tipo Cuenta y marcamos la opci\u00f3n de Administrador. Reiniciamos la m\u00e1quina y ya tenemos nuestro cliente Windows 10 validado en el dominio.</p> Unir cliente windows 10 a dominio VI. <p>A partir de este momento, ya podemos iniciar sesi\u00f3n con cualquier usuario del dominio. En nuestro caso solo tenemos el usuario Administrador, podemos probar a iniciar sesi\u00f3n en la m\u00e1quina con la cuenta del Administrador del dominio.</p> Unir cliente windows 10 a dominio VII. <p>Tambi\u00e9n podemos ver en nuestro servidor, desde el panel del Administrador de Servidor nuestra m\u00e1quina. Para ello, desde la m\u00e1quina Windows Server 2019, accedemos al Administrador de Servidor --&gt; Herramientas --&gt; Usuarios y Equipos de Active Directory:</p> Unir cliente windows 10 a dominio VIII. <p>Seleccionamos nuestro dominio ASO2223.LOCAL y luego Computers. Aparecer\u00e1 nuestra m\u00e1quina cliente PC01, si la seleccionamos, con el bot\u00f3n de la derecha del rat\u00f3n --&gt; propiedades. Aqu\u00ed podemos ver alguna informaci\u00f3n relativa a la m\u00e1quina conectada.</p> Unir cliente windows 10 a dominio IX."},{"location":"06_AD1/AyudaASO/Practica04_AD.html#errores-en-la-union","title":"Errores en la uni\u00f3n","text":"<p>En caso de que haya habido alg\u00fan error en la uni\u00f3n del equipo cliente al dominio se deben comprobar algunos aspectos:</p> <ul> <li>La configuraci\u00f3n de la interfaz de red est\u00e1 en modo 'Adaptador puente', no en 'NAT'.</li> <li>El equipo cliente y el equipo servidor se hallan en la misma red.</li> <li>El nombre del dominio puede resolverse desde el equipo cliente (ping ASO2223.LOCAL )</li> <li>La direcci\u00f3n del servidor DNS est\u00e1 correctamente configurada en el equipo cliente.</li> </ul>"},{"location":"07_DOMINIO_AD/071_DominioAD.html","title":"Administracio\u0301n de dominios en Active Directory","text":"<p>Un dominio en Active Directory es un conjunto de ordenadores conectados a una red los cuales cuentan con un equipo servidor para administrar las cuentas de usuario y credenciales de la red. </p>"},{"location":"07_DOMINIO_AD/071_DominioAD.html#caracteristicas","title":"Caracter\u00edsticas","text":"<p>Se dene tener en cuanta las siguientes caracter\u00edsticas:</p> <ul> <li>Los nombres de un dominio de Active Directory no tienen que corresponder a un dominio de Internet registrado, pero pueden hacerlo. </li> <li>Las estructuras de dominio se pueden configurar independientemente de las estructuras l\u00f3gicas o f\u00edsicas existentes de la organizaci\u00f3n. </li> <li>Cada dominio se identifica con un nombre \u00fanico basado en las convenciones de nomenclatura del Sistema de nombres de dominio (DNS). </li> <li>Los subdominios parten de un dominio ra\u00edz. </li> <li>El nombre completo incluye subdominios y dominio ra\u00edz.</li> </ul>"},{"location":"07_DOMINIO_AD/071_DominioAD.html#estructura-logica-de-active-directory","title":"Estructura L\u00f3gica de Active Directory","text":"<p>La estructura del Active Directory se basa en el dominio configurado, se puede pensar en un bosque que est\u00e1 formado por diferentes \u00e1rboles. Aquellos \u00e1rboles del mismo grupo o especie forman parte de un dominio y as\u00ed de vamos descendiendo hasta llegar a los objetos, que pueden ser los usuarios, perif\u00e9ricos u otros.</p> Estructura L\u00f3gica de Active Directory"},{"location":"07_DOMINIO_AD/071_DominioAD.html#prologo-practicas","title":"Pr\u00f3logo pr\u00e1cticas","text":"<p>En la unidad anterior en la pr\u00e1ctica PT62 se instal\u00f3 el Dominio y controlador en la instalaci\u00f3n de Active Directory, en esta unidad se realizan configuraciones que avanzan en la gesti\u00f3n del dominio instalado, como la creaci\u00f3n de usuarios y grupos, la degradaci\u00f3n de un dominio, o eliminaci\u00f3n de usuarios.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html","title":"Administraci\u00f3n de Usuarios y Grupos","text":"<p>Esta secci\u00f3n se muestra la creaci\u00f3n de usuarios, grupos y unidades organizativas.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#creacion-de-usuarios","title":"Creaci\u00f3n de usuarios","text":"<p>Los usuarios del dominio deben tener una cuenta para poder acceder a los recursos del mismo tras su autenticaci\u00f3n frente al controlador de dominio. </p> <p>Para crear una cuenta de usuario mediante la interfaz gr\u00e1fica accederemos a la herramienta:  'Usuarios y equipos de Active Directory' desde el Panel del Administrador --&gt; Herramientas:</p> Usuarios y Equipos de AD. <p>Una vez abierto el administrador de 'Usuarios y equipos de Active Directory', se hace clic con el bot\u00f3n derecho sobre 'Users' y en el men\u00fa que aparece, se selecciona 'Nuevo' y a continuaci\u00f3n 'Usuario' :</p> Creaci\u00f3n Nuevo Usuario I. <p>Nos aparece el asistente para la creaci\u00f3n del nuevo usuario:</p> Creaci\u00f3n Nuevo Usuario II. <p>En la primera parte del cuadro de di\u00e1logo anterior se puede introducir el nombre, la(s) inicial(es) del segundo nombre y los apellidos del usuario. Hasta aqu\u00ed toda esta informaci\u00f3n es meramente informativa, podr\u00eda haber, por ejemplo, dos usuarios cuyo nombre completo fuera \"F\u00ba Javier Hern\u00e1ndez Ill\u00e1n\".</p> <p>Note</p> <ul> <li>Como normas generales al crear un nombre de usuario hay que observar que:<ul> <li>Las cuentas de usuario deben ser \u00fanicas.</li> <li>Los nombres de inicio de sesi\u00f3n se pueden formar con una combinaci\u00f3n de letras, may\u00fasculas o min\u00fasculas, y caracteres alfanum\u00e9ricos.</li> <li>No se aceptan los caracteres: <code>/, |, :, ;, =, &lt;, &gt; ni *</code>. La cuenta de usuario puede tener hasta 20 caracteres.</li> </ul> </li> </ul> <p>Por lo tanto en la segunda parte del cuadro de texto dode se indica 'Nombre de inicio de sesi\u00f3n de usuario' se introduce el nombre de usuario siguiendo la estructura que haya predefinido el administrador del sistema y como se ha indicado anteriormente, este nombre debe ser \u00fanico en todo el dominio.</p> <p>Algunos ejemplos de criterios para la creaci\u00f3n del nombre de usuario podr\u00edan ser los siguientes:</p> <ul> <li>Dos primeras letras del nombre y apellidos.</li> <li>El nombre de inicio de sesi\u00f3n del usuario F\u00ba Javier Hern\u00e1ndez Ill\u00e1n ser\u00eda: <code>fjhernandez</code>.</li> <li>Diferentes caracteres para separar la inicial del primer nombre y el apellido completo: <code>fj.hernandez</code>.</li> <li>Primer nombre completo y primer apellido completo separados por un punto: <code>francisco.hernandez</code>.</li> </ul> <p>A continuaci\u00f3n se solicitar\u00e1 que se introduzca la contrase\u00f1a del usuario. Esta debe cumplir con los criterios de complejidad establecidos. Adem\u00e1s aparecen una serie de opciones para configurar las propiedades de la contrase\u00f1a:</p> Creaci\u00f3n Nuevo Usuario III. <p>En la figura anterior aparecen cuatro opciones para la contrase\u00f1a</p> <ul> <li>El usuario debe cambiar la contrase\u00f1a en el siguiente inicio de sesi\u00f3n.</li> <li>El usuario no puede cambiar la contrase\u00f1a.</li> <li>La contrase\u00f1a nunca expira.</li> <li>La cuenta est\u00e1 deshabilitada.</li> </ul> <p>La primera de las opciones es \u00fatil para que el administrador cree el nuevo usuario con una contrase\u00f1a convencional. El usuario cuando se autentifique por primera vez en el sistema entrar\u00e1 con la contrase\u00f1a que le ha proporcionado el administrador, pero autom\u00e1ticamente, el sistema le indicar\u00e1 que debe ser cambiada. De esta manera, el administrador ya no conocer\u00e1 la contrase\u00f1a del usuario, garantiz\u00e1ndose la privacidad de esta.</p> Mensaje para cambio de contrase\u00f1a. <ul> <li> <p>El segundo de los casos ('El usuario no puede cambiar la contrase\u00f1a') est\u00e1 pensado para crear usuarios gen\u00e9ricos, supongamos que creamos una cuenta de usuario para utilizar un ordenador conectado a un esc\u00e1ner, y queremos que los Usuarios que deseen utilizar ese esc\u00e1ner, siempre entren con la misma cuenta al equipo asociado al esc\u00e1ner.</p> </li> <li> <p>La inhabilitaci\u00f3n del tercer caso ('La contrase\u00f1a nunca expira'), tiene por objetivo evitar que el sistema pida al usuario que cambie la contrase\u00f1a peri\u00f3dicamente. Resulta interesante mantener esta opci\u00f3n, aunque pueda resultar inc\u00f3modo cambiar la contrase\u00f1a cada, por ejemplo, seis meses. De esta manera estamos protegi\u00e9ndonos de posibles accesos indebidos por parte de alguien que haya averiguado la contrase\u00f1a de alguna manera.</p> </li> <li> <p>Finalmente, la cuarta opci\u00f3n ('La cuenta est\u00e1 deshabilitada') sirve para bloquear usuarios que no queremos que tengan acceso al sistema, pero tampoco queremos eliminarlos, ya que se invalidar\u00edan los permisos referidos a este usuario. Tambi\u00e9n puede servir para crear usuarios que no queremos que est\u00e9n operativos hasta un momento determinado.</p> </li> </ul>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#eliminacion-y-deshabilitacion-de-usuarios","title":"Eliminaci\u00f3n y deshabilitaci\u00f3n de usuarios","text":"<p>Note</p> <ul> <li>Cada cuenta de usuario creada en un dominio tiene un identificador de seguridad (SID) \u00fanico. Si eliminamos una cuenta de usuario y despu\u00e9s volvemos a crearla exactamente igual, el identificador SID ser\u00e1 diferente. </li> <li>Esto se traduce en que no se podr\u00e1n recuperar los permisos y privilegios de la cuenta eliminada.</li> </ul> <p>Si finalmente decidimos eliminar la cuenta, accederemos a 'Usuarios y equipos de Active Directory', seleccionaremos el usuario a eliminar, haremos clic con el bot\u00f3n derecho y luego 'Eliminar':</p> Eliminar usuario de AD."},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#deshabilitar-cuentas","title":"Deshabilitar cuentas","text":"<p>Para evitar posibles problemas con la eliminaci\u00f3n de cuentas, el cual es un proceso definitivo, se suele optar por la deshabilitaci\u00f3n de cuentas.</p> Deshabilitar cuenta. <p>Example</p> <ul> <li>Supongamos una empresa en la que un trabajador va a cesar su actividad. El administrador de sistemas deshabilitar\u00e1 su cuenta en la fecha en la que el trabajador vaya a dejar de prestar sus servicios. De esta manera el trabajador cesado ya no podr\u00e1 iniciar sesi\u00f3n en el dominio, pero si pasado un tiempo hiciera falta volver a iniciar sesi\u00f3n, bastar\u00eda con habilitar de nuevo la cuenta.</li> <li>Otro ejemplo real podr\u00eda ser una universidad, en la que cada alumno tiene una cuenta de usuario. Cuando finaliza sus estudios, la cuenta es deshabilitada, pero si posteriormente cursa otros estudios, la cuenta volver\u00eda a habilitarse.</li> </ul> <p>Como antes, accederemos a 'Usuarios y equipos de Active Directory' y haciendo clic con el bot\u00f3n secundario sobre el usuario a bloquear, seleccionaremos la opci\u00f3n 'Deshabilitar la cuenta'.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#configuracion-de-la-cuenta-de-usuario","title":"Configuraci\u00f3n de la cuenta de usuario","text":"<p>Las cuentas de usuarios creadas en el domino se pueden configurar de una manera detallada en la ventana \u2018Propiedades de la cuenta\u2019, para ello se hace clic con el bot\u00f3n derecho del rat\u00f3n sobre la cuenta de usuario que se desea editar:</p> <p>Las propiedades de la cuenta de usuario qu\u00e9 m\u00e1s utilizaremos durante este curso ser\u00e1n:</p> <ul> <li>General: Se puede modificar el Nombre, Apellido, etc. y adem\u00e1s modificar informaci\u00f3n administrativa como la descripci\u00f3n, oficina, tel\u00e9fono, email y p\u00e1gina web.</li> <li>Cuenta: Se puede configurar algunas caracter\u00edsticas de la contrase\u00f1a de usuario, las horas de inicio de sesi\u00f3n, la caducidad de la cuenta, desbloquear la cuenta, etc.</li> <li>Perfil: En esta ficha se pueden editar aspectos importantes como son la ubicaci\u00f3n f\u00edsica del perfil del usuario y el fichero de comandos de inicio de sesi\u00f3n.</li> <li>Miembro de: Se muestra el listado de grupos a los que el usuario pertenece.</li> </ul>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#configuracion-de-inicio-de-sesion","title":"Configuraci\u00f3n de inicio de sesi\u00f3n","text":"<p>A partir de Windows Server 2008 se permite configurar los horarios en los que se puede iniciar sesi\u00f3n. Esta funcionalidad puede ser \u00fatil para controlar accesos al sistema a horas \u2018an\u00f3malas\u2019, o para evitar que usuarios de, por ejemplo, el turno de tarde, puedan acceder al sistema con la cuenta de un usuario del turno de ma\u00f1ana.</p> <p>Para establecer los horarios en los que se puede iniciar sesi\u00f3n se seguir\u00e1n los siguientes pasos.</p> <p>En \u2018Usuarios y Equipos de Active Directory\u2019 se selecciona el usuario buscado, y haciendo clic con el bot\u00f3n derecho se accede a \u2018Propiedades\u2019.</p> <ul> <li>Se abre el cuadro de di\u00e1logo \u2018Propiedades\u2019 de la cuenta seleccionada.</li> <li>Se hace clic en la ficha \u2018Cuenta\u2019 y despu\u00e9s se hace clic en el bot\u00f3n \u2018Horas de inicio de sesi\u00f3n\u2019</li> </ul> Horas de inicio de sesi\u00f3n I. <p>En color azul se muestran las horas de inicio permitidas. Para denegar el acceso basta con seleccionar las horas a las que se desea limitar el acceso y se marca la opci\u00f3n \u2018Inicio de sesi\u00f3n denegado\u2019:</p> Horas de inicio de sesi\u00f3n II. <p>Tambi\u00e9n es posible configurar el inicio de sesi\u00f3n en determinados equipos. Para ello basta con hacer clic en el bot\u00f3n \u2018Iniciar sesi\u00f3n en...\u2019. Se puede seleccionar si el usuario puede iniciar sesi\u00f3n en \u2018Todos los equipos\u2019 o solo en algunos equipos determinados:</p> Iniciar sesi\u00f3n en..."},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#creacion-de-grupos","title":"Creaci\u00f3n de grupos","text":"<p>Los grupos son un tipo de contenedor que permiten definir conjuntos de usuarios y definir permisos bas\u00e1ndonos en esa pertenencia al grupo, en lugar de hacerlo de modo individual, usuario por usuario. </p> <p>Eso no s\u00f3lo facilita la administraci\u00f3n del dominio sino que tambi\u00e9n permite trabajar de un modo menos propenso a errores. Como pauta general, la agrupaci\u00f3n de objetos suele facilitar las tareas de administraci\u00f3n reduciendo las posibilidades de error.</p> <p>Existen dos grandes tipos de grupos en el Directorio Activo de Windows:</p> <ul> <li>Grupos de seguridad: este tipo de grupos permite definir permisos para recursos del dominio. Son los utilizados en las listas de control de accesos (ACLs) que se estudiar\u00e1n m\u00e1s adelante. Este tipo de grupos son los que se utilizar\u00e1n en la administraci\u00f3n de la red.</li> <li>Grupos de distribuci\u00f3n: no poseen caracter\u00edsticas de seguridad, \u00fanicamente son un listado de usuarios para mensajer\u00eda.</li> </ul> <p>Dentro de los grupos de seguridad existen a su vez tres \u00e1mbitos:</p> <ul> <li>Grupo Universal: es un grupo cuyos permisos se extienden a diversos dominios. Adem\u00e1s este tipo de grupos puede estar formado por usuarios o grupos de usuarios de diferentes dominios.</li> <li>Grupo Global: es muy similar a los grupos universales, es decir pueden permitir el acceso a recursos de cualquiera de los dominios del \u00e1rbol del Directorio Activo, pero con la salvedad de que todos los miembros del grupo deben pertenecer al mismo dominio.</li> <li>Grupo Local del Dominio: es un grupo creado en un dominio con miembros que pueden provenir de otros dominios y que \u00fanicamente puede tener acceso a recursos dentro de su dominio.</li> </ul>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#en-que-casos-utilizar-un-ambito-y-otro-de-grupo","title":"\u00bfEn qu\u00e9 casos utilizar un \u00e1mbito y otro de grupo?","text":"<p>Los grupos universales suelen tener su utilidad en grandes empresas en las que se ha definido un bosque de dominios asignando dominios a cada uno de sus departamentos o divisiones. En este tipo de estructuras, cuando se realiza una modificaci\u00f3n en el grupo, esta debe replicarse en todos los controladores de domino que est\u00e9n configurados como cat\u00e1logo global.</p> <p>En redes de dominio \u00fanico se pueden aplicar grupos globales que tendr\u00e1n mayor sentido cuando se defina un segundo dominio, lo que puede ocurrir en el momento en el que haya una ampliaci\u00f3n de la organizaci\u00f3n.</p> <p>Como pautas generales para la administraci\u00f3n de redes tendremos en cuenta las siguientes consideraciones</p> <ol> <li>No se debe asignar un \u00e1mbito m\u00e1s amplio del necesario.</li> <li>Los grupos locales de dominio no se pueden procesar en otros dominios.</li> <li>Un grupo global no se replica fuera del dominio ya que no forma parte del plan de replicaci\u00f3n del cat\u00e1logo global.</li> <li>Los grupos universales se replican por toda la red generando tr\u00e1fico que puede tener una cierta incidencia en el rendimiento de esta (aunque este aspecto se ha optimizado a partir de Windows Server 2008).</li> <li>Si un grupo universal est\u00e1 compuesto por grupos globales y se producen cambios dentro de los grupos globales, no se produce un cambio en el cat\u00e1logo global, y por tanto esa modificaci\u00f3n no conlleva una replicaci\u00f3n en todos los controladores de domino del bosque.</li> </ol>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#grupos-predefinidos","title":"Grupos predefinidos","text":"<p>Al instalar el Directorio Activo podemos comprobar que se han generado autom\u00e1ticamente una serie de grupos predefinidos con unos permisos acorde a sus funciones asignadas:</p> Grupos predefinidos Grupos Builtin <p>Examinemos las funciones de algunos de los grupos m\u00e1s utilizados:</p> <ul> <li>Usuarios del dominio: grupo global que contiene todas las cuentas de usuarios el domino.</li> <li>Administradores del dominio: grupo global que permite a sus miembros realizar tareas de administraci\u00f3n del dominio.</li> <li>Administradores de empresa: grupo universal que permite a sus miembros realizar tareas de administraci\u00f3n en todos los dominios de la red.</li> <li>Administradores de esquema: grupo universal que permite a sus miembros modificar la estructura de los objetos del Directorio Activo.</li> <li>Administradores: grupo local que permite a sus miembros realizar tareas de administraci\u00f3n en el controlador de dominio.</li> <li>Operadores de copias de seguridad: grupo local que permite a sus miembros realizar copias de seguridad o restaurar archivos dentro del dominio.</li> <li>Operadores de cuenta: grupo local que permite a sus miembros crear, editar y eliminar cuentas de usuario y grupos.</li> <li>Operadores de impresi\u00f3n: grupo local que permite a sus miembros configurar y administrar el uso de impresoras de red.</li> <li>Operadores de servidor: grupo local que permite a sus miembros crear carpetas compartidas en el servidor y realizar copias de seguridad o restaurar archivos en el controlador de dominio.</li> <li>Usuarios: grupo local que limita las posibilidades de que un usuario haga un cambio accidental en el sistema pero s\u00ed permite ejecutar la mayor\u00eda de las aplicaciones.</li> </ul> <p>Es importante darse cuenta del considerable ahorro de tiempo para el administrador que permite la existencia de grupos predefinidos para tareas muy concretas.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#creacion-de-grupos_1","title":"Creaci\u00f3n de grupos","text":"<p>La forma de crear los grupos es muy parecida a la que hac\u00edamos para crear a los usuarios. Para ello desde la opci\u00f3n de Usuarios y equipos de Active Directory, con el bot\u00f3n de la derecha del rat\u00f3n, nuevo --&gt; Grupo:</p> Creaci\u00f3n de Grupos I <p>Se abrir\u00e1 el siguiente cuadro de dialogo:</p> Creaci\u00f3n de Grupos II <p>Por defecto se nos indica que el \u00e1mbito del grupo ser\u00e1 \u2018Global\u2019 y el tipo de grupo ser\u00e1 de \u2018Seguridad\u2019. En principio, si no tenemos unas necesidades que justifiquen lo contrario, crearemos los grupos con esas propiedades. Tras pulsar \u2018Aceptar\u2019 nos aparecer\u00e1 el nuevo grupo en el listado de \u2018Usuarios y equipos de Active Directory\u2019:</p> Creaci\u00f3n de Grupos III"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#anadir-usuarios-a-grupos","title":"A\u00f1adir usuarios a grupos","text":"<p>Para poder a\u00f1adir un usuario a un grupo, lo podemos hacer de varias maneras. La primera de ellas mediante basta con seleccionar el usuario y en el men\u00fa que se abrir\u00e1 al hacer clic con el bot\u00f3n derecho, acceder a la opci\u00f3n \u2018Agregar a un grupo\u2019:</p> A\u00f1adir usuario a grupo I <p>Se abrir\u00e1 un cuadro en el que podremos indicar/buscar el grupo al que queremos a\u00f1adir el usuario. Mediante comprobar nombres nos mostrar\u00e1 las coincidencias del grupo que hemos a\u00f1adido. Con las opciones avanzadas podemos hacer una b\u00fasqueda del grupo:</p> A\u00f1adir usuario a grupo II <p>Tras aceptar, aparecer\u00e1 un mensaje indicando que la operaci\u00f3n se ha realizado con \u00e9xito y podremos comprobar en las propiedades del usuario que efectivamente es miembro del grupo \u2018Profesores\u2019 :</p> A\u00f1adir usuario a grupo III Miembro de ... <p>Tambi\u00e9n podemos a\u00f1adir usuarios a un grupo a partir del grupo. Para ello podemos seleccionar el grupo y con el bot\u00f3n de la derecha propiedades, accedemos a la pesta\u00f1a miembros:</p> A\u00f1adir usuario a grupo IV <p>Y accedemos a la pesta\u00f1a miembros:</p> A\u00f1adir usuario a grupo IV <p>Y desde la opci\u00f3n Agregar podemos a\u00f1adir los usuarios miembros del grupo.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#unidades-organizativas","title":"Unidades Organizativas","text":"<p>Una unidad organizativa es un contenedor de objetos (usuarios, grupos, equipos, otras unidades organizativas, etc.) pertenecientes a un mismo dominio. Son especialmente \u00fatiles para reproducir la estructura de la empresa donde se halle el dominio. Es decir, si por ejemplo, una empresa est\u00e1 dividida en tres departamentos (direcci\u00f3n, ventas y producci\u00f3n), podemos crear tres unidades organizativas correspondientes a estos tres departamentos, donde incluyamos todos los objetos del dominio correspondientes a cada una de las \u00e1reas de la empresa.</p> <p>Su utilidad radica en dos aspectos fundamentales:</p> <ol> <li>De esta manera es muy sencillo establecer directivas de seguridad (las veremos en el siguiente tema) que se apliquen a todos los objetos de cada departamento.</li> <li>Como dentro de la unidad organizativa, se pueden introducir otras unidades organizativas, se puede replicar la estructura jer\u00e1rquica de la empresa sin necesidad de crear m\u00e1s dominios o subdominios.</li> </ol>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#creacion-de-unidades-organizativas","title":"Creaci\u00f3n de Unidades Organizativas","text":"<p>Para crear una unidad organizativa abriremos la ventana 'Usuarios y Equipos de Active Directory' (desde el Panel del Administrador, 'Herramientas Administrativas'). A continuaci\u00f3n, nos situamos sobre el dominio y haciendo clic con el bot\u00f3n secundario seleccionamos 'Nuevo' y 'Unidad Organizativa'</p> Unidades Organizativas <p>A continuaci\u00f3n se abrir\u00e1 el di\u00e1logo que nos permite indicar el nombre del nuevo objeto:</p> Creaci\u00f3n OU (Organizational Unit) <p>Al pulsar en Aceptar, se crear\u00e1 la Unidad Organizativa (OU) dentro de nuestro dominio. Notad tambi\u00e9n que por defecto se crea una protecci\u00f3n contra posibles errores de eliminaci\u00f3n. Por defecto la unidad no se podr\u00e1 eliminar de manera de manera accidental.</p> Creaci\u00f3n de una OU <p>Dentro de una Unidad Organizativa podemos a\u00f1adir objetos, usuarios, grupos, m\u00e1s unidades organizativas, etc... para ello seleccionamos la OU y con el bot\u00f3n derecho del rat\u00f3n accedemos a la opci\u00f3n Nuevo:</p> A\u00f1adir objetos a una OU <p>Podemos a\u00f1adir dos unidades organizativas dentro, una para Alumnos y otra para Profesores:</p> Crear elementos dentro de una OU <p>Tambi\u00e9n podemos arrastras elementos de una unidad a otra, por ejemplo, vamos a arrastras los grupos de Alumnos y Profesores y los usuarios que hemos creado. Seleccionamos el grupo Profesores y lo arrastramos a la unidad organizativa Profesores:</p> Mover objetos a OU Mover objetos entre OU"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#borrar-una-ou","title":"Borrar una OU","text":"<p>Si tratamos de borrar una OU, veremos que nos aparece un mensaje de que no tenemos los suficientes privilegios para poder realizar la acci\u00f3n de borrado. Esto es debido a la protecci\u00f3n contra eliminaciones accidentales de las que hemos comentado anteriormente:</p> Borrar OU <p>Para eliminar las unidades organizativas, en primer lugar deberemos activar las 'caracter\u00edsticas avanzadas' seleccionando en el men\u00fa 'Ver' la opci\u00f3n 'Caracter\u00edsticas Avanzadas'.</p> Borrado de una OU <p>Nos aparecer\u00e1 la ventana de la OU:</p> Desproteger una OU <p>Desmarcamos el check de protecci\u00f3n contra eliminaciones accidentales:</p> Desactivar protecci\u00f3n <p>Ahora ya s\u00ed podemos eliminar la OU. Dejamos de nuevo desactivadas las opciones avanzadas desde la opci\u00f3n men\u00fa. En la pr\u00f3xima pr\u00e1ctica, utilizaremos las unidades organizativas para gestionar de manera eficaz el dominio, aplicando directivas de seguridad espec\u00edficas a cada unidad organizativa.</p>"},{"location":"07_DOMINIO_AD/072_GestionDominioI.html#pt71-administracion-de-usuarios-y-grupos","title":"PT71 Administraci\u00f3n de usuarios y grupos","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE5, CE6, CE7, CE8 y CE9 del RA2 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Partiendo de la Situaci\u00f3n de aprendizaje de PT61, y despu\u00e9s de la instalaci\u00f3n previa del Active Directory realiza las siguientes tareas.</p> <p>Tarea</p> <p>Siguiendo con la configuraci\u00f3n del Active Directory para Area Studio, estas realizando pruebas de creaci\u00f3n de usuarios y credenciales debes realizar los siguientes puntos:</p> <ol> <li>Crea dos usuarios con el nombre usuario1 y usuario2. Ponles a ambos la contrase\u00f1a <code>Abc123!</code> y configura las cuentas de usuario para que no tengan que cambiar la contrase\u00f1a al iniciar sesi\u00f3n por primera vez.</li> <li>Agrega estos usuarios al grupo global Alumnos y deshabilita la cuenta de usuario2.</li> <li>Adjunta una captura de pantalla del error que sale al intentar acceder desde un equipo cliente con el usuario2. Habilita de nuevo la cuenta de usuario2. </li> <li>Configura la cuenta usuario1 para que solamente pueda iniciar sesi\u00f3n desde el equipo W10. </li> <li>Valida en el dominio otro equipo Windows 10 y comprueba que el usuario1 no puede iniciar sesi\u00f3n.</li> <li>Configura la cuenta de usuario2 para que pueda iniciar sesi\u00f3n en cualquier equipo del dominio solamente de lunes a viernes de 8.00 a 18.00. Adjunta una captura de la pantalla de la configuraci\u00f3n de los horarios de acceso al sistema del usuario2.</li> <li>Intenta iniciar sesi\u00f3n en el equipo controlador de dominio con usuario2. \u00bfPor qu\u00e9 no puedes?\u00bfQu\u00e9 podr\u00edas hacer para que usuario2 pudiera iniciar sesi\u00f3n en el controlador de dominio?</li> </ol>"},{"location":"07_DOMINIO_AD/073_GestionDominioII.html","title":"Gesti\u00f3n de dominio en Active Directory","text":"<p>A continuaci\u00f3n se desarrollan una serie de puntos para gestionar el dominio instalado en un Active Directory.</p>"},{"location":"07_DOMINIO_AD/073_GestionDominioII.html#degradar-un-controlador-de-dominio","title":"Degradar un controlador de dominio","text":"<p>En este apartado lo que vamos a ver es c\u00f3mo podemos degradar un servidor que est\u00e9 actuando como controlador de dominio, es decir, que tenga instalado un Active Directory. Para ello iremos al Panel de Administrador del Servidor y seleccionaremos Agregar roles y caracter\u00edsticas:</p> Degradar un controlador de dominio I. <p>Nos aparece el asistente para quitar roles y caracter\u00edsticas, seleccionamos siguiente:</p> Degradar un controlador de dominio II. <p>Iniciado el asistente seleccionamos el servidor en donde vamos a quitar alg\u00fan rol. En nuestro caso, eliminaremos el rol Servicios de dominio de Active Directory:</p> Degradar un controlador de dominio III. <p>Eliminamos las caracter\u00edsticas de los servicios de Active Directory:</p> Degradar un controlador de dominio IV. <p>Para poder eliminar los servicios de Active Directory, es necesario disminuir el nivel del controlador de dominio:</p> Degradar un controlador de dominio V. <p>Forzamos la eliminaci\u00f3n del controlador de dominio:</p> Degradar un controlador de dominio VI. <p>Introducimos la contrase\u00f1a del administrador del dominio, en nuestro caso \"cefire2017.\":</p> Degradar un controlador de dominio VII. <p>Y por \u00faltimo Disminuimos el nivel:</p> Degradar un controlador de dominio VIII."},{"location":"07_DOMINIO_AD/073_GestionDominioII.html#eliminar-clientes-de-un-dominio","title":"Eliminar clientes de un dominio","text":"<p>Habr\u00e1 veces que una determinada m\u00e1quina queramos sacarla de un dominio por alg\u00fan motivo, para quitar un cliente Windows 10 de un domino debemos realizar los siguientes pasos:</p> <p>Accedemos a Sistema, a trav\u00e9s del bot\u00f3n de inicio de Windows y con el rat\u00f3n bot\u00f3n de la derecha --&gt; Sistema.</p> Eliminar cliente windows 10 de dominio I. <p>Dentro de Sistema --&gt; Seleccionamos Administrar o desconectar del trabajo o de la escuela:</p> Eliminar cliente windows 10 de dominio II. <p>Seleccionamos el dominio al que est\u00e1 conectado, en nuestro caso a ASO2223.LOCAL y hacemos clic en Desconectar</p> Eliminar cliente windows 10 de dominio III. Eliminar cliente windows 10 de dominio IV. <p>Confirmamos la desconexi\u00f3n del dominio local</p> Eliminar cliente windows 10 de dominio V."},{"location":"07_DOMINIO_AD/073_GestionDominioII.html#pt72-gestion-de-dominios-en-active-directory","title":"PT72 Gesti\u00f3n de Dominios en Active Directory","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE2, CE3, CE5, CE6, CE7, CE8 y CE9 del RA3 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Partiendo de la Situaci\u00f3n de aprendizaje de PT41 y PT61, realiza las siguientes tareas. </p> <p>Tarea</p> <p>Siguiendo con la configuraci\u00f3n del Active Directory para Area Studio debes realizar los siguientes puntos:</p> <ol> <li>Creaci\u00f3n de los usuarios, grupos y unidades organizativas de los responsables de departamento de Area Studio:</li> </ol> Nombre Apellido Inicio de sesi\u00f3n Posici\u00f3n Contrase\u00f1a Eduard Casavella eduard.casavella Gerente casavella1 Pep Terr\u00f3n pep.terron Responsable IT terron1 Fran Delgado fran.delgado Administraci\u00f3n delgado1 Marcos Sabates marcos.sabates Comercial sabates1 Irene Masot irene.masot RR HH masot1 <ol> <li>Elimina los clientes usuario1 y usuario2 de pruebas generados en la PT71.</li> <li>Genera una instant\u00e1nea del WS, y Degrada el Controlador de un dominio. Despu\u00e9s de esta \u00faltima acci\u00f3n prueba acceder con cualquier usuario generado para Area Studio. \u00bfPuedes acceder?\u00bfPor qu\u00e9?</li> </ol>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html","title":"Pr\u00e1ctica05_AD","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#instalacion-de-active-directoryinstalacion-de-active-directory-ii","title":"Instalaci\u00f3n de Active DirectoryInstalaci\u00f3n de Active Directory II","text":"<p>Objetivos de esta pr\u00e1ctica:</p> <ul> <li>Eliminar Clientes de un dominio.</li> <li>Degradar Controlador de un dominio.</li> <li>Configurar un servicio de DHCP</li> <li>Acceso Remoto y NAT</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#eliminar-clientes-de-un-dominio","title":"Eliminar clientes de un dominio","text":"<p>Habr\u00e1 veces que una determinada m\u00e1quina queramos sacarla de un dominio por alg\u00fan motivo, para quitar un cliente Windows 10 de un domino debemos realizar los siguientes pasos:</p> <p>Accedemos a Sistema, a trav\u00e9s del bot\u00f3n de inicio de Windows y con el rat\u00f3n bot\u00f3n de la derecha --&gt; Sistema.</p> Eliminar cliente windows 10 de dominio I. <p>Dentro de Sistema --&gt; Seleccionamos Administrar o desconectar del trabajo o de la escuela:</p> Eliminar cliente windows 10 de dominio II. <p>Seleccionamos el dominio al que est\u00e1 conectado, en nuestro caso a ASO2223.LOCAL y hacemos clic en Desconectar</p> Eliminar cliente windows 10 de dominio III. Eliminar cliente windows 10 de dominio IV. <p>Confirmamos la desconexi\u00f3n del dominio local</p> Eliminar cliente windows 10 de dominio V."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#degradar-un-controlador-de-dominio","title":"Degradar un controlador de dominio","text":"<p>En este apartado lo que vamos a ver es c\u00f3mo podemos degradar un servidor que est\u00e9 actuando como controlador de dominio, es decir, que tenga instalado un Active Directory. Para ello iremos al Panel de Administrador del Servidor y seleccionaremos Agregar roles y caracter\u00edsticas:</p> Degradar un controlador de dominio I. <p>Nos aparece el asistente para quitar roles y caracter\u00edsticas, seleccionamos siguiente:</p> Degradar un controlador de dominio II. <p>Iniciado el asistente seleccionamos el servidor en donde vamos a quitar alg\u00fan rol. En nuestro caso, eliminaremos el rol Servicios de dominio de Active Directory:</p> Degradar un controlador de dominio III. <p>Eliminamos las caracter\u00edsticas de los servicios de Active Directory:</p> Degradar un controlador de dominio IV. <p>Para poder eliminar los servicios de Active Directory, es necesario disminuir el nivel del controlador de dominio:</p> Degradar un controlador de dominio V. <p>Forzamos la eliminaci\u00f3n del controlador de dominio:</p> Degradar un controlador de dominio VI. <p>Introducimos la contrase\u00f1a del administrador del dominio, en nuestro caso \"cefire2017.\":</p> Degradar un controlador de dominio VII. <p>Y por \u00faltimo Disminuimos el nivel:</p> Degradar un controlador de dominio VIII."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#servicio-de-dhcp","title":"Servicio de DHCP","text":"<p>Indiscutiblemente uno de los principales roles que nos ofrece Windows Server y que son vitales en el \u00f3ptimo funcionamiento de nuestra infraestructura de red es el rol de DHCP. DHCP (Dynamic Host Configuration Protocol \u2013 Protocolo de Configuraci\u00f3n Din\u00e1mica de Equipos) nos permite definir rangos de direcciones IP para los equipos cliente del dominio y de este modo administrar de forma centralizada todas las direcciones IP del dominio.</p> <p>Cuando en nuestra organizaci\u00f3n tenemos disponible un servidor DHCP tenemos la plena confianza que todos los equipos y dispositivos de nuestra red tendr\u00e1n de forma autom\u00e1tica su direcci\u00f3n IP y no es necesario ir a cada m\u00e1quina a definir la direcci\u00f3n de forma manual.</p> <p>Con el rol DHCP proveemos los siguientes par\u00e1metros:</p> <ul> <li>M\u00e1scara de subred</li> <li>Direcci\u00f3n IP</li> <li>Puerta de enlace</li> <li>Servidores DNS, entre otros.</li> </ul> <p>Para iniciar el proceso de instalaci\u00f3n seleccionaremos la opci\u00f3n Agregar roles y caracter\u00edsticas desde el Administrador del servidor. La primera ventana la podemos omitir ya que es de bienvenida. Pulsamos Siguiente y en la ventana desplegada seleccionamos la opci\u00f3n Instalaci\u00f3n basada en caracter\u00edsticas y roles, pulsamos Siguiente y seleccionamos el servidor donde instalaremos el rol DHCP.</p> Instalaci\u00f3n servicio de DHCP I. <p>Una vez seleccionado el equipo buscaremos el rol Servidor de DHCP, al activar la casilla veremos la siguiente ventana donde se indica si deseamos agregar las caracter\u00edsticas de DHCP. </p> <p>Seleccionamos la opci\u00f3n Agregar caracter\u00edstica y veremos el rol seleccionado. Llegaremos al resumen y haremos clic en Instalar:</p> Instalaci\u00f3n servicio de DHCP II. <p>Una vez instalado, hay que realizar la configuraci\u00f3n del rol. Para ello hay que hacer clic en Completar configuraci\u00f3n DHCP:</p> Instalaci\u00f3n servicio de DHCP III."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#configuracion-servicio-de-dhcp","title":"Configuraci\u00f3n servicio de DHCP","text":"<p>Como vemos debemos completar la configuraci\u00f3n del DHCP para que todo el rol quede correctamente preparado para la organizaci\u00f3n, para ello pulsamos en la opci\u00f3n \u201cCompletar configuraci\u00f3n de DHCP\u201d. Al pulsar esta opci\u00f3n veremos el siguiente asistente.</p> Configuraci\u00f3n servicio de DHCP I. <p>Pulsamos Siguiente y debemos configurar las credenciales del usuario que han de ser usadas para la configuraci\u00f3n del servidor DHCP:</p> Configuraci\u00f3n servicio de DHCP II. <p>Una vez definidas pulsamos Confirmar y veremos el resumen del proceso. Pulsamos Cerrar para salir del asistente. Con esto hemos instalado el rol de DHCP en Windows Server 2019:</p> Configuraci\u00f3n servicio de DHCP III. <p>Ahora debemos configurar el DHCP por lo que con este paso realizado vamos a ir a la siguiente ruta para establecer la configuraci\u00f3n deseada para el DHCP. Para ello vamos al Panel del Administrador --&gt; Herramientas y DHCP:</p> <p>Como podemos observar contamos con dos opciones de configuraci\u00f3n. All\u00ed podemos configurar todos los par\u00e1metros del direccionamiento IPv4, hasta ahora el m\u00e1s usado y el de IPv6.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#creacion-de-un-nuevo-ambito","title":"Creaci\u00f3n de un nuevo \u00e1mbito","text":"<p>Un \u00e1mbito es un rango de direcciones que ser\u00e1n asignadas de forma autom\u00e1tica a los equipos de nuestro dominio. Por tanto seleccionaremos IPv4 y con el bot\u00f3n de la derecha del rat\u00f3n accederemos a la opci\u00f3n \u00c1mbito Nuevo...</p> <p>Iniciar\u00e1 el asistente para creaci\u00f3n de un \u00e1mbito nuevo:</p> Configuraci\u00f3n servicio de DHCP IV. Configuraci\u00f3n servicio de DHCP V. <p>Pulsamos Siguiente y a continuaci\u00f3n debemos establecer un nombre a este nuevo \u00e1mbito. En nuestro caso, \u00e1mbito ASO2223.LOCAL:</p> Configuraci\u00f3n servicio de DHCP VI. <p>En la siguiente ventana debemos establecer el rango de direcciones IP a asignar de forma autom\u00e1tica, debemos indicar una direcci\u00f3n IP inicial y una direcci\u00f3n IP final. Es muy importante que tengamos claridad sobre la cantidad de usuarios estar\u00e1n activos para no asignar direcciones de m\u00e1s ni quedarnos cortos con las mismas. La longitud la dejamos por defecto en 24 y la m\u00e1scara de subred dejamos la que est\u00e1, clase C. En nuestro caso, introduciremos un rango desde la 192.168.100.20 - 192.168.100.250.</p> Configuraci\u00f3n servicio de DHCP VII. <p>Al pulsar Siguiente podemos establecer una o m\u00e1s direcciones IP que no ser\u00e1n distribuidas a los usuarios de manera normal, esto es efectivo en los siguientes casos:</p> <ul> <li>Tareas de administraci\u00f3n.</li> <li>Asignar IPs fijas a dispositivos como impresoras.</li> <li>Establecer direcciones IP a un grupo determinado de usuarios sin que \u00e9sta sea renovada.</li> </ul> Configuraci\u00f3n servicio de DHCP VIII. <p>Una vez establecido o no estas exclusiones pulsamos Siguiente y veremos que podemos configurar cu\u00e1nto tiempo durar\u00e1 la concesi\u00f3n de la direcci\u00f3n IP, esto hace que la direcci\u00f3n IP en el equipo cliente sea renovada de manera autom\u00e1tica, podemos definir este valor en d\u00edas, horas o minutos. Lo m\u00e1s recomendable es que para los equipos de nuestra organizaci\u00f3n se establezca esta concesi\u00f3n en d\u00edas ya que al renovarse la direcci\u00f3n IP el usuario puede verse afectado en su navegaci\u00f3n y uso de la red.</p> Configuraci\u00f3n servicio de DHCP IX. <p>Pulsamos Siguiente y debemos definir si establecemos esta configuraci\u00f3n de manera inmediata o m\u00e1s adelante. En nuestro caso marcaremos la opci\u00f3n de configurar las opciones ahora:</p> Configuraci\u00f3n servicio de DHCP X. <p>Al pulsar que las configure de manera inmediata el asistente nos solicitar\u00e1 que ingresemos la direcci\u00f3n IP del enrutador o puerta de enlace. En nuestro caso a\u00f1adiremos la ip 192.168.100.1 y le daremos a Agregar:</p> Configuraci\u00f3n servicio de DHCP XI. <p>Pulsamos nuevamente Siguiente y podemos ver el nombre del dominio o especificar cu\u00e1les equipos ser\u00e1n usados para la resoluci\u00f3n de los nombres DNS. En nuestro caso, la IP de la red interna, 192.168.100.1 y como alternativo podemos poder cualquier DNS, por ejemplo el de google 8.8.8.8:</p> Configuraci\u00f3n servicio de DHCP XII. <p>Al pulsar Siguiente veremos la configuraci\u00f3n de los servidores WINS los cuales permiten que los nombres de equipo NetBIOS sean convertidos en direcciones IP. Nuestro caso ninguno.</p> Configuraci\u00f3n servicio de DHCP XIII. <p>Finalmente activamos nuestro \u00e1mbito.</p> Configuraci\u00f3n servicio de DHCP XIV."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#configuracion-de-ip-por-dhcp-en-maquina-cliente","title":"Configuraci\u00f3n de IP por DHCP en m\u00e1quina cliente","text":"<p>Para comprobar que nuestro DHCP funciona, basta con cambiar la configuraci\u00f3n en la m\u00e1quina Windows 10 cliente y comprobar que nos asigna la primera direcci\u00f3n disponible de nuestro \u00e1mbito, t\u00edpicamente la 192.168.100.20, en nuestro caso:</p> Configuraci\u00f3n IP din\u00e1mica en cliente. <p>Y comprobamos la IP:</p> Comprobaci\u00f3n de asignaci\u00f3n de IP din\u00e1mica."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#concesion-de-direcciones-en-dhcp","title":"Concesi\u00f3n de direcciones en DHCP","text":"<p>Desde el servidor, en la opci\u00f3n de DHCP, tambi\u00e9n podemos comprobar las concesiones de direcciones IPs que se han realizado:</p> Comprobaci\u00f3n de las concesiones de direcciones IPs."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#acceso-remoto-nat","title":"Acceso Remoto. NAT.","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#servicios-de-enrutamiento","title":"Servicios de enrutamiento","text":"<p>En este punto vamos a realizar la configuraci\u00f3n de NAT en nuestro servidor. NAT (Network Address Translation) nos permite que nuestra interfaz externa, pueda traducir las direcciones de la red interna. De esta forma, en las m\u00e1quinas clientes de la red interna de nuestro dominio, puede tener acceso a internet. Este servicio en combinaci\u00f3n con el anterior se suele utilizar con mucha frecuencia. </p> <p>Para ello lo primero de debemos hacer es realizar la instalaci\u00f3n del rol Acceso Remoto, desde: el Panel del Administrador del Servidor en agregar roles y caracter\u00edsticas y seleccionar Acceso Remoto:</p> Configuraci\u00f3n de NAT I. <p>Marcamos y agregamos las caracter\u00edsticas, NAT va acompa\u00f1ado tambi\u00e9n del servicio de Enrutamiento y Direct Access. En nuestro caso, de momento solo realizaremos la configuraci\u00f3n de NAT:</p> Configuraci\u00f3n de NAT II. Configuraci\u00f3n de NAT III. <p>Una vez instalado vamos a realizar la configuraci\u00f3n del NAT. Para ello, dentro del Panel del Administrador del Servidor, accedemos a Herramientas y despu\u00e9s en Enrutamiento y Acceso Remoto:</p> Configuraci\u00f3n de NAT IV. <p>Dentro de enrutamiento y acceso remoto, seleccionamos nuestro servidor y con el bot\u00f3n de la derecha del rat\u00f3n, marcamos la opci\u00f3n Configurar y habilitar el Enrutamiento y acceso remoto:</p> Configuraci\u00f3n de NAT V. <p>Nos iniciar\u00e1 un asistente y marcaremos la opci\u00f3n Traducci\u00f3n de direcciones de red (NAT):</p> Configuraci\u00f3n de NAT VI. <p>Marcaremos nuestra interfaz externa (WAN) como interfaz de conexi\u00f3n a internet:</p> Configuraci\u00f3n de NAT VII."},{"location":"07_DOMINIO_AD/AyudaASO/Practica05_AD.html#acceso-a-internet-cliente-windows-10","title":"Acceso a internet cliente Windows 10","text":"<p>Ahora desde nuestra m\u00e1quina cliente Windows 10, ya tenemos nuestro acceso a internet:</p> Configuraci\u00f3n de NAT VIII."},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html","title":"Pr\u00e1ctica06_AD","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#administracion-de-usuarios-y-grupos","title":"Administraci\u00f3n de Usuarios y Grupos","text":"<p>Objetivos de esta pr\u00e1ctica:</p> <ul> <li>Crear y configurar usuarios</li> <li>Crear y configurar grupos</li> <li>Crear y configurar unidades organizativas</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-usuarios","title":"Creaci\u00f3n de usuarios","text":"<p>Los usuarios del dominio deben tener una cuenta para poder acceder a los recursos del mismo tras su autenticaci\u00f3n frente al controlador de dominio. </p> <p>Para crear una cuenta de usuario mediante la interfaz gr\u00e1fica accederemos a la herramienta:  'Usuarios y equipos de Active Directory' desde el Panel del Administrador --&gt; Herramientas:</p> Usuarios y Equipos de AD. <p>Una vez abierto el administrador de 'Usuarios y equipos de Active Directory', se hace clic con el bot\u00f3n derecho sobre 'Users' y en el men\u00fa que aparece, se selecciona 'Nuevo' y a continuaci\u00f3n 'Usuario' :</p> Creaci\u00f3n Nuevo Usuario I. <p>Nos aparece el asistente para la creaci\u00f3n del nuevo usuario:</p> Creaci\u00f3n Nuevo Usuario II. <p>En la primera parte del cuadro de di\u00e1logo anterior se puede introducir el nombre, la(s) inicial(es) del segundo nombre y los apellidos del usuario. Hasta aqu\u00ed toda esta informaci\u00f3n es meramente informativa, podr\u00eda haber, por ejemplo, dos usuarios cuyo nombre completo fuera \"F\u00ba Javier Hern\u00e1ndez Ill\u00e1n\".</p> <p>Note</p> <ul> <li>Como normas generales al crear un nombre de usuario hay que observar que:<ul> <li>Las cuentas de usuario deben ser \u00fanicas.</li> <li>Los nombres de inicio de sesi\u00f3n se pueden formar con una combinaci\u00f3n de letras, may\u00fasculas o min\u00fasculas, y caracteres alfanum\u00e9ricos.</li> <li>No se aceptan los caracteres: <code>/, |, :, ;, =, &lt;, &gt; ni *</code>. La cuenta de usuario puede tener hasta 20 caracteres.</li> </ul> </li> </ul> <p>Por lo tanto en la segunda parte del cuadro de texto dode se indica 'Nombre de inicio de sesi\u00f3n de usuario' se introduce el nombre de usuario siguiendo la estructura que haya predefinido el administrador del sistema y como se ha indicado anteriormente, este nombre debe ser \u00fanico en todo el dominio.</p> <p>Algunos ejemplos de criterios para la creaci\u00f3n del nombre de usuario podr\u00edan ser los siguientes:</p> <ul> <li>Dos primeras letras del nombre y apellidos.</li> <li>El nombre de inicio de sesi\u00f3n del usuario F\u00ba Javier Hern\u00e1ndez Ill\u00e1n ser\u00eda: <code>fjhernandez</code>.</li> <li>Diferentes caracteres para separar la inicial del primer nombre y el apellido completo: <code>fj.hernandez</code>.</li> <li>Primer nombre completo y primer apellido completo separados por un punto: <code>francisco.hernandez</code>.</li> </ul> <p>A continuaci\u00f3n se solicitar\u00e1 que se introduzca la contrase\u00f1a del usuario. Esta debe cumplir con los criterios de complejidad establecidos. Adem\u00e1s aparecen una serie de opciones para configurar las propiedades de la contrase\u00f1a:</p> Creaci\u00f3n Nuevo Usuario III. <p>En la figura anterior aparecen cuatro opciones para la contrase\u00f1a</p> <ul> <li>El usuario debe cambiar la contrase\u00f1a en el siguiente inicio de sesi\u00f3n.</li> <li>El usuario no puede cambiar la contrase\u00f1a.</li> <li>La contrase\u00f1a nunca expira.</li> <li>La cuenta est\u00e1 deshabilitada.</li> </ul> <p>La primera de las opciones es \u00fatil para que el administrador cree el nuevo usuario con una contrase\u00f1a convencional. El usuario cuando se autentifique por primera vez en el sistema entrar\u00e1 con la contrase\u00f1a que le ha proporcionado el administrador, pero autom\u00e1ticamente, el sistema le indicar\u00e1 que debe ser cambiada. De esta manera, el administrador ya no conocer\u00e1 la contrase\u00f1a del usuario, garantiz\u00e1ndose la privacidad de esta.</p> Mensaje para cambio de contrase\u00f1a. <ul> <li> <p>El segundo de los casos ('El usuario no puede cambiar la contrase\u00f1a') est\u00e1 pensado para crear usuarios gen\u00e9ricos, supongamos que creamos una cuenta de usuario para utilizar un ordenador conectado a un esc\u00e1ner, y queremos que los Usuarios que deseen utilizar ese esc\u00e1ner, siempre entren con la misma cuenta al equipo asociado al esc\u00e1ner.</p> </li> <li> <p>La inhabilitaci\u00f3n del tercer caso ('La contrase\u00f1a nunca expira'), tiene por objetivo evitar que el sistema pida al usuario que cambie la contrase\u00f1a peri\u00f3dicamente. Resulta interesante mantener esta opci\u00f3n, aunque pueda resultar inc\u00f3modo cambiar la contrase\u00f1a cada, por ejemplo, seis meses. De esta manera estamos protegi\u00e9ndonos de posibles accesos indebidos por parte de alguien que haya averiguado la contrase\u00f1a de alguna manera.</p> </li> <li> <p>Finalmente, la cuarta opci\u00f3n ('La cuenta est\u00e1 deshabilitada') sirve para bloquear usuarios que no queremos que tengan acceso al sistema, pero tampoco queremos eliminarlos, ya que se invalidar\u00edan los permisos referidos a este usuario. Tambi\u00e9n puede servir para crear usuarios que no queremos que est\u00e9n operativos hasta un momento determinado.</p> </li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-usuarios-por-comandos","title":"Creaci\u00f3n de usuarios por comandos","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#dsadd-user-cmd","title":"DSADD USER -&gt; CMD","text":"<p>Una opci\u00f3n para poder crear usuarios del dominio es mediante el comando <code>dsadd user</code>. Este comando nos va a permitir definir la ubicaci\u00f3n en la que se crear\u00e1 el usuario en lo referente a:</p> <ul> <li>Dominio o subdominio.</li> <li>Unidad Organizativa.</li> </ul> <p><code>dsadd</code> es una herramienta de l\u00ednea de comandos que est\u00e1 integrada a partir de Windows Server 2008.</p> <ul> <li>Est\u00e1 disponible si tiene instalada la funci\u00f3n de servidor de servicios de dominio de Active Directory (AD DS). </li> <li>Para utilizar <code>dsadd</code>, debe ejecutar el comando <code>dsadd</code> desde un s\u00edmbolo del sistema con privilegios de administrador. </li> <li>Para una referencia m\u00e1s amplia del comando, se puede acceder al siguiente enlace.</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#sintaxis-dsadd-user","title":"Sintaxis dsadd user","text":"<pre><code>dsadd user &lt;UserDN&gt; [-samid &lt;SAMName&gt;] [-upn &lt;UPN&gt;] [-fn &lt;FirstName&gt;] [-mi &lt;Initial&gt;] [-ln &lt;LastName&gt;] [-display &lt;DisplayName&gt;] [-empid &lt;EmployeeID&gt;] [-pwd {&lt;Password&gt; | *}] [-desc &lt;Description&gt;] [-memberof &lt;Group&gt; ...] [-office &lt;Office&gt;] [-tel &lt;PhoneNumber&gt;] [-email &lt;Email&gt;] [-hometel &lt;HomePhoneNumber&gt;] [-pager &lt;PagerNumber&gt;] [-mobile &lt;CellPhoneNumber&gt;] [-fax &lt;FaxNumber&gt;] [-iptel &lt;IPPhoneNumber&gt;] [-webpg &lt;WebPage&gt;] [-title &lt;Title&gt;] [-dept &lt;Department&gt;] [-company &lt;Company&gt;] [-mgr &lt;Manager&gt;] [-hmdir &lt;HomeDirectory&gt;] [-hmdrv &lt;DriveLetter&gt;:][-profile &lt;ProfilePath&gt;] [-loscr &lt;ScriptPath&gt;] [-mustchpwd {yes | no}] [-canchpwd {yes | no}] [-reversiblepwd {yes | no}] [-pwdneverexpires {yes | no}] [-acctexpires &lt;NumberOfDays&gt;] [-disabled {yes | no}] [{-s &lt;Server&gt; | -d &lt;Domain&gt;}] [-u &lt;UserName&gt;] [-p {&lt;Password&gt; | *}] [-q] [{-uc | -uco | -uci}]\n</code></pre> <p>Observaciones</p> <ul> <li>Si no proporciona un objeto de destino en el s\u00edmbolo del sistema, <code>dsadd</code> Obtiene el objeto de destino de la entrada est\u00e1ndar (<code>stdin</code>).</li> <li><code>Dsadd</code> puede aceptar <code>stdin</code> desde el teclado, desde un archivo redirigido o como salida canalizada desde otro comando. </li> <li>Para marcar el final de los datos <code>stdin</code> desde el teclado o en un archivo redirigido, utilice el car\u00e1cter de fin de archivo (CTRL+Z).</li> <li>Si un valor que se proporciona contiene espacios, use comillas alrededor del texto, por ejemplo, \"CN = Javier Hern\u00e1ndez, CN = Users, DC = ASO2223, DC = LOCAL\".</li> <li>Si proporciona m\u00faltiples valores para un par\u00e1metro, utilice espacios para separar los valores, por ejemplo, una lista de nombres completos.</li> <li>Uso de contrase\u00f1as seguras en todas las cuentas de usuario ayuda a minimizar los riesgos de seguridad.</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#crear-usuarios-con-powershell-new-aduser","title":"Crear usuarios con PowerShell: New-ADUser","text":"<p>Otra de las formas con las que podemos crear usuarios es mediante PowerShell, cada vez m\u00e1s utilizado en los sistemas Windows Server. Para poder crear usuarios con PowerShell, vamos a utilizar el comando <code>New-ADUser</code>. </p> <ul> <li>Desde el siguiente enlace pod\u00e9is obtener m\u00e1s informaci\u00f3n de este comando. </li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#la-sintaxis-del-mismo-es-la-siguiente","title":"La sintaxis del mismo es la siguiente:","text":"<pre><code>New-ADUser [-Name] &lt;string&gt; [-AccountExpirationDate &lt;System.Nullable[System.DateTime]&gt;] [-AccountNotDelegated &lt;System.Nullable[bool]&gt;] [-AccountPassword &lt;SecureString&gt;] [-AllowReversiblePasswordEncryption &lt;System.Nullable[bool]&gt;] [-AuthType {&lt;Negotiate&gt; | &lt;Basic&gt;}] [-CannotChangePassword &lt;System.Nullable[bool]&gt;] [-Certificates &lt;X509Certificate[]&gt;] [-ChangePasswordAtLogon &lt;System.Nullable[bool]&gt;] [-City &lt;string&gt;] [-Company &lt;string&gt;] [-Country &lt;string&gt;] [-Credential &lt;PSCredential&gt;] [-Department &lt;string&gt;] [-Description &lt;string&gt;] [-DisplayName &lt;string&gt;] [-Division &lt;string&gt;] [-EmailAddress &lt;string&gt;] [-EmployeeID &lt;string&gt;] [-EmployeeNumber &lt;string&gt;] [-Enabled &lt;System.Nullable[bool]&gt;] [-Fax &lt;string&gt;] [-GivenName &lt;string&gt;] [-HomeDirectory &lt;string&gt;] [-HomeDrive &lt;string&gt;] [-HomePage &lt;string&gt;] [-HomePhone &lt;string&gt;] [-Initials &lt;string&gt;] [-Instance &lt;ADUser&gt;] [-LogonWorkstations &lt;string&gt;] [-Manager &lt;ADUser&gt;] [-MobilePhone &lt;string&gt;] [-Office &lt;string&gt;] [-OfficePhone &lt;string&gt;] [-Organization &lt;string&gt;] [-OtherAttributes &lt;hashtable&gt;] [-OtherName &lt;string&gt;] [-PassThru &lt;switch&gt;] [-PasswordNeverExpires &lt;System.Nullable[bool]&gt;] [-PasswordNotRequired &lt;System.Nullable[bool]&gt;] [-Path &lt;string&gt;] [-POBox &lt;string&gt;] [-PostalCode &lt;string&gt;] [-ProfilePath &lt;string&gt;] [-SamAccountName &lt;string&gt;] [-ScriptPath &lt;string&gt;] [-Server &lt;string&gt;] [-ServicePrincipalNames &lt;string[]&gt;] [-SmartcardLogonRequired &lt;System.Nullable[bool]&gt;] [-State &lt;string&gt;] [-StreetAddress &lt;string&gt;] [-Surname &lt;string&gt;] [-Title &lt;string&gt;] [-TrustedForDelegation &lt;System.Nullable[bool]&gt;] [-Type &lt;string&gt;] [-UserPrincipalName &lt;string&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]\n</code></pre> <p>Example</p> <pre><code>New-ADUser -Name \"Javier Hernandez\" -Path \"CN=Users,DC=ASO2223,DC=LOCAL\" -SamAccountName \"fjhernandez\" -UserPrincipalName \"fjhernandez@CASO2223.LOCAL\" -AccountPassword (ConvertTo-SecureString\"ASO2223.\" -AsPlainText -Force) -GivenName \"Francisco Javier\" -Surname \"Hernandez Illan\" -ChangePasswordAtLogon $true -Enabled $true\n</code></pre> Par\u00e1metros New-ADUser I. Par\u00e1metros New-ADUser II."},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#eliminacion-y-deshabilitacion-de-usuarios","title":"Eliminaci\u00f3n y deshabilitaci\u00f3n de usuarios","text":"<p>Note</p> <ul> <li>Cada cuenta de usuario creada en un dominio tiene un identificador de seguridad (SID) \u00fanico. Si eliminamos una cuenta de usuario y despu\u00e9s volvemos a crearla exactamente igual, el identificador SID ser\u00e1 diferente. </li> <li>Esto se traduce en que no se podr\u00e1n recuperar los permisos y privilegios de la cuenta eliminada.</li> </ul> <p>Si finalmente decidimos eliminar la cuenta, accederemos a 'Usuarios y equipos de Active Directory', seleccionaremos el usuario a eliminar, haremos clic con el bot\u00f3n derecho y luego 'Eliminar':</p> Eliminar usuario de AD."},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#comandos","title":"Comandos","text":"<ul> <li>Para eliminar una cuenta de usuario mediante la l\u00ednea de comandos utilizaremos el comando dsrm</li> <li>Para eliminar una cuenta con PoweShell, entramos dentro del entorno powershell y ejecutamos Remove-ADUser</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#deshabilitar-cuentas","title":"Deshabilitar cuentas","text":"<p>Para evitar posibles problemas con la eliminaci\u00f3n de cuentas, el cual es un proceso definitivo, se suele optar por la deshabilitaci\u00f3n de cuentas.</p> Deshabilitar cuenta. <p>Example</p> <ul> <li>Supongamos una empresa en la que un trabajador va a cesar su actividad. El administrador de sistemas deshabilitar\u00e1 su cuenta en la fecha en la que el trabajador vaya a dejar de prestar sus servicios. De esta manera el trabajador cesado ya no podr\u00e1 iniciar sesi\u00f3n en el dominio, pero si pasado un tiempo hiciera falta volver a iniciar sesi\u00f3n, bastar\u00eda con habilitar de nuevo la cuenta.</li> <li>Otro ejemplo real podr\u00eda ser una universidad, en la que cada alumno tiene una cuenta de usuario. Cuando finaliza sus estudios, la cuenta es deshabilitada, pero si posteriormente cursa otros estudios, la cuenta volver\u00eda a habilitarse.</li> </ul> <p>Como antes, accederemos a 'Usuarios y equipos de Active Directory' y haciendo clic con el bot\u00f3n secundario sobre el usuario a bloquear, seleccionaremos la opci\u00f3n 'Deshabilitar la cuenta'.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#comandos_1","title":"Comandos","text":"<ul> <li> <p>Para deshabilitar una cuenta de usuario mediante la l\u00ednea de comandos utilizaremos el comando dsmod con el modificador <code>disabled</code> con valor yes.</p> </li> <li> <p>Desde el entorno powershell tambi\u00e9n podemos deshabilitar una cuenta de usuario con Disable-ADAccount</p> </li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#configuracion-de-la-cuenta-de-usuario","title":"Configuraci\u00f3n de la cuenta de usuario","text":"<p>Las cuentas de usuarios creadas en el domino se pueden configurar de una manera detallada en la ventana \u2018Propiedades de la cuenta\u2019, para ello se hace clic con el bot\u00f3n derecho del rat\u00f3n sobre la cuenta de usuario que se desea editar:</p> <p>Las propiedades de la cuenta de usuario qu\u00e9 m\u00e1s utilizaremos durante este curso ser\u00e1n:</p> <ul> <li>General: Se puede modificar el Nombre, Apellido, etc. y adem\u00e1s modificar informaci\u00f3n administrativa como la descripci\u00f3n, oficina, tel\u00e9fono, email y p\u00e1gina web.</li> <li>Cuenta: Se puede configurar algunas caracter\u00edsticas de la contrase\u00f1a de usuario, las horas de inicio de sesi\u00f3n, la caducidad de la cuenta, desbloquear la cuenta, etc.</li> <li>Perfil: En esta ficha se pueden editar aspectos importantes como son la ubicaci\u00f3n f\u00edsica del perfil del usuario y el fichero de comandos de inicio de sesi\u00f3n.</li> <li>Miembro de: Se muestra el listado de grupos a los que el usuario pertenece.</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#configuracion-de-inicio-de-sesion","title":"Configuraci\u00f3n de inicio de sesi\u00f3n","text":"<p>A partir de Windows Server 2008 se permite configurar los horarios en los que se puede iniciar sesi\u00f3n. Esta funcionalidad puede ser \u00fatil para controlar accesos al sistema a horas \u2018an\u00f3malas\u2019, o para evitar que usuarios de, por ejemplo, el turno de tarde, puedan acceder al sistema con la cuenta de un usuario del turno de ma\u00f1ana.</p> <p>Para establecer los horarios en los que se puede iniciar sesi\u00f3n se seguir\u00e1n los siguientes pasos.</p> <p>En \u2018Usuarios y Equipos de Active Directory\u2019 se selecciona el usuario buscado, y haciendo clic con el bot\u00f3n derecho se accede a \u2018Propiedades\u2019.</p> <ul> <li>Se abre el cuadro de di\u00e1logo \u2018Propiedades\u2019 de la cuenta seleccionada.</li> <li>Se hace clic en la ficha \u2018Cuenta\u2019 y despu\u00e9s se hace clic en el bot\u00f3n \u2018Horas de inicio de sesi\u00f3n\u2019</li> </ul> Horas de inicio de sesi\u00f3n I. <p>En color azul se muestran las horas de inicio permitidas. Para denegar el acceso basta con seleccionar las horas a las que se desea limitar el acceso y se marca la opci\u00f3n \u2018Inicio de sesi\u00f3n denegado\u2019:</p> Horas de inicio de sesi\u00f3n II. <p>Tambi\u00e9n es posible configurar el inicio de sesi\u00f3n en determinados equipos. Para ello basta con hacer clic en el bot\u00f3n \u2018Iniciar sesi\u00f3n en...\u2019. Se puede seleccionar si el usuario puede iniciar sesi\u00f3n en \u2018Todos los equipos\u2019 o solo en algunos equipos determinados:</p> Iniciar sesi\u00f3n en..."},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-grupos","title":"Creaci\u00f3n de grupos","text":"<p>Los grupos son un tipo de contenedor que permiten definir conjuntos de usuarios y definir permisos bas\u00e1ndonos en esa pertenencia al grupo, en lugar de hacerlo de modo individual, usuario por usuario. </p> <p>Eso no s\u00f3lo facilita la administraci\u00f3n del dominio sino que tambi\u00e9n permite trabajar de un modo menos propenso a errores. Como pauta general, la agrupaci\u00f3n de objetos suele facilitar las tareas de administraci\u00f3n reduciendo las posibilidades de error.</p> <p>Existen dos grandes tipos de grupos en el Directorio Activo de Windows:</p> <ul> <li>Grupos de seguridad: este tipo de grupos permite definir permisos para recursos del dominio. Son los utilizados en las listas de control de accesos (ACLs) que se estudiar\u00e1n m\u00e1s adelante. Este tipo de grupos son los que se utilizar\u00e1n en la administraci\u00f3n de la red.</li> <li>Grupos de distribuci\u00f3n: no poseen caracter\u00edsticas de seguridad, \u00fanicamente son un listado de usuarios para mensajer\u00eda.</li> </ul> <p>Dentro de los grupos de seguridad existen a su vez tres \u00e1mbitos:</p> <ul> <li>Grupo Universal: es un grupo cuyos permisos se extienden a diversos dominios. Adem\u00e1s este tipo de grupos puede estar formado por usuarios o grupos de usuarios de diferentes dominios.</li> <li>Grupo Global: es muy similar a los grupos universales, es decir pueden permitir el acceso a recursos de cualquiera de los dominios del \u00e1rbol del Directorio Activo, pero con la salvedad de que todos los miembros del grupo deben pertenecer al mismo dominio.</li> <li>Grupo Local del Dominio: es un grupo creado en un dominio con miembros que pueden provenir de otros dominios y que \u00fanicamente puede tener acceso a recursos dentro de su dominio.</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#en-que-casos-utilizar-un-ambito-y-otro-de-grupo","title":"\u00bfEn qu\u00e9 casos utilizar un \u00e1mbito y otro de grupo?","text":"<p>Los grupos universales suelen tener su utilidad en grandes empresas en las que se ha definido un bosque de dominios asignando dominios a cada uno de sus departamentos o divisiones. En este tipo de estructuras, cuando se realiza una modificaci\u00f3n en el grupo, esta debe replicarse en todos los controladores de domino que est\u00e9n configurados como cat\u00e1logo global.</p> <p>En redes de dominio \u00fanico se pueden aplicar grupos globales que tendr\u00e1n mayor sentido cuando se defina un segundo dominio, lo que puede ocurrir en el momento en el que haya una ampliaci\u00f3n de la organizaci\u00f3n.</p> <p>Como pautas generales para la administraci\u00f3n de redes tendremos en cuenta las siguientes consideraciones</p> <ol> <li>No se debe asignar un \u00e1mbito m\u00e1s amplio del necesario.</li> <li>Los grupos locales de dominio no se pueden procesar en otros dominios.</li> <li>Un grupo global no se replica fuera del dominio ya que no forma parte del plan de replicaci\u00f3n del cat\u00e1logo global.</li> <li>Los grupos universales se replican por toda la red generando tr\u00e1fico que puede tener una cierta incidencia en el rendimiento de esta (aunque este aspecto se ha optimizado a partir de Windows Server 2008).</li> <li>Si un grupo universal est\u00e1 compuesto por grupos globales y se producen cambios dentro de los grupos globales, no se produce un cambio en el cat\u00e1logo global, y por tanto esa modificaci\u00f3n no conlleva una replicaci\u00f3n en todos los controladores de domino del bosque.</li> </ol>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#grupos-predefinidos","title":"Grupos predefinidos","text":"<p>Al instalar el Directorio Activo podemos comprobar que se han generado autom\u00e1ticamente una serie de grupos predefinidos con unos permisos acorde a sus funciones asignadas:</p> Grupos predefinidos Grupos Builtin <p>Examinemos las funciones de algunos de los grupos m\u00e1s utilizados:</p> <ul> <li>Usuarios del dominio: grupo global que contiene todas las cuentas de usuarios el domino.</li> <li>Administradores del dominio: grupo global que permite a sus miembros realizar tareas de administraci\u00f3n del dominio.</li> <li>Administradores de empresa: grupo universal que permite a sus miembros realizar tareas de administraci\u00f3n en todos los dominios de la red.</li> <li>Administradores de esquema: grupo universal que permite a sus miembros modificar la estructura de los objetos del Directorio Activo.</li> <li>Administradores: grupo local que permite a sus miembros realizar tareas de administraci\u00f3n en el controlador de dominio.</li> <li>Operadores de copias de seguridad: grupo local que permite a sus miembros realizar copias de seguridad o restaurar archivos dentro del dominio.</li> <li>Operadores de cuenta: grupo local que permite a sus miembros crear, editar y eliminar cuentas de usuario y grupos.</li> <li>Operadores de impresi\u00f3n: grupo local que permite a sus miembros configurar y administrar el uso de impresoras de red.</li> <li>Operadores de servidor: grupo local que permite a sus miembros crear carpetas compartidas en el servidor y realizar copias de seguridad o restaurar archivos en el controlador de dominio.</li> <li>Usuarios: grupo local que limita las posibilidades de que un usuario haga un cambio accidental en el sistema pero s\u00ed permite ejecutar la mayor\u00eda de las aplicaciones.</li> </ul> <p>Es importante darse cuenta del considerable ahorro de tiempo para el administrador que permite la existencia de grupos predefinidos para tareas muy concretas.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-grupos_1","title":"Creaci\u00f3n de grupos","text":"<p>La forma de crear los grupos es muy parecida a la que hac\u00edamos para crear a los usuarios. Para ello desde la opci\u00f3n de Usuarios y equipos de Active Directory, con el bot\u00f3n de la derecha del rat\u00f3n, nuevo --&gt; Grupo:</p> Creaci\u00f3n de Grupos I <p>Se abrir\u00e1 el siguiente cuadro de dialogo:</p> Creaci\u00f3n de Grupos II <p>Por defecto se nos indica que el \u00e1mbito del grupo ser\u00e1 \u2018Global\u2019 y el tipo de grupo ser\u00e1 de \u2018Seguridad\u2019. En principio, si no tenemos unas necesidades que justifiquen lo contrario, crearemos los grupos con esas propiedades. Tras pulsar \u2018Aceptar\u2019 nos aparecer\u00e1 el nuevo grupo en el listado de \u2018Usuarios y equipos de Active Directory\u2019:</p> Creaci\u00f3n de Grupos III"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#anadir-usuarios-a-grupos","title":"A\u00f1adir usuarios a grupos","text":"<p>Para poder a\u00f1adir un usuario a un grupo, lo podemos hacer de varias maneras. La primera de ellas mediante basta con seleccionar el usuario y en el men\u00fa que se abrir\u00e1 al hacer clic con el bot\u00f3n derecho, acceder a la opci\u00f3n \u2018Agregar a un grupo\u2019:</p> A\u00f1adir usuario a grupo I <p>Se abrir\u00e1 un cuadro en el que podremos indicar/buscar el grupo al que queremos a\u00f1adir el usuario. Mediante comprobar nombres nos mostrar\u00e1 las coincidencias del grupo que hemos a\u00f1adido. Con las opciones avanzadas podemos hacer una b\u00fasqueda del grupo:</p> A\u00f1adir usuario a grupo II <p>Tras aceptar, aparecer\u00e1 un mensaje indicando que la operaci\u00f3n se ha realizado con \u00e9xito y podremos comprobar en las propiedades del usuario que efectivamente es miembro del grupo \u2018Profesores\u2019 :</p> A\u00f1adir usuario a grupo III Miembro de ... <p>Tambi\u00e9n podemos a\u00f1adir usuarios a un grupo a partir del grupo. Para ello podemos seleccionar el grupo y con el bot\u00f3n de la derecha propiedades, accedemos a la pesta\u00f1a miembros:</p> A\u00f1adir usuario a grupo IV <p>Y accedemos a la pesta\u00f1a miembros:</p> A\u00f1adir usuario a grupo IV <p>Y desde la opci\u00f3n Agregar podemos a\u00f1adir los usuarios miembros del grupo.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-grupos-por-comandos","title":"Creaci\u00f3n de grupos por comandos","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#dsadd-group","title":"DSADD GROUP","text":"<p>Para crear un grupo desde la consola, el comando utilizado es: dsaddgroup</p> <ul> <li>Para especificar si el grupo es de seguridad o de distribuci\u00f3n se utiliza la opci\u00f3n: <code>secgrp yes</code> ( o <code>\u2013secgrp</code> no si se trata de un grupo de distribuci\u00f3n). </li> <li>Para especificar el \u00e1mbito del grupo como universal, global o local se utiliza <code>\u2013scope</code> seguido de <code>u , g o l</code> , respectivamente. Si no se especifica nada por defecto se crear\u00e1 un grupo global y de seguridad.</li> </ul>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#sintaxis","title":"Sintaxis:","text":"<pre><code>dsadd group &lt;GroupDN&gt; [-secgrp {yes | no}] [-scope {l | g | u}] [-samid &lt;SAMName&gt;] [-desc &lt;Description&gt;] [-memberof &lt;Group&gt; ...] [-members &lt;Member&gt; ...] [{-s Server&gt; | -d &lt;Domain&gt;}] [-u &lt;UserName&gt;] [-p {&lt;Password&gt; | *}] [-q] [{-uc | -uco | -uci}]\n</code></pre>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#new-adgroup-creacion-de-grupos-en-powershell","title":"New-ADGroup: Creaci\u00f3n de grupos en powershell","text":"<p>Tambi\u00e9n podemos realizar la creaci\u00f3n de grupos desde powershell con el comando New-AdGroup </p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#la-sintaxis-del-comando-es-la-siguiente","title":"La sintaxis del comando es la siguiente:","text":"<pre><code>New-ADGroup [-Name] &lt;string&gt; [-GroupScope] &lt;System.Nullable[Microsoft.ActiveDirectory.Management.ADGroupScope]&gt; [-AuthType {&lt;Negotiate&gt; | &lt;Basic&gt;}] [-Credential &lt;PSCredential&gt;] [-Description &lt;string&gt;] [-DisplayName &lt;string&gt;] [-GroupCategory &lt;System.Nullable[Microsoft.ActiveDirectory.Management.ADGroupCategory]&gt;] [-HomePage &lt;string&gt;] [-Instance &lt;ADGroup&gt;] [-ManagedBy &lt;ADPrincipal&gt;] [-OtherAttributes &lt;hashtable&gt;] [-PassThru &lt;switch&gt;] [-Path &lt;string&gt;] [-SamAccountName &lt;string&gt;] [-Server &lt;string&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#unidades-organizativas","title":"Unidades Organizativas","text":"<p>Una unidad organizativa es un contenedor de objetos (usuarios, grupos, equipos, otras unidades organizativas, etc.) pertenecientes a un mismo dominio. Son especialmente \u00fatiles para reproducir la estructura de la empresa donde se halle el dominio. Es decir, si por ejemplo, una empresa est\u00e1 dividida en tres departamentos (direcci\u00f3n, ventas y producci\u00f3n), podemos crear tres unidades organizativas correspondientes a estos tres departamentos, donde incluyamos todos los objetos del dominio correspondientes a cada una de las \u00e1reas de la empresa.</p> <p>Su utilidad radica en dos aspectos fundamentales:</p> <ol> <li>De esta manera es muy sencillo establecer directivas de seguridad (las veremos en el siguiente tema) que se apliquen a todos los objetos de cada departamento.</li> <li>Como dentro de la unidad organizativa, se pueden introducir otras unidades organizativas, se puede replicar la estructura jer\u00e1rquica de la empresa sin necesidad de crear m\u00e1s dominios o subdominios.</li> </ol>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#creacion-de-unidades-organizativas","title":"Creaci\u00f3n de Unidades Organizativas","text":"<p>Para crear una unidad organizativa abriremos la ventana 'Usuarios y Equipos de Active Directory' (desde el Panel del Administrador, 'Herramientas Administrativas'). A continuaci\u00f3n, nos situamos sobre el dominio y haciendo clic con el bot\u00f3n secundario seleccionamos 'Nuevo' y 'Unidad Organizativa'</p> Unidades Organizativas <p>A continuaci\u00f3n se abrir\u00e1 el di\u00e1logo que nos permite indicar el nombre del nuevo objeto:</p> Creaci\u00f3n OU (Organizational Unit) <p>Al pulsar en Aceptar, se crear\u00e1 la Unidad Organizativa (OU) dentro de nuestro dominio. Notad tambi\u00e9n que por defecto se crea una protecci\u00f3n contra posibles errores de eliminaci\u00f3n. Por defecto la unidad no se podr\u00e1 eliminar de manera de manera accidental.</p> Creaci\u00f3n de una OU <p>Dentro de una Unidad Organizativa podemos a\u00f1adir objetos, usuarios, grupos, m\u00e1s unidades organizativas, etc... para ello seleccionamos la OU y con el bot\u00f3n derecho del rat\u00f3n accedemos a la opci\u00f3n Nuevo:</p> A\u00f1adir objetos a una OU <p>Podemos a\u00f1adir dos unidades organizativas dentro, una para Alumnos y otra para Profesores:</p> Crear elementos dentro de una OU <p>Tambi\u00e9n podemos arrastras elementos de una unidad a otra, por ejemplo, vamos a arrastras los grupos de Alumnos y Profesores y los usuarios que hemos creado. Seleccionamos el grupo Profesores y lo arrastramos a la unidad organizativa Profesores:</p> Mover objetos a OU Mover objetos entre OU"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#borrar-una-ou","title":"Borrar una OU","text":"<p>Si tratamos de borrar una OU, veremos que nos aparece un mensaje de que no tenemos los suficientes privilegios para poder realizar la acci\u00f3n de borrado. Esto es debido a la protecci\u00f3n contra eliminaciones accidentales de las que hemos comentado anteriormente:</p> Borrar OU <p>Para eliminar las unidades organizativas, en primer lugar deberemos activar las 'caracter\u00edsticas avanzadas' seleccionando en el men\u00fa 'Ver' la opci\u00f3n 'Caracter\u00edsticas Avanzadas'.</p> Borrado de una OU <p>Nos aparecer\u00e1 la ventana de la OU:</p> Desproteger una OU <p>Desmarcamos el check de protecci\u00f3n contra eliminaciones accidentales:</p> Desactivar protecci\u00f3n <p>Ahora ya s\u00ed podemos eliminar la OU. Dejamos de nuevo desactivadas las opciones avanzadas desde la opci\u00f3n men\u00fa. En la pr\u00f3xima pr\u00e1ctica, utilizaremos las unidades organizativas para gestionar de manera eficaz el dominio, aplicando directivas de seguridad espec\u00edficas a cada unidad organizativa.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#comandos_2","title":"Comandos","text":""},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#dsadd-ou","title":"dsadd ou","text":"<p>Mediante el comando <code>dsadd ou</code> en <code>cmd</code> podemos crear una unidad organizativa. ENLACE </p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#la-sintaxis-del-comando-es","title":"La sintaxis del comando es:","text":"<pre><code>dsadd ou &lt;OrganizationalUnitDN&gt; [-desc &lt;Description&gt;] [{-s &lt;Server&gt; | -d &lt;Domain&gt;}][-u &lt;UserName&gt;] [-p {&lt;Password&gt; | *}] [-q] [{-uc | -uco | -uci}]\n</code></pre>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#new-adorganizationalunit","title":"New-ADOrganizationalUnit","text":"<p>En PowerShell New-ADOrganizationalUnit.</p>"},{"location":"07_DOMINIO_AD/AyudaASO/Practica06_AD.html#la-sintaxis-del-comando-es_1","title":"La sintaxis del comando es:","text":"<pre><code>New-ADOrganizationalUnit [-Name] &lt;string&gt; [-AuthType {&lt;Negotiate&gt; | &lt;Basic&gt;}] [-City &lt;string&gt;] [-Country &lt;string&gt;] [-Credential &lt;PSCredential&gt;] [-Description &lt;string&gt;] [-DisplayName &lt;string&gt;] [-Instance &lt;ADOrganizationalUnit&gt;] [-ManagedBy &lt;ADPrincipal&gt;] [-OtherAttributes &lt;hashtable&gt;] [-PassThru &lt;switch&gt;] [-Path &lt;string&gt;] [-PostalCode &lt;string&gt;] [-ProtectedFromAccidentalDeletion &lt;System.Nullable[bool]&gt;] [-Server &lt;string&gt;] [-State &lt;string&gt;] [-StreetAddress &lt;string&gt;] [-Confirm] [-WhatIf] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"08_RECURSOS_AD/081_CarpetasPerfilesAD.html","title":"Compartir recursos en Active Directory","text":"<p>Compartir recursos se refiere a una carpeta o fichero, el cu\u00e1l suele estar alojado en un disco duro de datos, en un NAS o en la nube. Podemos compartir recursos que se alojan en cualquier lugar de nuestra red y sirven para que varios clientes o usuarios accedan a los mismos ficheros de forma centralizada.</p> <p>Entre las ventajas de compartir recursos destacan:</p> <ul> <li>No es necesario copiar el recurso localmente en los equipos, por lo tanto se consigue un ahorro de memoria determinado.</li> <li>Se pueden gestionar las pol\u00edticas de seguridad de forma centralizada.</li> </ul>"},{"location":"08_RECURSOS_AD/081_CarpetasPerfilesAD.html#carpetas-personales","title":"Carpetas Personales","text":"<p>Una de las opciones m\u00e1s utilizadas que puede configurarse en la ficha 'Perfiles' de las propiedades de la cuenta de usuario es el establecimiento de una unidad en red personal para cada usuario a la que \u00fanicamente \u00e9l tiene acceso:</p> Carpeta particular. <p>Ejemplo</p> <p>Para configurar la carpeta compartida, basta crear una carpeta a la que se tenga acceso desde la red. Esta carpeta la tenemos creada en el disco y dentro de esta carpeta est\u00e1n las carpetas de cada uno de los usuarios. Bastar\u00e1 asignar la ruta de esa carpeta a cada uno de los usuarios. </p> <p>A continuaci\u00f3n se muestra un ejemplo, donde se asigna a la unidad Z: a la carpeta personal de cada uno de los usuarios de una organizaci\u00f3n llamada \"Pistonazo\":</p> Carpetas particulares. <p>se asignan estas carpetas a cada uno de los usuarios. Para ello desde la pesta\u00f1a perfil:</p> Carpetas particulares. <p>La carpeta del usuario debe ser una carpeta compartida con permisos de escritura. En este caso se utilizan las carpetas creadas en la secci\u00f3n de Permisos NTFS. En concreto se crea una carpeta en <code>C:\\Pistonazo_Users</code>, esta carpeta tiene permisos de acceso el grupo Pistonazo y los Administradores. Por tanto, el recurso <code>\\\\192.168.100.1\\Pistonazo_users\\%username%</code> ser\u00e1 la carpeta de cada uno de los usuarios.</p> <p>Importante</p> <p>La variable <code>%username%</code> sustituye el valor por el identificador de usuario.</p>"},{"location":"08_RECURSOS_AD/081_CarpetasPerfilesAD.html#perfiles","title":"Perfiles","text":"<p>Los perfiles son una serie de ficheros de configuraci\u00f3n del entorno de trabajo, que se aplican a todos los equipos de la red desde donde pueda iniciar sesi\u00f3n el usuario. Por lo tanto , los perfiles son aquellos aspectos de configuraci\u00f3n del equipo y del entorno de trabajo propios del usuario, los cuales son exportables a otras m\u00e1quinas de manera transparente al mismo. En otras palabras, mediante los perfiles se consigue que el usuario independientemente del equipo en el que inicie la sesi\u00f3n disponga de un entorno de trabajo similar. </p> <p>Existen tres tipos de perfiles:</p> <ol> <li>Perfiles locales : se almacenan en el equipo, y configuran el entorno de trabajo de cada usuario.</li> <li>Perfiles m\u00f3viles : el usuario configura el entorno de trabajo a su gusto en un equipo, y al iniciar sesi\u00f3n en cualquier otra estaci\u00f3n de trabajo, la configuraci\u00f3n se importa y aplica a ese nuevo equipo.</li> <li>Perfiles obligatorios : un usuario con permisos de administraci\u00f3n define la configuraci\u00f3n del entorno de trabajo, la cual se aplica a los usuarios del dominio. Estos pueden modificarla durante la sesi\u00f3n, pero al iniciar otra sesi\u00f3n, se vuelve a cargar la configuraci\u00f3n del perfil obligatorio. En lugar de trabajar con perfiles obligatorios, se recomienda configurar entornos de trabajo definidos para los miembros de una unidad organizativa de una manera m\u00e1s c\u00f3moda y potente.</li> </ol>"},{"location":"08_RECURSOS_AD/081_CarpetasPerfilesAD.html#perfiles-moviles","title":"Perfiles m\u00f3viles","text":"<p>Los ficheros de configuraci\u00f3n de los perfiles deben almacenarse en una ubicaci\u00f3n accesible por los equipos clientes, como por ejemplo el controlador de dominio. Concretamente, los perfiles se almacenan  en una carpeta de perfil. Esta carpeta de perfil la se crea dentro de las carpetas particulares de los usuarios. </p> <p>Ejemplo</p> <p>Por ejemplo, a continuaci\u00f3n se muestra la configuraci\u00f3n para los usuarios del departamento Gesti\u00f3n tengan un perfil m\u00f3vil , de la organizaci\u00f3n \"Pistonazo\":</p> Perfil m\u00f3vil para usuarios de departamento Gesti\u00f3n <p>Estos usuarios cuando inicien sesi\u00f3n en alguna de las m\u00e1quinas cliente del dominio, recuperan todo su perfil de la carpeta personal del usuario. </p> <p>Para ello, vamos se modifica el siguiente campo de la pesta\u00f1a perfil:</p> Perfil m\u00f3vil usuario usudir1 <p>Y se establece la ruta de acceso al perfil. En este caso, se establece la ruta de acceso al perfil m\u00f3vil, dentro de la carpeta personal del usuario. Por tanto, se seleccionan los dos usuarios con el bot\u00f3n de la derecha del rat\u00f3n:</p> Perfil m\u00f3vil usuarios gestion <p>Y para la ruta del perfil m\u00f3vil se establece la siguiente direcci\u00f3n: <code>\\\\192.168.100.1\\Pistonazo_users$\\%username%\\perfil</code></p> <p>De esta forma cuando alg\u00fan usuario de Gesti\u00f3n inicie sesi\u00f3n, se crear\u00e1 en la carpeta personal su perfil. As\u00ed independientemente del equipo donde se conecte, siempre tendr\u00e1 la informaci\u00f3n:</p> Creaci\u00f3n de carpeta de perfil m\u00f3vil <p>Warning</p> <ul> <li>Carga en red Perfil M\u00f3vil : Hay que tener en cuenta de que cuando un usuario con perfil m\u00f3vil inicia la sesi\u00f3n, la informaci\u00f3n del servidor se copia al cliente. Cuando cierra la sesi\u00f3n se realiza la operaci\u00f3n inversa. Un alto n\u00famero de usuario con perfil m\u00f3vil puede sobrecargar la red demasiado. Por tanto, hay que saber exactamente en qu\u00e9 usuarios se deben aplicar esta caracter\u00edstica.</li> </ul>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html","title":"Permisos y directivas de grupo","text":"<p>En esta secci\u00f3n en global se tratan los siguientes puntos:</p> <ul> <li>Creaci\u00f3n de recursos compartidos.</li> <li>Configuraci\u00f3n y administraci\u00f3n de permisos de carpetas compartidas.</li> <li>Configuraci\u00f3n y administraci\u00f3n de permisos NTFS</li> <li>Gesti\u00f3n del dominio mediante directivas de grupo.</li> </ul>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#permisos","title":"Permisos","text":"<p>Los sistemas operativos de la familia Windows poseen dos niveles de permisos para los recursos compartidos:</p> <ul> <li>Permisos para carpetas compartidas: se aplican cada vez que un usuario quiere acceder a un archivo o carpeta de la red.</li> <li>Permisos para archivos y carpetas (NTFS): se aplican sobre dispositivos con formato NTFS para definir en mayor detalle las acciones permitidas.</li> </ul> <p>De lo anterior se extrae que cuando se accede en modo local a los archivos o carpetas s\u00f3lo intervienen los permisos asociados al sistema de ficheros, en este caso NTFS, sin embargo si se accede a trav\u00e9s de la red se aplican los dos niveles de permisos: en primer lugar se aplican los permisos de carpetas compartidas y posteriormente los permisos NTFS.</p> Permisos NTFS y compartidos."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#permisos-de-recursos-compartidos","title":"Permisos de recursos compartidos","text":"<p>Para acceder a la gesti\u00f3n de recursos compartidos, lo podemos hacer a trav\u00e9s de la opci\u00f3n servicios de archivo y almacenamiento, desde el Panel del Administrador del Servidor.</p> Recursos compartidos I. <p>Despu\u00e9s accedemos a la opci\u00f3n recursos compartidos:</p> Recursos compartidos II. <p>En la parte central de la consola de administraci\u00f3n del almacenamiento aparecen los recursos compartidos en el servidor. Para visualizar los permisos de cada recurso compartido, basta con hacer clic con el bot\u00f3n secundario del rat\u00f3n sobre el recurso cuyos permisos se quieren consultar y se selecciona \u2018Propiedades\u2019:</p> Propiedades Recursos Compartidos. <p>Veremos como aparece un cuadro de dialogo donde podemos ver en la parte de la izquierda la opci\u00f3n permisos. Y bajo Personalizar Permisos:</p> Permisos recursos compartidos. <p>Nos aparece despu\u00e9s el cuadro de permisos completo del recurso seleccionado:</p> Recursos compartidos V. <p>Si accedemos a la pesta\u00f1a compartir, podremos ver los permisos del recurso compartido. En este caso, el recurso compartido netlogon tiene los permisos:</p> Recursos compartidos VI. <p>Estos pueden ser de tres tipos:</p> <p>Control total : no solo permite cambiar y leer, sino modificar los permisos sobre el recurso compartido. Cambiar : se permite crear carpetas y archivos adem\u00e1s de modificar y borrar los archivos y directorios existentes. Lectura : \u00fanicamente permite la lectura de archivos y la ejecuci\u00f3n de archivos ejecutables que se hallen dentro del recurso compartido.</p> Permisos de NETLOGON. <p>Como se puede comprobar en la siguiente figura, existen dos tipos de directivas : \u2018Permitir\u2019 y \u2018Denegar\u2019. </p> <p>Warning</p> <p>Es importante destacar que la opci\u00f3n \u2018Denegar\u2019 tiene prioridad sobre otros permisos asignados sobre el recurso compartido.</p> Tipos de directivas."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#establecer-permisos-en-recursos-compartidos","title":"Establecer permisos en recursos compartidos","text":"<p>Establecer permisos de recursos compartidos se puede hacer de varias maneras. Probablemente la m\u00e1s sencilla sea seleccionar el recurso sobre el cual se desean configurar los permisos, y haciendo clic con el bot\u00f3n secundario \u2018Compartir con...\u2019 y usuarios espec\u00edficos.. Por ejemplo, vamos a crear una carpeta en C: llamada Empresa_users y la vamos a compartir:</p> Compartir recursos. <p>Y agregamos el grupo Empresa con lectura y escritura:</p> Agregar permisos. Agregar Permisos recurso compartido I. Agregar Permisos recurso compartido II. <p>Y por \u00faltimo Compartir.</p> <p>En lugar de hacer uso de este asistente, vamos a compartir mediante el uso compartido avanzado, que nos da m\u00e1s opciones para asignar los permisos. Para ello, seleccionaremos la carpeta y con el bot\u00f3n de la derecha del rat\u00f3n propiedades y pesta\u00f1a compartir:</p> Uso compartido avanzado I. Uso compartido avanzado II. <p>En la medida de lo posible, habr\u00e1 que asignar permisos a grupos y eliminar grupos que no tengan ninguna relaci\u00f3n con la carpeta que queremos compartir. Evitar el uso de grupo Todos para eso habr\u00e1 que crear los grupos correspondientes.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#permisos-ntfs","title":"Permisos NTFS","text":"<p>Como se ha comentado anteriormente, los permisos NTFS complementan y ampl\u00edan los permisos de recursos compartidos, siendo efectivo el m\u00e1s restrictivo.</p> <p>Todos los archivos y carpetas de un volumen NTFS tienen asociada una ACL o lista de control de acceso que fija el nivel de acceso de un usuario o grupo que pretenda acceder al recurso. Adem\u00e1s, los permisos NTFS pueden ser aplicados a nivel de archivo, a diferencia de los permisos de recursos compartidos, los cuales \u00fanicamente pueden aplicarse a nivel de carpeta.</p> <p>Por otra parte, surge un nuevo concepto al aplicar los permisos NTFS que los hace m\u00e1s complejos aunque tambi\u00e9n m\u00e1s potentes: la herencia, la cual determinar\u00e1 los permisos que se reciben sobre un determinado recurso provenientes de un nivel superior, aunque esto lo veremos detalladamente m\u00e1s adelante.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#tipos-de-permisos-ntfs","title":"Tipos de permisos NTFS","text":"<p>Tal y como se muestra en la figura (para abrir ese cuadro de di\u00e1logo hacer clic con el bot\u00f3n secundario sobre el recurso compartido y hacer clic en la pesta\u00f1a 'Seguridad'), los permisos (predeterminados) que pueden aplicarse sobre archivos y carpetas son:</p> <ul> <li>Control total.</li> <li>Cambiar.</li> <li>Leer y ejecutar.</li> <li>Mostrar el contenido de la carpeta.</li> <li>Leer.</li> <li>Escribir.</li> </ul> Permisos est\u00e1ndar. <p>No obstante, estos permisos en realidad representan varios aspectos mucho m\u00e1s concretos. Para tratar de clarificar esta cuesti\u00f3n, la tabla 1 resume qu\u00e9 tareas pueden realizarse con cada tipo de permiso.</p> Permisos para carpetas y archivos. <p>Para poder acceder a estos permisos especiales, lo haremos a trav\u00e9s de las propiedades, pesta\u00f1a de Seguridad y opciones avanzadas:</p> Acceso a permisos especiales I. Acceso a permisos especiales II. Acceso a permisos especiales III. Acceso a permisos especiales. <p>Warning</p> <p>Es importante entender que los permisos predeterminados est\u00e1ndar, en realidad corresponden a unas combinaciones de permisos espec\u00edficos, siendo estos \u00faltimos con los que trabajaremos m\u00e1s adelante cuando gestionemos las listas de control de acceso por l\u00ednea de comandos.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#asignacion-de-permisos-ntfs","title":"Asignaci\u00f3n de permisos NTFS","text":"<p>Al definir un permiso NTFS este puede ser un permiso o una denegaci\u00f3n:</p> Permisos NTFS I. <p>Warning</p> <ul> <li>Los permisos NTFS son acumulativos: se eval\u00faan los permisos otorgados al usuario y a los grupos a los que pertenece el usuario. En el caso de que haya una incompatibilidad entre los permisos asignados a un usuario y los asignados a un grupo del cual sea miembro, prevalecer\u00e1 la opci\u00f3n m\u00e1s restrictiva: Denegar (si est\u00e1 definido expl\u00edcitamente).</li> </ul> <p>Para asignar permisos NTFS a un recurso compartido bastar\u00e1 con hacer clic con el bot\u00f3n secundario sobre el recurso y acceder a la pesta\u00f1a 'Seguridad'. A continuaci\u00f3n pulsaremos el bot\u00f3n 'Opciones Avanzadas', como se muestra a continuaci\u00f3n:</p> Permisos NTFS II. Permisos NTFS III. Permisos NTFS IV. Permisos NTFS V. Permisos NTFS VI. <p>Warning</p> <p>Cuidado con el grupo Usuarios (del dominio) porque aparece por defecto en los permisos NTFS (con permisos de lectura), y puede provocar que se produzcan accesos diferentes a nuestra planificaci\u00f3n. Como norma general, si queremos limitar el acceso a un recurso compartido, eliminaremos el grupo Usuarios de los permisos NTFS y explicitaremos \u00fanicamente aquellos grupos o usuarios que efectivamente queramos que tengan acceso al recurso.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#permisos-implicitos-y-permisos-explicitos","title":"Permisos Impl\u00edcitos y permisos Expl\u00edcitos","text":"<p>Los permisos otorgados de manera impl\u00edcita o expl\u00edcita son una cuesti\u00f3n sencilla, en la que si no nos fijamos con atenci\u00f3n, podemos hacer que los accesos a los recursos no funcionen como ten\u00edamos previsto. Para evitar problemas tendremos en cuenta que:</p> <ol> <li>Un permiso definido de manera expl\u00edcita siempre prevalecer\u00e1 sobre un permiso definido de manera impl\u00edcita.</li> <li>Denegar un permiso siempre prevalece sobre otorgar ese permiso, siempre y cuando ambos est\u00e9n definidos de la misma manera (impl\u00edcita o expl\u00edcitamente).</li> </ol> <p>\u00bfC\u00f3mo se define un permiso de manera expl\u00edcita? Si nos fijamos en la siguiente figura, el grupo Compras no tiene (aparentemente) definidos permisos de escritura. Sin embargo esa aparente indefinici\u00f3n, en realidad indica que el permiso de escritura est\u00e1 denegado impl\u00edcitamente. Si un usuario del grupo Ventas intenta escribir en la carpeta, se producir\u00e1 un mensaje de error como muestra la siguiente figura:</p> Permisos expl\u00edcitos. Error al crear archivo en recurso compartido. <p>Sin embargo, si le otorgamos el permiso expl\u00edcito de escritura, veremos que efectivamente puede escribir en el recurso, ya que la definici\u00f3n expl\u00edcita del permiso para escribir prevalece sobre la denegaci\u00f3n impl\u00edcita del permiso escribir:</p> Permisos de escritura. Permisos de escritura. <p>Si explicitamos la denegaci\u00f3n del permiso de escritura para los miembros del grupo Compras, podremos comprobar que efectivamente el usuario usucomp1 no puede escribir en la carpeta:</p> Denegaci\u00f3n explicita. Denegaci\u00f3n explicita."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#herencia-de-permisos","title":"Herencia de permisos","text":"<p>Note</p> <p>Al crear un archivo o carpeta en un volumen NTFS ese objeto hereda autom\u00e1ticamente los permisos de su carpeta contenedora, y a la inversa: cuando asignamos permisos a una carpeta contenedora, los permisos se propagan autom\u00e1ticamente hacia los archivos y subcarpetas contenidas en el recurso.</p> <p>Sin embargo, pueden darse ocasiones en las que queramos eliminar esa herencia de permisos. Esto puede ejecutarse de tres maneras diferentes:</p> <ul> <li>Eliminar la herencia a nivel de la carpeta de nivel superior, los objetos contenidos en ella dejan de heredar los permisos.</li> <li>Eliminar la herencia a nivel de subcarpeta o archivo contenido dentro del recurso principal.</li> <li>Permitir o denegar expl\u00edcitamente un permiso de manera diferente a como est\u00e1 definido en el recurso contenedor.</li> </ul> <p>Note</p> <p>\u00bfQu\u00e9 utilidad pr\u00e1ctica piensas que puede tener la herencia de permisos? Fundamentalmente son dos las utilidades principales. La primera radica en que el administrador no tiene que asignar manualmente los permisos a los archivos y subcarpetas que haya contenidas dentro del recurso principal, y que f\u00e1cilmente pueden ser miles. Relacionado con este aspecto, tambi\u00e9n encontramos una segunda utilidad pr\u00e1ctica que es el aumento de la seguridad al descartar posibles errores de asignaci\u00f3n de permisos realizados manualmente.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#eliminacion-de-herencia-del-recurso-de-nivel-superior","title":"Eliminaci\u00f3n de herencia del recurso de nivel superior","text":"<p>Para eliminar la herencia de los permisos establecidos en la carpeta de nivel superior, se debe acceder a la ficha 'Seguridad' del cuadro de di\u00e1logo 'Permisos' y a continuaci\u00f3n se hace clic en 'Opciones Avanzadas' :</p> Denegaci\u00f3n explicita I. <p>En este caso vemos que la carpeta c:\\pistonazo_users hereda los permisos de la unidad *c:*. </p> <p>Para eliminar la herencia, debemos hacer clic en Deshabilitar herencia y nos aparecer\u00e1 un di\u00e1logo para dejar los permisos expl\u00edcitos o bien para eliminar todos los permisos:</p> Denegaci\u00f3n explicita II. <p>Tenemos dos opciones:</p> <ul> <li>Convertir los permisos heredados en permisos expl\u00edcitos: mantiene los permisos de todos los archivos y subcarpetas, pero no est\u00e1n vinculados a los del nivel superior.</li> <li>Quitar todos los permisos: elimina todos los permisos heredados.</li> </ul> <p>Tip</p> <p>Como norma general marcaremos la primera opci\u00f3n, convertir los permisos en permisos expl\u00edcitos:</p> Denegaci\u00f3n explicita III."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#cambio-de-los-permisos-de-un-objeto-hijo","title":"Cambio de los permisos de un objeto hijo","text":"<p>Si observamos los permisos de un objeto que est\u00e1 heredando permisos, veremos que las casillas de verificaci\u00f3n est\u00e1n (completa o parcialmente) inaccesibles. En este caso la carpeta Compras que hereda los permisos de la carpeta Administraci\u00f3n, hereda tambi\u00e9n los permisos del grupo administraci\u00f3n:</p> Herencia de permisos. <p>En primer lugar podemos interrumpir la herencia, denegando expl\u00edcitamente los permisos. Si el permiso heredado es de concesi\u00f3n, la denegaci\u00f3n est\u00e1 habilitada.</p> Interrupci\u00f3n de herencia."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#directivas-de-grupo-gpo","title":"Directivas de Grupo (GPO)","text":"<p>Las directivas de grupo (Group Policy) son una serie de configuraciones creadas por el administrador que se aplican a objetos del dominio. Por medio de estas directivas, el administrador controla los entornos de trabajo de los usuarios del dominio, los equipos y el comportamiento de distintos objetos. Son en definitiva un conjunto de reglas que facilitan las labores de administraci\u00f3n de los usuarios y equipos.</p> <p>Algunos de los aspectos m\u00e1s \u00fatiles que se pueden definir por parte del administrador mediante las directivas son:</p> <ul> <li>Los comandos de inicio de sesi\u00f3n.</li> <li>Caracter\u00edsticas de las directivas de seguridad de las cuentas de usuario.</li> <li>Configuraci\u00f3n de la apariencia de la sesi\u00f3n de usuario.</li> <li>Redirecci\u00f3n del acceso a ciertas carpetas o archivos centralizados Distribuci\u00f3n de software a los equipos clientes.</li> <li>Permisos otorgados a las cuentas de usuarios y grupos, etc.</li> </ul>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#acumulacion-de-directivas-de-grupo","title":"Acumulaci\u00f3n de directivas de grupo","text":"<p>Al existir diferentes niveles de directivas de grupo, estas pueden entrar en conflicto, haciendo que aparezcan efectos no deseados en la gesti\u00f3n del dominio. Al establecer directivas de grupo hay que tener en cuenta el orden de aplicaci\u00f3n de las mismas:</p> <ul> <li>Directiva de grupo local.</li> <li>Directiva de grupo de sitio.</li> <li>Directiva de grupo de dominio.</li> <li>Directiva de grupo de unidad organizativa.</li> </ul> <p>De manera predeterminada cuando existe una contradicci\u00f3n entre las directivas, la que prevalece ser\u00e1 la que est\u00e1 en un nivel inferior de la lista anterior. Obviamente, en caso de no existir contradicciones, se aplican todas las directivas.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#directivas-de-usuario-o-equipo","title":"Directivas de usuario o equipo","text":"<p>Si queremos saber las directivas que est\u00e1n aplicandose a un usuario o equipo, ejecutaremos rsop.msc:</p> rsop.msc."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#edicion-de-las-directivas-de-grupo-predeterminadas","title":"Edici\u00f3n de las directivas de grupo predeterminadas","text":"<p>Para acceder a las directivas de grupo predeterminadas, accedemos desde el Panel del Servidor --&gt; Herramientas --&gt; Administraci\u00f3n de directivas de grupo:</p> Administraci\u00f3n directivas de grupo. <p>Cuando se pone en marcha un dominio se crean dos directivas de grupo llamadas:</p> <ul> <li>Default Domain Controllers.</li> <li>Default Domain Policy.</li> </ul> GPOs predefinidos. <p>Estas dos directivas establecen la configuraci\u00f3n b\u00e1sica de los objetos del dominio, y est\u00e1n vinculadas respectivamente a:</p> <ul> <li>La unidad organizativa Domain Controllers.</li> <li>El dominio.</li> </ul> <p>Estos dos GPO se componen de un conjunto muy amplio de directivas, como se puede ver al abrir el editor de directivas:</p> GPOs predeterminadas Default Domain Policy. <p>Supongamos que queremos cambiar la configuraci\u00f3n de la directiva que aplica sobre el permiso para apagar el equipo. En ese caso la buscar\u00edamos entre todo el conjunto de directivas dentro del GPO Default Domain Policy y har\u00edamos doble clic sobre ella :</p> GPO Apagar el sistema. <p>Vemos que la directiva Apagar el Sistema no est\u00e1 habilitada. Si la habilitamos y \u00fanicamente otorgamos permiso a los administradores del dominio, podremos comprobar que efectivamente un usuario del dominio que inicia sesi\u00f3n en un equipo cliente no puede apagarlo, solamente podr\u00eda un usuario con privilegios de administraci\u00f3n.</p> <p>Para evitar generar un tr\u00e1fico de gesti\u00f3n excesivo en la red, las directivas de grupo no se actualizan inmediatamente tras su modificaci\u00f3n, sino que est\u00e1 establecido un intervalo de 5 minutos entre actualizaciones autom\u00e1ticas. No obstante, este intervalo se puede modificar en las propias directivas de grupo. De todas maneras, no es necesario modificar este intervalo para comprobar la correcta aplicaci\u00f3n de las directivas de grupo, basta con escribir en la consola cmd el comando gpupdate :</p> gpupdate. <p>Y ahora iniciamos una sesi\u00f3n con un usuario en la m\u00e1quina cliente y comprobamos que efectivamente no se puede apagar la m\u00e1quina:</p> Denegar apagado del sistema. <p>Tas tareas m\u00e1s comunes que se realizan con las GPOs son aquellas relativas a las directivas de contrase\u00f1as, de inicios de sesi\u00f3n y bloqueos entre otros. Para ejemplificar todo lo anterior vamos a modificar la Default Domain Policy para implementar las siguientes configuraciones en el dominio:</p> <ol> <li>Si el usuario se equivoca tres veces al introducir su contrase\u00f1a, su cuenta queda bloqueada (solo la podr\u00e1 desbloquear el administrador). Esto protege el sistema de posibles ataques.</li> <li>La contrase\u00f1a deber\u00e1 tener un m\u00ednimo de 5 caracteres, pero no es necesario obligatoriamente que sean may\u00fasculas, min\u00fasculas, caracteres alfanum\u00e9ricos, obligatoriamente, etc.</li> <li>La contrase\u00f1a que se haya utilizado ya, no podr\u00e1 volverse a utilizar hasta pasados al menos 10 cambios de contrase\u00f1a (de esta manera forzamos al usuario a que que no 'recicle' contrase\u00f1as antiguas, incrementando la seguridad del sistema).</li> <li>El usuario debe cambiar la contrase\u00f1a cada seis meses, al establecer una 'vida \u00fatil' de las contrase\u00f1as tenemos un sistema m\u00e1s seguro, ya que en caso de que alguien haya averiguado la contrase\u00f1a del usuario, y no se haya detectado, como tarde a los seis meses, perder\u00e1 el acceso a la cuenta.</li> </ol> <p>En las siguientes subsecciones se examina la manera de proceder para llevar a cabo estas configuraciones del sistema.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#bloqueo-de-cuenta-al-introducir-una-contrasena-3-veces-una-contrasena-erronea","title":"Bloqueo de cuenta al introducir una contrase\u00f1a 3 veces una contrase\u00f1a err\u00f3nea","text":"<p>En primer lugar editaremos el GPO 'Default Domain Policy' para configurar la directiva de bloqueo de cuenta. Esta se halla en:</p> <p>'Configuraci\u00f3n del equipo'\u2192'Directivas'\u2192'Configuraci\u00f3n de Windows'\u2192'Directiva de bloqueo de cuenta'\u2192'Umbral de bloqueo de cuenta'</p> Acceso a GPOs Default Domain Policy. Acceso directiva bloqueo de cuenta. <p>Modificamos la directiva Umbral de bloqueo de cuenta a '3 intentos' de inicio de sesi\u00f3n err\u00f3neos:</p> Umbral de bloqueo de cuenta. <p>Adem\u00e1s configuraremos la duraci\u00f3n del bloqueo, donde un valor de 0 indica que la cuenta deber\u00e1 ser desbloqueada manualmente por el administrador:</p> Duraci\u00f3n de bloqueo de cuenta. <p>Finalmente tambi\u00e9n configuraremos el tiempo que debe transcurrir entre intentos para que el contador de fallos de inicio de sesi\u00f3n vuelva a cero antes de que se bloquee la cuenta. Pondremos el m\u00e1ximo valor permitido:</p> Restablecer el bloqueo."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#longitud-de-la-contrasena","title":"Longitud de la contrase\u00f1a","text":"<p>Como en el caso anterior editaremos el GPO 'Default Domain Policy' para configurar la longitud y complejidad de las contrase\u00f1as:</p> Directivas de contrase\u00f1as. <p>Modificamos el valor de la longitud a 5 caracteres:</p> Longitud de la contrase\u00f1a. <p>A continuaci\u00f3n deshabilitamos los requisitos de complejidad de las contrase\u00f1as. En la siguiente figura aparecen las caracter\u00edsticas de complejidad que aplica esta directiva cuando est\u00e1 habilitada:</p> Deshabilitar complejidad de contrase\u00f1as."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#historial-de-contrasenas","title":"Historial de contrase\u00f1as","text":"<p>Editamos de nuevo el GPO 'Default Domain Policy' y accedemos a las directivas de contrase\u00f1as:</p> Historial de contrase\u00f1as."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#vigencia-maxima-de-la-contrasena","title":"Vigencia m\u00e1xima de la contrase\u00f1a","text":"<p>Como en casos anteriores accedemos a las directivas de contrase\u00f1a:</p> Vigencia m\u00e1xima de la contrase\u00f1a. <p>Cambiamos la duraci\u00f3n m\u00e1xima de las contrase\u00f1as a 180 d\u00edas -6 meses </p> <ul> <li>El resultado de cada una de las directivas de la secci\u00f3n Directivas de contrase\u00f1as ser\u00eda:</li> </ul> Directivas de contrase\u00f1as."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#creacion-de-directivas-de-grupo","title":"Creaci\u00f3n de directivas de grupo","text":"<p>Vamos a modificar ciertas directivas de la organizaci\u00f3n Pistonazo, para ello accederemos: 'Panel del administrador'\u2192'Herramientas administrativas'\u2192'Administraci\u00f3n de directivas de grupo'</p> <p>Supongamos que queremos crear una Directiva de Grupo sobre la unidad organizativa 'Pistonazo' que creamos en el tema anterior. Hacemos clic con el bot\u00f3n secundario y escogemos la opci\u00f3n 'Crear un GPO en este dominio y vincularlo aqu\u00ed'</p> Directivas de grupo. <p>Aparecer\u00e1 el cuadro de di\u00e1logo e introduciremos el nombre que le queremos dar, por ejemplo 'Entorno de trabajo', ya que posteriormente utilizaremos esta directiva para configurar un entorno de trabajo homog\u00e9neo en todos los usuarios que pertenecen a la Unidad Organizativa 'Pistonazo'.</p> Nueva GPO I. <p>La nueva directiva aparecer\u00e1 en el panel de detalles:</p> Nueva GPO II. <p>Seleccionamos el GPO y hacemos clic con el bot\u00f3n derecho, escogiendo la opci\u00f3n 'Editar'. Con la nueva directiva vamos a establecer las siguientes configuraciones:</p> <ol> <li>Todos los miembros de la unidad organizativa 'Pistonazo' tendr\u00e1n un fondo de escritorio 'corporativo' que se instalar\u00e1 de manera autom\u00e1tica y que no podr\u00e1 ser modificado.</li> <li>Los miembros de la unidad organizativa 'Trabajadores' no pueden abrir la consola de comandos.</li> </ol> <p>En las siguientes subsecciones se examina la manera de proceder para llevar a cabo estas configuraciones del sistema.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#fondo-de-escritorio-obligatorio","title":"Fondo de escritorio obligatorio","text":"<p>Para modificar de una manera centralizada el fondo de escritorio de los usuarios de la unidad organizativa 'Pistonazo' debemos editar la directiva 'Entorno de Trabajo' y acceder a 'Configuraci\u00f3n del usuario'\u2192'Plantillas administrativas'\u2192'Active Desktop'\u2192'Active Desktop'</p> GPO Pistonazo. Personalizar Active Desktop. Habilitamos el Active Desktop. Active Desktop. <p>Vamos a impedir tambi\u00e9n que los usuarios puedan modificar el fondo de escritorio:</p> No permitir cambios. <p>Indicamos la ruta en la que se halla la imagen que queremos poner como fondo de escritorio. En este caso se llama fondopisto.jpg y hay que a\u00f1adirla a una carpeta compartida que se encuentre en el servidor. En nuestro caso, la a\u00f1adiremos a la carpeta Pistonazo:</p> Tapiz de escritorio. <p>La imagen debe hallarse en una carpeta compartida en red (preferiblemente en el servidor por cuestiones de disponibilidad) donde todos los usuarios del dominio tengan permiso de lectura. Adem\u00e1s, se recomienda que la ruta se introduzca en formato UNC del tipo:</p> <pre><code>\\\\server 1\\gestion\\fondocorp.jpg no en formato \\\\192.168.0.100\\gestion\\fondocorp.jpg\n</code></pre>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#bloqueo-de-la-linea-de-comandos","title":"Bloqueo de la l\u00ednea de comandos","text":"<p>Para bloquear la l\u00ednea de comandos editaremos el GPO correspondiente accediendo a 'Configuraci\u00f3n del usuario'\u2192'Plantillas administrativas'\u2192'Sistema'</p> Bloqueo consola. <p>Y habilitamos el bloqueo:</p> Habilitar el bloqueo."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#comprobacion-de-las-directivas-establecidas","title":"Comprobaci\u00f3n de las directivas establecidas","text":"<p>Ahora comprobaremos que las directivas se han aplicado correctamente. Para ello utilizaremos un usuario cualquiera dentro de la unidad organizativa 'Pistonazo' que es sobre la que se aplican el GPO creado 'Entorno de Trabajo', y obviamente el GPO Default Domain Policy, que hemos editado.</p>"},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#bloqueo-de-cuenta","title":"Bloqueo de cuenta","text":"<p>La primera directiva que hemos aplicado consist\u00eda en bloquear la cuenta indefinidamente al introducir en tres ocasiones la contrase\u00f1a incorrectamente. Nos equivocamos voluntariamente al iniciar sesi\u00f3n en un equipo cliente y la cuenta se acaba bloqueando. Por ejemplo, vamos a iniciar sesi\u00f3n con usuario usucomp1 e introduciremos 3 veces de manera incorrecta la contrase\u00f1a:</p> Cuenta usucomp1 bloqueada. <p>Comprobamos en el controlador de dominio que efectivamente est\u00e1 bloqueada y la desbloqueamos:</p> Cuenta bloqueada."},{"location":"08_RECURSOS_AD/082_PermisosGPOs.html#longitud-de-la-contrasena_1","title":"Longitud de la contrase\u00f1a","text":"<p>Para comprobar la longitud de la contrase\u00f1a, vamos a cambiar la contrase\u00f1a del usuario usucomp1 y vamos a poner una contrase\u00f1a que tenga 5 caracteres, por ejemplo 12345.</p> Restablecer contrase\u00f1a. <p>As\u00ed tambi\u00e9n hemos visto que podemos introducir una contrase\u00f1a sin requisitos de complejidad.</p> <p>Note</p> <p>Ya se podr\u00eda comprobar estas restricciones.</p>"},{"location":"08_RECURSOS_AD/083_EstructuraAD.html","title":"Estructura de empresa en Active Directory","text":"<p>En esta secci\u00f3n se detalla el enunciado de la pr\u00e1ctica a a realizar en esta unidad.</p>"},{"location":"08_RECURSOS_AD/083_EstructuraAD.html#pt81-estructura-de-empresa-en-ad-con-recursos-compartidos","title":"PT81. Estructura de empresa en AD con recursos compartidos","text":"<p>Partiendo de la Situaci\u00f3n de aprendizaje la empresa SOR Systems solicita un servicio de directorio en Active directory que gestione los recursos compartidos de sus empleados y dispositivos. La empresa esta compuesta por cuatro departamentos Finanzas, Personal, Producci\u00f3n, y ventas, y con 2 empleados por departamento.</p> <p>A partir de estos datos se deben realizar los siguientes apartados de configuraci\u00f3n de la estructura de la empresa SOR Systems</p>"},{"location":"08_RECURSOS_AD/083_EstructuraAD.html#pt81_1-creacion-de-usuarios-y-grupos","title":"PT81_1 Creaci\u00f3n de usuarios y grupos","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE1, CE3, y CE7 del RA2 de SOR.</p> <p>Tarea</p> <p>Debes realizar un informe con una captura de la realizaci\u00f3n del siguiente punto:</p> <ol> <li>Crea los usuarios y grupos ficticios para la organizaci\u00f3n de SOR Systems, siguiendo la unidad anterior, en concreto la secci\u00f3n 7.2. Administraci\u00f3n de Usuarios y Grupos. </li> </ol> <p>Nota</p> <p>Utiliza datos inventados para la informaci\u00f3n personal. Puedes usar esta web para obtener datos personales ficticios: GeneraData.</p>"},{"location":"08_RECURSOS_AD/083_EstructuraAD.html#pt81_2-gestion-de-recursos-en-ad","title":"PT81_2 Gesti\u00f3n de recursos en AD","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los criterios de evaluaci\u00f3n CE2, CE3, CE5 y CE6 del RA4de SOR.</p> <p>Tarea</p> <p>Debes realizar un informe con una captura de la realizaci\u00f3n de los siguientes puntos:</p> <ol> <li>Crear la estructura de carpetas en disco y definir los siguientes permisos:</li> </ol> <p>A la carpeta principal Empresa, s\u00f3lo podr\u00e1n acceder los miembros del grupo Empresa. En esta carpeta solo tendr\u00e1n acceso de lectura. Cada departamento podr\u00e1 entrar en su carpeta con permisos de control total y no podr\u00e1 acceder al resto de departamentos de la empresa.</p> Estructura de carpetas Empresa <ol> <li>Crear tambi\u00e9n la estructura para almacenar las carpetas particulares de los usuarios. Por ejemplo en <code>C:\\Empresa_users</code></li> </ol> Carpeta de usuarios <ol> <li>Cuando un usuario inicie sesi\u00f3n, conectar\u00e1 de manera autom\u00e1tica la carpeta personal en la unidad X: y la carpeta de empresas en la unidad Y:</li> </ol> Inicio sesi\u00f3n usuario Empresa <p>Adem\u00e1s se debe modificar las directivas necesarias para conseguir:</p> <ol> <li>Los usuarios deben cambiar la contrase\u00f1a cada 90 d\u00edas y guardar el historial de 5 contrase\u00f1as. Para facilitar la gesti\u00f3n no ser\u00e1 necesaria tener una restricci\u00f3n en cu\u00e1nto a la complejidad de la contrase\u00f1a y el n\u00famero m\u00ednimo de caracteres ser\u00e1 de 4.</li> <li>Para evitar posibles robos de contrase\u00f1a y ataques mal intencionados, cuando un usuario intenta 4 veces introducir de manera incorrecta su contrase\u00f1a, la cuenta se bloquear\u00e1 hasta que se reestablezca el contador de inicios de sesi\u00f3n err\u00f3neos a los 10minutos.</li> </ol> <p>Haced una captura de pantalla de las directivas de contrase\u00f1a y de inicios de sesi\u00f3n.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html","title":"Caso Pr\u00e1ctico: Creaci\u00f3n de una estructura en AD","text":"<p>La administraci\u00f3n del dominio es una tarea sencilla mediante la interfaz gr\u00e1fica, pero puede ser muy tediosa si hay que repetir en innumerables ocasiones secuencias de acciones.</p> <ul> <li> <p>Pensemos por ejemplo en el caso t\u00edpico en el que hay que dar de alta a una cantidad muy grande de usuarios, creando la estructura completa de la organizaci\u00f3n. Este tipo de procesos puede facilitarse enormemente mediante la utilizaci\u00f3n de scripts.</p> </li> <li> <p>Concretamente, en este ejemplo se plantea la creaci\u00f3n de las cuentas de usuario de una organizaci\u00f3n, as\u00ed como sus grupos y unidades organizativas.</p> </li> </ul> <p>Vamos a suponer que tenemos que crear la siguiente estructura de AD:</p> Estructura AD. <p>Es decir que tendremos 3 secciones y cada secci\u00f3n tiene un conjunto de departamentos.</p> <p>De manera que tengamos Administraci\u00f3n, Almac\u00e9n y Direcci\u00f3n. Y cada secci\u00f3n tenga los departamentos que se indican.</p> <p>Para ello vamos a disponer de los ficheros: secciones.csv, departamentos.csv y personal.csv. Subidos en aules.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#creacion-de-ou-y-grupos","title":"Creaci\u00f3n de OU y Grupos","text":"<p>Lo primero que vamos a crear es la Unidad Organizativa ra\u00edz. Para ello se utiliza: <code>New-ADOrganizationalUnit</code> y <code>New-ADGroup</code></p> <pre><code>Write-Output \"Creando Estructura de OU y Grupos...\"\nNew-ADOrganizationalUnit -Name \"Pistonazo\" -Path \"DC=CEFIRE2019, DC=LOCAL\" -Description \"Unidad organizativa Pistonazo\" -ProtectedFromAccidentalDeletion $false \nNew-ADGroup -Name \"Pistonazo\" -GroupScope Global -Path \"OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\n</code></pre> <p>Despu\u00e9s crearemos cada una de las unidades organizativas y grupos a partir de los ficheros secciones.csv. Para ello se har\u00e1 uso del comando <code>foreach</code>:</p> <pre><code>$secciones = Import-CSV -Path \"./secciones.csv\"\n$group = Get-ADGroup \"CN=Pistonazo,OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\nforeach ($ou in $secciones) {\n    New-ADOrganizationalUnit -Name ($ou.seccion) -Path \"OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    $path=\"OU=\"+($ou.seccion)+\",OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    New-ADGroup -Name $ou.seccion -GroupScope Global -Path $path\n    $member = \"CN=\"+($ou.seccion)+\",\"+$path \n    Add-ADGroupMember $group -Members $member       \n    Write-Output \"Unidad $($ou.seccion) creada!\"\n}\n</code></pre> <p>Con esto ya tendremos la estructura de Unidades Organizativas y grupos creados.</p> OU y grupos creados."},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#creacion-de-usuarios","title":"Creaci\u00f3n de Usuarios","text":"<p>Ahora queda crear los usuarios de nuestra organizaci\u00f3n. Para ello leeremos del archivo personal.csv. Este archivo tiene 3 columnas, una para el login, otra para el departamento y otra para la secci\u00f3n. Crearemos una contrase\u00f1a para todos y haremos que el usuario cuando inicie la sesi\u00f3n se la tenga que cambiar.</p> <pre><code>$usuarios = Import-CSV -Path \"./personal.csv\"\nWrite-Output \"Creando usuarios....\"\nforeach ($user in $usuarios) {\n    $login = $user.login\n    $path=\"OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\n    New-ADUser -Name $login  -Path $path -SamAccountName $login -UserPrincipalName ($login+\"@CEFIRE2019.LOCAL\") -AccountPassword (ConvertTo-SecureString \"cefire2019.\" -AsPlainText -Force) -GivenName $login -ChangePasswordAtLogon $true-Enabled $true\n    $group = Get-ADGroup (\"CN=\"+$user.departamento+\",OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\")\n    $member = \"CN=\"+$login+\",\"+$path\n    Add-ADGroupMember $group -Members $member       \n    Write-Output \"Usuario $($user.login) creado!\"\n}\n</code></pre> <p>As\u00ed ya tenemos la estructura de AD creada con los usuarios:</p> Usuarios creados."},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#script-de-creacion-de-estructura","title":"Script de creaci\u00f3n de estructura","text":"<p><pre><code>Write-Output \"Creando Estructura de OU y Grupos...\"\nNew-ADOrganizationalUnit -Name \"Pistonazo\" -Path \"DC=CEFIRE2019, DC=LOCAL\" -Description \"Unidad organizativa Pistonazo\" -ProtectedFromAccidentalDeletion $false \nNew-ADGroup -Name \"Pistonazo\" -GroupScope Global -Path \"OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\n$secciones = Import-CSV -Path \"./secciones.csv\"\n$group = Get-ADGroup \"CN=Pistonazo,OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\nforeach ($ou in $secciones) {\n    New-ADOrganizationalUnit -Name ($ou.seccion) -Path \"OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    $path=\"OU=\"+($ou.seccion)+\",OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    New-ADGroup -Name $ou.seccion -GroupScope Global -Path $path\n    $member = \"CN=\"+($ou.seccion)+\",\"+$path \n    Add-ADGroupMember $group -Members $member       \n    Write-Output \"Unidad $($ou.seccion) creada!\"\n}\n\n$departamentos = Import-CSV -Path \"./departamentos.csv\"\nforeach ($ou in $departamentos) {\n    $path=\"OU=\"+($ou.seccion)+\", OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    New-ADOrganizationalUnit -Name ($ou.departamento) -Path $path\n    $path=\"OU=\"+($ou.departamento)+\",OU=\"+$ou.seccion+\",OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\n    New-ADGroup -Name $ou.departamento -GroupScope Global -Path $path\n    $group = Get-ADGroup (\"CN=\"+$ou.seccion+\",OU=\"+$ou.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\")\n    $member = \"CN=\"+($ou.departamento)+\",\"+$path\n    Add-ADGroupMember $group -Members $member       \n    Write-Output \"Unidad $($ou.departamento) - $($ou.seccion) creada!\"\n}\n\n$usuarios = Import-CSV -Path \"./personal.csv\"\nWrite-Output \"Creando usuarios....\"\nforeach ($user in $usuarios) {\n    $login = $user.login\n    $path=\"OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\n    New-ADUser -Name $login  -Path $path -SamAccountName $login -UserPrincipalName ($login+\"@CEFIRE2019.LOCAL\") -AccountPassword (ConvertTo-SecureString \"cefire2019.\" -AsPlainText -Force) -GivenName $login -ChangePasswordAtLogon $true -Enabled $true\n    $group = Get-ADGroup (\"CN=\"+$user.departamento+\",OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\")\n    $member = \"CN=\"+$login+\",\"+$path\n    Add-ADGroupMember $group -Members $member       \n    Write-Output \"Usuario $($user.login) creado!\"\n}\n</code></pre> Se prueba a iniciar sesi\u00f3n con un usuario, por ejemplo usudir1@isca2019.local (su contrase\u00f1a ser\u00e1 cefire2019.):</p> Inicio sesi\u00f3n Post-Script."},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#consultas-sobre-objetos-del-dominio","title":"Consultas sobre objetos del dominio","text":""},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#get-adobject","title":"Get-AdObject","text":"<p>El cmdlet Get-AdObject de PowerShell obtiene un objeto de Active Directory o realiza una b\u00fasqueda para obtener varios objetos seg\u00fan los criterios de b\u00fasqueda. Puede obtener todos los objetos en Active Directory mediante el par\u00e1metro -Filter.</p> <ul> <li>La sintaxis es:</li> </ul> <pre><code>Get-ADObject\n   [-AuthType &lt;ADAuthType&gt;]\n   [-Credential &lt;PSCredential&gt;]\n   -Filter &lt;String&gt;\n   [-IncludeDeletedObjects]\n   [-Properties &lt;String[]&gt;]\n   [-ResultPageSize &lt;Int32&gt;]\n   [-ResultSetSize &lt;Int32&gt;]\n   [-SearchBase &lt;String&gt;]\n   [-SearchScope &lt;ADSearchScope&gt;]\n   [-Server &lt;String&gt;]\n   [&lt;CommonParameters&gt;]\n}\n</code></pre> <pre><code>Get-ADObject\n   [-AuthType &lt;ADAuthType&gt;]\n   [-Credential &lt;PSCredential&gt;]\n   [-Identity] &lt;ADObject&gt;\n   [-IncludeDeletedObjects]\n   [-Partition &lt;String&gt;]\n   [-Properties &lt;String[]&gt;]\n   [-Server &lt;String&gt;]\n   [&lt;CommonParameters&gt;]\n}\n</code></pre> <pre><code>Get-ADObject\n   [-AuthType &lt;ADAuthType&gt;]\n   [-Credential &lt;PSCredential&gt;]\n   [-IncludeDeletedObjects]\n   -LDAPFilter &lt;String&gt;\n   [-Properties &lt;String[]&gt;]\n   [-ResultPageSize &lt;Int32&gt;]\n   [-ResultSetSize &lt;Int32&gt;]\n   [-SearchBase &lt;String&gt;]\n   [-SearchScope &lt;ADSearchScope&gt;]\n   [-Server &lt;String&gt;]\n   [&lt;CommonParameters&gt;]\n}\n</code></pre> <p>Se pueden observar ejemplos en el enlace de la fuente oficial Get-ADObject</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica07_AD.html#actividad-1","title":"Actividad 1","text":"<p>Crea una estructura de AD mediante comandos PowerShell de la Empresa ASO2122. Se deben crear dos archivos csv con cuatro departamentos a definir (por ejemplo Finanzas, RRHH, Compras, TIC), y con 5 empleados; los csv deben contener:</p> <ol> <li>departamentos.csv: Contiene los departamentos de la empresa. El archivo departamentos.csv contiene 2 columnas, el departamento y una descripci\u00f3n.</li> <li>empleados.csv: Contiene los empleados de la empresa. El archivo departamento contiene 3 columnas, una para el departamento, otra para el nombre y otra el apellido.</li> </ol> <p>De manera que el usuario tendr\u00e1 el login compuesto por el nombre y el apellido, de manera que si existiera una empleada llamada Carla Mateu, tendr\u00e1 un login carla.mateu:</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html","title":"Permisos, directivas de grupo y perfiles I","text":"<p>Objetivos de esta pr\u00e1ctica:</p> <ul> <li>Creaci\u00f3n de recursos compartidos.</li> <li>Configuraci\u00f3n y administraci\u00f3n de permisos de carpetas compartidas.</li> <li>Configuraci\u00f3n y administraci\u00f3n de permisos NTFS</li> <li>Gesti\u00f3n del dominio mediante directivas de grupo.</li> </ul>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#permisos","title":"Permisos","text":"<p>Los sistemas operativos de la familia Windows poseen dos niveles de permisos para los recursos compartidos:</p> <ul> <li>Permisos para carpetas compartidas: se aplican cada vez que un usuario quiere acceder a un archivo o carpeta de la red.</li> <li>Permisos para archivos y carpetas (NTFS): se aplican sobre dispositivos con formato NTFS para definir en mayor detalle las acciones permitidas.</li> </ul> <p>De lo anterior se extrae que cuando se accede en modo local a los archivos o carpetas s\u00f3lo intervienen los permisos asociados al sistema de ficheros, en este caso NTFS, sin embargo si se accede a trav\u00e9s de la red se aplican los dos niveles de permisos: en primer lugar se aplican los permisos de carpetas compartidas y posteriormente los permisos NTFS.</p> Permisos NTFS y compartidos."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#permisos-de-recursos-compartidos","title":"Permisos de recursos compartidos","text":"<p>Para acceder a la gesti\u00f3n de recursos compartidos, lo podemos hacer a trav\u00e9s de la opci\u00f3n servicios de archivo y almacenamiento, desde el Panel del Administrador del Servidor.</p> Recursos compartidos I. <p>Despu\u00e9s accedemos a la opci\u00f3n recursos compartidos:</p> Recursos compartidos II. <p>En la parte central de la consola de administraci\u00f3n del almacenamiento aparecen los recursos compartidos en el servidor. Para visualizar los permisos de cada recurso compartido, basta con hacer clic con el bot\u00f3n secundario del rat\u00f3n sobre el recurso cuyos permisos se quieren consultar y se selecciona \u2018Propiedades\u2019:</p> Propiedades Recursos Compartidos. <p>Veremos como aparece un cuadro de dialogo donde podemos ver en la parte de la izquierda la opci\u00f3n permisos. Y bajo Personalizar Permisos:</p> Permisos recursos compartidos. <p>Nos aparece despu\u00e9s el cuadro de permisos completo del recurso seleccionado:</p> Recursos compartidos V. <p>Si accedemos a la pesta\u00f1a compartir, podremos ver los permisos del recurso compartido. En este caso, el recurso compartido netlogon tiene los permisos:</p> Recursos compartidos VI. <p>Estos pueden ser de tres tipos:</p> <p>Control total : no solo permite cambiar y leer, sino modificar los permisos sobre el recurso compartido. Cambiar : se permite crear carpetas y archivos adem\u00e1s de modificar y borrar los archivos y directorios existentes. Lectura : \u00fanicamente permite la lectura de archivos y la ejecuci\u00f3n de archivos ejecutables que se hallen dentro del recurso compartido.</p> Permisos de NETLOGON. <p>Como se puede comprobar en la siguiente figura, existen dos tipos de directivas : \u2018Permitir\u2019 y \u2018Denegar\u2019. </p> <p>Warning</p> <p>Es importante destacar que la opci\u00f3n \u2018Denegar\u2019 tiene prioridad sobre otros permisos asignados sobre el recurso compartido.</p> Tipos de directivas."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#establecer-permisos-en-recursos-compartidos","title":"Establecer permisos en recursos compartidos","text":"<p>Establecer permisos de recursos compartidos se puede hacer de varias maneras. Probablemente la m\u00e1s sencilla sea seleccionar el recurso sobre el cual se desean configurar los permisos, y haciendo clic con el bot\u00f3n secundario \u2018Compartir con...\u2019 y usuarios espec\u00edficos.. Por ejemplo, vamos a crear una carpeta en C: llamada Empresa_users y la vamos a compartir:</p> Compartir recursos. <p>Y agregamos el grupo Empresa con lectura y escritura:</p> Agregar permisos. Agregar Permisos recurso compartido I. Agregar Permisos recurso compartido II. <p>Y por \u00faltimo Compartir.</p> <p>En lugar de hacer uso de este asistente, vamos a compartir mediante el uso compartido avanzado, que nos da m\u00e1s opciones para asignar los permisos. Para ello, seleccionaremos la carpeta y con el bot\u00f3n de la derecha del rat\u00f3n propiedades y pesta\u00f1a compartir:</p> Uso compartido avanzado I. Uso compartido avanzado II. <p>En la medida de lo posible, habr\u00e1 que asignar permisos a grupos y eliminar grupos que no tengan ninguna relaci\u00f3n con la carpeta que queremos compartir. Evitar el uso de grupo Todos para eso habr\u00e1 que crear los grupos correspondientes.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#permisos-ntfs","title":"Permisos NTFS","text":"<p>Como se ha comentado anteriormente, los permisos NTFS complementan y ampl\u00edan los permisos de recursos compartidos, siendo efectivo el m\u00e1s restrictivo.</p> <p>Todos los archivos y carpetas de un volumen NTFS tienen asociada una ACL o lista de control de acceso que fija el nivel de acceso de un usuario o grupo que pretenda acceder al recurso. Adem\u00e1s, los permisos NTFS pueden ser aplicados a nivel de archivo, a diferencia de los permisos de recursos compartidos, los cuales \u00fanicamente pueden aplicarse a nivel de carpeta.</p> <p>Por otra parte, surge un nuevo concepto al aplicar los permisos NTFS que los hace m\u00e1s complejos aunque tambi\u00e9n m\u00e1s potentes: la herencia, la cual determinar\u00e1 los permisos que se reciben sobre un determinado recurso provenientes de un nivel superior, aunque esto lo veremos detalladamente m\u00e1s adelante.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#tipos-de-permisos-ntfs","title":"Tipos de permisos NTFS","text":"<p>Tal y como se muestra en la figura (para abrir ese cuadro de di\u00e1logo hacer clic con el bot\u00f3n secundario sobre el recurso compartido y hacer clic en la pesta\u00f1a 'Seguridad'), los permisos (predeterminados) que pueden aplicarse sobre archivos y carpetas son:</p> <ul> <li>Control total.</li> <li>Cambiar.</li> <li>Leer y ejecutar.</li> <li>Mostrar el contenido de la carpeta.</li> <li>Leer.</li> <li>Escribir.</li> </ul> Permisos est\u00e1ndar. <p>No obstante, estos permisos en realidad representan varios aspectos mucho m\u00e1s concretos. Para tratar de clarificar esta cuesti\u00f3n, la tabla 1 resume qu\u00e9 tareas pueden realizarse con cada tipo de permiso.</p> Permisos para carpetas y archivos. <p>Para poder acceder a estos permisos especiales, lo haremos a trav\u00e9s de las propiedades, pesta\u00f1a de Seguridad y opciones avanzadas:</p> Acceso a permisos especiales I. Acceso a permisos especiales II. Acceso a permisos especiales III. Acceso a permisos especiales. <p>Warning</p> <p>Es importante entender que los permisos predeterminados est\u00e1ndar, en realidad corresponden a unas combinaciones de permisos espec\u00edficos, siendo estos \u00faltimos con los que trabajaremos m\u00e1s adelante cuando gestionemos las listas de control de acceso por l\u00ednea de comandos.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#asignacion-de-permisos-ntfs","title":"Asignaci\u00f3n de permisos NTFS","text":"<p>Al definir un permiso NTFS este puede ser un permiso o una denegaci\u00f3n:</p> Permisos NTFS I. <p>Warning</p> <ul> <li>Los permisos NTFS son acumulativos: se eval\u00faan los permisos otorgados al usuario y a los grupos a los que pertenece el usuario. En el caso de que haya una incompatibilidad entre los permisos asignados a un usuario y los asignados a un grupo del cual sea miembro, prevalecer\u00e1 la opci\u00f3n m\u00e1s restrictiva: Denegar (si est\u00e1 definido expl\u00edcitamente).</li> </ul> <p>Para asignar permisos NTFS a un recurso compartido bastar\u00e1 con hacer clic con el bot\u00f3n secundario sobre el recurso y acceder a la pesta\u00f1a 'Seguridad'. A continuaci\u00f3n pulsaremos el bot\u00f3n 'Opciones Avanzadas', como se muestra a continuaci\u00f3n:</p> Permisos NTFS II. Permisos NTFS III. Permisos NTFS IV. Permisos NTFS V. Permisos NTFS VI. <p>Warning</p> <p>Cuidado con el grupo Usuarios (del dominio) porque aparece por defecto en los permisos NTFS (con permisos de lectura), y puede provocar que se produzcan accesos diferentes a nuestra planificaci\u00f3n. Como norma general, si queremos limitar el acceso a un recurso compartido, eliminaremos el grupo Usuarios de los permisos NTFS y explicitaremos \u00fanicamente aquellos grupos o usuarios que efectivamente queramos que tengan acceso al recurso.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#permisos-implicitos-y-permisos-explicitos","title":"Permisos Impl\u00edcitos y permisos Expl\u00edcitos","text":"<p>Los permisos otorgados de manera impl\u00edcita o expl\u00edcita son una cuesti\u00f3n sencilla, en la que si no nos fijamos con atenci\u00f3n, podemos hacer que los accesos a los recursos no funcionen como ten\u00edamos previsto. Para evitar problemas tendremos en cuenta que:</p> <ol> <li>Un permiso definido de manera expl\u00edcita siempre prevalecer\u00e1 sobre un permiso definido de manera impl\u00edcita.</li> <li>Denegar un permiso siempre prevalece sobre otorgar ese permiso, siempre y cuando ambos est\u00e9n definidos de la misma manera (impl\u00edcita o expl\u00edcitamente).</li> </ol> <p>\u00bfC\u00f3mo se define un permiso de manera expl\u00edcita? Si nos fijamos en la siguiente figura, el grupo Compras no tiene (aparentemente) definidos permisos de escritura. Sin embargo esa aparente indefinici\u00f3n, en realidad indica que el permiso de escritura est\u00e1 denegado impl\u00edcitamente. Si un usuario del grupo Ventas intenta escribir en la carpeta, se producir\u00e1 un mensaje de error como muestra la siguiente figura:</p> Permisos expl\u00edcitos. Error al crear archivo en recurso compartido. <p>Sin embargo, si le otorgamos el permiso expl\u00edcito de escritura, veremos que efectivamente puede escribir en el recurso, ya que la definici\u00f3n expl\u00edcita del permiso para escribir prevalece sobre la denegaci\u00f3n impl\u00edcita del permiso escribir:</p> Permisos de escritura. Permisos de escritura. <p>Si explicitamos la denegaci\u00f3n del permiso de escritura para los miembros del grupo Compras, podremos comprobar que efectivamente el usuario usucomp1 no puede escribir en la carpeta:</p> Denegaci\u00f3n explicita. Denegaci\u00f3n explicita."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#herencia-de-permisos","title":"Herencia de permisos","text":"<p>Note</p> <p>Al crear un archivo o carpeta en un volumen NTFS ese objeto hereda autom\u00e1ticamente los permisos de su carpeta contenedora, y a la inversa: cuando asignamos permisos a una carpeta contenedora, los permisos se propagan autom\u00e1ticamente hacia los archivos y subcarpetas contenidas en el recurso.</p> <p>Sin embargo, pueden darse ocasiones en las que queramos eliminar esa herencia de permisos. Esto puede ejecutarse de tres maneras diferentes:</p> <ul> <li>Eliminar la herencia a nivel de la carpeta de nivel superior, los objetos contenidos en ella dejan de heredar los permisos.</li> <li>Eliminar la herencia a nivel de subcarpeta o archivo contenido dentro del recurso principal.</li> <li>Permitir o denegar expl\u00edcitamente un permiso de manera diferente a como est\u00e1 definido en el recurso contenedor.</li> </ul> <p>Note</p> <p>\u00bfQu\u00e9 utilidad pr\u00e1ctica piensas que puede tener la herencia de permisos? Fundamentalmente son dos las utilidades principales. La primera radica en que el administrador no tiene que asignar manualmente los permisos a los archivos y subcarpetas que haya contenidas dentro del recurso principal, y que f\u00e1cilmente pueden ser miles. Relacionado con este aspecto, tambi\u00e9n encontramos una segunda utilidad pr\u00e1ctica que es el aumento de la seguridad al descartar posibles errores de asignaci\u00f3n de permisos realizados manualmente.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#eliminacion-de-herencia-del-recurso-de-nivel-superior","title":"Eliminaci\u00f3n de herencia del recurso de nivel superior","text":"<p>Para eliminar la herencia de los permisos establecidos en la carpeta de nivel superior, se debe acceder a la ficha 'Seguridad' del cuadro de di\u00e1logo 'Permisos' y a continuaci\u00f3n se hace clic en 'Opciones Avanzadas' :</p> Denegaci\u00f3n explicita I. <p>En este caso vemos que la carpeta c:\\pistonazo_users hereda los permisos de la unidad *c:*. </p> <p>Para eliminar la herencia, debemos hacer clic en Deshabilitar herencia y nos aparecer\u00e1 un di\u00e1logo para dejar los permisos expl\u00edcitos o bien para eliminar todos los permisos:</p> Denegaci\u00f3n explicita II. <p>Tenemos dos opciones:</p> <ul> <li>Convertir los permisos heredados en permisos expl\u00edcitos: mantiene los permisos de todos los archivos y subcarpetas, pero no est\u00e1n vinculados a los del nivel superior.</li> <li>Quitar todos los permisos: elimina todos los permisos heredados.</li> </ul> <p>Tip</p> <p>Como norma general marcaremos la primera opci\u00f3n, convertir los permisos en permisos expl\u00edcitos:</p> Denegaci\u00f3n explicita III."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#cambio-de-los-permisos-de-un-objeto-hijo","title":"Cambio de los permisos de un objeto hijo","text":"<p>Si observamos los permisos de un objeto que est\u00e1 heredando permisos, veremos que las casillas de verificaci\u00f3n est\u00e1n (completa o parcialmente) inaccesibles. En este caso la carpeta Compras que hereda los permisos de la carpeta Administraci\u00f3n, hereda tambi\u00e9n los permisos del grupo administraci\u00f3n:</p> Herencia de permisos. <p>En primer lugar podemos interrumpir la herencia, denegando expl\u00edcitamente los permisos. Si el permiso heredado es de concesi\u00f3n, la denegaci\u00f3n est\u00e1 habilitada.</p> Interrupci\u00f3n de herencia."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#directivas-de-grupo-gpo","title":"Directivas de Grupo (GPO)","text":"<p>Las directivas de grupo (Group Policy) son una serie de configuraciones creadas por el administrador que se aplican a objetos del dominio. Por medio de estas directivas, el administrador controla los entornos de trabajo de los usuarios del dominio, los equipos y el comportamiento de distintos objetos. Son en definitiva un conjunto de reglas que facilitan las labores de administraci\u00f3n de los usuarios y equipos.</p> <p>Algunos de los aspectos m\u00e1s \u00fatiles que se pueden definir por parte del administrador mediante las directivas son:</p> <ul> <li>Los comandos de inicio de sesi\u00f3n.</li> <li>Caracter\u00edsticas de las directivas de seguridad de las cuentas de usuario.</li> <li>Configuraci\u00f3n de la apariencia de la sesi\u00f3n de usuario.</li> <li>Redirecci\u00f3n del acceso a ciertas carpetas o archivos centralizados Distribuci\u00f3n de software a los equipos clientes.</li> <li>Permisos otorgados a las cuentas de usuarios y grupos, etc.</li> </ul>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#acumulacion-de-directivas-de-grupo","title":"Acumulaci\u00f3n de directivas de grupo","text":"<p>Al existir diferentes niveles de directivas de grupo, estas pueden entrar en conflicto, haciendo que aparezcan efectos no deseados en la gesti\u00f3n del dominio. Al establecer directivas de grupo hay que tener en cuenta el orden de aplicaci\u00f3n de las mismas:</p> <ul> <li>Directiva de grupo local.</li> <li>Directiva de grupo de sitio.</li> <li>Directiva de grupo de dominio.</li> <li>Directiva de grupo de unidad organizativa.</li> </ul> <p>De manera predeterminada cuando existe una contradicci\u00f3n entre las directivas, la que prevalece ser\u00e1 la que est\u00e1 en un nivel inferior de la lista anterior. Obviamente, en caso de no existir contradicciones, se aplican todas las directivas.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#directivas-de-usuario-o-equipo","title":"Directivas de usuario o equipo","text":"<p>Si queremos saber las directivas que est\u00e1n aplicandose a un usuario o equipo, ejecutaremos rsop.msc:</p> rsop.msc."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#edicion-de-las-directivas-de-grupo-predeterminadas","title":"Edici\u00f3n de las directivas de grupo predeterminadas","text":"<p>Para acceder a las directivas de grupo predeterminadas, accedemos desde el Panel del Servidor --&gt; Herramientas --&gt; Administraci\u00f3n de directivas de grupo:</p> Administraci\u00f3n directivas de grupo. <p>Cuando se pone en marcha un dominio se crean dos directivas de grupo llamadas:</p> <ul> <li>Default Domain Controllers.</li> <li>Default Domain Policy.</li> </ul> GPOs predefinidos. <p>Estas dos directivas establecen la configuraci\u00f3n b\u00e1sica de los objetos del dominio, y est\u00e1n vinculadas respectivamente a:</p> <ul> <li>La unidad organizativa Domain Controllers.</li> <li>El dominio.</li> </ul> <p>Estos dos GPO se componen de un conjunto muy amplio de directivas, como se puede ver al abrir el editor de directivas:</p> GPOs predeterminadas Default Domain Policy. <p>Supongamos que queremos cambiar la configuraci\u00f3n de la directiva que aplica sobre el permiso para apagar el equipo. En ese caso la buscar\u00edamos entre todo el conjunto de directivas dentro del GPO Default Domain Policy y har\u00edamos doble clic sobre ella :</p> GPO Apagar el sistema. <p>Vemos que la directiva Apagar el Sistema no est\u00e1 habilitada. Si la habilitamos y \u00fanicamente otorgamos permiso a los administradores del dominio, podremos comprobar que efectivamente un usuario del dominio que inicia sesi\u00f3n en un equipo cliente no puede apagarlo, solamente podr\u00eda un usuario con privilegios de administraci\u00f3n.</p> <p>Para evitar generar un tr\u00e1fico de gesti\u00f3n excesivo en la red, las directivas de grupo no se actualizan inmediatamente tras su modificaci\u00f3n, sino que est\u00e1 establecido un intervalo de 5 minutos entre actualizaciones autom\u00e1ticas. No obstante, este intervalo se puede modificar en las propias directivas de grupo. De todas maneras, no es necesario modificar este intervalo para comprobar la correcta aplicaci\u00f3n de las directivas de grupo, basta con escribir en la consola cmd el comando gpupdate :</p> gpupdate. <p>Y ahora iniciamos una sesi\u00f3n con un usuario en la m\u00e1quina cliente y comprobamos que efectivamente no se puede apagar la m\u00e1quina:</p> Denegar apagado del sistema. <p>Tas tareas m\u00e1s comunes que se realizan con las GPOs son aquellas relativas a las directivas de contrase\u00f1as, de inicios de sesi\u00f3n y bloqueos entre otros. Para ejemplificar todo lo anterior vamos a modificar la Default Domain Policy para implementar las siguientes configuraciones en el dominio:</p> <ol> <li>Si el usuario se equivoca tres veces al introducir su contrase\u00f1a, su cuenta queda bloqueada (solo la podr\u00e1 desbloquear el administrador). Esto protege el sistema de posibles ataques.</li> <li>La contrase\u00f1a deber\u00e1 tener un m\u00ednimo de 5 caracteres, pero no es necesario obligatoriamente que sean may\u00fasculas, min\u00fasculas, caracteres alfanum\u00e9ricos, obligatoriamente, etc.</li> <li>La contrase\u00f1a que se haya utilizado ya, no podr\u00e1 volverse a utilizar hasta pasados al menos 10 cambios de contrase\u00f1a (de esta manera forzamos al usuario a que que no 'recicle' contrase\u00f1as antiguas, incrementando la seguridad del sistema).</li> <li>El usuario debe cambiar la contrase\u00f1a cada seis meses, al establecer una 'vida \u00fatil' de las contrase\u00f1as tenemos un sistema m\u00e1s seguro, ya que en caso de que alguien haya averiguado la contrase\u00f1a del usuario, y no se haya detectado, como tarde a los seis meses, perder\u00e1 el acceso a la cuenta.</li> </ol> <p>En las siguientes subsecciones se examina la manera de proceder para llevar a cabo estas configuraciones del sistema.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#bloqueo-de-cuenta-al-introducir-una-contrasena-3-veces-una-contrasena-erronea","title":"Bloqueo de cuenta al introducir una contrase\u00f1a 3 veces una contrase\u00f1a err\u00f3nea","text":"<p>En primer lugar editaremos el GPO 'Default Domain Policy' para configurar la directiva de bloqueo de cuenta. Esta se halla en:</p> <p>'Configuraci\u00f3n del equipo'\u2192'Directivas'\u2192'Configuraci\u00f3n de Windows'\u2192'Directiva de bloqueo de cuenta'\u2192'Umbral de bloqueo de cuenta'</p> Acceso a GPOs Default Domain Policy. Acceso directiva bloqueo de cuenta. <p>Modificamos la directiva Umbral de bloqueo de cuenta a '3 intentos' de inicio de sesi\u00f3n err\u00f3neos:</p> Umbral de bloqueo de cuenta. <p>Adem\u00e1s configuraremos la duraci\u00f3n del bloqueo, donde un valor de 0 indica que la cuenta deber\u00e1 ser desbloqueada manualmente por el administrador:</p> Duraci\u00f3n de bloqueo de cuenta. <p>Finalmente tambi\u00e9n configuraremos el tiempo que debe transcurrir entre intentos para que el contador de fallos de inicio de sesi\u00f3n vuelva a cero antes de que se bloquee la cuenta. Pondremos el m\u00e1ximo valor permitido:</p> Restablecer el bloqueo."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#longitud-de-la-contrasena","title":"Longitud de la contrase\u00f1a","text":"<p>Como en el caso anterior editaremos el GPO 'Default Domain Policy' para configurar la longitud y complejidad de las contrase\u00f1as:</p> Directivas de contrase\u00f1as. <p>Modificamos el valor de la longitud a 5 caracteres:</p> Longitud de la contrase\u00f1a. <p>A continuaci\u00f3n deshabilitamos los requisitos de complejidad de las contrase\u00f1as. En la siguiente figura aparecen las caracter\u00edsticas de complejidad que aplica esta directiva cuando est\u00e1 habilitada:</p> Deshabilitar complejidad de contrase\u00f1as."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#historial-de-contrasenas","title":"Historial de contrase\u00f1as","text":"<p>Editamos de nuevo el GPO 'Default Domain Policy' y accedemos a las directivas de contrase\u00f1as:</p> Historial de contrase\u00f1as."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#vigencia-maxima-de-la-contrasena","title":"Vigencia m\u00e1xima de la contrase\u00f1a","text":"<p>Como en casos anteriores accedemos a las directivas de contrase\u00f1a:</p> Vigencia m\u00e1xima de la contrase\u00f1a. <p>Cambiamos la duraci\u00f3n m\u00e1xima de las contrase\u00f1as a 180 d\u00edas -6 meses </p> <ul> <li>El resultado de cada una de las directivas de la secci\u00f3n Directivas de contrase\u00f1as ser\u00eda:</li> </ul> Directivas de contrase\u00f1as."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#creacion-de-directivas-de-grupo","title":"Creaci\u00f3n de directivas de grupo","text":"<p>Vamos a modificar ciertas directivas de la organizaci\u00f3n Pistonazo, para ello accederemos: 'Panel del administrador'\u2192'Herramientas administrativas'\u2192'Administraci\u00f3n de directivas de grupo'</p> <p>Supongamos que queremos crear una Directiva de Grupo sobre la unidad organizativa 'Pistonazo' que creamos en el tema anterior. Hacemos clic con el bot\u00f3n secundario y escogemos la opci\u00f3n 'Crear un GPO en este dominio y vincularlo aqu\u00ed'</p> Directivas de grupo. <p>Aparecer\u00e1 el cuadro de di\u00e1logo e introduciremos el nombre que le queremos dar, por ejemplo 'Entorno de trabajo', ya que posteriormente utilizaremos esta directiva para configurar un entorno de trabajo homog\u00e9neo en todos los usuarios que pertenecen a la Unidad Organizativa 'Pistonazo'.</p> Nueva GPO I. <p>La nueva directiva aparecer\u00e1 en el panel de detalles:</p> Nueva GPO II. <p>Seleccionamos el GPO y hacemos clic con el bot\u00f3n derecho, escogiendo la opci\u00f3n 'Editar'. Con la nueva directiva vamos a establecer las siguientes configuraciones:</p> <ol> <li>Todos los miembros de la unidad organizativa 'Pistonazo' tendr\u00e1n un fondo de escritorio 'corporativo' que se instalar\u00e1 de manera autom\u00e1tica y que no podr\u00e1 ser modificado.</li> <li>Los miembros de la unidad organizativa 'Trabajadores' no pueden abrir la consola de comandos.</li> </ol> <p>En las siguientes subsecciones se examina la manera de proceder para llevar a cabo estas configuraciones del sistema.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#fondo-de-escritorio-obligatorio","title":"Fondo de escritorio obligatorio","text":"<p>Para modificar de una manera centralizada el fondo de escritorio de los usuarios de la unidad organizativa 'Pistonazo' debemos editar la directiva 'Entorno de Trabajo' y acceder a 'Configuraci\u00f3n del usuario'\u2192'Plantillas administrativas'\u2192'Active Desktop'\u2192'Active Desktop'</p> GPO Pistonazo. Personalizar Active Desktop. Habilitamos el Active Desktop. Active Desktop. <p>Vamos a impedir tambi\u00e9n que los usuarios puedan modificar el fondo de escritorio:</p> No permitir cambios. <p>Indicamos la ruta en la que se halla la imagen que queremos poner como fondo de escritorio. En este caso se llama fondopisto.jpg y hay que a\u00f1adirla a una carpeta compartida que se encuentre en el servidor. En nuestro caso, la a\u00f1adiremos a la carpeta Pistonazo:</p> Tapiz de escritorio. <p>La imagen debe hallarse en una carpeta compartida en red (preferiblemente en el servidor por cuestiones de disponibilidad) donde todos los usuarios del dominio tengan permiso de lectura. Adem\u00e1s, se recomienda que la ruta se introduzca en formato UNC del tipo:</p> <pre><code>\\\\server 1\\gestion\\fondocorp.jpg no en formato \\\\192.168.0.100\\gestion\\fondocorp.jpg\n</code></pre>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#bloqueo-de-la-linea-de-comandos","title":"Bloqueo de la l\u00ednea de comandos","text":"<p>Para bloquear la l\u00ednea de comandos editaremos el GPO correspondiente accediendo a 'Configuraci\u00f3n del usuario'\u2192'Plantillas administrativas'\u2192'Sistema'</p> Bloqueo consola. <p>Y habilitamos el bloqueo:</p> Habilitar el bloqueo."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#comprobacion-de-las-directivas-establecidas","title":"Comprobaci\u00f3n de las directivas establecidas","text":"<p>Ahora comprobaremos que las directivas se han aplicado correctamente. Para ello utilizaremos un usuario cualquiera dentro de la unidad organizativa 'Pistonazo' que es sobre la que se aplican el GPO creado 'Entorno de Trabajo', y obviamente el GPO Default Domain Policy, que hemos editado.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#bloqueo-de-cuenta","title":"Bloqueo de cuenta","text":"<p>La primera directiva que hemos aplicado consist\u00eda en bloquear la cuenta indefinidamente al introducir en tres ocasiones la contrase\u00f1a incorrectamente. Nos equivocamos voluntariamente al iniciar sesi\u00f3n en un equipo cliente y la cuenta se acaba bloqueando. Por ejemplo, vamos a iniciar sesi\u00f3n con usuario usucomp1 e introduciremos 3 veces de manera incorrecta la contrase\u00f1a:</p> Cuenta usucomp1 bloqueada. <p>Comprobamos en el controlador de dominio que efectivamente est\u00e1 bloqueada y la desbloqueamos:</p> Cuenta bloqueada."},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#longitud-de-la-contrasena_1","title":"Longitud de la contrase\u00f1a","text":"<p>Para comprobar la longitud de la contrase\u00f1a, vamos a cambiar la contrase\u00f1a del usuario usucomp1 y vamos a poner una contrase\u00f1a que tenga 5 caracteres, por ejemplo 12345.</p> Restablecer contrase\u00f1a. <p>As\u00ed tambi\u00e9n hemos visto que podemos introducir una contrase\u00f1a sin requisitos de complejidad.</p> <p>Note</p> <p>Ya se podr\u00eda comprobar estas restricciones.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica08_AD.html#actividad","title":"Actividad","text":"<p>Habr\u00e1 que modificar las siguientes directivas para conseguir:</p> <ol> <li>Los usuarios deben cambiar la contrase\u00f1a cada 90 d\u00edas y guardar el historial de 5 contrase\u00f1as. Para facilitar la gesti\u00f3n no ser\u00e1 necesaria tener una restricci\u00f3n en cu\u00e1nto a la complejidad de la contrase\u00f1a y el n\u00famero m\u00ednimo de caracteres ser\u00e1 de 4.</li> <li>Para evitar posibles robos de contrase\u00f1a y ataques mal intencionados, cuando un usuario intenta 4 veces introducir de manera incorrecta su contrase\u00f1a, la cuenta se bloquear\u00e1 hasta que se reestablezca el contador de inicios de sesi\u00f3n err\u00f3neos a los 10minutos.</li> </ol> <p>Haced una captura de pantalla de las directivas de contrase\u00f1a y de inicios de sesi\u00f3n.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html","title":"Permisos, directivas de grupo y perfiles II","text":"<p>Objetivos de esta pr\u00e1ctica:</p> <ul> <li>Establecimiento de carpetas particulares de los usuarios del dominio.</li> <li>Ejecuci\u00f3n de comandos de inicio de sesi\u00f3n.</li> <li>Configuraci\u00f3n del entorno de trabajo del usuario mediante perfiles.</li> </ul>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#carpetas-personales","title":"Carpetas Personales","text":"<p>Una de las opciones m\u00e1s utilizadas que puede configurarse en la ficha 'Perfiles' de las propiedades de la cuenta de usuario es el establecimiento de una unidad en red personal para cada usuario a la que \u00fanicamente \u00e9l tiene acceso:</p> Carpeta particular. <p>Para configurarla, basta crear una carpeta a la que se tenga acceso desde la red. Esta carpeta la tenemos creada en el disco <code>c:\\Pistonazo_users</code> y dentro de esta carpeta est\u00e1n las carpetas de cada uno de los usuarios. Bastar\u00e1 asignar la ruta de esa carpeta a cada uno de los usuarios. Por ejemplo, vamos a asignar la unidad Z: a la carpeta personal de cada uno de los usuarios de nuestra organizaci\u00f3n Pistonazo:</p> Carpetas particulares. <p>Asignaremos estas carpetas a cada uno de los usuarios. Para ello desde la pesta\u00f1a perfil:</p> Carpetas particulares. <p>La carpeta del usuario debe ser una carpeta compartida y con permisos de escritura. En nuestro caso utilizaremos las carpetas que creamos en la secci\u00f3n de Permisos NTFS por l\u00ednea de comandos. Creamos una carpeta en <code>C:\\Pistonazo_Users</code>, esta carpeta tiene permisos de acceso el grupo Pistonazo y los Administradores. Por tanto, el recurso <code>\\\\192.168.100.1\\Pistonazo_users\\%username%</code> ser\u00e1 la carpeta de cada uno de los usuarios.</p> <p>La variable <code>%username%</code> sustituye el valor por el identificador de usuario.</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#carpetas-personales-ocultas","title":"Carpetas personales ocultas","text":"<p>Si quisi\u00e9ramos que las carpetas personales estuvieran ocultas, bastar\u00eda con a\u00f1adir un <code>$</code> al final del nombre del recurso compartido. En nuestro caso, pod\u00edamos haber compartido el recurso Pistonazo_Users con un <code>$</code> al final y as\u00ed ocultar las carpetas de usuarios.</p> <p>Pod\u00e9is probar el siguiente script que elimina toda la estructura pistonazo y la regenera con carpetas ocultas asignando las carpetas personales a los usuarios:</p>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#pistonazo-completo-bat","title":"Pistonazo Completo .BAT","text":"<pre><code>REM ELIMINANDO OU PISTONAZO\ndsrm -subtree -noprompt -c \"ou=Pistonazo, dc=cefire2017, dc=local\"\n\nRem Creaci\u00f3n de Unidades Organizativas\ndsadd ou \"ou=Pistonazo, dc=cefire2017, dc=local\"\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (secciones.csv) do dsadd ou \"ou=%%a, ou=Pistonazo,\ndc=cefire2017, dc=local\" -desc \"%%b\"\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (departamentos.csv) do dsadd ou \"ou=%%b, ou=%%a,\nou=Pistonazo, dc=cefire2017, dc=local\" -desc \"%%b\"\n\nRem Creacion de grupos\ndsadd group \"cn=Pistonazo, ou=Pistonazo, dc=cefire2017, dc=local\"\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (secciones.csv) do dsadd group \"cn=%%a, ou=%%a,\nou=Pistonazo, dc=cefire2017, dc=local\" -memberof \"cn=Pistonazo, ou=Pistonazo, dc=cefire2017,\ndc=local\"\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (departamentos.csv) do dsadd group \"cn=%%b, ou=%%b,\nou=%%a, ou=Pistonazo, dc=cefire2017, dc=local\" -memberof \"cn=%%a, ou=%%a, ou=Pistonazo,\ndc=cefire2017, dc=local\"\nREM Creacion de usuarios\nFOR /F \"tokens=1-3 delims=, skip=1\" %%a in (personal.csv) do dsadd user \"cn=%%a, ou=%%b, ou=%%c,\nou=Pistonazo, dc=cefire2017, dc=local\" -memberof \"cn=%%b, ou=%%b, ou=%%c, ou=Pistonazo,\ndc=cefire2017, dc=local\" -samid \"%%a\" -upn \"%%a@CEFIRE2017.LOCAL\" -pwd \"cefire2017.\" -fn \"%%a\" -\nmustchpwd \"yes\"\nREM Borrando carpetas\nrmdir c:\\pistonazo\nREM Creando carpetas\nmkdir c:\\pistonazo\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (secciones.csv) do mkdir c:\\pistonazo\\%%a\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (departamentos.csv) do mkdir c:\\pistonazo\\%%a\\%%b\nicacls c:\\Pistonazo /inheritance:r\nicacls c:\\Pistonazo /GRANT Administradores:(OI)(CI)F\nicacls c:\\Pistonazo /GRANT Pistonazo:RX\n\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (secciones.csv) do mkdir c:\\pistonazo\\%%a\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (secciones.csv) do icacls c:\\pistonazo\\%%a /GRANT %%a:RX\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (departamentos.csv) do mkdir c:\\pistonazo\\%%a\\%%b\nFOR /F \"tokens=1-2 delims=, skip=1\" %%a in (departamentos.csv) do icacls c:\\pistonazo\\%%a\\%%b\n/GRANT %%b:(OI)(CI)F\n\nnet share Pistonazo /delete\nnet share Pistonazo=c:\\Pistonazo /grant:Administradores,FULL /grant:Pistonazo,CHANGE\nmkdir c:\\Pistonazo_users\nicacls c:\\Pistonazo_users /inheritance:r\nicacls c:\\Pistonazo_users /grant Administradores:(OI)(CI)F\nicacls c:\\Pistonazo_users /grant Pistonazo:RX\nREM Creacion de carpetas de usuarios\nFOR /F \"tokens=1-3 delims=, skip=1\" %%a in (personal.csv) do mkdir c:\\Pistonazo_users\\%%a\nFOR /F \"tokens=1-3 delims=, skip=1\" %%a in (personal.csv) do icacls c:\\Pistonazo_users\\%%a /grant\n%%a:(OI)(CI)F\n\nnet share Pistonazo_users /delete\nnet share Pistonazo_users$ /delete\nnet share Pistonazo_users$=c:\\Pistonazo_users /grant:Administradores,FULL /grant:Pistonazo,CHANGE\n\nFOR /F \"tokens=1-3 delims=, skip=1\" %%a in (personal.csv) do dsmod user \"cn=%%a, ou=%%b, ou=%%c,\nou=Pistonazo, dc=cefire2017, dc=local\" -hmdrv Z: -hmdir \"\\\\192.168.100.1\\Pistonazo_users$\\%%a\"\n</code></pre>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#version-completa-en-powershell-pistonazocompletopsps1","title":"Version completa en POWERSHELL (pistonazoCompletoPS.ps1)","text":"<p>En PowerShell ser\u00eda:</p> <pre><code>Write-Output \"Creando Estructura de OU y Grupos...\"\nNew-ADOrganizationalUnit -Name \"Pistonazo\" -Path \"DC=CEFIRE2019, DC=LOCAL\" -Description\n\"Unidad organizativa Pistonazo\" -ProtectedFromAccidentalDeletion $false\nNew-ADGroup -Name \"Pistonazo\" -GroupScope Global -Path\n\"OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\n$secciones = Import-CSV -Path \"./secciones.csv\"\n$group = Get-ADGroup \"CN=Pistonazo,OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\"\nforeach ($ou in $secciones) {\nNew-ADOrganizationalUnit -Name ($ou.seccion) -Path \"OU=Pistonazo, DC=CEFIRE2019,\nDC=LOCAL\"\n$path=\"OU=\"+($ou.seccion)+\",OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\nNew-ADGroup -Name $ou.seccion -GroupScope Global -Path $path\n$member = \"CN=\"+($ou.seccion)+\",\"+$path\nAdd-ADGroupMember $group -Members $member\nWrite-Output \"Unidad $($ou.seccion) creada!\"\n}\n$departamentos = Import-CSV -Path \"./departamentos.csv\"\nforeach ($ou in $departamentos) {\n$path=\"OU=\"+($ou.seccion)+\", OU=Pistonazo, DC=CEFIRE2019, DC=LOCAL\"\nNew-ADOrganizationalUnit -Name ($ou.departamento) -Path $path\n$path=\"OU=\"+($ou.departamento)+\",OU=\"+$ou.seccion+\",OU=Pistonazo, DC=CEFIRE2019,\nDC=LOCAL\"\nNew-ADGroup -Name $ou.departamento -GroupScope Global -Path $path\n$group = Get-ADGroup\n(\"CN=\"+$ou.seccion+\",OU=\"+$ou.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\")\n$member = \"CN=\"+($ou.departamento)+\",\"+$path\nAdd-ADGroupMember $group -Members $member\nWrite-Output \"Unidad $($ou.departamento) - $($ou.seccion) creada!\"\n}\n$usuarios = Import-CSV -Path \"./personal.csv\"\nWrite-Output \"Creando usuarios....\"\nforeach ($user in $usuarios) {\n$login = $user.login\n\n$path=\"OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE2019,DC=LOCAL\nNew-ADUser -Name $login -Path $path -SamAccountName $login -UserPrincipalName\n($login+\"@CEFIRE2019.LOCAL\") -AccountPassword (ConvertTo-SecureString \"cefire2019.\" -\nAsPlainText -Force) -GivenName $login -ChangePasswordAtLogon $true -Enabled $true\n$group = Get-ADGroup\n(\"CN=\"+$user.departamento+\",OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,D\n$member = \"CN=\"+$login+\",\"+$path\nAdd-ADGroupMember $group -Members $member\nWrite-Output \"Usuario $($user.login) creado!\"\n\n}\nWrite-Host \"Creamos la estructura de Pistonazo...\"\nRemove-Item C:\\Pistonazo -Force\nNew-Item C:\\Pistonazo -Type Directory\n$acl = Get-Acl C:\\Pistonazo\n$acl.SetAccessRuleProtection($true, $false)\n$rule = New-Object\n\n\nSystem.Security.AccessControl.FileSystemAccessRule(\"Administradores\",\"FullControl\",\n\"ContainerInherit, ObjectInherit\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule(\"Pistonazo\",\"ReadAndExecute\", \"None\",\n\"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -path C:\\Pistonazo -AclObject $acl\nWrite-Host \"Asignamos Permisos\"\n$deps = Import-CSV -Path \"./departamentos.csv\"\nforeach ($ou in $deps) {\nNew-Item C:\\Pistonazo\\$($ou.seccion)\\$($ou.departamento) -Type Directory -Force\n$acl = Get-Acl C:\\Pistonazo\\$($ou.seccion)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule($($ou.seccion),\"ReadAndExecute\",\n\"None\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -path C:\\Pistonazo\\$($ou.seccion) -AclObject $acl\n$acl = Get-Acl C:\\Pistonazo\\$($ou.seccion)\\$($ou.departamento)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule($($ou.departamento),\"FullControl\",\n\"ContainerInherit, ObjectInherit\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -path C:\\Pistonazo\\$($ou.seccion)\\\\$($ou.departamento) -AclObject $acl\n}\n\nWrite-Host \"Creamos la estructura de Carpetas de Usuarios\"\nRemove-Item C:\\Pistonazo_users -Force\nNew-Item C:\\Pistonazo_users -Type Directory\n$acl = Get-Acl C:\\Pistonazo_users\n$acl.SetAccessRuleProtection($true, $false)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule(\"Administradores\",\"FullControl\",\n\"ContainerInherit, ObjectInherit\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule(\"Pistonazo\",\"ReadAndExecute\", \"None\",\n\"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -path C:\\Pistonazo_users -AclObject $acl\n$usuarios = Import-CSV -Path \"./personal.csv\"\nWrite-Output \"Creando carpetas de usuarios....\"\nforeach ($user in $usuarios) {\n$login = $user.login\nNew-Item C:\\Pistonazo_users\\$($user.login) -Type Directory\n$acl = Get-Acl C:\\Pistonazo_users\\$($user.login)\n$rule = New-Object\nSystem.Security.AccessControl.FileSystemAccessRule($($user.login),\"FullControl\",\n\"ContainerInherit, ObjectInherit\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -path C:\\Pistonazo_users\\$($user.login) -AclObject $acl\n\n}\nNew-SmbShare -Name Pistonazo_Users$ -Path c:\\Pistonazo_Users -ChangeAccess Pistonazo -\nFullAccess Administradores\n\nNew-SmbShare -Name Pistonazo -Path c:\\Pistonazo -ChangeAccess Pistonazo -FullAccess\nAdministradores\n\n$usuarios = Import-CSV -Path \"./personal.csv\"\nWrite-Output \"Modificando atributos de usuarios....\"\nforeach ($user in $usuarios) {\n$userObj =\n\"CN=\"+$user.login+\",OU=\"+$user.departamento+\",OU=\"+$user.seccion+\",OU=Pistonazo,DC=CEFIRE\n$usuario = Get-ADUser -Identity $userObj\nSet-ADUser -Identity $usuario -ScriptPath \"Pistonazo2.bat\" -HomeDrive \"Z:\" -\nHomeDirectory \"\\\\192.168.100.1\\Pistonazo_users$\\$($user.login)\"\nWrite-Output \"Usuario $usuario encontrado!\"\n}\n</code></pre>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#comandos-de-inicio-de-sesion","title":"Comandos de inicio de sesi\u00f3n","text":"<p>Otra opci\u00f3n que podemos configurar dentro de la ficha perfil consiste en indicar un script que se ejecutar\u00e1 en cada inicio de sesi\u00f3n de manera autom\u00e1tica y transparente al usuario. Para ello desde la pesta\u00f1a perfil del usuario accedemos a Script de inicio de sesi\u00f3n:</p> Script de inicio de sesi\u00f3n. <p>Estos scripts deben hallarse en la carpeta compartida NETLOGON, cuya direcci\u00f3n local en el controlador de dominio es: <code>C:\\Windows\\SYSVOL\\sysvolCEFIRE2017.LOCAL\\scripts</code>. En este caso concreto, la direcci\u00f3n local y la direcci\u00f3n en red ser\u00edan respectivamente:</p> Ruta Netlogon. <p>Crearemos en esta carpeta un fichero llamado pistonazo.bat. Que ser\u00e1 donde a\u00f1adamos los comandos que queremos que se ejecuten cuando un usuario inicie la sesi\u00f3n:</p> Fichero pistonazo.bat <p>Hay que tener en cuenta que por defecto est\u00e1n las extensiones de archivo ocultas. Para evitar confusiones con los archivos, vamos a marcar que nos muestre las extensiones de los archivos. Para ello seleccionamos Vista y marcamos extensiones de archivo:</p> Marcar extensiones de archivos en Netlogon"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#ejemplos-de-scripts-de-inicio-de-sesion-asignacion-de-unidad-de-red","title":"Ejemplos de scripts de inicio de sesi\u00f3n: Asignaci\u00f3n de unidad de red","text":"<p>Vamos a hacer que se monte de manera autom\u00e1tica la unidad P: que ser\u00e1 la unidad donde se encuentren las carpetas de los departamentos de los usuarios de la organizaci\u00f3n Pistonazo. </p> <p>Para ello, a\u00f1adiremos a nuestro script, el comando Net Use P:\\192.168.100.1\\Pistonazo</p> Pistonazo.bat <p>Ahora lo que haremos ser\u00e1 modificar el campo Script de inicio de sesi\u00f3n a los usuarios de la organizaci\u00f3n Pistonazo. Podemos a\u00f1adir a nuestro script el siguiente comando:</p> <pre><code>FOR /F \"tokens=1-3 delims=, skip=1\" %%a in (personal.csv) do dsmod user \"cn=%%a, ou=%%b, ou=%%c, ou=Pistonazo, dc=cefire2017, dc=local\" -loscr \"pistonazo.bat\"\n</code></pre> <p>Tambi\u00e9n podemos ejecutar el siguiente comando desde la l\u00ednea de comandos:</p> <pre><code>dsmod user \"OU=Pistonazo, DC=CEFIRE2017, DC=LOCAL\" | dsmod user -loscr \"Pistonazo.bat\"\n</code></pre> dsmod user para modificar el script de inicio <p>Esto habr\u00e1 modificado el campo Script de inicio de sesi\u00f3n de nuestros usuarios de la organizaci\u00f3n de Pistonazo:</p> Script de inicio de sesi\u00f3n <p>Y ahora si iniciamos sesi\u00f3n con alguno de los usuarios de Pistonazo, veremos que nos habr\u00e1 a\u00f1adido una nueva unidad de red, la unidad P: que conectar\u00e1 a la estructura de Pistonazo que se encuentra en el servidor:</p> Unidad de red Pistonazo"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#ejemplos-de-scripts-de-inicio-de-sesion-asignacion-de-unidad-de-red_1","title":"Ejemplos de scripts de inicio de sesi\u00f3n: Asignaci\u00f3n de unidad de red","text":"<p>Supongamos que queremos enviar un mensaje a los usuarios cuando se conecten al sistema. Suele ser habitual enviar mensajes del tipo 'Guarda los datos en red' o 'No instales software sin permiso del administrador', o simplemente avisar de paradas planeadas en el sistema. Para enviar este tipo de mensajes autom\u00e1ticamente cuando el usuario inicia sesi\u00f3n podemos utilizar el comando msg dentro del fichero de comandos de inicio de sesi\u00f3n que hemos creado en el punto anterior:</p> <pre><code>if NOT EXIST P: net use P: \\\\192.168.100.1\\Pistonazo\nmsg %username% Recuerda guardar los datos en las unidades Z: o P:\n</code></pre> Mensajes de aviso a usuarios"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#perfiles","title":"Perfiles","text":"<p>Podemos definir un perfil como aquellos aspectos de configuraci\u00f3n del equipo y del entorno de trabajo propios del usuario y que adem\u00e1s son exportables a otras m\u00e1quinas de manera transparente al mismo. En otras palabras, mediante los perfiles conseguimos que el usuario independientemente del equipo en el que inicie la sesi\u00f3n disponga de un entorno de trabajo similar. Todo esto se entender\u00e1 mejor con los ejemplos preparados en las secciones siguientes.</p> <p>Existen tres tipos de perfiles:</p> <ol> <li>Perfiles locales : se almacenan en el equipo, y configuran el entorno de trabajo de cada usuario. No los abordaremos en este curso ya que lo que nos interesa es la gesti\u00f3n centralizada de recursos.</li> <li>Perfiles m\u00f3viles : el usuario configura el entorno de trabajo a su gusto en un equipo, y al iniciar sesi\u00f3n en cualquier otra estaci\u00f3n de trabajo, la configuraci\u00f3n se importa y aplica a ese nuevo equipo. Abordaremos este tipo de perfiles m\u00e1s adelante.</li> <li>Perfiles obligatorios : un usuario con permisos de administraci\u00f3n define la configuraci\u00f3n del entorno de trabajo, y se aplica a los usuarios del dominio. Estos pueden modificarla durante la sesi\u00f3n, pero al iniciar otra sesi\u00f3n, se vuelve a cargar la configuraci\u00f3n del perfil obligatorio. En lugar de trabajar con perfiles obligatorios, en el apartado anterior hemos visto c\u00f3mo configurar entornos de trabajo definidos para los miembros de una unidad organizativa de una manera m\u00e1s c\u00f3moda y potente.</li> </ol>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#perfiles-moviles","title":"Perfiles m\u00f3viles","text":"<p>Como se ha comentado en el apartado anterior, los perfiles consisten en una serie de ficheros de configuraci\u00f3n del entorno de trabajo, que se aplican a todos los equipos de la red desde donde pueda iniciar sesi\u00f3n el usuario. Estos ficheros de configuraci\u00f3n deben almacenarse en una ubicaci\u00f3n accesible por los equipos clientes, como por ejemplo el controlador de dominio.</p> <p>Concretamente, almacenaremos los perfiles en una carpeta de perfil. Esta carpeta de perfil la crearemos dentro de las carpetas particulares de los usuarios. Por ejemplo, vamos a hacer que los usuarios del departamento Gesti\u00f3n tengan un perfil m\u00f3vil:</p> Perfil m\u00f3vil para usuarios de departamento Gesti\u00f3n <p>Esto har\u00e1 que estos usuarios cuando inicien sesi\u00f3n en alguna de las m\u00e1quinas cliente de nuestro dominio, recupere todo su perfil de la carpeta personal del usuario. Para ello, vamos a modificar el siguiente campo de la pesta\u00f1a perfil:</p> Perfil m\u00f3vil usuario usudir1 <p>Y estableceremos la ruta de acceso al perfil. En nuestro caso, vamos a establecer la ruta de acceso al perfil m\u00f3vil, dentro de la carpeta personal del usuario. Por tanto, seleccionaremos los dos usuarios y con el bot\u00f3n de la derecha del rat\u00f3n:</p> Perfil m\u00f3vil usuarios gestion <p>Y para la ruta del perfil m\u00f3vil estableceremos la siguiente direcci\u00f3n: <code>\\\\192.168.100.1\\Pistonazo_users$\\%username%\\perfil</code></p> <p>De esta forma cuando alg\u00fan usuario de Gesti\u00f3n inicie sesi\u00f3n, se crear\u00e1 en la carpeta personal su perfil. As\u00ed independientemente del equipo donde se conecte, siempre tendr\u00e1 la informaci\u00f3n:</p> Creaci\u00f3n de carpeta de perfil m\u00f3vil <p>Warning</p> <ul> <li>Carga en red Perfil M\u00f3vil : Hay que tener en cuenta de que cuando un usuario con perfil m\u00f3vil inicia la sesi\u00f3n, la informaci\u00f3n del servidor se copia al cliente. Cuando cierra la sesi\u00f3n se realiza la operaci\u00f3n inversa. Un alto n\u00famero de usuario con perfil m\u00f3vil puede sobrecargar la red demasiado. Por tanto, hay que saber exactamente en qu\u00e9 usuarios debemos aplicar esta caracter\u00edstica.</li> </ul>"},{"location":"08_RECURSOS_AD/AyudaASO/Practica09_AD.html#actividades","title":"Actividades","text":"<p>En esta actividad, vamos a seguir con la organizaci\u00f3n de vuestra empresa. La que realizasteis en la pr\u00e1ctica anterior:</p> <p>Un supuesto ejemplo de empresa:</p> Estructura Empresa <ol> <li>Crear la estructura de carpetas en disco y definir los siguientes permisos:</li> </ol> <p>Se puede seguir el siguiente ejemplo: A la carpeta principal Empresa, s\u00f3lo podr\u00e1n acceder los miembros del grupo Empresa. En esta carpeta solo tendr\u00e1n acceso de lectura. Cada departamento podr\u00e1 entrar en su carpeta con permisos de control total y no podr\u00e1 acceder al resto de departamentos de la empresa.</p> Estructura de carpetas Empresa <ol> <li>Crear tambi\u00e9n la estructura para almacenar las carpetas particulares de los usuarios. Por ejemplo en <code>C:\\Empresa_users</code></li> </ol> Carpeta de usuarios <ol> <li>Cuando un usuario inicie sesi\u00f3n, conectar\u00e1 de manera autom\u00e1tica la carpeta personal en la unidad X: y la carpeta de empresas en la unidad Y:</li> </ol> Inicio sesi\u00f3n usuario Empresa <p>Para esta actividad hay que utilizar los scripts <code>pistonazoCompleto.bat | pistonazoCompletoPS.ps1</code>; </p> <p>Note</p> <p>Se debe adaptadar a la actividad y explicar cada parte del script.</p> <ul> <li>En esta actividad se entregar\u00e1 un script.ps1 y script.bat con las \u00f3rdenes para crear las carpetas de los departamentos, las carpetas de los usuarios y los permisos correspondientes. </li> <li>Tambi\u00e9n un informe con una captura de pantalla con las unidades de red montadas de un usuario.</li> </ul>"},{"location":"09_PT_FINAL/ProyectoFinal.html","title":"Proyecto Final de M\u00f3dulo (PFM)","text":"<p>Contribuci\u00f3n a los CEs (Criterios de Evaluaci\u00f3n)</p> <p>Estas actividades contribuyen a los siguientes resultados de aprendizaje RA1, RA2, RA3, RA4, RA5 RA6 y RA7 de SOR.</p> <p>Situaci\u00f3n de Aprendizaje</p> <p>Partiendo de la Situaci\u00f3n de aprendizaje, Se te ha encargado realizar la implantaci\u00f3n de un Servicio de Directorio a elegir entre Active directory y Samba DC. </p> <p>Premisas</p> <ul> <li>Proyecto Creaci\u00f3n de Servicio de Directorio. El proyecto se realizar\u00e1 individual o por grupos de dos personas como m\u00e1ximo con el principal objetivo de emular la configuraci\u00f3n de instalaci\u00f3n de un Active Directory o de Samba DC en una empresa ficticia que se deber\u00e1 detallar (por parte del alumnado). </li> <li>Una vez instalado se crear\u00e1n usuarios, grupos y dominios, comprobando el acceso de los usuarios al servicio de directorio seg\u00fan las directivas de seguridad que se deben definir (por parte del alumnado) durante el proyecto.</li> <li>Adem\u00e1s se generaran recursos compartidos, a los que se configuraran el acceso apropiado seg\u00fan las directivas de seguridad definidas, comprobando dicho acceso.</li> </ul> <p>\u00a1\u00a1Cuidado!!</p> <ul> <li>Los puntos a realizar en el proyecto pueden aumentar hasta que se imparta todo el temario.</li> <li>El proyecto se presentar\u00e1 al profesor/a responsable del m\u00f3dulo en una cita concertada en la semana de ex\u00e1menes de la evaluaci\u00f3n, previa consulta y muestra de la situaci\u00f3n del proyecto en la semana de preparaci\u00f3n de los ex\u00e1menes.</li> </ul> <p>Tarea</p> <p>A continuaci\u00f3n se muestra una gu\u00eda de pasos para iniciar el proyecto.</p>"},{"location":"09_PT_FINAL/ProyectoFinal.html#pfm11-inicio-del-proyecto","title":"PFM11 Inicio del proyecto","text":"<p>Se debe presentar un un pdf con las siguientes premisas:</p> <ul> <li>Nombre del componente o de los componentes del grupo (m\u00e1ximo 2).</li> <li>Definici\u00f3n de la Organizaci\u00f3n:<ul> <li>Nombre.</li> <li>Dominio.</li> <li>Unidades Organizativas, (m\u00ednimo 4).</li> <li>Usuarios y grupos (diferentes niveles, administradores, usuarios de OUs). Se deber\u00e1 generar informaci\u00f3n inventada para los usuarios. Para generar datos inventados PINCHA AQU\u00cd.</li> <li>Definici\u00f3n de directorios de cada OU.</li> <li>Realizar un mapa conceptual de la organizaci\u00f3n. Ejemplo:</li> </ul> </li> </ul> Ejemplo de Directorios de Organizaci\u00f3n. <p>NOTA</p> <p>En el caso de ser realizado el proyecto por un grupo la nota ser\u00e1 la misma para los componentes del grupo.</p>"},{"location":"09_PT_FINAL/ProyectoFinal.html#pfm12-desarrollo-del-proyecto","title":"PFM12 Desarrollo del proyecto","text":"<p>Se debe realizar una memoria y presentaci\u00f3n del desarrollo del proyecto donde se cumplan las siguientes premisas.</p> <ul> <li>La memoria debe contener, portada, \u00edndice, desarrollo de los apartados, numeraci\u00f3n de figuras, y bibliograf\u00eda.</li> <li>La presentaci\u00f3n debe estar orientada a la defensa del proyecto el d\u00eda del examen, con una duraci\u00f3n m\u00e1xima de 10 minutos (Importante).</li> <li>El desarrollo del proyecto debe centrase en la implementaci\u00f3n de un servicio de directorio en linux o Windows, explicando con argumentos la elecci\u00f3n de la distribuci\u00f3n y desplegando el escenario necesario en virtualbox.</li> <li>En el servicio de directorio se deben crear los usuarios, grupos, departamentos, y recursos compartidos definidos en el PFM11.</li> </ul>"},{"location":"09_PT_FINAL/ProyectoFinal.html#pfm13-defensa-del-proyecto","title":"PFM13 Defensa del proyecto","text":"<p>Se debe defender el proyecto seg\u00fan la memoria y presentaci\u00f3n entregada, el d\u00eda del examen, con duraci\u00f3n de 10 minutos.</p>"},{"location":"AyudaASO/ProgramacionAula.html","title":"Programaci\u00f3n de Aula","text":""},{"location":"AyudaASO/ProgramacionAula.html#resultados-de-aprendizaje","title":"Resultados de Aprendizaje","text":"<p>Esta unidad cubre parte del Resultado de aprendizaje 1 (RA1) seg\u00fan el Real Decreto 1629/2009, de 30 de octubre, el cual es:</p> <ol> <li>Administra el servicio de directorio interpretando especificaciones e integr\u00e1ndolo en una red.</li> </ol> <p>Los criterios de evaluaci\u00f3n asociados son:</p> <ol> <li>a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>b. Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>g. Se han implantado guiones en sistemas libres y propietario.</li> <li>h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>i. Se han documentado los guiones creados.</li> </ol>"},{"location":"AyudaASO/ProgramacionAula.html#planificacion-temporal","title":"Planificaci\u00f3n Temporal","text":"<p>Sesi\u00f3n.</p> <p>Fecha</p> <p>Contenido</p> <p>Recurso Did\u00e1ctico</p> <p>             1             </p> <p>             13/09/22             </p> <p>             Introducci\u00f3n ShellScripting, Creaci\u00f3n ShellScript, Comentarios, Depuraci\u00f3n.             </p> <p> Introducci\u00f3n ShellScripting </p> <p>             2             </p> <p>             14/09/22             </p> <p>             Sintaxis, Argumentos, Variables, Interacci\u00f3n con el usuario, Operadores, re-direcciones y tuber\u00edas.             </p> <p> Sintaxis ShellScripting </p> <p>             3             </p> <p>             15/09/22             </p> <p>             Control de Flujo. Estructuras condicionales e iterativas.             </p> <p> Control de Flujo. </p> <p>             4             </p> <p>             20/09/22             </p> <p>             Vectores y funciones             </p> <p> Vectores y Funciones. </p> <p>             5             </p> <p>             22/09/22             </p> <p>             Refuerzo y Ampliaci\u00f3n.             </p> <p> Refuerzo y Ampliaci\u00f3n. </p> <p>             6             </p> <p>             19/09/22             </p> <p>             Prueba Espec\u00edfica             </p> <p> Prueba Espec\u00edfica. </p>"},{"location":"tags.html","title":"Tags","text":"<p>Los tags m\u00e1s empleados en los apuntes son:</p>"}]}