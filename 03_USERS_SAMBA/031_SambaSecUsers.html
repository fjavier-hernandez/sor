
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Configuración Secciones y Usuarios en Samba de Francisco Javier Hernández Illán.">
      
      
      
        <link rel="canonical" href="https://github.com/fjavier-hernandez/sor/03_USERS_SAMBA/031_SambaSecUsers.html">
      
      
      
      
      <link rel="icon" href="../imagenes/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Secciones y Usuarios en Samba - Sistemas Operativos en Red</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-0CPJP88MBF"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-0CPJP88MBF",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-0CPJP88MBF",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="javi" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#secciones-y-usuarios-en-samba" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Sistemas Operativos en Red" class="md-header__button md-logo" aria-label="Sistemas Operativos en Red" data-md-component="logo">
      
  <img src="../imagenes/SOR_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sistemas Operativos en Red
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Secciones y Usuarios en Samba
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="javi" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Sistemas Operativos en Red" class="md-nav__button md-logo" aria-label="Sistemas Operativos en Red" data-md-component="logo">
      
  <img src="../imagenes/SOR_logo.png" alt="logo">

    </a>
    Sistemas Operativos en Red
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../SituacionAprendizaje.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Situación de Aprendizaje
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Evaluacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1.- Instalación de Sistemas Operativos en red.
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            1.- Instalación de Sistemas Operativos en red.
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_INTRO_SOR/001_IntroSOR.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1- Introducción a Sistemas Operativos en Red
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_INTRO_SOR/002_Virtualizaci%C3%B3n.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2- Virtualización
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_INTRO_SOR/006_Instalacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3- Instalación de Sistemas Operativos en Red
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="secciones-y-usuarios-en-samba">Secciones y Usuarios en SAMBA<a class="headerlink" href="#secciones-y-usuarios-en-samba" title="Permanent link">&para;</a></h1>
<h2 id="secciones">Secciones<a class="headerlink" href="#secciones" title="Permanent link">&para;</a></h2>
<p>Aunque en la UT anterior ya se comentaron parámetros de algunas de las secciones del archivo de configuración de <strong>Samba</strong>, es importante desarrollar más en profundidad las diferentes opciones que nos brinda <strong>Samba</strong> a través de dichas secciones.</p>
<p>Dentro del fichero de configuración <code>/etc/samba/smb.conf</code> encontramos diversas secciones, entre las que se destacan tres:</p>
<ul>
<li><code>[global]</code>: Es la sección principal que nos permite configurar los parámetros generales del servicio. Las opciones especificadas aquí afectan a cualquier recurso compartido. </li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>A tener en cuenta, si una misma opción se declara en la sección global y en otra sección, por ejemplo una carpeta compartida con el nombre <code>ejercicio1</code>, tendrá mayor peso la de la sección más específica, es decir, la especificada en la sección llamada <code>ejercicio1</code>.</p>
</div>
<ul>
<li><code>[homes]</code>: Esta sección permite compartir las carpetas home de cada usuario, para que cada usuario pueda acceder a su carpeta home por la red. </li>
</ul>
<div class="admonition tip">
<p class="admonition-title">consejo</p>
<p>Se puede indicar las opciones para el <code>/home</code> de los usuarios existentes en el servidor. De tal forma que podríamos acceder a nuestro <code>/home</code> desde cualquier máquina del grupo de trabajo de la siguiente forma: <code>\\IP_SERVIDOR\usuario</code> &#8594; (file://IP_SERVIDOR/usuario)</p>
</div>
<ul>
<li><code>[printers]</code>: Permite compartir impresoras en red.</li>
</ul>
<h3 id="parametros">Parámetros<a class="headerlink" href="#parametros" title="Permanent link">&para;</a></h3>
<p>Puesto que editando el archivo <code>smb.conf</code> se pueden configurar más de 300 parámetros, dando lugar a miles de configuraciones, esta guía se limitará a analizar los parámetros más relevantes</p>
<ol>
<li>En la sección <code>[global]</code> se especifican las siguientes opciones generales:</li>
</ol>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>workgroup</strong></td>
<td>Esta variable ha de almacenar el nombre del grupo de trabajo o dominio que usamos en nuestra red.</td>
</tr>
<tr>
<td><strong>server string</strong></td>
<td>Permite reconocer el equipo dentro del dominio. Por defecto tiene como valor el nombre del servidor.</td>
</tr>
<tr>
<td><strong>hosts allow</strong></td>
<td>Especifica desde qué direcciones IP se podrá acceder al servicio. Si se especifica  192.168. todas las direcciones que empiecen de ese modo tendrán acceso al recurso. Se puede establecer direcciones IP completas.</td>
</tr>
<tr>
<td><strong>hosts deny</strong></td>
<td>Especifica los rangos no permitidos, del mismo modo que <strong>host allow</strong>.</td>
</tr>
<tr>
<td><strong>security,</strong></td>
<td>Especifica el nivel de seguridad con el que se puede acceder.</td>
</tr>
</tbody>
</table>
<div class="admonition example">
<p class="admonition-title">Ejemplo [global]</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="w">    </span><span class="o">[</span>global<span class="o">]</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="c1"># Seguridad por usuarios</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="nv">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>user
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="c1"># Grupo de trabajo &#39;Aula5&#39;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="nv">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Aula5<span class="w"> </span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="c1"># Las contraseñas se deberán enviar encriptadas </span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span>encrypt<span class="w"> </span><span class="nv">passwords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="c1"># Samba será servidor wins</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span>wins<span class="w"> </span><span class="nv">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="c1"># Nivel y longitud máxima del archivo de registro</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span>log<span class="w"> </span><span class="nv">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span>max<span class="w"> </span>log<span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="c1"># Por defecto, lectura y escritura</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="nb">read</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="c1"># Se comparten también las impresoras</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span>load<span class="w"> </span><span class="nv">printers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
</code></pre></div>
<ul>
<li>Más ejemplos:</li>
</ul>
<p><code>hosts allow/deny</code>: Permite restringir el acceso por IP:</p>
<div class="admonition example">
<p class="admonition-title">Ejemplo1</p>
<p><strong>Permitir Redes</strong><br />
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">hosts allow = 192.168.2.0/24 192.168.3.0/24</span>
</code></pre></div></p>
</div>
<div class="admonition example">
<p class="admonition-title">Ejemplo2</p>
<p><strong>Permitir IP específica</strong><br />
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">hosts allow = 192.168.2.5 192.168.3.100 192.168.3.200</span>
</code></pre></div></p>
</div>
<div class="admonition example">
<p class="admonition-title">Ejemplo1</p>
<p><strong>Permitir acceso a todos los hosts que comiencen por 192.168.</strong><br />
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">hosts allow = 192.168.</span>
</code></pre></div></p>
</div>
<div class="admonition example">
<p class="admonition-title">Ejemplo1</p>
<p><strong>Deniega acceso a todos los hosts que comiencen por 10.</strong><br />
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">hosts deny = 10.</span>
</code></pre></div></p>
</div>
<ul>
<li>Su funcionamiento es de arriba abajo, como las listas de acceso. Es decir, si tenemos:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="l l-Scalar l-Scalar-Plain">hosts allow = 127.0.0.1 192.168.2.0/24 192.168.3.0/24</span>
<span class="linenos" data-linenos="2 "></span><span class="l l-Scalar l-Scalar-Plain">hosts deny = 127.0.0.1 192.168.2.0/24 192.168.3.0/24</span>
</code></pre></div>
<p><strong>El que cuenta es el primero que coincida, por tanto sí permitiría el acceso.</strong></p>
<ol start="2">
<li>En la sección <code>[homes]</code> se muestra el siguiente ejemplo:</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Ejemplo</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="w">    </span><span class="o">[</span>homes<span class="o">]</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="c1"># Comentario</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nv">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Carpetas<span class="w"> </span>home<span class="w"> </span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="c1"># No explorables</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="nv">browsable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no<span class="w"> </span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="c1"># Máscara de creación de archivos (rxw------)</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span>create<span class="w"> </span><span class="nv">mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0700</span><span class="w"> </span>
<span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="c1"># Máscara de creación de carpetas</span>
<span class="linenos" data-linenos="9 "></span><span class="w">    </span>directory<span class="w"> </span><span class="nv">mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0700</span>
</code></pre></div>
<ol start="3">
<li>En la sección <code>[printers]</code> se muestra el siguiente ejemplo:</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Ejemplo</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="w">    </span><span class="o">[</span>printers<span class="o">]</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/var/tmp<span class="w"> </span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="nv">printable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="linenos" data-linenos="4 "></span><span class="w">    </span>min<span class="w"> </span>print<span class="w"> </span><span class="nv">space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2000</span>
</code></pre></div>
<h2 id="usuarios">Usuarios<a class="headerlink" href="#usuarios" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Para que esa administración sea posible, <strong>Samba</strong> dispone de su propia base de datos de <code>usuarios samba</code> pero como los usuarios utilizan otros recursos del servidor como carpetas e impresoras, es necesario que estén creados en el sistema Unix.</p>
</li>
<li>
<p>Resumiendo, podemos decir que <strong>para poder ser usuario de samba, es necesario disponer de una cuenta de usuario en Unix y de una cuenta de usuario en samba</strong>.</p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Gestión usuarios</p>
<ul>
<li>La gestión de usuarios de samba se puede realizar de dos formas: </li>
<li>con el comando <code>smbpasswd</code>. Con dicho comando, entre otras cosas podremos crear y eliminar usuarios, cambiar su contraseña, etc.</li>
<li>A través de los comandos <strong>samba-tool user</strong> y <strong>samba-tool group</strong>.</li>
</ul>
</div>
<ul>
<li>Inicialmente se van a realizar con la primera opción.</li>
</ul>
<h3 id="creacion-de-un-usuario-de-samba-con-smbpasswd">Creación de un usuario de samba con smbpasswd<a class="headerlink" href="#creacion-de-un-usuario-de-samba-con-smbpasswd" title="Permanent link">&para;</a></h3>
<p>Para crear un usuario de samba se puede utilizar el comando <code>smbpasswd</code>, pero antes debemos haber creado el usuario en Unix.</p>
<div class="admonition example">
<p class="admonition-title">Ejemplo</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># Creación del usuario pepe</span>
<span class="linenos" data-linenos="2 "></span>sudo<span class="w"> </span>useradd<span class="w"> </span>pepe
<span class="linenos" data-linenos="3 "></span><span class="c1"># Si se desea que pepe pueda disfrutar de los servicios samba, debemos crear a pepe como usuario de samba ejecutando el siguiente comando:</span>
<span class="linenos" data-linenos="4 "></span>sudo<span class="w"> </span>smbpasswd<span class="w"> </span>-a<span class="w"> </span>pepe
<span class="linenos" data-linenos="5 "></span><span class="c1"># Con la opción -a indicamos que añada al usuario. </span>
<span class="linenos" data-linenos="6 "></span><span class="c1"># Acto seguido nos preguntará dos veces la contraseña que deseamos poner al usuario. Lo razonable es que sea la misma contraseña que tiene el usuario en Unix. </span>
</code></pre></div>
<h3 id="eliminar-un-usuario-de-samba">Eliminar un usuario de samba<a class="headerlink" href="#eliminar-un-usuario-de-samba" title="Permanent link">&para;</a></h3>
<p>Para eliminar un usuario de samba debemos ejecutar <code>smbpasswd</code> con la opción <code>-x</code>, </p>
<div class="admonition example">
<p class="admonition-title">Ejemplo</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># Eliminar un usuario de samba</span>
<span class="linenos" data-linenos="2 "></span>sudo<span class="w"> </span>smbpasswd<span class="w"> </span>-x<span class="w"> </span>pepe
<span class="linenos" data-linenos="3 "></span><span class="c1"># Inmediatamente el usuario habrá desaparecido de la base de datos de &#39;usuarios samba&#39; aunque seguirá siendo un usuario de Unix.</span>
</code></pre></div>
<ol start="3">
<li>Otras opciones de <code>smbpasswd</code></li>
</ol>
<ul>
<li><code>-d</code>: Deshabilitar un usuario</li>
<li><code>-e</code>: Habilitar un usuario.</li>
<li><code>-m</code>: Indica que es una cuenta de máquina (equipo)</li>
<li><code>-n</code>: Usuario sin password.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La última opción Necesita parámetro null passwords = yes en sección 'global' del archivo de configuración de samba</p>
</div>
<h3 id="el-usuario-invitado">El usuario Invitado<a class="headerlink" href="#el-usuario-invitado" title="Permanent link">&para;</a></h3>
<p>Cuando accedemos como “<strong>invitado</strong>” (guest ok) por defecto accedemos como el usuario <code>nobody:nogroup</code>. Esto se puede modificar usando el siguiente parámetro:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>force<span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>javi
<span class="linenos" data-linenos="2 "></span>force<span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>alumnos
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Opción</p>
<p>De esta forma cuando accedamos al sistema como invitado accederemos como el usuario <code>javi</code> que tiene el grupo principal alumnos.</p>
</div>
<h3 id="restriccion-por-usuarios">Restricción por usuarios<a class="headerlink" href="#restriccion-por-usuarios" title="Permanent link">&para;</a></h3>
<p>En caso de que no permitamos el acceso de invitados (guest ok = no) el servidor nos solicitará nuestras credenciales:</p>
<figure>
  <img src="./imagenes/001.png" width="450"/>
</figure>

<ul>
<li>Por otra parte se puede restringir los usuarios que pueden tener acceso a un recurso:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>valid<span class="w"> </span><span class="nv">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>javi<span class="w"> </span>pepe<span class="w"> </span>jorge
<span class="linenos" data-linenos="2 "></span>invalid<span class="w"> </span><span class="nv">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>root<span class="w"> </span>@profesores<span class="w"> </span>@root
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El <code>“@”</code> indica que se hace referencia a un grupo. Por tanto ningún usuario perteneciente al grupo root o de profesores puede acceder.</p>
</div>
<ul>
<li>Además se pueden crear usuarios administradores.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>admin<span class="w"> </span><span class="nv">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>javi
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA:</strong></p>
<p>Los usuarios dentro de esta lista actuarán como <code>root</code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA:</strong></p>
<p>Si un usuario está en el listado de “valid users” y en el de “invalid users” se le deniega el acceso.</p>
</div>
<h3 id="autentificacion-en-samba-a-traves-de-usuarios">Autentificación en Samba a través de usuarios<a class="headerlink" href="#autentificacion-en-samba-a-traves-de-usuarios" title="Permanent link">&para;</a></h3>
<p>Para autentificarse en <code>Samba</code> a través de usuarios se deben cumplir 2 requisitos:</p>
<ol>
<li>El usuario debe existir en el sistema <code>/etc/passwd</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>sudo<span class="w"> </span>useradd<span class="w"> </span>-s<span class="w"> </span>/bin/true<span class="w"> </span>“usuario”
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>Nota</strong></p>
<p>De esta forma no se crea el <code>/home</code> del usuario y no se permite el acceso al sistema si no es a través de <strong>Samba</strong>. Es decir, el usuario no se podría conectar a través de <code>ssh</code> o localmente.</p>
</div>
<ol start="2">
<li>El usuario debe existir en el servicio de samba. Para listar los usuarios se utiliza el comando <code>pbedit -L</code>.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>sudo<span class="w"> </span>smbpasswd<span class="w"> </span>–a<span class="w"> </span>“usuario”
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTA:</strong></p>
<p>La contraseña es recomendable que sea diferente a la usada en el sistema.</p>
</div>
<ul>
<li><strong>Listar usuarios dados de alta en SAMBA:</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>pdbedit<span class="w"> </span>-L
</code></pre></div>
<!-- smb encrypt = required
client min protocol = SMB2
client max protocol = SMB3 -->







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023-2024 Francisco Javier Hernández Illán - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:<fj.hernandez@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/fjavier-hernandez-illan" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Consentimiento de cookie</h4>
<p>Esta página de apuntes utiliza cookies para reconocer las visitas, medir la efectividad de la documentación y averiguar si encuentras aquello que buscas o cómo has llegado a estos apuntes. Con tu consentimiento, me ayudas a mejorar estos materiales.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Aceptar</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestionar cookies</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "toc.integrate", "navigation.indexes", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>